var all = "%3CEffect%20matchname%3D%22Ouroboros%22%20name%3D%22%24%24%24%2FAE%2FPreset%2FOuroboros%3DOuroboros%22%3E%0A%20%20%20%20%3CLayer%20name%3D%22%24%24%24%2FAE%2FPreset%2FReference%3DReference%22%20default_self%3D%22false%22%2F%3E%0A%20%20%20%20%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FRandomSeed%3DRandom%20Seed%22%20default%3D%221%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%220%22%2F%3E%0A%20%20%20%20%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FPathIndexnr.%3DPath%20Index%20nr.%22%20default%3D%221%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%220%22%2F%3E%0A%20%20%20%20%3CGroup%20name%3D%22%24%24%24%2FAE%2FPreset%2F.%3D.%22%3E%0A%20%20%20%20%3C%2FGroup%3E%0A%20%20%20%20%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FStart%3DStart%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FEnd%3DEnd%22%20default%3D%22100%22%20valid_min%3D%220%22%20valid_max%3D%22100%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%3CAngle%20name%3D%22%24%24%24%2FAE%2FPreset%2FOffset%3DOffset%22%20default%3D%220%22%2F%3E%0A%20%20%20%20%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FOffsetRandom%3DOffset%20Random%22%20default%3D%220%22%20valid_min%3D%22-100000%22%20valid_max%3D%22100000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%20CANNOT_TIME_VARY%3D%22true%22%2F%3E%0A%20%20%20%20%3CGroup%20name%3D%22%24%24%24%2FAE%2FPreset%2FStroke%3DStroke%22%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FWidthpx%3DWidth%20px%22%20default%3D%2230%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%220%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FWidthRandom%3DWidth%20Random%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%09%3CCheckbox%20name%3D%22%24%24%24%2FAE%2FPreset%2FWidthMaintain%3DWidth%20Maintain%22%20default%3D%22false%22%2F%3E%0A%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FOpacity%3DOpacity%22%20default%3D%22100%22%20valid_min%3D%220%22%20valid_max%3D%22100%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FOpacityRandom%3DOpacity%20Random%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FTrimStart%3DTrim%20Start%22%20default%3D%220%22%20valid_min%3D%22-1000%22%20valid_max%3D%221000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FTrimEnd%3DTrim%20End%22%20default%3D%22100%22%20valid_min%3D%22-1000%22%20valid_max%3D%221000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%09%09%3CAngle%20name%3D%22%24%24%24%2FAE%2FPreset%2FTrimOffset%3DTrim%20Offset%22%20default%3D%220%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FTrimRandom%3DTrim%20Random%22%20default%3D%220%22%20valid_min%3D%22-10000%22%20valid_max%3D%2210000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FSpeed%3DSpeed%22%20default%3D%220%22%20valid_min%3D%22-100000%22%20valid_max%3D%22100000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FSpeedRandom%3DSpeed%20Random%22%20default%3D%220%22%20valid_min%3D%22-100000%22%20valid_max%3D%22100000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%20CANNOT_TIME_VARY%3D%22true%22%2F%3E%0A%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FDelay%2Fsec%3DDelay%20%2F%20sec%22%20default%3D%220%22%20valid_min%3D%22-100000%22%20valid_max%3D%22100000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FDelayRandom%3DDelay%20Random%22%20default%3D%220%22%20valid_min%3D%22-100000%22%20valid_max%3D%22100000%22%20slider_min%3D%22-100%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%09%3C%2FGroup%3E%0A%20%20%20%20%3CGroup%20name%3D%22%24%24%24%2FAE%2FPreset%2FColor%3DColor%22%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FColorOffset%3DColor%20Offset%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%220%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FCyclesps%3DCycles%20ps%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100000%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%220%22%2F%3E%0A%20%20%20%20%09%3CCheckbox%20name%3D%22%24%24%24%2FAE%2FPreset%2FColorRandom%3DColor%20Random%22%20default%3D%22false%22%2F%3E%0A%20%20%20%20%09%3CSlider%20name%3D%22%24%24%24%2FAE%2FPreset%2FRainbow%3DRainbow%22%20default%3D%220%22%20valid_min%3D%220%22%20valid_max%3D%22100%22%20slider_min%3D%220%22%20slider_max%3D%22100%22%20precision%3D%221%22%20DISPLAY_PERCENT%3D%22true%22%2F%3E%0A%20%20%20%20%3C%2FGroup%3E%0A%3C%2FEffect%3E";var instName = "Ouroboros";function PseudoEffectInstaller() {	var clearInstName, startInst, endInst, myPalette, inst, deinst;	clearInstName = decodeURIComponent(instName);	startInst = encodeURIComponent("<!-- ") + instName + encodeURIComponent("_start -->");	endInst = encodeURIComponent("<!-- ") + instName + encodeURIComponent("_end -->");	function isNetworkAccessAllowed() {		var securitySetting		securitySetting = app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY");		if (!securitySetting) alert("Please set preference \"Allow Scripts to Write Files and Access Network\". \n \nWindows:   After Effects  > Edit > Preferences > General \n \nMac:   After Effects > Preferences > General   ");		return securitySetting;	}	function checkOS() {		var appFolderPath, cmd;		if ($.os.indexOf('Windows') > -1) {			//if Windows			appFolderPath = (new Folder(Folder.appPackage).fsName.toString());			cmd = "cmd /c attrib -r /S /D " + "\"" + appFolderPath + "\"";			system.callSystem(cmd);			cmd = "cmd /c attrib -r /S /D " + "\"" + appFolderPath + "\\" + "\PresetEffects.xml\"";			appFolderPath = appFolderPath + "\\";			system.callSystem(cmd);		} else {			//if Mac			appFolderPath = (new Folder(Folder.appPackage.absoluteURI).fsName.toString()) + "/Contents/Resources/";			cmd = "chmod u+rw  " + "\"" + appFolderPath + "\PresetEffects.xml\"";			system.callSystem(cmd);		}		return appFolderPath;	}	// Install Click	function on_inst_click() {		var alreadyInst, AEPath, tempFile, XMLFile, XMLFileIsOK, tempFileIsOK, curLine;		alreadyInst = 0;		if (!isNetworkAccessAllowed()) return ("");		AEPath = checkOS();		tempFile = new File(AEPath + "temp.xml");		XMLFile = new File(AEPath + "PresetEffects.xml");		XMLFileIsOK = XMLFile.open("r", "TEXT", "????");		tempFileIsOK = tempFile.open("w", "TEXT", "????");		if (!(XMLFileIsOK)) {			alert("Installation Error: Can't read PresetEffects.xml ");			return ("");		}		while (!XMLFile.eof) {			curLine = XMLFile.readln();			if (curLine == (decodeURIComponent(startInst))) alreadyInst = 1;			if (curLine.indexOf("</Effects>") == -1) tempFile.writeln(curLine);			else break;		}		tempFile.writeln(decodeURIComponent(startInst + "%0A" + all + "%0A" + endInst + "%0A%3C%2FEffects%3E"));		if (alreadyInst == 1) {			alert(clearInstName + " already installed !");			XMLFile.close();			tempFile.close();			tempFile.remove();		} else {			XMLFile.close();			tempFile.close();			XMLFile.remove();			tempFile.rename("PresetEffects.xml");			alert("Installation complete\nPlease restart After Effects");		}	}	// Deinstall Click	function on_deinst_click() {		var appFolderPath, AEPath, tempFile, tempFileIsOK, XMLFile, XMLFileIsOK, writeOk, curLine;		if ($.os.indexOf('Windows') > -1) {			appFolderPath = (new Folder(Folder.appPackage).fsName.toString()) + "\\";		} else {			appFolderPath = (new Folder(Folder.appPackage.absoluteURI).fsName.toString()) + "/Contents/Resources/";		}		AEPath = appFolderPath;		tempFile = new File(AEPath + "temp.xml");		tempFileIsOK = tempFile.open("w", "TEXT", "????");		XMLFile = new File(AEPath + "PresetEffects.xml");		XMLFileIsOK = XMLFile.open("r", "TEXT", "????");		writeOk = 1;		if (XMLFileIsOK && tempFileIsOK) {			while (!XMLFile.eof) {				curLine = XMLFile.readln();				if (curLine.indexOf(decodeURIComponent(startInst)) != -1)					writeOk = 0;				if (curLine.indexOf(decodeURIComponent(endInst)) != -1) {					writeOk = 1;					continue				}				if (writeOk == 1)					tempFile.writeln(curLine);			}		}		if (tempFile.length != XMLFile.length && tempFile.length > 0) {			XMLFile.close();			tempFile.close();			XMLFile.remove();			tempFile.rename("PresetEffects.xml");			alert("Removing " + clearInstName + " complete");		} else {			XMLFile.close();			tempFile.close();			tempFile.remove();			alert("Nothing to remove")		}	}	myPalette = new Window("palette", clearInstName + " Installer", [400, 300, 695, 410]);	inst = myPalette.add("button", [10, 10, 285, 50], "Install " + clearInstName);	inst.onClick = on_inst_click;	deinst = myPalette.add("button", [10, 60, 285, 100], "Remove " + clearInstName);	deinst.onClick = on_deinst_click;	myPalette.center();	myPalette.show();}PseudoEffectInstaller()