This file is a merged representation of a subset of the codebase, containing specifically included files and files not matching ignore patterns, combined into a single document by Repomix.
The content has been processed where line numbers have been added.

# File Summary

## Purpose
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

## File Format
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  a. A header with the file path (## File: path/to/file)
  b. The full contents of the file in a code block

## Usage Guidelines
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

## Notes
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: Aescripts-easyRulers 2 v2.01/easyRulers.jsx, Aescripts-Origami v1.4.0/**/*.jsx, Aescripts-Easy Clones v1.1/Easy Clones.jsx, Aescripts-Faux Parent 1.1/Faux Parent.jsx, Aescripts-Good Parents v1.4.1/goodParents.jsx
- Files matching these patterns are excluded: .idea/**, **/*.mp4, **/*.mov, **/*.mp3, **/*.wav, **/*.aep, **/*.ffx, **/*.zip, **/*.rar, **/*.7z, **/*.exe, **/*.dmg, **/*.pkg, **/*.pdf, **/*.png, **/*.jpg, **/*.jpeg, **/*.gif, **/*.svg, **/*.ico, **/*.psd, **/*.ai, **/*.reg, **/*.url, Aescripts-Social Importer 1.0.3 for After Effects/Social Importer/panel.js
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Line numbers have been added to the beginning of each line
- Files are sorted by Git change count (files with more changes are at the bottom)

# Directory Structure
```
Aescripts-Easy Clones v1.1/
  Easy Clones.jsx
Aescripts-easyRulers 2 v2.01/
  easyRulers.jsx
Aescripts-Faux Parent 1.1/
  Faux Parent.jsx
Aescripts-Good Parents v1.4.1/
  goodParents.jsx
Aescripts-Origami v1.4.0/
  (Origami_packages)/
    basicSlice.jsx
  Origami.jsx
```

# Files

## File: Aescripts-Easy Clones v1.1/Easy Clones.jsx
```javascript
   1: /*
   2:  * Decompiled with Jsxer
   3:  * Version: 1.7.4
   4:  * JSXBIN 2.0
   5:  */
   6: 
   7: function MW_EasyClones(thisObj) {
   8:   function applyEasyClonesEffect(layer) {
   9:     function makePseudoEffectAvailable(presetFile) {
  10:       var myComp = app.project.activeItem;
  11:       var layerCollection = myComp.selectedLayers;
  12:       switchLayerSelection(layerCollection, false);
  13:       var tempNull = myComp.layers.addNull();
  14:       tempNull.selected = true;
  15:       tempNull.applyPreset(presetFile);
  16:       tempNull.remove();
  17:       switchLayerSelection(layerCollection, true);
  18:     }
  19:     function switchLayerSelection(layerArray, selectionValue) {
  20:       for (var i = 0, il = layerArray.length; i < il; i++) {
  21:         layerArray[i].selected = selectionValue;
  22:       }
  23:     }
  24:     function getAnimationPreset(presetName, presetLocation, presetBinary) {
  25:       var presetFolder = Folder(presetLocation);
  26:       var presetFile = File(presetFolder.toString() + "/" + presetName);
  27:       if (!presetFolder.exists) {
  28:         presetFolder = presetFolder.create();
  29:       }
  30:       if (!presetFile.exists) {
  31:         presetFile.encoding = "BINARY";
  32:         presetFile.open("w");
  33:         presetFile.write(presetBinary);
  34:         presetFile.close();
  35:       }
  36:       return presetFile;
  37:     }
  38:     if (!layer) {
  39:       throw new Error(
  40:         "applyPseudoEffect() method expects one parameter - Layer Object",
  41:       );
  42:     }
  43:     var PseudoEffectMachName = "Pseudo/easyClones1.1";
  44:     var PseudoEffectName = "Easy Clones";
  45:     var AnimationPresetName = "Easy Clones.ffx";
  46:     var aescriptsFolder = Folder(
  47:       Folder.userData.fsName + "/Aescripts/Easy Clones/1.0/",
  48:     );
  49:     aescriptsFolder.create();
  50:     var AnimationPresetBinary = __BLOB__BLOB_000131__;
  51:     if (
  52:       layer.property("Effects").canAddProperty(PseudoEffectMachName) === false
  53:     ) {
  54:       var presetFile = getAnimationPreset(
  55:         AnimationPresetName,
  56:         aescriptsFolder,
  57:         AnimationPresetBinary,
  58:       );
  59:       makePseudoEffectAvailable(presetFile);
  60:     }
  61:     var myEffect = layer.property("Effects").addProperty(PseudoEffectMachName);
  62:     myEffect.name = "Easy Clones";
  63:   }
  64:   function applyCloneControlEffect(selectedLayer) {
  65:     function makePseudoEffectAvailable(presetFile) {
  66:       var myComp = app.project.activeItem;
  67:       var layerCollection = myComp.selectedLayers;
  68:       switchLayerSelection(layerCollection, false);
  69:       var tempNull = myComp.layers.addNull();
  70:       tempNull.selected = true;
  71:       tempNull.applyPreset(presetFile);
  72:       tempNull.remove();
  73:       switchLayerSelection(layerCollection, true);
  74:     }
  75:     function switchLayerSelection(layerArray, selectionValue) {
  76:       for (var i = 0, il = layerArray.length; i < il; i++) {
  77:         layerArray[i].selected = selectionValue;
  78:       }
  79:     }
  80:     function getAnimationPreset(presetName, presetLocation, presetBinary) {
  81:       var presetFolder = Folder(presetLocation);
  82:       var presetFile = File(presetFolder.toString() + "/" + presetName);
  83:       if (!presetFolder.exists) {
  84:         presetFolder = presetFolder.create();
  85:       }
  86:       if (!presetFile.exists) {
  87:         presetFile.encoding = "BINARY";
  88:         presetFile.open("w");
  89:         presetFile.write(presetBinary);
  90:         presetFile.close();
  91:       }
  92:       return presetFile;
  93:     }
  94:     if (!selectedLayer) {
  95:       throw new Error(
  96:         "applyPseudoEffect() method expects one parameter - Layer Object",
  97:       );
  98:     }
  99:     var PseudoEffectMachName = "Pseudo/cloneControls1.1";
 100:     var PseudoEffectName = "Clone Controls";
 101:     var AnimationPresetName = "Clone Controls.ffx";
 102:     var aescriptsFolder = Folder(
 103:       Folder.userData.fsName + "/Aescripts/Easy Clones/1.0/",
 104:     );
 105:     aescriptsFolder.create();
 106:     var AnimationPresetBinary = __BLOB__BLOB_000132__;
 107:     if (
 108:       selectedLayer.property("Effects").canAddProperty(PseudoEffectMachName) ===
 109:       false
 110:     ) {
 111:       var presetFile = getAnimationPreset(
 112:         AnimationPresetName,
 113:         aescriptsFolder,
 114:         AnimationPresetBinary,
 115:       );
 116:       makePseudoEffectAvailable(presetFile);
 117:     }
 118:     var myEffect = selectedLayer
 119:       .property("Effects")
 120:       .addProperty(PseudoEffectMachName);
 121:     myEffect.name = "Clone Controls";
 122:   }
 123:   function createCloneExpressions(
 124:     controlLayer,
 125:     selectedLayers,
 126:     i,
 127:     cloneControlEffect,
 128:   ) {
 129:     var cloneRandomXPositionExpression = [
 130:       'var left = thisComp.layer("' +
 131:         controlLayer.name +
 132:         '").effect("Easy Clones")(13);',
 133:       'var right = thisComp.layer("' +
 134:         controlLayer.name +
 135:         '").effect("Easy Clones")(14);',
 136:       'seedRandom(thisComp.layer("' +
 137:         controlLayer.name +
 138:         '").effect("Easy Clones")(12), true);',
 139:       "random() * (+right - +left) + +left;",
 140:     ].join("\n");
 141:     cloneControlEffect.property("Pseudo/cloneControls1.1-0001").expression =
 142:       cloneRandomXPositionExpression;
 143:     var cloneRandomYPositionExpression = [
 144:       'var up = thisComp.layer("' +
 145:         controlLayer.name +
 146:         '").effect("Easy Clones")(20);',
 147:       'var down = thisComp.layer("' +
 148:         controlLayer.name +
 149:         '").effect("Easy Clones")(21);',
 150:       'seedRandom(thisComp.layer("' +
 151:         controlLayer.name +
 152:         '").effect("Easy Clones")(19), true);',
 153:       "random() * (+down - +up) + +up;",
 154:     ].join("\n");
 155:     cloneControlEffect.property("Pseudo/cloneControls1.1-0002").expression =
 156:       cloneRandomYPositionExpression;
 157:     var cloneRandomZPositionExpression = [
 158:       'var near = thisComp.layer("' +
 159:         controlLayer.name +
 160:         '").effect("Easy Clones")(27);',
 161:       'var far = thisComp.layer("' +
 162:         controlLayer.name +
 163:         '").effect("Easy Clones")(28);',
 164:       'seedRandom(thisComp.layer("' +
 165:         controlLayer.name +
 166:         '").effect("Easy Clones")(26), true);',
 167:       "random() * (+far - +near) + +near;",
 168:     ].join("\n");
 169:     cloneControlEffect.property("Pseudo/cloneControls1.1-0003").expression =
 170:       cloneRandomZPositionExpression;
 171:     var cloneRandomScaleExpression = [
 172:       'var decrease = thisComp.layer("' +
 173:         controlLayer.name +
 174:         '").effect("Easy Clones")(36);',
 175:       'var increase = thisComp.layer("' +
 176:         controlLayer.name +
 177:         '").effect("Easy Clones")(37);',
 178:       'seedRandom(thisComp.layer("' +
 179:         controlLayer.name +
 180:         '").effect("Easy Clones")(35), true);',
 181:       "random() * (+increase - +decrease) + +decrease;",
 182:     ].join("\n");
 183:     cloneControlEffect.property("Pseudo/cloneControls1.1-0004").expression =
 184:       cloneRandomScaleExpression;
 185:     var cloneRandomRotationExpression = [
 186:       'var decrease = thisComp.layer("' +
 187:         controlLayer.name +
 188:         '").effect("Easy Clones")(44);',
 189:       'var increase = thisComp.layer("' +
 190:         controlLayer.name +
 191:         '").effect("Easy Clones")(45);',
 192:       'seedRandom(thisComp.layer("' +
 193:         controlLayer.name +
 194:         '").effect("Easy Clones")(43), true);',
 195:       "random() * (+increase - +decrease) + +decrease;",
 196:     ].join("\n");
 197:     cloneControlEffect.property("Pseudo/cloneControls1.1-0005").expression =
 198:       cloneRandomRotationExpression;
 199:     var cloneRandomOpacityExpression = [
 200:       'var decrease = thisComp.layer("' +
 201:         controlLayer.name +
 202:         '").effect("Easy Clones")(52);',
 203:       'var increase = thisComp.layer("' +
 204:         controlLayer.name +
 205:         '").effect("Easy Clones")(53);',
 206:       'seedRandom(thisComp.layer("' +
 207:         controlLayer.name +
 208:         '").effect("Easy Clones")(51), true);',
 209:       "random() * (+increase - +decrease) + +decrease;",
 210:     ].join("\n");
 211:     cloneControlEffect.property("Pseudo/cloneControls1.1-0006").expression =
 212:       cloneRandomOpacityExpression;
 213:     var cloneRandomDelayExpression = [
 214:       'var decrease = thisComp.layer("' +
 215:         controlLayer.name +
 216:         '").effect("Easy Clones")(5);',
 217:       'var increase = thisComp.layer("' +
 218:         controlLayer.name +
 219:         '").effect("Easy Clones")(6);',
 220:       'seedRandom(thisComp.layer("' +
 221:         controlLayer.name +
 222:         '").effect("Easy Clones")(4), true);',
 223:       "random() * (+increase - +decrease) + +decrease;",
 224:     ].join("\n");
 225:     cloneControlEffect.property("Pseudo/cloneControls1.1-0007").expression =
 226:       cloneRandomDelayExpression;
 227:     var cloneRandomSeedExpression = [
 228:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10);',
 229:       "seedRandom(newIndex,true);",
 230:       "random(0,100);",
 231:     ].join("\n");
 232:     cloneControlEffect.property("Pseudo/cloneControls1.1-0008").expression =
 233:       cloneRandomSeedExpression;
 234:     var clonePositionExpression = [
 235:       "// Clone Master //",
 236:       'var cloneMaster = thisComp.layer("' + controlLayer.name + '");',
 237:       " ",
 238:       "// Delay & Frames //",
 239:       'var frameDelay = thisComp.layer("' +
 240:         controlLayer.name +
 241:         '").effect("Easy Clones")(2);',
 242:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 243:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 244:       "var delay = frameDelay*framesToTime(newIndex);",
 245:       " ",
 246:       "//Modifiers //",
 247:       'var randomXPosition = effect("Clone Controls")(1);',
 248:       'var xWiggle = wiggle(thisComp.layer("' +
 249:         controlLayer.name +
 250:         '").effect("Easy Clones")(15), thisComp.layer("' +
 251:         controlLayer.name +
 252:         '").effect("Easy Clones")(16));',
 253:       'var randomYPosition = effect("Clone Controls")(2);',
 254:       'var yWiggle = wiggle(thisComp.layer("' +
 255:         controlLayer.name +
 256:         '").effect("Easy Clones")(22),thisComp.layer("' +
 257:         controlLayer.name +
 258:         '").effect("Easy Clones")(23));',
 259:       'var randomZPosition = effect("Clone Controls")(3);',
 260:       'var zWiggle = wiggle(thisComp.layer("' +
 261:         controlLayer.name +
 262:         '").effect("Easy Clones")(29),thisComp.layer("' +
 263:         controlLayer.name +
 264:         '").effect("Easy Clones")(30));',
 265:       " ",
 266:       'if ( thisComp.layer("' +
 267:         controlLayer.name +
 268:         '").effect("Easy Clones")(10) == true ) {',
 269:       '    var randomXPosition = effect("Clone Controls")(1).valueAtTime(time - (delay - randomDelay));',
 270:       '    var xWiggle = wiggle(thisComp.layer("' +
 271:         controlLayer.name +
 272:         '").effect("Easy Clones")(15).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 273:         controlLayer.name +
 274:         '").effect("Easy Clones")(16).valueAtTime(time - (delay - randomDelay)));',
 275:       '    var randomYPosition = effect("Clone Controls")(2).valueAtTime(time - (delay - randomDelay));',
 276:       '    var yWiggle = wiggle(thisComp.layer("' +
 277:         controlLayer.name +
 278:         '").effect("Easy Clones")(22).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 279:         controlLayer.name +
 280:         '").effect("Easy Clones")(23).valueAtTime(time - (delay - randomDelay)));',
 281:       "    var randomZPosition = randomZPosition.valueAtTime(time - (delay - randomDelay));",
 282:       '    var zWiggle = wiggle(thisComp.layer("' +
 283:         controlLayer.name +
 284:         '").effect("Easy Clones")(29).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 285:         controlLayer.name +
 286:         '").effect("Easy Clones")(30).valueAtTime(time - (delay - randomDelay)));',
 287:       "}",
 288:       " ",
 289:       "function xPositionModifiers(randomXPosition, xWiggle) {",
 290:       "    return randomXPosition + xWiggle[0];",
 291:       "}",
 292:       " ",
 293:       "function yPositionModifiers(randomYPosition, yWiggle) {",
 294:       "    return randomYPosition + yWiggle[1];",
 295:       "}",
 296:       " ",
 297:       "function zPositionModifiers(randomZPosition, zWiggle) {",
 298:       "    return randomZPosition + zWiggle[2];",
 299:       "}",
 300:       " ",
 301:       "//Execute//",
 302:       "if (transform.position.value.length === 3) {",
 303:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle), zPositionModifiers(randomZPosition, zWiggle) ];",
 304:       "} else {",
 305:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle) ];",
 306:       "}",
 307:     ].join("\n");
 308:     selectedLayers[i]
 309:       .property("ADBE Transform Group")
 310:       .property("ADBE Position").expression = clonePositionExpression;
 311:     var cloneRotationExpression = [
 312:       "// Clone Master //",
 313:       'var cloneMaster = thisComp.layer("' +
 314:         controlLayer.name +
 315:         '")("ADBE Transform Group")("ADBE Rotate Z");',
 316:       " ",
 317:       "// Delay & Frames //",
 318:       'var frameDelay = thisComp.layer("' +
 319:         controlLayer.name +
 320:         '").effect("Easy Clones")(2);',
 321:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 322:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 323:       "var delay = frameDelay*framesToTime(newIndex);",
 324:       " ",
 325:       "//Modifiers //",
 326:       'var randomRotation = effect("Clone Controls")(5);',
 327:       'var rotationWiggle = wiggle(thisComp.layer("' +
 328:         controlLayer.name +
 329:         '").effect("Easy Clones")(46),thisComp.layer("' +
 330:         controlLayer.name +
 331:         '").effect("Easy Clones")(47));',
 332:       " ",
 333:       'if ( thisComp.layer("' +
 334:         controlLayer.name +
 335:         '").effect("Easy Clones")(42) == true ) {',
 336:       "    var randomRotation = randomRotation.valueAtTime(time - (delay - randomDelay));",
 337:       '    var rotationWiggle = wiggle(thisComp.layer("' +
 338:         controlLayer.name +
 339:         '").effect("Easy Clones")(46).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 340:         controlLayer.name +
 341:         '").effect("Easy Clones")(47).valueAtTime(time - (delay - randomDelay)));',
 342:       "}",
 343:       " ",
 344:       "function rotationModifiers(cloneMaster, randomRotation, rotationWiggle) {",
 345:       "    return cloneMaster.valueAtTime(time - (delay - randomDelay)) + randomRotation + rotationWiggle;",
 346:       "}",
 347:       " ",
 348:       "//Execute//",
 349:       "rotationModifiers(cloneMaster, randomRotation, rotationWiggle);",
 350:     ].join("\n");
 351:     selectedLayers[i]
 352:       .property("Transform")
 353:       .property("ADBE Rotate Z").expression = cloneRotationExpression;
 354:     var cloneScaleExpression = [
 355:       "// Clone Master //",
 356:       'var cloneMaster = thisComp.layer("' +
 357:         controlLayer.name +
 358:         '").transform.scale;',
 359:       " ",
 360:       "// Delay & Frames //",
 361:       'var frameDelay = thisComp.layer("' +
 362:         controlLayer.name +
 363:         '").effect("Easy Clones")(2);',
 364:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 365:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 366:       "var delay = frameDelay*framesToTime(newIndex);",
 367:       " ",
 368:       "//Modifiers //",
 369:       'var randomScale = effect("Clone Controls")(4);',
 370:       'var scaleWiggle = wiggle(thisComp.layer("' +
 371:         controlLayer.name +
 372:         '").effect("Easy Clones")(38),thisComp.layer("' +
 373:         controlLayer.name +
 374:         '").effect("Easy Clones")(39));',
 375:       " ",
 376:       'if ( thisComp.layer("' +
 377:         controlLayer.name +
 378:         '").effect("Easy Clones")(34) == true ) {',
 379:       '    var randomScale = effect("Clone Controls")(4).valueAtTime(time - (delay - randomDelay));',
 380:       '    var scaleWiggle = wiggle( thisComp.layer("' +
 381:         controlLayer.name +
 382:         '").effect("Easy Clones")(38).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 383:         controlLayer.name +
 384:         '").effect("Easy Clones")(39).valueAtTime(time - (delay - randomDelay)) );',
 385:       "}",
 386:       " ",
 387:       "function scaleModifiers(randomScale, scaleWiggle) {",
 388:       "    return [ randomScale, randomScale ] + [ scaleWiggle[0], scaleWiggle[0] ];",
 389:       "}",
 390:       " ",
 391:       "//Execute//",
 392:       "if (transform.scale.value.length === 3) {",
 393:       "    cloneMaster.valueAtTime(time - (delay - randomDelay)) + [ scaleModifiers(randomScale, scaleWiggle)[0], scaleModifiers(randomScale, scaleWiggle)[1], 100 ];",
 394:       "} else {",
 395:       "    cloneMaster.valueAtTime(time - (delay - randomDelay)) + [ scaleModifiers(randomScale, scaleWiggle)[0], scaleModifiers(randomScale, scaleWiggle)[1] ];",
 396:       "}",
 397:     ].join("\n");
 398:     selectedLayers[i]
 399:       .property("ADBE Transform Group")
 400:       .property("ADBE Scale").expression = cloneScaleExpression;
 401:     var cloneOpacityExpression = [
 402:       "// Clone Master //",
 403:       'var cloneMaster = thisComp.layer("' +
 404:         controlLayer.name +
 405:         '").transform.opacity;',
 406:       " ",
 407:       "// Delay & Frames //",
 408:       'var frameDelay = thisComp.layer("' +
 409:         controlLayer.name +
 410:         '").effect("Easy Clones")(2);',
 411:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 412:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 413:       "var delay = frameDelay*framesToTime(newIndex);",
 414:       " ",
 415:       "//Modifiers //",
 416:       'var randomOpacity = effect("Clone Controls")(6);',
 417:       'var opacityWiggle = wiggle(thisComp.layer("' +
 418:         controlLayer.name +
 419:         '").effect("Easy Clones")(54),thisComp.layer("' +
 420:         controlLayer.name +
 421:         '").effect("Easy Clones")(55));',
 422:       " ",
 423:       'if ( thisComp.layer("' +
 424:         controlLayer.name +
 425:         '").effect("Easy Clones")(50) == true ) {',
 426:       "    var randomOpacity = randomOpacity.valueAtTime(time - (delay - randomDelay));",
 427:       '   var opacityWiggle = wiggle(thisComp.layer("' +
 428:         controlLayer.name +
 429:         '").effect("Easy Clones")(54).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 430:         controlLayer.name +
 431:         '").effect("Easy Clones")(55).valueAtTime(time - (delay - randomDelay)));',
 432:       "}",
 433:       " ",
 434:       "function opacityModifiers(cloneMaster, randomOpacity, opacityWiggle) {",
 435:       "    return cloneMaster.valueAtTime(time - (delay - randomDelay)) + randomOpacity + opacityWiggle;",
 436:       "}",
 437:       " ",
 438:       "//Execute//",
 439:       "clamp(opacityModifiers(cloneMaster, randomOpacity, opacityWiggle), 0, 100) - value;",
 440:     ].join("\n");
 441:     selectedLayers[i]
 442:       .property("ADBE Transform Group")
 443:       .property("ADBE Opacity").expression = cloneOpacityExpression;
 444:   }
 445:   function createCloneTrialExpressions(
 446:     controlLayer,
 447:     selectedLayers,
 448:     i,
 449:     cloneControlEffect,
 450:   ) {
 451:     var cloneRandomXPositionTrialExpression = [
 452:       'var left = thisComp.layer("' +
 453:         controlLayer.name +
 454:         '").effect("Easy Clones")(13);',
 455:       'var right = thisComp.layer("' +
 456:         controlLayer.name +
 457:         '").effect("Easy Clones")(14);',
 458:       'seedRandom(thisComp.layer("' +
 459:         controlLayer.name +
 460:         '").effect("Easy Clones")(12), true);',
 461:       "random() * (+right - +left) + +left;",
 462:     ].join("\n");
 463:     var cloneRandomYPositionTrialExpression = [
 464:       'var up = thisComp.layer("' +
 465:         controlLayer.name +
 466:         '").effect("Easy Clones")(20);',
 467:       'var down = thisComp.layer("' +
 468:         controlLayer.name +
 469:         '").effect("Easy Clones")(21);',
 470:       'seedRandom(thisComp.layer("' +
 471:         controlLayer.name +
 472:         '").effect("Easy Clones")(19), true);',
 473:       "random() * (+down - +up) + +up;",
 474:     ].join("\n");
 475:     var cloneRandomZPositionTrialExpression = [
 476:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 477:       "value",
 478:     ].join("\n");
 479:     var cloneRandomScaleTrialExpression = [
 480:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 481:       "value",
 482:     ].join("\n");
 483:     var cloneRandomRotationTrialExpression = [
 484:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 485:       "value",
 486:     ].join("\n");
 487:     var cloneRandomOpacityTrialExpression = [
 488:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 489:       "value",
 490:     ].join("\n");
 491:     var cloneRandomDelayTrialExpression = [
 492:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 493:       "value",
 494:     ].join("\n");
 495:     var cloneRandomSeedTrialExpression = [
 496:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10);',
 497:       "seedRandom(newIndex,true);",
 498:       "random(0,100);",
 499:     ].join("\n");
 500:     var clonePositionTrialExpression = [
 501:       "// Clone Master //",
 502:       'var cloneMaster = thisComp.layer("' + controlLayer.name + '");',
 503:       " ",
 504:       "// Delay & Frames //",
 505:       'var frameDelay = thisComp.layer("' +
 506:         controlLayer.name +
 507:         '").effect("Easy Clones")(2);',
 508:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 509:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 510:       "var delay = frameDelay*framesToTime(newIndex);",
 511:       " ",
 512:       "//Modifiers //",
 513:       'var randomXPosition = effect("Clone Controls")(1);',
 514:       'var xWiggle = wiggle(thisComp.layer("' +
 515:         controlLayer.name +
 516:         '").effect("Easy Clones")(15), thisComp.layer("' +
 517:         controlLayer.name +
 518:         '").effect("Easy Clones")(16));',
 519:       'var randomYPosition = effect("Clone Controls")(2);',
 520:       'var yWiggle = wiggle(thisComp.layer("' +
 521:         controlLayer.name +
 522:         '").effect("Easy Clones")(22),thisComp.layer("' +
 523:         controlLayer.name +
 524:         '").effect("Easy Clones")(23));',
 525:       " ",
 526:       'if ( thisComp.layer("' +
 527:         controlLayer.name +
 528:         '").effect("Easy Clones")(10) == true ) {',
 529:       '    var randomXPosition = effect("Clone Controls")(1).valueAtTime(time - (delay - randomDelay));',
 530:       '    var xWiggle = wiggle(thisComp.layer("' +
 531:         controlLayer.name +
 532:         '").effect("Easy Clones")(15).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 533:         controlLayer.name +
 534:         '").effect("Easy Clones")(16).valueAtTime(time - (delay - randomDelay)));',
 535:       '    var randomYPosition = effect("Clone Controls")(2).valueAtTime(time - (delay - randomDelay));',
 536:       '    var yWiggle = wiggle(thisComp.layer("' +
 537:         controlLayer.name +
 538:         '").effect("Easy Clones")(22).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
 539:         controlLayer.name +
 540:         '").effect("Easy Clones")(23).valueAtTime(time - (delay - randomDelay)));',
 541:       "}",
 542:       " ",
 543:       "function xPositionModifiers(randomXPosition, xWiggle) {",
 544:       "    return randomXPosition + xWiggle[0];",
 545:       "}",
 546:       " ",
 547:       "function yPositionModifiers(randomYPosition, yWiggle) {",
 548:       "    return randomYPosition + yWiggle[1];",
 549:       "}",
 550:       " ",
 551:       " ",
 552:       "//Execute//",
 553:       "if (transform.position.value.length === 3) {",
 554:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle), value ];",
 555:       "} else {",
 556:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle) ];",
 557:       "}",
 558:     ].join("\n");
 559:     var cloneRotationTrialExpression = [
 560:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 561:       'thisComp.layer("' + controlLayer.name + '").transform.rotation',
 562:     ].join("\n");
 563:     var cloneScaleTrialExpression = [
 564:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 565:       'thisComp.layer("' + controlLayer.name + '").transform.scale',
 566:     ].join("\n");
 567:     var cloneOpacityTrialExpression = [
 568:       "/*this is a trial version, purchase a license to unlock this feature.*/",
 569:       'thisComp.layer("' + controlLayer.name + '").transform.opacity',
 570:     ].join("\n");
 571:     cloneControlEffect.property("Pseudo/cloneControls1.1-0001").expression =
 572:       cloneRandomXPositionTrialExpression;
 573:     cloneControlEffect.property("Pseudo/cloneControls1.1-0002").expression =
 574:       cloneRandomYPositionTrialExpression;
 575:     cloneControlEffect.property("Pseudo/cloneControls1.1-0003").expression =
 576:       cloneRandomZPositionTrialExpression;
 577:     cloneControlEffect.property("Pseudo/cloneControls1.1-0004").expression =
 578:       cloneRandomScaleTrialExpression;
 579:     cloneControlEffect.property("Pseudo/cloneControls1.1-0005").expression =
 580:       cloneRandomRotationTrialExpression;
 581:     cloneControlEffect.property("Pseudo/cloneControls1.1-0006").expression =
 582:       cloneRandomOpacityTrialExpression;
 583:     cloneControlEffect.property("Pseudo/cloneControls1.1-0007").expression =
 584:       cloneRandomDelayTrialExpression;
 585:     cloneControlEffect.property("Pseudo/cloneControls1.1-0008").expression =
 586:       cloneRandomSeedTrialExpression;
 587:     selectedLayers[i]
 588:       .property("ADBE Transform Group")
 589:       .property("ADBE Position").expression = clonePositionTrialExpression;
 590:     selectedLayers[i]
 591:       .property("Transform")
 592:       .property("ADBE Rotate Z").expression = cloneRotationTrialExpression;
 593:     selectedLayers[i]
 594:       .property("ADBE Transform Group")
 595:       .property("ADBE Scale").expression = cloneScaleTrialExpression;
 596:     selectedLayers[i]
 597:       .property("ADBE Transform Group")
 598:       .property("ADBE Opacity").expression = cloneOpacityTrialExpression;
 599:   }
 600:   function createClones(trialMode) {
 601:     function buildClones(zeroPositionCheckbox, trialMode) {
 602:       var comp = app.project.activeItem;
 603:       var selectedLayers = comp.selectedLayers;
 604:       if (comp instanceof CompItem) {
 605:         controlLayer = comp.layers.addShape();
 606:         var shapeGroup = controlLayer
 607:           .property("Contents")
 608:           .addProperty("ADBE Vector Group");
 609:         shapeGroup.property("Contents").addProperty("ADBE Vector Shape - Rect");
 610:         shapeGroup
 611:           .property("Contents")
 612:           .addProperty("ADBE Vector Graphic - Stroke");
 613:         var myRGBColour = [0, 255, 0, 255] / 255;
 614:         controlLayer
 615:           .property("ADBE Root Vectors Group")
 616:           .property("ADBE Vector Group")
 617:           .property("ADBE Vectors Group")
 618:           .property("ADBE Vector Graphic - Stroke")
 619:           .property("ADBE Vector Stroke Color")
 620:           .setValue(myRGBColour);
 621:         controlLayer.name = newSystem.name + " Clone Controls";
 622:         controlLayer.moveToBeginning();
 623:         controlLayer.label = 9;
 624:         controlLayer.guideLayer = true;
 625:         var easyClonesEffect = applyEasyClonesEffect(controlLayer);
 626:         for (var i = 0; i < selectedLayers.length; i += 1) {
 627:           selectedLayers[i].name = newSystem.name + " Clone-" + i + 1;
 628:           selectedLayers[i].label = 2;
 629:           selectedLayers[i].comment = newSystem.name;
 630:           var removePositionKeys = selectedLayers[i].transform.position;
 631:           var removeRotationKeys = selectedLayers[i].transform.rotation;
 632:           var removeScaleKeys = selectedLayers[i].transform.scale;
 633:           var removeOpactityKeys = selectedLayers[i].transform.opacity;
 634:           for (var p = removePositionKeys.numKeys; p != 0; p--) {
 635:             removePositionKeys.removeKey(p);
 636:           }
 637:           for (var r = removeRotationKeys.numKeys; r != 0; r--) {
 638:             removeRotationKeys.removeKey(r);
 639:           }
 640:           for (var s = removeScaleKeys.numKeys; s != 0; s--) {
 641:             removeScaleKeys.removeKey(s);
 642:           }
 643:           for (var o = removeOpactityKeys.numKeys; o != 0; o--) {
 644:             removeOpactityKeys.removeKey(o);
 645:           }
 646:           var clonePosition = selectedLayers[i].transform.position;
 647:           var clonePositionValue = selectedLayers[i].transform.position.value;
 648:           if (zeroPositionCheckbox === true) {
 649:             clonePosition.setValue([0, 0, 0]);
 650:           } else {
 651:             clonePosition.setValue(
 652:               -controlLayer.transform.position.value + clonePositionValue,
 653:             );
 654:           }
 655:           var cloneScale = selectedLayers[i].transform.scale;
 656:           cloneScale.setValue([0, 0]);
 657:           var cloneRotation = selectedLayers[i].transform.rotation;
 658:           cloneRotation.setValue(0);
 659:           var cloneOpacity = selectedLayers[i].transform.opacity;
 660:           cloneOpacity.setValue(0);
 661:         }
 662:       }
 663:       for (var i = 0; i < selectedLayers.length; i += 1) {
 664:         applyCloneControlEffect(selectedLayers[i]);
 665:         var cloneControlEffect = selectedLayers[i]
 666:           .property("ADBE Effect Parade")
 667:           .property("Pseudo/cloneControls1.1");
 668:         if (trialMode == true) {
 669:           createCloneTrialExpressions(
 670:             controlLayer,
 671:             selectedLayers,
 672:             i,
 673:             cloneControlEffect,
 674:           );
 675:         } else {
 676:           createCloneExpressions(
 677:             controlLayer,
 678:             selectedLayers,
 679:             i,
 680:             cloneControlEffect,
 681:           );
 682:         }
 683:       }
 684:     }
 685:     function addColours() {
 686:       var comp = app.project.activeItem;
 687:       var compLayers = comp.layers;
 688:       var colourDelayCheckbox = controlLayer
 689:         .property("ADBE Effect Parade")
 690:         .addProperty("ADBE Checkbox Control");
 691:       colourDelayCheckbox.name = "Delay Colours?";
 692:       colourDelayCheckbox("ADBE Checkbox Control-0001").setValue(true);
 693:       var colourSeedSlider = controlLayer
 694:         .property("ADBE Effect Parade")
 695:         .addProperty("ADBE Slider Control");
 696:       colourSeedSlider.name = "Colour Seed";
 697:       var myFillExpressions = [];
 698:       for (var i = 1; i <= newSystem.randomColours; i += 1) {
 699:         var colourControl = controlLayer
 700:           .property("Effects")
 701:           .addProperty("ADBE Color Control");
 702:         var colourFill = [255, 210, 0, 255] / 255;
 703:         colourControl.property("ADBE Color Control-0001").setValue(colourFill);
 704:         colourControl.name = "Colour " + i;
 705:         colourControlExpression =
 706:           'thisComp.layer("' +
 707:           controlLayer.name +
 708:           '").effect("' +
 709:           colourControl.name +
 710:           '")(1)';
 711:         myFillExpressions.push(colourControlExpression);
 712:       }
 713:       var myFillDelayExpressions = [];
 714:       for (var i = 1; i <= newSystem.randomColours; i += 1) {
 715:         colourControl.name = "Colour " + i;
 716:         colourControlDelayExpression =
 717:           'thisComp.layer("' +
 718:           controlLayer.name +
 719:           '").effect("' +
 720:           colourControl.name +
 721:           '")(1).valueAtTime(time - (delay - randomDelay))';
 722:         myFillDelayExpressions.push(colourControlDelayExpression);
 723:       }
 724:       for (var i = 1; i <= compLayers.length; i += 1) {
 725:         var layerComment = compLayers[i].comment;
 726:         if (layerComment == newSystem.name) {
 727:           var applyFill = compLayers[i]
 728:             .property("ADBE Effect Parade")
 729:             .addProperty("ADBE Fill");
 730:           applyFill.name = "Random Colour";
 731:           var applyFillExpression = [
 732:             "/* Delay & Frames */",
 733:             'var frameDelay = thisComp.layer("' +
 734:               controlLayer.name +
 735:               '").effect("Easy Clones")(2);',
 736:             'var randomDelay = framesToTime(effect("Clone Controls")(7));',
 737:             'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
 738:             "var delay = frameDelay*framesToTime(newIndex);",
 739:             " ",
 740:             'if (thisComp.layer("' +
 741:               controlLayer.name +
 742:               '").effect("Delay Colours?")(1) == false) {',
 743:             " ",
 744:             "   var colours = [" + myFillExpressions.toString() + "];",
 745:             '   var colourSeed = effect("Clone Controls")(8) + thisComp.layer("' +
 746:               controlLayer.name +
 747:               '").effect("Colour Seed")(1);',
 748:             "   seedRandom(colourSeed, true);",
 749:             "   colours[Math.floor(random (colours.length - 0.0001) )];",
 750:             " ",
 751:             "} else {",
 752:             " ",
 753:             "   var colours = [" + myFillDelayExpressions.toString() + "];",
 754:             '   var colourSeed = effect("Clone Controls")(8) + thisComp.layer("' +
 755:               controlLayer.name +
 756:               '").effect("Colour Seed")(1);',
 757:             "   seedRandom(colourSeed, true);",
 758:             "   colours[Math.floor(random (colours.length - 0.0001) )];",
 759:             " ",
 760:             "}",
 761:           ].join("\n");
 762:           compLayers[i]
 763:             .property("ADBE Effect Parade")
 764:             .property("ADBE Fill")
 765:             .property("ADBE Fill-0002").expression = applyFillExpression;
 766:         }
 767:       }
 768:     }
 769:     app.beginUndoGroup("Create Easy Clones");
 770:     JSON || (JSON = {});
 771:     (function () {
 772:       function k(a) {
 773:         return a < 10 ? "0" + a : a;
 774:       }
 775:       function o(a) {
 776:         p.lastIndex = 0;
 777:         return p.test(a)
 778:           ? '"' +
 779:               a.replace(p, function (a) {
 780:                 var c = r[a];
 781:                 return typeof c === "string"
 782:                   ? c
 783:                   : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 784:               }) +
 785:               '"'
 786:           : '"' + a + '"';
 787:       }
 788:       function l(a, j) {
 789:         var g = e;
 790:         var b = j[a];
 791:         b &&
 792:           typeof b === "object" &&
 793:           typeof b.toJSON === "function" &&
 794:           (b = b.toJSON(a));
 795:         typeof i === "function" && (b = i.call(j, a, b));
 796:         switch (typeof b) {
 797:           case "string":
 798:             return o(b);
 799:           case "number":
 800:             return isFinite(b) ? String(b) : "null";
 801:           case "boolean":
 802:           case "null":
 803:             return String(b);
 804:           case "object":
 805:             if (!b) {
 806:               return "null";
 807:             }
 808:             e += n;
 809:             f = [];
 810:             if (Object.prototype.toString.apply(b) === "[object Array]") {
 811:               m = b.length;
 812:               for (var c = 0; c < m; c += 1) {
 813:                 f[c] = l(c, b) || "null";
 814:               }
 815:               h =
 816:                 f.length === 0
 817:                   ? "[]"
 818:                   : e
 819:                     ? "[\n" + e + f.join(",\n" + e) + "\n" + g + "]"
 820:                     : "[" + f.join(",") + "]";
 821:               e = g;
 822:               return h;
 823:             }
 824:             if (i && typeof i === "object") {
 825:               m = i.length;
 826:               for (var c = 0; c < m; c += 1) {
 827:                 typeof i[c] === "string" &&
 828:                   ((d = i[c]),
 829:                   (h = l(d, b)) && f.push(o(d) + e ? ": " : ":" + h));
 830:               }
 831:             } else {
 832:               for (var d in b) {
 833:                 Object.prototype.hasOwnProperty.call(b, d) &&
 834:                   (h = l(d, b)) &&
 835:                   f.push(o(d) + e ? ": " : ":" + h);
 836:               }
 837:             }
 838:             h =
 839:               f.length === 0
 840:                 ? "{}"
 841:                 : e
 842:                   ? "{\n" + e + f.join(",\n" + e) + "\n" + g + "}"
 843:                   : "{" + f.join(",") + "}";
 844:             e = g;
 845:             return h;
 846:         }
 847:       }
 848:       if (typeof Date.prototype.toJSON !== "function") {
 849:         Date.prototype.toJSON = function () {
 850:           return isFinite(this.valueOf())
 851:             ? this.getUTCFullYear() +
 852:                 "-" +
 853:                 k(this.getUTCMonth() + 1) +
 854:                 "-" +
 855:                 k(this.getUTCDate()) +
 856:                 "T" +
 857:                 k(this.getUTCHours()) +
 858:                 ":" +
 859:                 k(this.getUTCMinutes()) +
 860:                 ":" +
 861:                 k(this.getUTCSeconds()) +
 862:                 "Z"
 863:             : null;
 864:         };
 865:         String.prototype.toJSON =
 866:           Number.prototype.toJSON =
 867:           Boolean.prototype.toJSON =
 868:             function () {
 869:               return this.valueOf();
 870:             };
 871:       }
 872:       var q =
 873:         /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 874:       var p =
 875:         /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 876:       var r = {
 877:         "\b": "\\b",
 878:         "\t": "\\t",
 879:         "\n": "\\n",
 880:         "\f": "\\f",
 881:         "\r": "\\r",
 882:         '"': '\\"',
 883:         "\\": "\\\\",
 884:       };
 885:       if (typeof JSON.stringify !== "function") {
 886:         JSON.stringify = function (a, j, c) {
 887:           n = e = "";
 888:           if (typeof c === "number") {
 889:             for (var d = 0; d < c; d += 1) {
 890:               n += " ";
 891:             }
 892:           } else {
 893:             typeof c === "string" && (n = c);
 894:           }
 895:           if (
 896:             (i = j) &&
 897:             typeof j !== "function" &&
 898:             (typeof j !== "object" || typeof j.length !== "number")
 899:           ) {
 900:             throw Error("JSON.stringify");
 901:           }
 902:           return l("", { "": a });
 903:         };
 904:       }
 905:       if (typeof JSON.parse !== "function") {
 906:         JSON.parse = function (a, e) {
 907:           function c(a, d) {
 908:             var b = a[d];
 909:             if (b && typeof b === "object") {
 910:               for (var g in b) {
 911:                 Object.prototype.hasOwnProperty.call(b, g) &&
 912:                   ((f = c(b, g)), f !== void 0 ? (b[g] = f) : delete b[g]);
 913:               }
 914:             }
 915:             return e.call(a, d, b);
 916:           }
 917:           var a = String(a);
 918:           q.lastIndex = 0;
 919:           q.test(a) &&
 920:             (a = a.replace(q, function (a) {
 921:               return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 922:             }));
 923:           if (
 924:             /^[\],:{}\s]*$/.test(
 925:               a
 926:                 .replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@")
 927:                 .replace(
 928:                   /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
 929:                   "]",
 930:                 )
 931:                 .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
 932:             )
 933:           ) {
 934:             return (
 935:               (d = eval("(" + a + ")")),
 936:               typeof e === "function" ? c({ "": d }, "") : d
 937:             );
 938:           }
 939:           throw new SyntaxError("JSON.parse");
 940:         };
 941:       }
 942:     })();
 943:     var comp = app.project.activeItem;
 944:     if (comp == null || comp instanceof CompItem == false) {
 945:       alert("Please select at least one layer to build a Clone System.");
 946:       return;
 947:     } else {
 948:       function getNewSystem() {
 949:         var win = new Window("dialog", "Easy Clones");
 950:         win.margins = 15;
 951:         var content = win.add("group");
 952:         content.orientation = "column";
 953:         var panel01 = content.add("panel", undefined, "Create Clone System");
 954:         panel01.alignChildren = ["left", "top"];
 955:         panel01.orientation = "column";
 956:         panel01.preferredSize.width = 340;
 957:         panel01.spacing = 5;
 958:         var row01 = panel01.add("group");
 959:         row01.orientation = "row";
 960:         row01.spacing = 5;
 961:         var row01Label = row01.add(
 962:           'statictext {text: "Name:", justify: "right"}',
 963:         );
 964:         row01Label.preferredSize.width = 100;
 965:         var row01 = row01.add("edittext", undefined, "Shapes");
 966:         row01.preferredSize.width = 200;
 967:         var row02 = panel01.add("group");
 968:         row02.orientation = "row";
 969:         row02.spacing = 5;
 970:         var row02Label = row02.add(
 971:           'statictext {text: "Random Colours:", justify: "right"}',
 972:         );
 973:         row02Label.preferredSize.width = 100;
 974:         var row02 = row02.add("edittext", undefined, "3");
 975:         row02.preferredSize.width = 200;
 976:         var row03 = panel01.add("group");
 977:         row03.orientation = "row";
 978:         row03.spacing = 5;
 979:         var row03Label = row03.add(
 980:           'statictext {text: "Centre to Control?", justify: "right"}',
 981:         );
 982:         row03Label.preferredSize.width = 100;
 983:         var row03 = row03.add("checkbox", undefined);
 984:         row03.preferredSize.width = 200;
 985:         var buttonGroup = win.add("group");
 986:         buttonGroup.alignChildren = ["right", "top"];
 987:         buttonGroup.orientation = "row";
 988:         buttonGroup.preferredSize.width = 340;
 989:         var cancelButton = buttonGroup.add("button", undefined, "Cancel");
 990:         var okayButton = buttonGroup.add("button", undefined, "Ok");
 991:         okayButton.active = true;
 992:         if (win.show() === 1) {
 993:           var newSystem = {
 994:             name: row01.text,
 995:             randomColours: row02.text,
 996:             zeroClones: row03.value,
 997:           };
 998:           return newSystem;
 999:         } else {
1000:           return false;
1001:         }
1002:       }
1003:       function chooseSystem(trialMode, newSystem) {
1004:         var zeroPositionCheckbox = newSystem.zeroClones;
1005:         if (newSystem === false) {
1006:           return;
1007:         }
1008:         var colourPromptNum = parseFloat(newSystem.randomColours);
1009:         if (isNaN(colourPromptNum)) {
1010:           alert(
1011:             "You must enter a number into the Random Colours Field, not text.",
1012:           );
1013:           return;
1014:         } else if (colourPromptNum === 0) {
1015:           buildClones(zeroPositionCheckbox, trialMode);
1016:         } else {
1017:           if (trialMode == true) {
1018:             buildClones(zeroPositionCheckbox, trialMode);
1019:           } else {
1020:             buildClones(zeroPositionCheckbox, trialMode);
1021:             addColours();
1022:           }
1023:         }
1024:       }
1025:       var selectedLayer = comp.selectedLayers[0];
1026:       if (selectedLayer == null) {
1027:         alert("Please select at least one layer to build a Clone System.");
1028:         return;
1029:       }
1030:       try {
1031:         var newSystem = getNewSystem();
1032:       } catch (err) {
1033:         alert(err);
1034:       }
1035:       chooseSystem(trialMode, newSystem);
1036:     }
1037:     app.endUndoGroup();
1038:   }
1039:   function applyCloneControlEffect(selectedLayer) {
1040:     function makePseudoEffectAvailable(presetFile) {
1041:       var myComp = app.project.activeItem;
1042:       var layerCollection = myComp.selectedLayers;
1043:       switchLayerSelection(layerCollection, false);
1044:       var tempNull = myComp.layers.addNull();
1045:       tempNull.selected = true;
1046:       tempNull.applyPreset(presetFile);
1047:       tempNull.remove();
1048:       switchLayerSelection(layerCollection, true);
1049:     }
1050:     function switchLayerSelection(layerArray, selectionValue) {
1051:       for (var i = 0, il = layerArray.length; i < il; i++) {
1052:         layerArray[i].selected = selectionValue;
1053:       }
1054:     }
1055:     function getAnimationPreset(presetName, presetLocation, presetBinary) {
1056:       var presetFolder = Folder(presetLocation);
1057:       var presetFile = File(presetFolder.toString() + "/" + presetName);
1058:       if (!presetFolder.exists) {
1059:         presetFolder = presetFolder.create();
1060:       }
1061:       if (!presetFile.exists) {
1062:         presetFile.encoding = "BINARY";
1063:         presetFile.open("w");
1064:         presetFile.write(presetBinary);
1065:         presetFile.close();
1066:       }
1067:       return presetFile;
1068:     }
1069:     if (!selectedLayer) {
1070:       throw new Error(
1071:         "applyPseudoEffect() method expects one parameter - Layer Object",
1072:       );
1073:     }
1074:     var PseudoEffectMachName = "Pseudo/cloneControls1.1";
1075:     var PseudoEffectName = "Clone Controls";
1076:     var AnimationPresetName = "Clone Controls.ffx";
1077:     var aescriptsFolder = Folder(
1078:       Folder.userData.fsName + "/Aescripts/Easy Clones/1.0/",
1079:     );
1080:     aescriptsFolder.create();
1081:     var AnimationPresetBinary = __BLOB__BLOB_000133__;
1082:     if (
1083:       selectedLayer.property("Effects").canAddProperty(PseudoEffectMachName) ===
1084:       false
1085:     ) {
1086:       var presetFile = getAnimationPreset(
1087:         AnimationPresetName,
1088:         aescriptsFolder,
1089:         AnimationPresetBinary,
1090:       );
1091:       makePseudoEffectAvailable(presetFile);
1092:     }
1093:     var myEffect = selectedLayer
1094:       .property("Effects")
1095:       .addProperty(PseudoEffectMachName);
1096:     myEffect.name = "Clone Controls";
1097:   }
1098:   function addCloneTrialExpressions(
1099:     controlLayerName,
1100:     selectedLayer,
1101:     i,
1102:     cloneControlEffect,
1103:   ) {
1104:     var cloneRandomXPositionExpression = [
1105:       'var left = thisComp.layer("' +
1106:         controlLayerName +
1107:         '").effect("Easy Clones")(13);',
1108:       'var right = thisComp.layer("' +
1109:         controlLayerName +
1110:         '").effect("Easy Clones")(14);',
1111:       'seedRandom(thisComp.layer("' +
1112:         controlLayerName +
1113:         '").effect("Easy Clones")(12), true);',
1114:       "random() * (+right - +left) + +left;",
1115:     ].join("\n");
1116:     cloneControlEffect.property("Pseudo/cloneControls1.1-0001").expression =
1117:       cloneRandomXPositionExpression;
1118:     var cloneRandomYPositionExpression = [
1119:       'var up = thisComp.layer("' +
1120:         controlLayerName +
1121:         '").effect("Easy Clones")(20);',
1122:       'var down = thisComp.layer("' +
1123:         controlLayerName +
1124:         '").effect("Easy Clones")(21);',
1125:       'seedRandom(thisComp.layer("' +
1126:         controlLayerName +
1127:         '").effect("Easy Clones")(19), true);',
1128:       "random() * (+down - +up) + +up;",
1129:     ].join("\n");
1130:     cloneControlEffect.property("Pseudo/cloneControls1.1-0002").expression =
1131:       cloneRandomYPositionExpression;
1132:     var cloneRandomZPositionExpression = [
1133:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1134:       "value",
1135:     ].join("\n");
1136:     cloneControlEffect.property("Pseudo/cloneControls1.1-0003").expression =
1137:       cloneRandomZPositionExpression;
1138:     var cloneRandomScaleExpression = [
1139:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1140:       "value",
1141:     ].join("\n");
1142:     cloneControlEffect.property("Pseudo/cloneControls1.1-0004").expression =
1143:       cloneRandomScaleExpression;
1144:     var cloneRandomRotationExpression = [
1145:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1146:       "value",
1147:     ].join("\n");
1148:     cloneControlEffect.property("Pseudo/cloneControls1.1-0005").expression =
1149:       cloneRandomRotationExpression;
1150:     var cloneRandomOpacityExpression = [
1151:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1152:       "value",
1153:     ].join("\n");
1154:     cloneControlEffect.property("Pseudo/cloneControls1.1-0006").expression =
1155:       cloneRandomOpacityExpression;
1156:     var cloneRandomDelayExpression = [
1157:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1158:       "value",
1159:     ].join("\n");
1160:     cloneControlEffect.property("Pseudo/cloneControls1.1-0007").expression =
1161:       cloneRandomDelayExpression;
1162:     var cloneRandomSeedExpression = [
1163:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10);',
1164:       "seedRandom(newIndex,true);",
1165:       "random(0,100);",
1166:     ].join("\n");
1167:     cloneControlEffect.property("Pseudo/cloneControls1.1-0008").expression =
1168:       cloneRandomSeedExpression;
1169:     var clonePositionExpression = [
1170:       "// Clone Master //",
1171:       'var cloneMaster = thisComp.layer("' + controlLayerName + '");',
1172:       " ",
1173:       "// Delay & Frames //",
1174:       'var frameDelay = thisComp.layer("' +
1175:         controlLayerName +
1176:         '").effect("Easy Clones")(2);',
1177:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1178:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1179:       "var delay = frameDelay*framesToTime(newIndex);",
1180:       " ",
1181:       "//Modifiers //",
1182:       'var randomXPosition = effect("Clone Controls")(1);',
1183:       'var xWiggle = wiggle(thisComp.layer("' +
1184:         controlLayerName +
1185:         '").effect("Easy Clones")(15), thisComp.layer("' +
1186:         controlLayerName +
1187:         '").effect("Easy Clones")(16));',
1188:       'var randomYPosition = effect("Clone Controls")(2);',
1189:       'var yWiggle = wiggle(thisComp.layer("' +
1190:         controlLayerName +
1191:         '").effect("Easy Clones")(22),thisComp.layer("' +
1192:         controlLayerName +
1193:         '").effect("Easy Clones")(23));',
1194:       " ",
1195:       'if ( thisComp.layer("' +
1196:         controlLayerName +
1197:         '").effect("Easy Clones")(10) == true ) {',
1198:       '    var randomXPosition = effect("Clone Controls")(1).valueAtTime(time - (delay - randomDelay));',
1199:       '    var xWiggle = wiggle(thisComp.layer("' +
1200:         controlLayerName +
1201:         '").effect("Easy Clones")(15).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1202:         controlLayerName +
1203:         '").effect("Easy Clones")(16).valueAtTime(time - (delay - randomDelay)));',
1204:       '    var randomYPosition = effect("Clone Controls")(2).valueAtTime(time - (delay - randomDelay));',
1205:       '    var yWiggle = wiggle(thisComp.layer("' +
1206:         controlLayerName +
1207:         '").effect("Easy Clones")(22).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1208:         controlLayerName +
1209:         '").effect("Easy Clones")(23).valueAtTime(time - (delay - randomDelay)));',
1210:       "}",
1211:       " ",
1212:       "function xPositionModifiers(randomXPosition, xWiggle) {",
1213:       "    return randomXPosition + xWiggle[0];",
1214:       "}",
1215:       " ",
1216:       "function yPositionModifiers(randomYPosition, yWiggle) {",
1217:       "    return randomYPosition + yWiggle[1];",
1218:       "}",
1219:       " ",
1220:       " ",
1221:       "//Execute//",
1222:       "if (transform.position.value.length === 3) {",
1223:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle), value ];",
1224:       "} else {",
1225:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle) ];",
1226:       "}",
1227:     ].join("\n");
1228:     selectedLayer
1229:       .property("ADBE Transform Group")
1230:       .property("ADBE Position").expression = clonePositionExpression;
1231:     var cloneRotationExpression = [
1232:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1233:       'thisComp.layer("' + controlLayerName + '").transform.rotation',
1234:     ].join("\n");
1235:     selectedLayer.property("Transform").property("ADBE Rotate Z").expression =
1236:       cloneRotationExpression;
1237:     var cloneScaleExpression = [
1238:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1239:       'thisComp.layer("' + controlLayerName + '").transform.scale',
1240:     ].join("\n");
1241:     selectedLayer
1242:       .property("ADBE Transform Group")
1243:       .property("ADBE Scale").expression = cloneScaleExpression;
1244:     var cloneOpacityExpression = [
1245:       "/*this is a trial version, purchase a license to unlock this feature.*/",
1246:       'thisComp.layer("' + controlLayerName + '").transform.opacity',
1247:     ].join("\n");
1248:     selectedLayer
1249:       .property("ADBE Transform Group")
1250:       .property("ADBE Opacity").expression = cloneOpacityExpression;
1251:   }
1252:   function addCloneExpressions(
1253:     controlLayerName,
1254:     selectedLayer,
1255:     i,
1256:     cloneControlEffect,
1257:   ) {
1258:     var cloneRandomXPositionExpression = [
1259:       'var left = thisComp.layer("' +
1260:         controlLayerName +
1261:         '").effect("Easy Clones")(13);',
1262:       'var right = thisComp.layer("' +
1263:         controlLayerName +
1264:         '").effect("Easy Clones")(14);',
1265:       'seedRandom(thisComp.layer("' +
1266:         controlLayerName +
1267:         '").effect("Easy Clones")(12), true);',
1268:       "random() * (+right - +left) + +left;",
1269:     ].join("\n");
1270:     cloneControlEffect.property("Pseudo/cloneControls1.1-0001").expression =
1271:       cloneRandomXPositionExpression;
1272:     var cloneRandomYPositionExpression = [
1273:       'var up = thisComp.layer("' +
1274:         controlLayerName +
1275:         '").effect("Easy Clones")(20);',
1276:       'var down = thisComp.layer("' +
1277:         controlLayerName +
1278:         '").effect("Easy Clones")(21);',
1279:       'seedRandom(thisComp.layer("' +
1280:         controlLayerName +
1281:         '").effect("Easy Clones")(19), true);',
1282:       "random() * (+down - +up) + +up;",
1283:     ].join("\n");
1284:     cloneControlEffect.property("Pseudo/cloneControls1.1-0002").expression =
1285:       cloneRandomYPositionExpression;
1286:     var cloneRandomZPositionExpression = [
1287:       'var near = thisComp.layer("' +
1288:         controlLayerName +
1289:         '").effect("Easy Clones")(27);',
1290:       'var far = thisComp.layer("' +
1291:         controlLayerName +
1292:         '").effect("Easy Clones")(28);',
1293:       'seedRandom(thisComp.layer("' +
1294:         controlLayerName +
1295:         '").effect("Easy Clones")(26), true);',
1296:       "random() * (+far - +near) + +near;",
1297:     ].join("\n");
1298:     cloneControlEffect.property("Pseudo/cloneControls1.1-0003").expression =
1299:       cloneRandomZPositionExpression;
1300:     var cloneRandomScaleExpression = [
1301:       'var decrease = thisComp.layer("' +
1302:         controlLayerName +
1303:         '").effect("Easy Clones")(36);',
1304:       'var increase = thisComp.layer("' +
1305:         controlLayerName +
1306:         '").effect("Easy Clones")(37);',
1307:       'seedRandom(thisComp.layer("' +
1308:         controlLayerName +
1309:         '").effect("Easy Clones")(35), true);',
1310:       "random() * (+increase - +decrease) + +decrease;",
1311:     ].join("\n");
1312:     cloneControlEffect.property("Pseudo/cloneControls1.1-0004").expression =
1313:       cloneRandomScaleExpression;
1314:     var cloneRandomRotationExpression = [
1315:       'var decrease = thisComp.layer("' +
1316:         controlLayerName +
1317:         '").effect("Easy Clones")(44);',
1318:       'var increase = thisComp.layer("' +
1319:         controlLayerName +
1320:         '").effect("Easy Clones")(45);',
1321:       'seedRandom(thisComp.layer("' +
1322:         controlLayerName +
1323:         '").effect("Easy Clones")(43), true);',
1324:       "random() * (+increase - +decrease) + +decrease;",
1325:     ].join("\n");
1326:     cloneControlEffect.property("Pseudo/cloneControls1.1-0005").expression =
1327:       cloneRandomRotationExpression;
1328:     var cloneRandomOpacityExpression = [
1329:       'var decrease = thisComp.layer("' +
1330:         controlLayerName +
1331:         '").effect("Easy Clones")(52);',
1332:       'var increase = thisComp.layer("' +
1333:         controlLayerName +
1334:         '").effect("Easy Clones")(53);',
1335:       'seedRandom(thisComp.layer("' +
1336:         controlLayerName +
1337:         '").effect("Easy Clones")(51), true);',
1338:       "random() * (+increase - +decrease) + +decrease;",
1339:     ].join("\n");
1340:     cloneControlEffect.property("Pseudo/cloneControls1.1-0006").expression =
1341:       cloneRandomOpacityExpression;
1342:     var cloneRandomDelayExpression = [
1343:       'var decrease = thisComp.layer("' +
1344:         controlLayerName +
1345:         '").effect("Easy Clones")(5);',
1346:       'var increase = thisComp.layer("' +
1347:         controlLayerName +
1348:         '").effect("Easy Clones")(6);',
1349:       'seedRandom(thisComp.layer("' +
1350:         controlLayerName +
1351:         '").effect("Easy Clones")(4), true);',
1352:       "random() * (+increase - +decrease) + +decrease;",
1353:     ].join("\n");
1354:     cloneControlEffect.property("Pseudo/cloneControls1.1-0007").expression =
1355:       cloneRandomDelayExpression;
1356:     var cloneRandomSeedExpression = [
1357:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10);',
1358:       "seedRandom(newIndex,true);",
1359:       "random(0,100);",
1360:     ].join("\n");
1361:     cloneControlEffect.property("Pseudo/cloneControls1.1-0008").expression =
1362:       cloneRandomSeedExpression;
1363:     var clonePositionExpression = [
1364:       "// Clone Master //",
1365:       'var cloneMaster = thisComp.layer("' + controlLayerName + '");',
1366:       " ",
1367:       "// Delay & Frames //",
1368:       'var frameDelay = thisComp.layer("' +
1369:         controlLayerName +
1370:         '").effect("Easy Clones")(2);',
1371:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1372:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1373:       "var delay = frameDelay*framesToTime(newIndex);",
1374:       " ",
1375:       "//Modifiers //",
1376:       'var randomXPosition = effect("Clone Controls")(1);',
1377:       'var xWiggle = wiggle(thisComp.layer("' +
1378:         controlLayerName +
1379:         '").effect("Easy Clones")(15), thisComp.layer("' +
1380:         controlLayerName +
1381:         '").effect("Easy Clones")(16));',
1382:       'var randomYPosition = effect("Clone Controls")(2);',
1383:       'var yWiggle = wiggle(thisComp.layer("' +
1384:         controlLayerName +
1385:         '").effect("Easy Clones")(22),thisComp.layer("' +
1386:         controlLayerName +
1387:         '").effect("Easy Clones")(23));',
1388:       'var randomZPosition = effect("Clone Controls")(3);',
1389:       'var zWiggle = wiggle(thisComp.layer("' +
1390:         controlLayerName +
1391:         '").effect("Easy Clones")(29),thisComp.layer("' +
1392:         controlLayerName +
1393:         '").effect("Easy Clones")(30));',
1394:       " ",
1395:       'if ( thisComp.layer("' +
1396:         controlLayerName +
1397:         '").effect("Easy Clones")(10) == true ) {',
1398:       '    var randomXPosition = effect("Clone Controls")(1).valueAtTime(time - (delay - randomDelay));',
1399:       '    var xWiggle = wiggle(thisComp.layer("' +
1400:         controlLayerName +
1401:         '").effect("Easy Clones")(15).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1402:         controlLayerName +
1403:         '").effect("Easy Clones")(16).valueAtTime(time - (delay - randomDelay)));',
1404:       '    var randomYPosition = effect("Clone Controls")(2).valueAtTime(time - (delay - randomDelay));',
1405:       '    var yWiggle = wiggle(thisComp.layer("' +
1406:         controlLayerName +
1407:         '").effect("Easy Clones")(22).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1408:         controlLayerName +
1409:         '").effect("Easy Clones")(23).valueAtTime(time - (delay - randomDelay)));',
1410:       "    var randomZPosition = randomZPosition.valueAtTime(time - (delay - randomDelay));",
1411:       '    var zWiggle = wiggle(thisComp.layer("' +
1412:         controlLayerName +
1413:         '").effect("Easy Clones")(29).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1414:         controlLayerName +
1415:         '").effect("Easy Clones")(30).valueAtTime(time - (delay - randomDelay)));',
1416:       "}",
1417:       " ",
1418:       "function xPositionModifiers(randomXPosition, xWiggle) {",
1419:       "    return randomXPosition + xWiggle[0];",
1420:       "}",
1421:       " ",
1422:       "function yPositionModifiers(randomYPosition, yWiggle) {",
1423:       "    return randomYPosition + yWiggle[1];",
1424:       "}",
1425:       " ",
1426:       "function zPositionModifiers(randomZPosition, zWiggle) {",
1427:       "    return randomZPosition + zWiggle[2];",
1428:       "}",
1429:       " ",
1430:       "//Execute//",
1431:       "if (transform.position.value.length === 3) {",
1432:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle), zPositionModifiers(randomZPosition, zWiggle) ];",
1433:       "} else {",
1434:       "    cloneMaster.toWorld(cloneMaster.anchorPoint, time - (delay - randomDelay)) + [ xPositionModifiers(randomXPosition, xWiggle) , yPositionModifiers(randomYPosition, yWiggle) ];",
1435:       "}",
1436:     ].join("\n");
1437:     selectedLayer
1438:       .property("ADBE Transform Group")
1439:       .property("ADBE Position").expression = clonePositionExpression;
1440:     var cloneRotationExpression = [
1441:       "// Clone Master //",
1442:       'var cloneMaster = thisComp.layer("' +
1443:         controlLayerName +
1444:         '")("ADBE Transform Group")("ADBE Rotate Z");',
1445:       " ",
1446:       "// Delay & Frames //",
1447:       'var frameDelay = thisComp.layer("' +
1448:         controlLayerName +
1449:         '").effect("Easy Clones")(2);',
1450:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1451:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1452:       "var delay = frameDelay*framesToTime(newIndex);",
1453:       " ",
1454:       "//Modifiers //",
1455:       'var randomRotation = effect("Clone Controls")(5);',
1456:       'var rotationWiggle = wiggle(thisComp.layer("' +
1457:         controlLayerName +
1458:         '").effect("Easy Clones")(46),thisComp.layer("' +
1459:         controlLayerName +
1460:         '").effect("Easy Clones")(47));',
1461:       " ",
1462:       'if ( thisComp.layer("' +
1463:         controlLayerName +
1464:         '").effect("Easy Clones")(42) == true ) {',
1465:       "    var randomRotation = randomRotation.valueAtTime(time - (delay - randomDelay));",
1466:       '    var rotationWiggle = wiggle(thisComp.layer("' +
1467:         controlLayerName +
1468:         '").effect("Easy Clones")(46).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1469:         controlLayerName +
1470:         '").effect("Easy Clones")(47).valueAtTime(time - (delay - randomDelay)));',
1471:       "}",
1472:       " ",
1473:       "function rotationModifiers(cloneMaster, randomRotation, rotationWiggle) {",
1474:       "    return cloneMaster.valueAtTime(time - (delay - randomDelay)) + randomRotation + rotationWiggle;",
1475:       "}",
1476:       " ",
1477:       "//Execute//",
1478:       "rotationModifiers(cloneMaster, randomRotation, rotationWiggle);",
1479:     ].join("\n");
1480:     selectedLayer.property("Transform").property("ADBE Rotate Z").expression =
1481:       cloneRotationExpression;
1482:     var cloneScaleExpression = [
1483:       "// Clone Master //",
1484:       'var cloneMaster = thisComp.layer("' +
1485:         controlLayerName +
1486:         '").transform.scale;',
1487:       " ",
1488:       "// Delay & Frames //",
1489:       'var frameDelay = thisComp.layer("' +
1490:         controlLayerName +
1491:         '").effect("Easy Clones")(2);',
1492:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1493:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1494:       "var delay = frameDelay*framesToTime(newIndex);",
1495:       " ",
1496:       "//Modifiers //",
1497:       'var randomScale = effect("Clone Controls")(4);',
1498:       'var scaleWiggle = wiggle(thisComp.layer("' +
1499:         controlLayerName +
1500:         '").effect("Easy Clones")(38),thisComp.layer("' +
1501:         controlLayerName +
1502:         '").effect("Easy Clones")(39));',
1503:       " ",
1504:       'if ( thisComp.layer("' +
1505:         controlLayerName +
1506:         '").effect("Easy Clones")(34) == true ) {',
1507:       '    var randomScale = effect("Clone Controls")(4).valueAtTime(time - (delay - randomDelay));',
1508:       '    var scaleWiggle = wiggle( thisComp.layer("' +
1509:         controlLayerName +
1510:         '").effect("Easy Clones")(38).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1511:         controlLayerName +
1512:         '").effect("Easy Clones")(39).valueAtTime(time - (delay - randomDelay)) );',
1513:       "}",
1514:       " ",
1515:       "function scaleModifiers(randomScale, scaleWiggle) {",
1516:       "    return [ randomScale, randomScale ] + [ scaleWiggle[0], scaleWiggle[0] ];",
1517:       "}",
1518:       " ",
1519:       "//Execute//",
1520:       "if (transform.scale.value.length === 3) {",
1521:       "    cloneMaster.valueAtTime(time - (delay - randomDelay)) + [ scaleModifiers(randomScale, scaleWiggle)[0], scaleModifiers(randomScale, scaleWiggle)[1], 100 ];",
1522:       "} else {",
1523:       "    cloneMaster.valueAtTime(time - (delay - randomDelay)) + [ scaleModifiers(randomScale, scaleWiggle)[0], scaleModifiers(randomScale, scaleWiggle)[1] ];",
1524:       "}",
1525:     ].join("\n");
1526:     selectedLayer
1527:       .property("ADBE Transform Group")
1528:       .property("ADBE Scale").expression = cloneScaleExpression;
1529:     var cloneOpacityExpression = [
1530:       "// Clone Master //",
1531:       'var cloneMaster = thisComp.layer("' +
1532:         controlLayerName +
1533:         '").transform.opacity;',
1534:       " ",
1535:       "// Delay & Frames //",
1536:       'var frameDelay = thisComp.layer("' +
1537:         controlLayerName +
1538:         '").effect("Easy Clones")(2);',
1539:       'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1540:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1541:       "var delay = frameDelay*framesToTime(newIndex);",
1542:       " ",
1543:       "//Modifiers //",
1544:       'var randomOpacity = effect("Clone Controls")(6);',
1545:       'var opacityWiggle = wiggle(thisComp.layer("' +
1546:         controlLayerName +
1547:         '").effect("Easy Clones")(54),thisComp.layer("' +
1548:         controlLayerName +
1549:         '").effect("Easy Clones")(55));',
1550:       " ",
1551:       'if ( thisComp.layer("' +
1552:         controlLayerName +
1553:         '").effect("Easy Clones")(50) == true ) {',
1554:       "    var randomOpacity = randomOpacity.valueAtTime(time - (delay - randomDelay));",
1555:       '   var opacityWiggle = wiggle(thisComp.layer("' +
1556:         controlLayerName +
1557:         '").effect("Easy Clones")(54).valueAtTime(time - (delay - randomDelay)),thisComp.layer("' +
1558:         controlLayerName +
1559:         '").effect("Easy Clones")(55).valueAtTime(time - (delay - randomDelay)));',
1560:       "}",
1561:       " ",
1562:       "function opacityModifiers(cloneMaster, randomOpacity, opacityWiggle) {",
1563:       "    return cloneMaster.valueAtTime(time - (delay - randomDelay)) + randomOpacity + opacityWiggle;",
1564:       "}",
1565:       " ",
1566:       "//Execute//",
1567:       "clamp(opacityModifiers(cloneMaster, randomOpacity, opacityWiggle), 0, 100) - value;",
1568:     ].join("\n");
1569:     selectedLayer
1570:       .property("ADBE Transform Group")
1571:       .property("ADBE Opacity").expression = cloneOpacityExpression;
1572:   }
1573:   function addClones(trialMode) {
1574:     function addClones(cloneControlLayer, zeroPositionCheckbox, trialMode) {
1575:       var comp = app.project.activeItem;
1576:       var selectedLayers = comp.selectedLayers;
1577:       var numSelectedLayers = selectedLayers.length;
1578:       var controlLayerName = cloneControlLayer.name;
1579:       var controlLayerSplit = controlLayerName.split(" ")[0];
1580:       cloneLabel;
1581:       try {
1582:         var comp = app.project.activeItem;
1583:         var layers = comp.layers;
1584:         var numLayers = layers.length;
1585:         var highestNumber = 0;
1586:         for (var i = 1; i <= numLayers; i += 1) {
1587:           if (layers[i].comment === controlLayerSplit) {
1588:             var layer = layers[i];
1589:             var cloneLabel = layer.label;
1590:             var layerIndex = layer.index;
1591:             var name = layer.name;
1592:             var index = parseInt(name.split("-")[1]);
1593:             if (isNaN(index) === false) {
1594:               if (index > highestNumber) {
1595:                 highestNumber = index;
1596:               }
1597:               if (index === highestNumber) {
1598:                 var highestIndex = layerIndex;
1599:               }
1600:               if (layerIndex === highestIndex) {
1601:                 var highestLayerIndex = layer;
1602:               }
1603:             }
1604:           }
1605:         }
1606:       } catch (err) {}
1607:       if (comp instanceof CompItem) {
1608:         for (var i = 0; i < numSelectedLayers; i += 1) {
1609:           var selectedLayer = selectedLayers[i];
1610:           selectedLayer.name =
1611:             controlLayerSplit + " Clone-" + highestNumber + i + 1;
1612:           selectedLayer.comment = controlLayerSplit;
1613:           selectedLayer.label = 2;
1614:           if (typeof CloneLabel !== "undefined") {
1615:             selectedLayer.label = cloneLabel;
1616:           }
1617:           var removePositionKeys = selectedLayer.transform.position;
1618:           var removeRotationKeys = selectedLayer.transform.rotation;
1619:           var removeScaleKeys = selectedLayer.transform.scale;
1620:           var removeOpactityKeys = selectedLayer.transform.opacity;
1621:           for (var p = removePositionKeys.numKeys; p != 0; p--) {
1622:             removePositionKeys.removeKey(p);
1623:           }
1624:           for (var r = removeRotationKeys.numKeys; r != 0; r--) {
1625:             removeRotationKeys.removeKey(r);
1626:           }
1627:           for (var s = removeScaleKeys.numKeys; s != 0; s--) {
1628:             removeScaleKeys.removeKey(s);
1629:           }
1630:           for (var o = removeOpactityKeys.numKeys; o != 0; o--) {
1631:             removeOpactityKeys.removeKey(o);
1632:           }
1633:           var clonePosition = selectedLayers[i].transform.position;
1634:           var clonePositionValue = selectedLayers[i].transform.position.value;
1635:           if (zeroPositionCheckbox === true) {
1636:             clonePosition.setValue([0, 0, 0]);
1637:           } else {
1638:             clonePosition.setValue(
1639:               -cloneControlLayer.transform.position.value + clonePositionValue,
1640:             );
1641:           }
1642:           var cloneScale = selectedLayer.transform.scale;
1643:           cloneScale.setValue([0, 0]);
1644:           var cloneRotation = selectedLayer.transform.rotation;
1645:           cloneRotation.setValue(0);
1646:           var cloneOpacity = selectedLayer.transform.opacity;
1647:           cloneOpacity.setValue(0);
1648:           applyCloneControlEffect(selectedLayer);
1649:           var cloneControlEffect = selectedLayer
1650:             .property("ADBE Effect Parade")
1651:             .property("Pseudo/cloneControls1.1");
1652:           if (trialMode == true) {
1653:             addCloneTrialExpressions(
1654:               controlLayerName,
1655:               selectedLayer,
1656:               i,
1657:               cloneControlEffect,
1658:             );
1659:           } else {
1660:             addCloneExpressions(
1661:               controlLayerName,
1662:               selectedLayer,
1663:               i,
1664:               cloneControlEffect,
1665:             );
1666:             checkColours(cloneControlLayer, selectedLayer);
1667:           }
1668:         }
1669:       }
1670:       selectedLayer.index;
1671:       if (typeof cloneLabel !== "undefined") {
1672:         if (highestLayerIndex.index < layer.index) {
1673:           for (var i = numSelectedLayers - 1; i >= 0; i--) {
1674:             var selectedLayer = selectedLayers[i];
1675:             selectedLayer.moveBefore(highestLayerIndex);
1676:           }
1677:         } else {
1678:           for (var i = numSelectedLayers - 1; i >= 0; i--) {
1679:             var selectedLayer = selectedLayers[i];
1680:             selectedLayer.moveAfter(highestLayerIndex);
1681:           }
1682:         }
1683:       }
1684:     }
1685:     function checkColours(cloneControlLayer, selectedLayer) {
1686:       var controlEffects = cloneControlLayer.property("ADBE Effect Parade");
1687:       var numControlEffects = controlEffects.numProperties;
1688:       var colourCount = 0;
1689:       for (var c = 1; c <= numControlEffects; c += 1) {
1690:         var effect = controlEffects.property(c);
1691:         if (effect.matchName === "ADBE Color Control") {
1692:           colourCount += 1;
1693:         }
1694:       }
1695:       if (colourCount !== 0) {
1696:         addColours(cloneControlLayer, selectedLayer, colourCount);
1697:       }
1698:     }
1699:     function addColours(cloneControlLayer, selectedLayer, colourCount) {
1700:       var controlLayerName = cloneControlLayer.name;
1701:       var myFillExpressions = [];
1702:       for (var i = 1; i <= colourCount; i += 1) {
1703:         var colourFillExpression =
1704:           'thisComp.layer("' +
1705:           controlLayerName +
1706:           '").effect("Colour ' +
1707:           i +
1708:           '")(1)';
1709:         myFillExpressions.push(colourFillExpression);
1710:       }
1711:       var myFillDelayExpressions = [];
1712:       for (var i = 1; i <= colourCount; i += 1) {
1713:         var colourFillDelayExpression =
1714:           'thisComp.layer("' +
1715:           controlLayerName +
1716:           '").effect("Colour ' +
1717:           i +
1718:           '")(1).valueAtTime(time - (delay - randomDelay))';
1719:         myFillDelayExpressions.push(colourFillDelayExpression);
1720:       }
1721:       var cloneFill = selectedLayer
1722:         .property("ADBE Effect Parade")
1723:         .addProperty("ADBE Fill");
1724:       cloneFill.name = "Random Colour";
1725:       var cloneFillExpression = [
1726:         "/* Delay & Frames */",
1727:         'var frameDelay = thisComp.layer("' +
1728:           controlLayerName +
1729:           '").effect("Easy Clones")(2);',
1730:         'var randomDelay = framesToTime(effect("Clone Controls")(7));',
1731:         'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
1732:         "var delay = frameDelay*framesToTime(newIndex);",
1733:         " ",
1734:         'if (thisComp.layer("' +
1735:           controlLayerName +
1736:           '").effect("Delay Colours?")(1) == false) {',
1737:         " ",
1738:         "   var colours = [" + myFillExpressions.toString() + "];",
1739:         '   var colourSeed = effect("Clone Controls")(8) + thisComp.layer("' +
1740:           controlLayerName +
1741:           '").effect("Colour Seed")(1);',
1742:         "   seedRandom(colourSeed, true);",
1743:         "   colours[Math.floor(random (colours.length - 0.0001) )];",
1744:         " ",
1745:         "} else {",
1746:         " ",
1747:         "   var colours = [" + myFillDelayExpressions.toString() + "];",
1748:         '   var colourSeed = effect("Clone Controls")(8) + thisComp.layer("' +
1749:           controlLayerName +
1750:           '").effect("Colour Seed")(1);',
1751:         "   seedRandom(colourSeed, true);",
1752:         "   colours[Math.floor(random (colours.length - 0.0001) )];",
1753:         " ",
1754:         "}",
1755:       ].join("\n");
1756:       selectedLayer
1757:         .property("ADBE Effect Parade")
1758:         .property("ADBE Fill")
1759:         .property("ADBE Fill-0002").expression = cloneFillExpression;
1760:     }
1761:     app.beginUndoGroup("Add Clones");
1762:     var comp = app.project.activeItem;
1763:     if (comp == null || comp instanceof CompItem == false) {
1764:       alert("Please select at least one layer to add Clones.");
1765:       return;
1766:     } else {
1767:       var selectedLayer = comp.selectedLayers[0];
1768:       if (selectedLayer == null) {
1769:         alert("Please select at least one layer to add Clones.");
1770:         return;
1771:       }
1772:     }
1773:     try {
1774:       function getCloneControlLayer() {
1775:         var comp = app.project.activeItem;
1776:         var layers = comp.layers;
1777:         var numLayers = layers.length;
1778:         var cloneControlLayers = [];
1779:         for (var i = 1; i <= numLayers; i += 1) {
1780:           var layer = layers[i];
1781:           var effects = layer.property("ADBE Effect Parade");
1782:           if (effects.numProperties > 0) {
1783:             if (effects.property(1).name === "Easy Clones") {
1784:               cloneControlLayers.push(layer);
1785:             }
1786:           }
1787:         }
1788:         if (cloneControlLayers.length > 0) {
1789:           var win = new Window("dialog", "Select An Existing Clone System");
1790:           win.margins = 15;
1791:           var content = win.add("group");
1792:           content.orientation = "column";
1793:           var panel01 = content.add(
1794:             "panel",
1795:             undefined,
1796:             "Add to a Clone System",
1797:           );
1798:           panel01.alignChildren = ["left", "top"];
1799:           panel01.orientation = "column";
1800:           panel01.preferredSize.width = 340;
1801:           panel01.spacing = 5;
1802:           var row01 = panel01.add("group");
1803:           row01.orientation = "row";
1804:           row01.spacing = 5;
1805:           var row01Label = row01.add(
1806:             'statictext {text: "Clone System:", justify: "right"}',
1807:           );
1808:           row01Label.preferredSize.width = 100;
1809:           var cloneSystemNames = [];
1810:           var numCloneControlLayers = cloneControlLayers.length;
1811:           for (var i = 0; i < numCloneControlLayers; i += 1) {
1812:             var name = cloneControlLayers[i].name;
1813:             cloneSystemNames.push(name.replace(" Clone Controls", ""));
1814:           }
1815:           var row01Input = row01.add(
1816:             "dropdownlist",
1817:             undefined,
1818:             cloneSystemNames,
1819:           );
1820:           row01Input.preferredSize.width = 200;
1821:           row01Input.selection = 0;
1822:           var row02 = panel01.add("group");
1823:           row02.orientation = "row";
1824:           row02.spacing = 5;
1825:           var row02Label = row02.add(
1826:             'statictext {text: "Centre to Control?", justify: "right"}',
1827:           );
1828:           row02Label.preferredSize.width = 100;
1829:           var row02 = row02.add("checkbox", undefined);
1830:           row02.preferredSize.width = 200;
1831:           var buttonGroup = win.add("group");
1832:           buttonGroup.alignChildren = ["right", "top"];
1833:           buttonGroup.orientation = "row";
1834:           buttonGroup.preferredSize.width = 340;
1835:           var cancelButton = buttonGroup.add("button", undefined, "Cancel");
1836:           var okayButton = buttonGroup.add("button", undefined, "Ok");
1837:           okayButton.active = true;
1838:           if (win.show() === 1) {
1839:             var selectionIndex = row01Input.selection.index;
1840:             var layer = cloneControlLayers[selectionIndex];
1841:             var newSystem = { layer: layer, zeroClones: row02.value };
1842:             return newSystem;
1843:           } else {
1844:             return false;
1845:           }
1846:         } else {
1847:           return "No Layer Found";
1848:         }
1849:       }
1850:       try {
1851:         var newSystem = getCloneControlLayer();
1852:       } catch (err) {
1853:         alert(err);
1854:       }
1855:       var zeroPositionCheckbox = newSystem.zeroClones;
1856:       var cloneControlLayer = newSystem.layer;
1857:       if (newSystem === "No Layer Found") {
1858:         alert(
1859:           "No \'Easy Clones\' control layer was found in the current composition.",
1860:         );
1861:       } else if (newSystem !== false) {
1862:         addClones(cloneControlLayer, zeroPositionCheckbox, trialMode);
1863:       } else {
1864:         if (newSystem === false) {
1865:         }
1866:       }
1867:     } catch (err) {
1868:       alert(err);
1869:     }
1870:     app.endUndoGroup();
1871:   }
1872:   function shuffleClones() {
1873:     var comp = app.project.activeItem;
1874:     if (comp == null || comp instanceof CompItem == false) {
1875:       alert("Please select Clones tosShuffle their index order.");
1876:     } else {
1877:       var selectedLayer = comp.selectedLayers[0];
1878:       if (selectedLayer == null) {
1879:         alert("Please select Clones to shuffle their index order.");
1880:       } else {
1881:         randomIndex();
1882:       }
1883:     }
1884:   }
1885:   function scanEffectsFor(effectParade, search) {
1886:     for (var i = 1; i <= effectParade.numProperties; i += 1) {
1887:       if (effectParade.property(i).matchName === search) {
1888:         return true;
1889:       }
1890:     }
1891:     return false;
1892:   }
1893:   function randomIndex() {
1894:     app.beginUndoGroup("Reorder Clones");
1895:     var comp = app.project.activeItem;
1896:     var layers = comp.selectedLayers;
1897:     var numLayers = layers.length;
1898:     for (var i = 0; i < numLayers; i += 1) {
1899:       var myLayer = layers[i];
1900:       var myLayerName = myLayer.name;
1901:       var layerEffects = myLayer.property("ADBE Effect Parade");
1902:       if (myLayerName.match(/\bClone-/g)) {
1903:         if (scanEffectsFor(layerEffects, "Pseudo/cloneControls1.1")) {
1904:           function shuffle(array) {
1905:             var currentIndex = array.length;
1906:             while (0 !== currentIndex) {
1907:               randomIndex = Math.floor(Math.random() * currentIndex);
1908:               currentIndex -= 1;
1909:               temporaryValue = array[currentIndex];
1910:               array[currentIndex] = array[randomIndex];
1911:               array[randomIndex] = temporaryValue;
1912:             }
1913:             return array;
1914:           }
1915:           var comp = app.project.activeItem;
1916:           var selectedLayers = comp.selectedLayers;
1917:           var newOrder = shuffle(selectedLayers);
1918:           for (var i = 1; i < selectedLayers.length; i += 1) {
1919:             selectedLayers[i].moveBefore(comp.layer(newOrder[i - 1].index));
1920:           }
1921:         }
1922:       } else {
1923:         alert("Please only select Clone layers");
1924:         break;
1925:       }
1926:     }
1927:     app.endUndoGroup();
1928:   }
1929:   function renumberClones() {
1930:     var comp = app.project.activeItem;
1931:     if (comp == null || comp instanceof CompItem == false) {
1932:       alert("Please select the Clones you wish to renumber.");
1933:     } else {
1934:       var selectedLayer = comp.selectedLayers[0];
1935:       if (selectedLayer == null) {
1936:         alert("Please select the Clones you wish to renumber.");
1937:       } else {
1938:         renameClones();
1939:       }
1940:     }
1941:   }
1942:   function scanEffectsFor(effectParade, search) {
1943:     for (var i = 1; i <= effectParade.numProperties; i += 1) {
1944:       if (effectParade.property(i).matchName === search) {
1945:         return true;
1946:       }
1947:     }
1948:     return false;
1949:   }
1950:   function renameClones() {
1951:     app.beginUndoGroup("Reorder Clones");
1952:     var comp = app.project.activeItem;
1953:     var layers = comp.selectedLayers;
1954:     var numLayers = layers.length;
1955:     for (var i = 0; i < numLayers; i += 1) {
1956:       var myLayer = layers[i];
1957:       var myLayerName = myLayer.name;
1958:       var layerEffects = myLayer.property("ADBE Effect Parade");
1959:       if (myLayerName.match(/\bClone-/g)) {
1960:         if (scanEffectsFor(layerEffects, "Pseudo/cloneControls1.1")) {
1961:           var commentMatch = layers[i].comment;
1962:           layers[i].name = commentMatch + " Clone-" + i + 1;
1963:         }
1964:       } else {
1965:         alert("Please only select Clone layers");
1966:         break;
1967:       }
1968:     }
1969:     app.endUndoGroup();
1970:   }
1971:   function centreClones() {
1972:     var comp = app.project.activeItem;
1973:     if (comp == null || comp instanceof CompItem == false) {
1974:       alert("Please select Clones to centre their position.");
1975:     } else {
1976:       var selectedLayer = comp.selectedLayers[0];
1977:       if (selectedLayer == null) {
1978:         alert("Please select Clones to centre their position.");
1979:       } else {
1980:         centreClonesPosition();
1981:       }
1982:     }
1983:   }
1984:   function scanEffectsFor(effectParade, search) {
1985:     for (var i = 1; i <= effectParade.numProperties; i += 1) {
1986:       if (effectParade.property(i).matchName === search) {
1987:         return true;
1988:       }
1989:     }
1990:     return false;
1991:   }
1992:   function centreClonesPosition() {
1993:     app.beginUndoGroup("Centre Clones");
1994:     var comp = app.project.activeItem;
1995:     var layers = comp.selectedLayers;
1996:     var numLayers = layers.length;
1997:     for (var i = 0; i < numLayers; i += 1) {
1998:       var myLayer = layers[i];
1999:       var myLayerName = myLayer.name;
2000:       var layerEffects = myLayer.property("ADBE Effect Parade");
2001:       if (myLayerName.match(/\bClone-/g)) {
2002:         if (scanEffectsFor(layerEffects, "Pseudo/cloneControls1.1")) {
2003:           var commentMatch = layers[i].comment;
2004:           if (myLayer.comment === commentMatch) {
2005:             var time = comp.time;
2006:             for (var i = 0; i < numLayers; i += 1) {
2007:               if (layerEffects.numProperties > 0) {
2008:                 if (layerEffects.property(1).name === "Clone Controls") {
2009:                   var selectedLayersPosition = layers[i].transform.position;
2010:                 }
2011:                 if (selectedLayersPosition.numKeys > 0) {
2012:                   selectedLayersPosition.addKey(time);
2013:                   selectedLayersPosition.setValueAtTime(time, [0, 0, 0]);
2014:                 } else {
2015:                   selectedLayersPosition.setValue([0, 0, 0]);
2016:                 }
2017:               }
2018:             }
2019:           }
2020:         }
2021:       } else {
2022:         alert("Please only select Clone layers");
2023:         break;
2024:       }
2025:     }
2026:     app.endUndoGroup();
2027:   }
2028:   function applyCloneControlEffect(selectedLayer) {
2029:     function makePseudoEffectAvailable(presetFile) {
2030:       var myComp = app.project.activeItem;
2031:       var layerCollection = myComp.selectedLayers;
2032:       switchLayerSelection(layerCollection, false);
2033:       var tempNull = myComp.layers.addNull();
2034:       tempNull.selected = true;
2035:       tempNull.applyPreset(presetFile);
2036:       tempNull.remove();
2037:       switchLayerSelection(layerCollection, true);
2038:     }
2039:     function switchLayerSelection(layerArray, selectionValue) {
2040:       for (var i = 0, il = layerArray.length; i < il; i++) {
2041:         layerArray[i].selected = selectionValue;
2042:       }
2043:     }
2044:     function getAnimationPreset(presetName, presetLocation, presetBinary) {
2045:       var presetFolder = Folder(presetLocation);
2046:       var presetFile = File(presetFolder.toString() + "/" + presetName);
2047:       if (!presetFolder.exists) {
2048:         presetFolder = presetFolder.create();
2049:       }
2050:       if (!presetFile.exists) {
2051:         presetFile.encoding = "BINARY";
2052:         presetFile.open("w");
2053:         presetFile.write(presetBinary);
2054:         presetFile.close();
2055:       }
2056:       return presetFile;
2057:     }
2058:     if (!selectedLayer) {
2059:       throw new Error(
2060:         "applyPseudoEffect() method expects one parameter - Layer Object",
2061:       );
2062:     }
2063:     var PseudoEffectMachName = "Pseudo/cloneControls1.1";
2064:     var PseudoEffectName = "Clone Controls";
2065:     var AnimationPresetName = "Clone Controls.ffx";
2066:     var aescriptsFolder = Folder(
2067:       Folder.userData.fsName + "/Aescripts/Easy Clones/1.0/",
2068:     );
2069:     aescriptsFolder.create();
2070:     var AnimationPresetBinary = __BLOB__BLOB_000134__;
2071:     if (
2072:       selectedLayer.property("Effects").canAddProperty(PseudoEffectMachName) ===
2073:       false
2074:     ) {
2075:       var presetFile = getAnimationPreset(
2076:         AnimationPresetName,
2077:         aescriptsFolder,
2078:         AnimationPresetBinary,
2079:       );
2080:       makePseudoEffectAvailable(presetFile);
2081:     }
2082:     var myEffect = selectedLayer
2083:       .property("Effects")
2084:       .addProperty(PseudoEffectMachName);
2085:     myEffect.name = "Clone Controls";
2086:   }
2087:   function delayExpression(trialMode) {
2088:     var comp = app.project.activeItem;
2089:     if (comp == null || comp instanceof CompItem == false) {
2090:       alert(
2091:         "Please select at least one layer property to add the Delay Expression.",
2092:       );
2093:       return;
2094:     } else {
2095:       var selectedLayer = comp.selectedLayers[0];
2096:       if (selectedLayer == null) {
2097:         alert(
2098:           "Please select at least one layer property to add the Delay Expression.",
2099:         );
2100:         return;
2101:       }
2102:     }
2103:     try {
2104:       function getCloneSystem() {
2105:         var comp = app.project.activeItem;
2106:         var layers = comp.layers;
2107:         var numLayers = layers.length;
2108:         var systemMasters = [];
2109:         for (var l = 1; l <= numLayers; l += 1) {
2110:           var layer = layers[l];
2111:           var effects = layer.property("ADBE Effect Parade");
2112:           if (effects.numProperties > 0) {
2113:             if (scanEffectsFor(effects, "Pseudo/easyClones1.1")) {
2114:               var cloneSystemName = layer.name.replace("Clone Controls", "");
2115:               var layerIndex = layer.index;
2116:               systemMasters.push({ index: layerIndex, name: cloneSystemName });
2117:             }
2118:           }
2119:         }
2120:         if (systemMasters.length > 0) {
2121:           var win = new Window("dialog", "Select An Existing Clone System");
2122:           win.margins = 15;
2123:           var content = win.add("group");
2124:           content.orientation = "column";
2125:           var row01 = content.add("group");
2126:           row01.orientation = "row";
2127:           row01.spacing = 5;
2128:           var row01Label = row01.add(
2129:             'statictext {text: "Clone System:", justify: "right"}',
2130:           );
2131:           row01Label.preferredSize.width = 100;
2132:           var cloneSystemNames = [];
2133:           var numCloneSystems = systemMasters.length;
2134:           for (var s = 0; s < numCloneSystems; s += 1) {
2135:             cloneSystemNames.push(systemMasters[s].name);
2136:           }
2137:           var row01Input = row01.add(
2138:             "dropdownlist",
2139:             undefined,
2140:             cloneSystemNames,
2141:           );
2142:           row01Input.preferredSize.width = 200;
2143:           row01Input.selection = 0;
2144:           var buttonGroup = win.add("group");
2145:           buttonGroup.alignChildren = ["right", "top"];
2146:           buttonGroup.orientation = "row";
2147:           buttonGroup.preferredSize.width = 340;
2148:           var cancelButton = buttonGroup.add("button", undefined, "Cancel");
2149:           var okayButton = buttonGroup.add("button", undefined, "Ok");
2150:           okayButton.active = true;
2151:           if (win.show() === 1) {
2152:             return systemMasters[row01Input.selection.index];
2153:           } else {
2154:             return false;
2155:           }
2156:         } else {
2157:           return "no system found";
2158:         }
2159:       }
2160:       var cloneSystem = getCloneSystem();
2161:       if (cloneSystem === "no system found") {
2162:         alert("no system found in the current composition");
2163:       } else if (cloneSystem !== false) {
2164:         applyDelay(cloneSystem, trialMode);
2165:       } else {
2166:         if (cloneSystem === false) {
2167:         }
2168:       }
2169:     } catch (err) {
2170:       alert(err);
2171:     }
2172:   }
2173:   function applyDelay(cloneSystem, trialMode) {
2174:     app.beginUndoGroup("Add delay");
2175:     var comp = app.project.activeItem;
2176:     var layers = comp.selectedLayers;
2177:     var numLayers = layers.length;
2178:     var delayExpression = [
2179:       'var frameDelay = effect("Clone Controls")(7) + thisComp.layer("' +
2180:         cloneSystem.name +
2181:         'Clone Controls").effect("Easy Clones")(2);',
2182:       'var newIndex = parseInt(thisLayer.name.split("-").pop(), 10) - 1;',
2183:       "var delay = frameDelay*framesToTime(newIndex);",
2184:       "valueAtTime(time - delay)",
2185:     ].join("\n");
2186:     var delayTrialExpression = [
2187:       "/*this is a trial version, purchase a license to unlock this feature.*/",
2188:       "value",
2189:     ].join("\n");
2190:     for (var i = 0; i < numLayers; i += 1) {
2191:       var myLayer = layers[i];
2192:       var layerEffects = myLayer.property("ADBE Effect Parade");
2193:       var layerProperties = myLayer.selectedProperties;
2194:       if (layerProperties.length !== 0) {
2195:         if (scanEffectsFor(layerEffects, "Pseudo/cloneControls1.1")) {
2196:           for (var p = 0; p < layerProperties.length; p += 1) {
2197:             if (trialMode == true) {
2198:               layerProperties[p].expression = delayTrialExpression;
2199:             } else {
2200:               layerProperties[p].expression = delayExpression;
2201:             }
2202:           }
2203:         } else {
2204:           applyCloneControlEffect(myLayer);
2205:           layers[i].comment = layers[i].name;
2206:           layers[i].name = layers[i].name + " Clone-" + i + 1;
2207:           for (var p = 0; p < layerProperties.length; p += 1) {
2208:             if (trialMode == true) {
2209:               layerProperties[p].expression = delayTrialExpression;
2210:             } else {
2211:               layerProperties[p].expression = delayExpression;
2212:             }
2213:           }
2214:         }
2215:       } else {
2216:         alert("Please select a Layer Property to add the Delay Expression");
2217:       }
2218:     }
2219:     app.endUndoGroup();
2220:   }
2221:   function scanEffectsFor(effectParade, search) {
2222:     for (var i = 1; i <= effectParade.numProperties; i += 1) {
2223:       if (effectParade.property(i).matchName === search) {
2224:         return true;
2225:       }
2226:     }
2227:     return false;
2228:   }
2229:   var easyClones_settings = {
2230:     betaExpirationDate: new Date(""),
2231:     betaStartDate: new Date(""),
2232:     betaSupportEmail: "hola@mwmotion.tv",
2233:     helpButtons: [
2234:       {
2235:         name: "Demo Series",
2236:         url: "https://www.youtube.com/playlist?list=PLfla-R6TCGJ3dYtUyfjRErpVZg072bMOO",
2237:       },
2238:       { name: "MW Motion", url: "http://mwmotion.tv" },
2239:     ],
2240:     helpText:
2241:       "Easy Clones is a cloning system built for 2d artwork including Bitmap Layers, Vector Shape Layers and Precomps.\n\nEasy Clones will create a Clone Control Layer that will control basic properties (Position, Scale, Rotation and Opacity) as well as more advanced features within the Easy Clones effect for all the Clone layers assigned to the system.\n\nFor more information on how the tool works please watch the demo series (Click Button below).",
2242:     offerBeta: false,
2243:     offerTrial: true,
2244:     privateNumber: 7245256522480352,
2245:     productSKU: "MWEC-SUL",
2246:     scriptAuthor: "MW Motion",
2247:     scriptName: "Easy Clones",
2248:     scriptURL: "https://aescripts.com/easy-clones/",
2249:     scriptVersion: "1.1",
2250:   };
2251:   function a(vars) {
2252:     function licUI() {
2253:       var e = new Window(
2254:         "dialog",
2255:         strTrialWelcomeHeader + " - " + strVersion + " " + strScriptVersion,
2256:         void 0,
2257:         { resizeable: true },
2258:       );
2259:       if (null != e) {
2260:         var t =
2261:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\tinfoGrp: Group { \t\t\t\t\talignment: [\'fill\',\'top\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\torientation: \'column\', \t\t\t\t\t\thdrGrp: Group {\t\t\t\t\t\t\ttxt: StaticText {}, \t\t\t\t\t\t\tpaste: StaticText {}, \t\t\t\t\t\t}\t\t\t\t\t\ttrial: StaticText {}, \t\t\t\t\t} \t\t\t\t\tlicGrp: Group { \t\t\t\t\t\ttxt: EditText {alignment: [\'fill\',\'fill\'], properties:{multiline:false}}, \t\t\t\t\t} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'],                             buyGrp: Group {                             alignment: [\'left\',\'fill\'],                             alignChildren: [\'left\',\'fill\'],                             orientation: \'column\',                             spacing:1,                                  retrieveReg: Button {text:\'" +
2262:           strRetrieveLic.replace(/%t/, strLicense) +
2263:           "\', name:\'retrieve\',preferredSize:[130,25]}                                   buyLic: Button {text:\'" +
2264:           strBuyLic.replace(/%t/, strLicense) +
2265:           "\', name:\'buy\',preferredSize:[130,25]}                                   }\t\t\t\t\t\tcancelBtn: Button {text:\'" +
2266:           strCancel +
2267:           "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t\tokBtn: Button {text:\'" +
2268:           strOK +
2269:           "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
2270:         e.grp = e.add(t);
2271:         var i = ScriptUI.newFont(
2272:           "dialog || palette",
2273:           ScriptUI.FontStyle.BOLD,
2274:           12,
2275:         );
2276:         var n = ScriptUI.newFont(
2277:           "dialog || palette",
2278:           ScriptUI.FontStyle.REGULAR,
2279:           9,
2280:         );
2281:         return (
2282:           (e.grp.licGrp.txt.preferredSize = [600, 30]),
2283:           (e.grp.infoGrp.hdrGrp.txt.text = strEnterLicenseCode),
2284:           (e.grp.infoGrp.hdrGrp.txt.graphics.font = i),
2285:           (e.grp.infoGrp.hdrGrp.paste.text = ""),
2286:           (e.grp.infoGrp.hdrGrp.paste.graphics.font = n),
2287:           (e.grp.infoGrp.trial.text =
2288:             betaMode || !offerTrial ? "" : strTrialInstructMsg),
2289:           isServerConfigured(licenseValidity) &&
2290:             (isServerRunning(licenseValidity)
2291:               ? (e.grp.infoGrp.hdrGrp.txt.text = strServerInstructMsg)
2292:               : (e.grp.infoGrp.hdrGrp.txt.text =
2293:                   strEnterLicenseCode + " " + strServerNotRunning),
2294:             (e.grp.infoGrp.trial.text = strTrialInstructMsg)),
2295:           (e.grp.licGrp.txt.text = betaMode || !offerTrial ? "" : "trial"),
2296:           isServerConfigured(licenseValidity) &&
2297:             isServerRunning(licenseValidity) &&
2298:             (e.grp.licGrp.txt.text = "@REMOTE"),
2299:           (e.grp.okGrp.buyGrp.retrieveReg.visible =
2300:             e.grp.okGrp.buyGrp.buyLic.visible =
2301:               !betaMode),
2302:           (e.grp.okGrp.buyGrp.buyLic.onClick = function () {
2303:             openURL(strTrialUrl);
2304:             e.close(false);
2305:           }),
2306:           (e.grp.okGrp.buyGrp.retrieveReg.onClick = function () {
2307:             retrieveLicenseUI(strLicense);
2308:             e.close(false);
2309:           }),
2310:           (e.grp.okGrp.cancelBtn.onClick = function () {
2311:             e.close(false);
2312:           }),
2313:           (e.grp.okGrp.okBtn.onClick = function () {
2314:             license = e.grp.licGrp.txt.text
2315:               .replace(/^\s\s*/, "")
2316:               .replace(/\s\s*$/, "");
2317:             e.close(true);
2318:           }),
2319:           e.layout.layout(true),
2320:           e.layout.resize(),
2321:           (e.onResizing = e.onResize =
2322:             function () {
2323:               this.layout.resize();
2324:             }),
2325:           e
2326:         );
2327:       }
2328:     }
2329:     function retrieveLicenseUI(e) {
2330:       var t = new Window("dialog", strRetrieveLic.replace(/%t/, e), void 0, {
2331:         resizeable: true,
2332:       });
2333:       if (null != t) {
2334:         var i =
2335:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'],                     hdrGrp: Group {                         orientation: \'column\',                         alignment: [\'fill\',\'fill\'],                         alignChildren: [\'fill\',\'fill\'],                                 hdr: StaticText {text:\'" +
2336:           strLicenseDownloadOptions.replace(
2337:             /%t/,
2338:             e.toLowerCase() + "de" == locale ? "n" : "s",
2339:           ) +
2340:           "\', alignment: [\'fill\',\'top\'], properties:{multiline:true} },                                },                     buttonsGrp: Group {                         alignment: [\'fill\',\'bottom\'],                         alignChildren: [\'fill\',\'fill\'],                             myDownloadsBtn: Button {text:\'" +
2341:           strMyDownloads +
2342:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                             downloadManagerBtn: Button {text:\'" +
2343:           strDownloadManager +
2344:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                         }, \t\t\t\t}";
2345:         t.grp = t.add(i);
2346:         t.grp.buttonsGrp.myDownloadsBtn.onClick = function () {
2347:           openURL(retrieveUrl);
2348:           t.close(false);
2349:         };
2350:         t.grp.buttonsGrp.downloadManagerBtn.onClick = function () {
2351:           openURL(managerAppUrl);
2352:           t.close(false);
2353:         };
2354:         t.layout.layout(true);
2355:         t.layout.resize();
2356:         t.onResizing = t.onResize = function () {
2357:           this.layout.resize();
2358:         };
2359:         t.show();
2360:       }
2361:     }
2362:     function checkBeta(e, t) {
2363:       return new Date() < t || new Date() > e;
2364:     }
2365:     function helpUI() {
2366:       var e = new Window(
2367:         "dialog",
2368:         strScriptName + " - " + strVersion + " " + strScriptVersion,
2369:         void 0,
2370:         { resizeable: true },
2371:       );
2372:       if (null != e) {
2373:         for (
2374:           var t =
2375:               -1 != $.os.indexOf("Windows") &&
2376:               12 <= parseFloat(app.version) &&
2377:               parseFloat(app.version) < 14
2378:                 ? ["left", "top"]
2379:                 : ["fill", "fill"],
2380:             i =
2381:               "group { \t\torientation: \'column\', \t\talignment: [\'" +
2382:               t[0] +
2383:               "\',\'" +
2384:               t[1] +
2385:               "\'], \t\talignChildren: [\'fill\',\'fill\'],                    infoGrp: Group {                    alignment: [\'fill\',\'top\'],                    alignChildren: [\'fill\',\'top\'], \t\t\t\t\ttxt: StaticText {properties:{multiline:true}, preferredSize:[150,50]},                       hdr: StaticText {properties:{multiline:true}},                       removeLic: Button {text:\'" +
2386:               strDeactivate +
2387:               "\', preferredSize:[40,30]} \t\t\t\t} \t\t\t\thelpGrp: Group {                    alignment: [\'" +
2388:               t[0] +
2389:               "\',\'" +
2390:               t[1] +
2391:               "\'],                    alignChildren: [\'fill\',\'fill\'],                     txt: EditText {properties:{multiline:true, readonly:true}}, \t\t\t\t}                 prefsGrp: Group {                       alignment: [\'fill\',\'bottom\'],                        alignChildren: [\'left\',\'center\'],                        orientation: \'row\',                        checkNow: Button {text:\'" +
2392:               strCheckNow +
2393:               "\', preferredSize:[150,25]}                        doUpdateCheck: Checkbox {text:\'" +
2394:               strVersionCheck +
2395:               "\', preferredSize:[-1,25]}                        }\t\t\tokGrp: Group {                 alignment: [\'fill\',\'bottom\'],                 alignChildren: [\'fill\',\'center\'],                 supportBtn: Button {text:\'" +
2396:               strGetSupport +
2397:               "\', preferredSize:[150,30], alignment: [\'left\',\'center\']}                 ",
2398:             n = 0;
2399:           n < Math.min(maxUIButtons, vars.helpButtons.length);
2400:           n++
2401:         ) {
2402:           if (vars.helpButtons[n].hasOwnProperty("name")) {
2403:             i +=
2404:               "btn" + n + ": " + vars.helpButtons[n].hasOwnProperty("type") &&
2405:               validateButtonType(vars.helpButtons[n].type)
2406:                 ? vars.helpButtons[n].type
2407:                 : "Button" +
2408:                   " {id: \'" +
2409:                   n +
2410:                   "\', alignment: [\'left\',\'center\']}";
2411:           }
2412:         }
2413:         i +=
2414:           "\t\t\t\t\tokBtn: Button {text:\'" +
2415:           strOK +
2416:           "\', preferredSize:[150,30], alignment: [\'right\',\'center\']} \t\t\t\t} \t\t}";
2417:         e.grp = e.add(i);
2418:         e.grp.helpGrp.txt.preferredSize = [800, 500];
2419:         var r = "\xa9" + (new Date().getYear() + 1900).toString();
2420:         e.grp.infoGrp.txt.text =
2421:           strScriptName +
2422:           " - " +
2423:           strVersion +
2424:           " " +
2425:           strScriptVersion +
2426:           "\n" +
2427:           r +
2428:           " " +
2429:           vars.scriptAuthor +
2430:           "\n\n";
2431:         e.grp.infoGrp.hdr.text = getRegistration();
2432:         e.grp.helpGrp.txt.text = vars.helpText;
2433:         haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
2434:           (doUpdateCheck = !(
2435:             "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
2436:           ));
2437:         e.grp.prefsGrp.doUpdateCheck.value = doUpdateCheck;
2438:         e.grp.prefsGrp.doUpdateCheck.onClick = function () {
2439:           setUpdateCheck(this.value);
2440:         };
2441:         e.grp.prefsGrp.checkNow.onClick = function () {
2442:           ScriptUI.environment.keyboardState.altKey
2443:             ? alert(
2444:                 "aescripts licensing framework version\n" + licensingVersion,
2445:               )
2446:             : doUpdateCheckNow();
2447:         };
2448:         for (
2449:           var n = 0;
2450:           n < Math.min(maxUIButtons, vars.helpButtons.length);
2451:           n += 1
2452:         ) {
2453:           vars.helpButtons[n].hasOwnProperty("name") &&
2454:             ((e.grp.okGrp["btn" + n].text = vars.helpButtons[n].name),
2455:             vars.helpButtons[n].hasOwnProperty("url")
2456:               ? (e.grp.okGrp["btn" + n].onClick = function () {
2457:                   openURL(vars.helpButtons[this.id].url);
2458:                 })
2459:               : vars.helpButtons[n].hasOwnProperty("onClickFunction") &&
2460:                 (e.grp.okGrp["btn" + n].onClick =
2461:                   vars.helpButtons[n].onClickFunction),
2462:             vars.helpButtons[n].hasOwnProperty("btnValue") &&
2463:               (e.grp.okGrp["btn" + n].value = vars.helpButtons[n].btnValue));
2464:         }
2465:         e.grp.infoGrp.removeLic.visible = !isResultTrial(
2466:           licenseValidity.result,
2467:         );
2468:         e.grp.infoGrp.removeLic.onClick = function () {
2469:           removeLic() &&
2470:             ((e.grp.infoGrp.hdr.text = getRegistration()),
2471:             (this.visible = false));
2472:         };
2473:         e.grp.okGrp.supportBtn.onClick = function () {
2474:           ScriptUI.environment.keyboardState.shiftKey &&
2475:           ScriptUI.environment.keyboardState.altKey
2476:             ? alert(
2477:                 "aescripts + aeplugins\nFramework version: " +
2478:                   licensingVersion +
2479:                   "\n" +
2480:                   strScriptName +
2481:                   " - " +
2482:                   strVersion +
2483:                   " " +
2484:                   strScriptVersion,
2485:               )
2486:             : (openSupportTicket({}), e.close());
2487:         };
2488:         e.grp.okGrp.okBtn.onClick = function () {
2489:           e.close();
2490:         };
2491:         -1 != $.os.indexOf("Windows") &&
2492:           12 <= parseFloat(app.version) &&
2493:           parseFloat(app.version) < 14 &&
2494:           (e.maximumSize = [840, 670]);
2495:         e.layout.layout(true);
2496:         e.layout.resize();
2497:         e.onResizing = e.onResize = function () {
2498:           this.layout.resize();
2499:         };
2500:         e.show();
2501:       }
2502:     }
2503:     function validateButtonType(e) {
2504:       return "Button" === e || "Checkbox" === e;
2505:     }
2506:     function openSupportTicket(e) {
2507:       i = n = "";
2508:       t = "&subject=";
2509:       null != e &&
2510:         void 0 !== e &&
2511:         (e.hasOwnProperty("subject") && (t += File.encode(e.subject)),
2512:         e.hasOwnProperty("message") && (i = File.encode(e.message)),
2513:         e.hasOwnProperty("diagnostic") &&
2514:           (n = File.encode(e.diagnostic + "\n--\n")));
2515:       var r =
2516:         true === isAescriptsSupportUrl
2517:           ? strSKU + t + "&message="
2518:           : t.replace(/\&/, "?") + "&body=";
2519:       var a =
2520:         "" != r
2521:           ? i +
2522:             "%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A-------%0D%0A" +
2523:             n +
2524:             getDiagnosticData(true)
2525:           : "";
2526:       supportUrl.toString().match(/@/) &&
2527:         !supportUrl.toString().match(/^mailto:/) &&
2528:         (supportUrl = "mailto:" + supportUrl);
2529:       openURL(supportUrl + r + a);
2530:     }
2531:     function getDiagnosticData(e) {
2532:       var t = $.os.toString();
2533:       var i =
2534:         BridgeTalk.getDisplayName(BridgeTalk.appName) +
2535:         " (" +
2536:         app.version +
2537:         ") - " +
2538:         $.locale.toString();
2539:       var n =
2540:         strScriptName.replace(/&/, "and") +
2541:         " - " +
2542:         strVersion +
2543:         " " +
2544:         strScriptVersion;
2545:       var r = "Lic. fw v" + licensingVersion + isVT() ? " (Trial)" : "";
2546:       return e
2547:         ? File.encode(n) +
2548:             "%0D%0A" +
2549:             File.encode(t) +
2550:             "%0D%0A" +
2551:             File.encode(i) +
2552:             "%0D%0A" +
2553:             File.encode(r)
2554:         : n + "\n" + t + "\n" + i + "\n" + r;
2555:     }
2556:     function setUpdateCheck(e) {
2557:       saveSettings(prefsSectionName, prefsDoUpdateCheck, (doUpdateCheck = e));
2558:     }
2559:     function doUpdateCheckNow() {
2560:       checkForNewVersion((doUpdateCheck = true));
2561:     }
2562:     function newVersionUI(t) {
2563:       var i = new Window("dialog", strNewVersionAvailableHdr, void 0, {
2564:         resizeable: true,
2565:       });
2566:       if (null != i) {
2567:         var e =
2568:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t   hdrGrp: Group { \t\t\t\t   alignment: [\'fill\',\'fill\'], \t\t\t\t   alignChildren: [\'fill\',\'fill\'], \t\t\t\t   orientation: \'column\',                         hdr: StaticText {alignment: [\'fill\',\'top\'], properties:{multiline:true}}, ";
2569:         t.hasOwnProperty("header") &&
2570:           (e +=
2571:             "   infoGrp: Panel {                            alignment: [\'fill\',\'fill\'],                            alignChildren: [\'fill\',\'fill\'],                            orientation: \'column\',                               info: StaticText {properties:{multiline:true}},                               } ");
2572:         e +=
2573:           "} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\t\tskipVersionBtn: Button {text:\'" +
2574:           strSkipVersion +
2575:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']}                            remindMeLaterBtn: Button {text:\'" +
2576:           strRemindMeLater +
2577:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t\tdownloadBtn: Button {text:\'" +
2578:           strDownload +
2579:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
2580:         i.grp = i.add(e);
2581:         var n = ScriptUI.newFont(
2582:           "dialog || palette",
2583:           ScriptUI.FontStyle.BOLD,
2584:           12,
2585:         );
2586:         ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.BOLD, 11);
2587:         ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.REGULAR, 9);
2588:         i.grp.hdrGrp.hdr.graphics.font = n;
2589:         i.grp.hdrGrp.hdr.text = strNewVersionAvailable.replace(
2590:           /%v/,
2591:           t.version + "\n" + strCurrentVersion.replace(/%v/, strScriptVersion),
2592:         );
2593:         t.hasOwnProperty("header") &&
2594:           (i.grp.hdrGrp.infoGrp.info.text = t.header + "\n\n" + t.detail);
2595:         i.grp.okGrp.skipVersionBtn.onClick = function () {
2596:           saveSettings(
2597:             prefsSectionName,
2598:             prefsLastVersionChecked,
2599:             strScriptVersion,
2600:           );
2601:           saveSettings(
2602:             prefsSectionName,
2603:             prefsLastTimeVersionChecked,
2604:             new Date().toString(),
2605:           );
2606:           saveSettings(
2607:             prefsSectionName,
2608:             prefsNextTimeVersionCheckedSkipVersion,
2609:             t.version,
2610:           );
2611:           saveSettings(
2612:             prefsSectionName,
2613:             prefsLastServerVersionChecked,
2614:             t.version,
2615:           );
2616:           i.close(false);
2617:         };
2618:         i.grp.okGrp.remindMeLaterBtn.onClick = function () {
2619:           try {
2620:             var e = new Date();
2621:             e = dateAddDays(remindMeLaterDays);
2622:             saveSettings(
2623:               prefsSectionName,
2624:               prefsLastVersionChecked,
2625:               strScriptVersion,
2626:             );
2627:             saveSettings(
2628:               prefsSectionName,
2629:               prefsLastTimeVersionChecked,
2630:               new Date().toString(),
2631:             );
2632:             saveSettings(
2633:               prefsSectionName,
2634:               prefsNextTimeVersionChecked,
2635:               e.toString(),
2636:             );
2637:             saveSettings(
2638:               prefsSectionName,
2639:               prefsLastServerVersionChecked,
2640:               t.version,
2641:             );
2642:             i.close(false);
2643:           } catch (e) {
2644:             alert(e.toString());
2645:           }
2646:         };
2647:         i.grp.okGrp.downloadBtn.onClick = function () {
2648:           retrieveLicenseUI(strDownload);
2649:           i.close(true);
2650:         };
2651:         i.layout.layout(true);
2652:         i.layout.resize();
2653:         i.onResizing = i.onResize = function () {
2654:           this.layout.resize();
2655:         };
2656:         t.hasOwnProperty("header") &&
2657:           ((i.grp.hdrGrp.infoGrp.size.height = Math.min(
2658:             i.grp.hdrGrp.infoGrp.size.height,
2659:             300,
2660:           )),
2661:           i.layout.layout(true),
2662:           i.layout.resize());
2663:         i.show();
2664:       }
2665:     }
2666:     function dateAddDays(e) {
2667:       var t = new Date().getTime() + 86400000 * e;
2668:       return new Date(t);
2669:     }
2670:     function checkForNewVersion(e) {
2671:       if ((null == e && (e = false), doUpdateCheck)) {
2672:         haveSettings(prefsSectionName, prefsLastVersionChecked) &&
2673:           (i = getSettings(prefsSectionName, prefsLastVersionChecked));
2674:         haveSettings(prefsSectionName, prefsLastServerVersionChecked) &&
2675:           (n = getSettings(prefsSectionName, prefsLastServerVersionChecked));
2676:         haveSettings(prefsSectionName, prefsLastTimeVersionChecked) &&
2677:           (r = new Date(
2678:             getSettings(prefsSectionName, prefsLastTimeVersionChecked),
2679:           ));
2680:         haveSettings(
2681:           prefsSectionName,
2682:           prefsNextTimeVersionCheckedSkipVersion,
2683:         ) &&
2684:           (s = getSettings(
2685:             prefsSectionName,
2686:             prefsNextTimeVersionCheckedSkipVersion,
2687:           ));
2688:         haveSettings(prefsSectionName, prefsNextTimeVersionChecked) &&
2689:           (a = new Date(
2690:             getSettings(prefsSectionName, prefsNextTimeVersionChecked),
2691:           ));
2692:         haveSettings(prefsSectionName, prefsVersionCheckInit) &&
2693:           (t = getSettings(prefsSectionName, prefsVersionCheckInit));
2694:         var o = new Date();
2695:         if (e || null == t || null == a || !(o < a)) {
2696:           var l = versionCheck(strSKU, true, e);
2697:           if (null != l) {
2698:             var c =
2699:               null != l && l.hasOwnProperty("version")
2700:                 ? l.version
2701:                 : strScriptVersion;
2702:             if ((e || null == n || n != c) && (e || null == s || s != n)) {
2703:               saveSettings(prefsSectionName, prefsVersionCheckInit, 1);
2704:               try {
2705:                 var f = new Date();
2706:                 f = dateAddDays(updateCheckInterval);
2707:                 saveSettings(
2708:                   prefsSectionName,
2709:                   prefsLastVersionChecked,
2710:                   strScriptVersion,
2711:                 );
2712:                 saveSettings(
2713:                   prefsSectionName,
2714:                   prefsLastTimeVersionChecked,
2715:                   new Date().toString(),
2716:                 );
2717:                 saveSettings(
2718:                   prefsSectionName,
2719:                   prefsNextTimeVersionChecked,
2720:                   f.toString(),
2721:                 );
2722:               } catch (e) {
2723:                 alert(e.toString());
2724:               }
2725:               var d = compareVersions(c, strScriptVersion);
2726:               0 < d && (null == i || null == r || null == a || e || a <= o)
2727:                 ? newVersionUI(l)
2728:                 : d <= 0 && e && alert(strUpToDate);
2729:             }
2730:           } else {
2731:             saveSettings(
2732:               prefsSectionName,
2733:               prefsDoUpdateCheck,
2734:               (doUpdateCheck = false),
2735:             );
2736:           }
2737:         }
2738:       }
2739:     }
2740:     function versionCheck(e, t, i) {
2741:       var n = extComms(
2742:         "https://notify.aescripts.com/versioncheck2.php?json=1&plain=1&sku=" +
2743:           e +
2744:           t
2745:           ? "&latest=1"
2746:           : "" + parseFloat(app.version) < 12
2747:             ? "&clip_length=200"
2748:             : "&clip_length=300",
2749:         null,
2750:       );
2751:       if (null == n || "" == n || !validateJSON(n)) {
2752:         return (i && alert(strUpdateCheckError), null);
2753:       }
2754:       try {
2755:         if (null == (n = JSONify(n, "parse"))) {
2756:           return null;
2757:         }
2758:       } catch (e) {
2759:         return null;
2760:       }
2761:       return "ok" != n.status
2762:         ? null
2763:         : t
2764:           ? {
2765:               date: n.latest.release_date,
2766:               detail: n.latest.detail,
2767:               header: strVersionRev
2768:                 .replace(/%a/, n.version)
2769:                 .replace(/%b/, "")
2770:                 .replace(/%c/, n.latest.release_date),
2771:               version: n.version,
2772:             }
2773:           : { version: n.version };
2774:     }
2775:     function extComms(e) {
2776:       try {
2777:         if (-1 != $.os.indexOf("Mac")) {
2778:           var t = system.callSystem('curl -s 2 "' + e + '"');
2779:         } else {
2780:           var i =
2781:             ((n = new File(
2782:               Folder.userData.fsName + "/Aescripts/aescripts_helper.vbs",
2783:             )).open("w"),
2784:             n.write(
2785:               'dim o: Set o = createobject("MSXML2.XMLHTTP.6.0")\no.Open "GET", WScript.Arguments(0), False\no.Send\nIf o.Status >= 200 And o.Status <= 202 Then\nWScript.Echo o.responseText\nElse\nWScript.Echo "Error"\nEnd If',
2786:             ),
2787:             n.close(),
2788:             n.exists ? n : null);
2789:           if (null == i) {
2790:             return null;
2791:           }
2792:           t = system.callSystem(
2793:             'cscript //nologo "' + i.fsName + '" "' + e + '"',
2794:           );
2795:         }
2796:         return t;
2797:       } catch (e) {
2798:         return (alert("extComms error\n" + e.toString()), null);
2799:       }
2800:     }
2801:     function socketConnect(e, t) {
2802:       var i = new Socket();
2803:       if (
2804:         ((i.encoding = "binary"), (i.timeout = 2), i.open(e + ":80", "UTF-8"))
2805:       ) {
2806:         i.write(
2807:           "GET /" + t + " HTTP/1.1\nHost: " + e + "\n\nConnection: close\n\n",
2808:         );
2809:         var n = i.read(2000);
2810:         return (i.close(), null != n ? (n = n.toString()) : null);
2811:       }
2812:       return null;
2813:     }
2814:     function formatHistory(e, t) {
2815:       var i = e.data;
2816:       var n = [];
2817:       for (var r in i) {
2818:         if (i.hasOwnProperty(r)) {
2819:           for (var a = i[r].history, s = a.length - 1; 0 <= s; s--) {
2820:             var o = a[s];
2821:             var l = "";
2822:             var c = o.detail;
2823:             s == a.length - 1 && (l = " (" + strNewestVersionAvailable + ")");
2824:             var f = strVersionRev
2825:               .replace(/%0/, o.version_number)
2826:               .replace(/%1/, l)
2827:               .replace(/%2/, o.release_date)
2828:               .replace(/%3/, c);
2829:             (!options.summaryOnlyNewChanges ||
2830:               compareVersions(t, o.version_number) < 0) &&
2831:               n.push(f);
2832:           }
2833:         }
2834:       }
2835:       return n.join("\n\n");
2836:     }
2837:     function getVerifCode(e) {
2838:       return "1";
2839:       "trial" == e.toLowerCase() && (e = "");
2840:       var i =
2841:         -1 != $.os.indexOf("Mac") &&
2842:         (Folder("/Volumes/Private").exists || Folder("/Volumes/private").exists)
2843:           ? Folder.userData.fsName
2844:           : Folder.temp.fsName +
2845:             "/" +
2846:             Math.round(Math.random() * 42132 * new Date().getTime());
2847:       if (-1 != $.os.indexOf("Win")) {
2848:         t = wx;
2849:         i += ".exe";
2850:       } else {
2851:         if (systemCall("arch").toLowerCase().match(/ppc/)) {
2852:           return (alert(strPpcNotSupported), false);
2853:         }
2854:         t = mx;
2855:       }
2856:       var n = createFile(File(i), t, "BINARY");
2857:       if (!n.exists) {
2858:         return ((licenseData = { result: -108 }), licenseData);
2859:       }
2860:       n.hidden = true;
2861:       -1 != $.os.indexOf("Mac") && systemCall('chmod +x "' + n.fsName + '"');
2862:       var r = systemCall(
2863:         '"' + n.fsName + '" "' + strHeader + '" ' + privateNum + ' "' + e + '"',
2864:       );
2865:       return (n.remove(), parseResult(r));
2866:     }
2867:     function parseResult(t) {
2868:       try {
2869:         i = parseVerifCode(t.toString());
2870:       } catch (e) {
2871:         (i = { result: -101 }).e =
2872:           e.toString() + "\nresult:\n\n" + t.toString();
2873:       }
2874:       return i;
2875:     }
2876:     function parseVerifCode(e) {
2877:       for (var t = e.match(/[^\r\n]+/g), i = {}, n = 0; n < t.length; n++) {
2878:         var r = t[n].split(":");
2879:         if (2 <= r.length) {
2880:           var a = r[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
2881:           var s = trimQuotes(r[1]);
2882:           "LS" == a && "UP" == s && (a = "LSS");
2883:           isNaN(s) || (s = parseFloat(s));
2884:           i[a] = s;
2885:         }
2886:       }
2887:       return (
2888:         void 0 === i.result && ((i.result = -102), (i.e = e)),
2889:         checkTrialDetails(i),
2890:         checkBetaDetails(i),
2891:         (isTimeLimited = checkTimeLimited(i)),
2892:         i
2893:       );
2894:     }
2895:     function checkTimeLimited(e) {
2896:       var t = retProp("rt$", e);
2897:       var i = retProp("nd$", e);
2898:       if ("" == t || "" == i) {
2899:         return false;
2900:       }
2901:       switch (e.result) {
2902:         case -20:
2903:           e.e = t;
2904:           break;
2905:         case -21:
2906:           e.e = i;
2907:       }
2908:     }
2909:     function checkFloatingLicense(e) {
2910:       retProp("pe$", e) != bD("RkxU") ||
2911:         isServerRunning(e) ||
2912:         (e.result = -109);
2913:     }
2914:     function checkTrialDetails(e) {
2915:       if (-7 !== e.result) {
2916:       } else if (0 == trialLengthDays) {
2917:         e.result = -106;
2918:       } else {
2919:         var t = retProp("^d", e);
2920:         if (void 0 === t) {
2921:           return void (e.result = -103);
2922:         }
2923:         var i = trialLengthDays - t;
2924:         0 < i
2925:           ? ((e.result = 100), (e.tdl = i), (e.license = bD("VFJJQUw=")))
2926:           : ((e.result = -100), (e.tdl = 0));
2927:       }
2928:     }
2929:     function checkBetaDetails(e) {
2930:       var t = e.result;
2931:       var i = retProp("pe$", e).match(/^B/);
2932:       betaMode && (isResultTrial(t) || -106 == t || -7 == t)
2933:         ? (e.result = -107)
2934:         : !betaMode && i && (e.result = -105);
2935:     }
2936:     function isResultValidLicense(e) {
2937:       return true;
2938:     }
2939:     function isResultTrial(e) {
2940:       return false;
2941:     }
2942:     function isServerConfigured(e) {
2943:       try {
2944:         return retProp("^L", e).match(/^O/);
2945:       } catch (e) {}
2946:     }
2947:     function isServerRunning(e) {
2948:       try {
2949:         return retProp("SS$", e).match(/^U/);
2950:       } catch (e) {}
2951:     }
2952:     function trimQuotes(e) {
2953:       return (
2954:         "\'" == (e = e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ""))[0] &&
2955:           "\'" == e[e.length - 1] &&
2956:           (e = e.substring(1, e.length - 1)),
2957:         e
2958:       );
2959:     }
2960:     function sanitizeProductName(e) {
2961:       return e.toString().replace(/[^a-z0-9]/gi, "");
2962:     }
2963:     function checkErrorCode(e) {
2964:       return licErrors[locale].hasOwnProperty(e.toString()) ? e : "unknown";
2965:     }
2966:     function string_encode3(e) {
2967:       for (var t = 0, i = 0; i < e.length; i++) {
2968:         t += e.charCodeAt(i);
2969:       }
2970:       return t;
2971:     }
2972:     function getVerifCode3(e) {
2973:       var t = e.split("*");
2974:       if (4 == t.length) {
2975:         var i = t[3].replace(/^[0-9]+/, "");
2976:         var n = t[3].match(/^[0-9]+/, "");
2977:         var r = n[0].substr(0, 2);
2978:         var a = n[0].substr(n[0].length - 2);
2979:         var s = r[0] + t[0] + r[1] + t[1] + a[0] + t[2] + a[1] + i;
2980:         var o = n[0].substring(2, n[0].length - 2);
2981:         return string_encode3(s) * privateNum == o ? "1" : "0";
2982:       }
2983:       return (e != bE("bad") && alert(strNewLicenseFormat), "0");
2984:     }
2985:     function string_encode(e) {
2986:       return (
2987:         e.length * e.charCodeAt(0) +
2988:         e.charCodeAt(Math.floor(0.1 * (e.length - 1))) +
2989:         e.charCodeAt(Math.floor(0.2 * (e.length - 1))) +
2990:         e.charCodeAt(Math.floor(0.3 * (e.length - 1))) +
2991:         e.charCodeAt(Math.floor(0.4 * (e.length - 1))) +
2992:         e.charCodeAt(Math.floor(0.5 * (e.length - 1))) +
2993:         e.charCodeAt(Math.floor(0.7 * (e.length - 1))) +
2994:         e.charCodeAt(Math.floor(0.8 * (e.length - 1))) +
2995:         e.charCodeAt(Math.floor(0.9 * (e.length - 1))) +
2996:         e.charCodeAt(e.length - 1)
2997:       );
2998:     }
2999:     function check_v1_License(e) {
3000:       var t = e.split("**");
3001:       return (
3002:         !(
3003:           !e
3004:             .replace(/^ +|| +$/g, "")
3005:             .match(/^.+\*\*.+\*\*[0-9]+[A-Za-z]{3}$/) || 3 != t.length
3006:         ) || (alert(strOldLicenseFormat), false)
3007:       );
3008:     }
3009:     function check_v2_License(e) {
3010:       var t = e.split("*");
3011:       return (
3012:         e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[0-9]+[A-Za-z]{3}[0-9]+$/) &&
3013:         4 == t.length
3014:       );
3015:     }
3016:     function check_timed_License(e) {
3017:       var t = e.split("*");
3018:       return (
3019:         e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[A-Z0-9#]+[A-Za-z]{3}[0-9]+$/) &&
3020:         4 == t.length
3021:       );
3022:     }
3023:     function checkCode(e, t, i) {
3024:       if (
3025:         ((t = null == t ? "" : t.replace(/^\s\s*/, "").replace(/\s\s*$/, "")),
3026:         (myLicense = false),
3027:         e && ((regUI = licUI()), (myRegPrompt = regUI.show()), !myRegPrompt))
3028:       ) {
3029:         return false;
3030:       }
3031:       var n = false;
3032:       "@remote" == (t = null == license ? t : license).toLowerCase() &&
3033:         ((t = strHeader + t), (n = true));
3034:       var r = t.split("*");
3035:       var a = t.match(/#/);
3036:       var s = a && check_timed_License(t);
3037:       var o = check_v2_License(t);
3038:       if (!((offerTrial && "trial" == t.toLowerCase()) || n || o || s)) {
3039:         if (t.match(/^[A-Z]{2}[A-Z0-9]{30}$/)) {
3040:           var l = confirm(strTempCode);
3041:           return (
3042:             isSecurityPrefSet() && l && openURL(exchangeUrl + "?serial=" + t),
3043:             myLicense
3044:           );
3045:         }
3046:         return (
3047:           alert(
3048:             strInvalidCode + "\n" + betaMode
3049:               ? strNewLicenseFormat.replace(
3050:                   new RegExp(bD("U1VM"), "g"),
3051:                   bD("QlRB"),
3052:                 )
3053:               : strNewLicenseFormat + "\n\n" + strContactSupport,
3054:           ),
3055:           saveSettings(prefsSectionName, prefsName, bE("bad")),
3056:           saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
3057:           saveSettings(prefsSectionName, prefsLicVersion, licensingVersion),
3058:           checkCode(true),
3059:           myLicense
3060:         );
3061:       }
3062:       if (("trial" != t.toLowerCase() || n) && !n) {
3063:         if (null != r[0] && r[0] != strHeader) {
3064:           return (
3065:             alert(strWrongProduct + "\n" + strContactSupport),
3066:             checkCode(e),
3067:             false
3068:           );
3069:         }
3070:         var c = r[3].match(/[A-Z]{3}[0-9]+$/);
3071:         if (null != c) {
3072:           if (c[0].match(bD("QlRB")) && !betaMode) {
3073:             return (
3074:               alert(strBetaCodeAlert),
3075:               saveSettings(prefsSectionName, prefsName, bE("bad")),
3076:               checkCode(true),
3077:               false
3078:             );
3079:           }
3080:           myLicense = true;
3081:         }
3082:       }
3083:       if (
3084:         !isResultValidLicense(
3085:           (licenseValidity = 2 == licV ? getVerifCode(t) : getVerifCode3(t)),
3086:         )
3087:       ) {
3088:         e || (e = true);
3089:         var f = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
3090:         return (
3091:           alert(
3092:             licErrors[locale][checkErrorCode(licenseValidity.result)].title +
3093:               "\n" +
3094:               licErrors[locale][checkErrorCode(licenseValidity.result)].detail +
3095:               f,
3096:           ),
3097:           -9 == licenseValidity.result &&
3098:             prompt(strDeactivate + "?") &&
3099:             getVerifCode("-"),
3100:           checkCode(e),
3101:           myLicense
3102:         );
3103:       }
3104:       if (
3105:         ((isValidTrial =
3106:           !a &&
3107:           offerTrial &&
3108:           "trial" == t.toLowerCase() &&
3109:           isResultTrial(licenseValidity.result)),
3110:         e && !isValidTrial)
3111:       ) {
3112:         var d = parseInt(retProp("^n", licenseValidity), 10);
3113:         t.match(/@remote/i) ||
3114:           alert(
3115:             strRegSuccess.replace("%u", d) + (1 < d) && "de" != locale
3116:               ? "s"
3117:               : "" + betaMode
3118:                 ? ""
3119:                 : "\n" + strRegSuccess1,
3120:           );
3121:       }
3122:       return ((myLicense = true), myLicense);
3123:     }
3124:     function checkForLegacyLic() {
3125:       var e = haveSettings(prefsSectionName, prefsName)
3126:         ? bD(getSettings(prefsSectionName, prefsName))
3127:         : "";
3128:       return check_v2_License(e) ? e : "";
3129:     }
3130:     function trial_expired() {
3131:       var e = confirm(strExpiredAlert);
3132:       isSecurityPrefSet() && e
3133:         ? openURL(strTrialUrl)
3134:         : e && isAE() && alert(strErrScriptAccess);
3135:     }
3136:     function bD(e) {
3137:       var o = "";
3138:       var l = 0;
3139:       e = e.replace(/[^A-Za-z0-9\+\/\=]/g, "");
3140:       for (
3141:         var c =
3142:           "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
3143:         l < e.length;
3144:       ) {
3145:         t =
3146:           (c.indexOf(e.charAt(l++)) << 2) |
3147:           ((r = c.indexOf(e.charAt(l++))) >> 4);
3148:         i = ((15 & r) << 4) | ((a = c.indexOf(e.charAt(l++))) >> 2);
3149:         n = ((3 & a) << 6) | (s = c.indexOf(e.charAt(l++)));
3150:         o += String.fromCharCode(t);
3151:         64 != a && (o += String.fromCharCode(i));
3152:         64 != s && (o += String.fromCharCode(n));
3153:       }
3154:       return o;
3155:     }
3156:     function bE(e) {
3157:       for (
3158:         t,
3159:           i,
3160:           n,
3161:           r,
3162:           a,
3163:           s,
3164:           o,
3165:           l = "",
3166:           c = 0,
3167:           f =
3168:             "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
3169:         c < e.length;
3170:       ) {
3171:         r = (t = e.charCodeAt(c++)) >> 2;
3172:         a = ((3 & t) << 4) | ((i = e.charCodeAt(c++)) >> 4);
3173:         s = ((15 & i) << 2) | ((n = e.charCodeAt(c++)) >> 6);
3174:         o = 63 & n;
3175:         isNaN(i) ? (s = o = 64) : isNaN(n) && (o = 64);
3176:         l = l + f.charAt(r) + f.charAt(a) + f.charAt(s) + f.charAt(o);
3177:       }
3178:       return l;
3179:     }
3180:     function isSecurityPrefSet() {
3181:       var e =
3182:         parseFloat(app.version) < 12
3183:           ? "Main Pref Section"
3184:           : "Main Pref Section v2";
3185:       return (
3186:         1 ==
3187:         app.preferences.getPrefAsLong(e, "Pref_SCRIPTING_FILE_NETWORK_SECURITY")
3188:       );
3189:     }
3190:     function openURL(e) {
3191:       if (
3192:         ((e = e.toString()).match(/@/) ||
3193:           e.match(/^https?:\/\//) ||
3194:           (e = "http://" + e.replace(/^(http)?s?:?\/?\/?/, "")),
3195:         isAE() || isPS())
3196:       ) {
3197:         Folder.commonFiles.parent.fsName;
3198:         -1 != $.os.indexOf("Windows")
3199:           ? systemCall('cmd /c "start ' + (e = e.replace(/&/g, "^&")) + '"')
3200:           : systemCall('open "' + e + '"');
3201:       } else {
3202:         createFile(
3203:           File(Folder.temp.fsName + "/openUrl.url"),
3204:           "[InternetShortcut]\rURL=" + e + "\r",
3205:           "UTF-8",
3206:           true,
3207:         ).execute();
3208:       }
3209:     }
3210:     function parseRegistration(e) {
3211:       if (0 == retProp("^r", licenseValidity)) {
3212:         if (
3213:           ((a = retProp("^f", licenseValidity)),
3214:           (s = retProp("^la", licenseValidity)),
3215:           (o = retProp("^n", licenseValidity)),
3216:           (l = retProp("pe$", licenseValidity)),
3217:           isTimeLimited &&
3218:             (parseDateString(retProp("rt$", licenseValidity)),
3219:             (f = parseDateString(retProp("nd$", licenseValidity)))),
3220:           0 < e)
3221:         ) {
3222:           return a + "\'" + s + "\'" + retProp("^s", licenseValidity) + l + o;
3223:         }
3224:         n = a + s.toString().match(/^@/) ? "" : " " + s + " ";
3225:         r = l;
3226:       } else {
3227:         n = "";
3228:       }
3229:       var d = strUsers.replace("%u", o) + (1 < o) && "de" != locale ? "s" : "";
3230:       switch (r) {
3231:         case bD("U1VM"):
3232:           t = " - " + strLicense + " " + d;
3233:           break;
3234:         case bD("QlRB"):
3235:           t = " - " + strBTA + " " + d;
3236:           break;
3237:         case bD("RURV"):
3238:           t = " - " + strEDU + " " + d;
3239:           break;
3240:         case bD("RkxU"):
3241:           t = " - " + strFLT + " " + d;
3242:           break;
3243:         default:
3244:           c = retProp("^t", licenseValidity);
3245:           isTimeLimited ||
3246:             (t = c < 1 ? strTrialExpired : strTrialTxt.replace(/%E/, c));
3247:       }
3248:       return (
3249:         (i = "" != n ? strRegistration + n + t : t),
3250:         isTimeLimited && (i += "\nLicense ends: " + f),
3251:         i
3252:       );
3253:     }
3254:     function parseDateString(e) {
3255:       var t = e.toString().split("-");
3256:       return new Date(
3257:         parseInt(t[0]),
3258:         parseInt(t[1] - 1),
3259:         parseInt(t[2]),
3260:       ).toDateString();
3261:     }
3262:     function retProp(e, t) {
3263:       for (var i in t) {
3264:         if (t.hasOwnProperty(i) && i.toString().match(new RegExp(e))) {
3265:           return t[i];
3266:         }
3267:       }
3268:       return "";
3269:     }
3270:     function isAE() {
3271:       return BridgeTalk.appName.match(new RegExp(bD("YWZ0ZXJlZmZlY3Rz")));
3272:     }
3273:     function isPS() {
3274:       return BridgeTalk.appName.match(new RegExp(bD("cGhvdG9zaG9w")));
3275:     }
3276:     function readFile(e) {
3277:       if (null != e && null != e && e.exists && e.open("r")) {
3278:         var t = e.read();
3279:         return (e.close(), t);
3280:       }
3281:       return null;
3282:     }
3283:     function createFile(e, t, i, n, r) {
3284:       return (
3285:         ((null == e || null == e || e.exists) && !n) ||
3286:           (e.exists && e.remove(),
3287:           ((e =
3288:             -1 != $.os.indexOf("Win")
3289:               ? new File(e.fsName)
3290:               : new File(e.absoluteURI)).encoding = i),
3291:           e.open("w"),
3292:           e.write(t),
3293:           e.close(),
3294:           (null != r && r) || (e.hidden = true),
3295:           -1 != $.os.indexOf("Mac") &&
3296:             systemCall(bD("Y2htb2QgK3gg") + e.absoluteURI)),
3297:         e
3298:       );
3299:     }
3300:     function systemCall(e) {
3301:       if (isAE()) {
3302:         return system.callSystem(e);
3303:       }
3304:       if (isPS()) {
3305:         var t =
3306:           -1 != $.os.indexOf("Win")
3307:             ? Folder.temp.fsName
3308:             : Folder.temp.absoluteURI +
3309:               "/" +
3310:               Math.round(Math.random() * 71827 * new Date().getTime());
3311:         return (app.system(e + " > " + t), readFile(File(t)));
3312:       }
3313:       return "";
3314:     }
3315:     function parseSettings(e, t) {
3316:       for (var i in t) {
3317:         if (t.hasOwnProperty(i)) {
3318:           if ("object" == typeof t[i]) {
3319:             return parseSettings(e, t[i]);
3320:           }
3321:           if (i === e) {
3322:             return t[i];
3323:           }
3324:         }
3325:       }
3326:     }
3327:     function readJSON(e) {
3328:       if (null == e || null == e) {
3329:         return false;
3330:       }
3331:       e instanceof File || File(e);
3332:       var t = readFile(e);
3333:       return JSONify(t, "parse");
3334:     }
3335:     function writeJSON(e, t) {
3336:       if (null == e || null == e || null == t || null == t) {
3337:         return false;
3338:       }
3339:       t instanceof File || File(t);
3340:       return (
3341:         createFile(t, JSONify(e, "stringify", "\t"), "UTF-8", true, true),
3342:         t.exists
3343:       );
3344:     }
3345:     function getSettings(e, t, i) {
3346:       if (isAE() && "settings" != i) {
3347:         return app.settings.getSetting(e, t);
3348:       }
3349:       var n = File(prefsLocation + prefsPrefix + File.encode(e));
3350:       var r = readFile(n);
3351:       var a = JSONify(r, "parse");
3352:       if (a instanceof Array) {
3353:         for (var s in ((a = fixSettingsFile(a)), n.remove(), a)) {
3354:           saveSettings(e, s, a[s]);
3355:         }
3356:       }
3357:       return a[t];
3358:     }
3359:     function haveSettings(e, t, i) {
3360:       if (isAE() && "settings" != i) {
3361:         return app.settings.haveSetting(e, t);
3362:       }
3363:       var n = readFile(File(prefsLocation + prefsPrefix + File.encode(e)));
3364:       if (null != n) {
3365:         var r = JSONify(n.toString(), "parse");
3366:         return (r instanceof Array && (r = fixSettingsFile(r)), t in r);
3367:       }
3368:       return false;
3369:     }
3370:     function fixSettingsFile(e) {
3371:       for (var t = {}, i = 0; i < e.length - 1; i++) {
3372:         t[e[i]] = e[i + 1];
3373:         i++;
3374:       }
3375:       return t;
3376:     }
3377:     function saveSettings(e, t, i, n) {
3378:       if (isAE() && "settings" != n) {
3379:         app.settings.saveSetting(e, t, i);
3380:         app.preferences.saveToDisk();
3381:       } else {
3382:         var r = {};
3383:         var a = File(prefsLocation + prefsPrefix + File.encode(e));
3384:         if (a.exists) {
3385:           var s = readFile(a);
3386:           null != s && (r = JSONify(s.toString(), "parse"));
3387:         }
3388:         r instanceof Array && (r = fixSettingsFile(r));
3389:         r[t] = i;
3390:         createFile(
3391:           File(prefsLocation + prefsPrefix + File.encode(e)),
3392:           JSONify(r, "stringify", "\t"),
3393:           "UTF-8",
3394:           true,
3395:         );
3396:       }
3397:     }
3398:     function saveVersionsToPrefs() {
3399:       saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
3400:       saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
3401:     }
3402:     function isVT() {
3403:       return (
3404:         (void 0 !== licenseValidity &&
3405:           licenseValidity.hasOwnProperty("result")) ||
3406:           (licenseValidity = getVerifCode("")),
3407:         isResultValidLicense(licenseValidity) &&
3408:           isResultTrial(licenseValidity.result)
3409:       );
3410:     }
3411:     function getRegistration(e) {
3412:       return (
3413:         (void 0 !== licenseValidity &&
3414:           licenseValidity.hasOwnProperty("result")) ||
3415:           (licenseValidity = getVerifCode("")),
3416:         parseRegistration(e)
3417:       );
3418:     }
3419:     function removeLic() {
3420:       (void 0 !== licenseValidity &&
3421:         licenseValidity.hasOwnProperty("result")) ||
3422:         (licenseValidity = getVerifCode(""));
3423:       var e =
3424:         isServerConfigured(licenseValidity) && isServerRunning(licenseValidity)
3425:           ? strHeader + "@REMOTE"
3426:           : "";
3427:       return (
3428:         (licenseValidity = getVerifCode("-" + e)),
3429:         (theLicense = false),
3430:         alert(strScriptName + ": " + strLicenseRemoved),
3431:         isServerConfigured(licenseValidity) ||
3432:           (saveSettings(prefsSectionName, prefsName, bE("bad")),
3433:           saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
3434:           saveSettings(prefsSectionName, prefsLicVersion, licensingVersion)),
3435:         !theLicense
3436:       );
3437:     }
3438:     function mainFunc(e) {
3439:       if (
3440:         !isAE() ||
3441:         isSecurityPrefSet() ||
3442:         (alert(strErrScriptAccess),
3443:         parseFloat(app.version) < 16.1
3444:           ? app.executeCommand(2359)
3445:           : app.executeCommand(3131),
3446:         isSecurityPrefSet())
3447:       ) {
3448:         if (betaMode && checkBeta(betaExpirationDate, betaStartDate)) {
3449:           "l" == e && alert(strBetaExpiredAlert);
3450:         } else {
3451:           if ("l" == e || "c" == e || "r" == e) {
3452:             var n = false;
3453:             if (
3454:               ("l" == e && doUpdateCheck && checkForNewVersion(), 2 == licV)
3455:             ) {
3456:               if ("r" == e) {
3457:                 i = !removeLic();
3458:               } else {
3459:                 if ("-22" == (licenseValidity = getVerifCode("")).result) {
3460:                   var r =
3461:                     "e" in licenseValidity ? "\n" + licenseValidity.e : "";
3462:                   alert(
3463:                     licErrors[locale][checkErrorCode(licenseValidity.result)]
3464:                       .title +
3465:                       "\n" +
3466:                       licErrors[locale][checkErrorCode(licenseValidity.result)]
3467:                         .detail +
3468:                       r,
3469:                   );
3470:                   getVerifCode("-");
3471:                   n = true;
3472:                   t =
3473:                     isServerConfigured(licenseValidity) &&
3474:                     isServerRunning(licenseValidity)
3475:                       ? "@REMOTE"
3476:                       : "trial";
3477:                 }
3478:                 if (
3479:                   isResultValidLicense(licenseValidity) &&
3480:                   !isResultTrial(licenseValidity.result)
3481:                 ) {
3482:                   return true;
3483:                 }
3484:                 "" == (t = checkForLegacyLic()) &&
3485:                   ((n = true),
3486:                   (t =
3487:                     isServerConfigured(licenseValidity) &&
3488:                     isServerRunning(licenseValidity)
3489:                       ? "@REMOTE"
3490:                       : "trial"));
3491:                 i = checkCode(n, t, privateNum);
3492:               }
3493:             } else {
3494:               haveSettings(prefsSectionName, prefsName)
3495:                 ? ((t = getSettings(prefsSectionName, prefsName)),
3496:                   (n = !(
3497:                     "c" == e ||
3498:                     !(
3499:                       ("bad" == t || "bad" == bD(t) || offerTrial) &&
3500:                       "trial" == bD(t)
3501:                     )
3502:                   )))
3503:                 : "c" == e
3504:                   ? (saveSettings(
3505:                       prefsSectionName,
3506:                       prefsName,
3507:                       bE((t = !isTimeLimited && offerTrial ? "trial" : "")),
3508:                     ),
3509:                     saveSettings(
3510:                       prefsSectionName,
3511:                       prefsVersionName,
3512:                       strScriptVersion,
3513:                     ),
3514:                     saveSettings(
3515:                       prefsSectionName,
3516:                       prefsLicVersion,
3517:                       licensingVersion,
3518:                     ),
3519:                     (n = false))
3520:                   : (n = true);
3521:               i = checkCode(n, t, privateNum);
3522:             }
3523:             return i;
3524:           }
3525:         }
3526:       }
3527:     }
3528:     var licensingVersion = "3.0.42";
3529:     null == vars.scriptName &&
3530:       alert("scriptName variable missing in settings object");
3531:     var strScriptName = vars.scriptName;
3532:     null == vars.scriptVersion &&
3533:       alert("scriptVersion variable missing in settings object");
3534:     var strScriptVersion = vars.scriptVersion;
3535:     null == vars.scriptURL &&
3536:       alert("scriptURL variable missing in settings object");
3537:     var strTrialUrl = vars.scriptURL;
3538:     null == vars.privateNumber &&
3539:       alert("privateNumber variable missing in settings object");
3540:     var privateNum = vars.privateNumber;
3541:     null == vars.productSKU &&
3542:       alert("productSKU variable missing in settings object");
3543:     var strSKU = vars.productSKU;
3544:     var strSKUArray = strSKU.toString().split("-");
3545:     if (null == strSKUArray || 2 != strSKUArray.length) {
3546:       return (
3547:         alert(
3548:           "Product SKU incorrectly entered in settings. Should looks like this: XXXX-SUL",
3549:         ),
3550:         false
3551:       );
3552:     }
3553:     null == vars.helpText && (vars.helpText = "");
3554:     null == vars.helpButtons && (vars.helpButtons = []);
3555:     var isTimeLimited =
3556:       vars.hasOwnProperty("isTimeLimited") && vars.isTimeLimited;
3557:     var strHeader = strSKUArray[0];
3558:     var betaSupportEmail = vars.hasOwnProperty("betaSupportEmail")
3559:       ? vars.betaSupportEmail
3560:       : "";
3561:     var offerTrial = !vars.hasOwnProperty("offerTrial") || vars.offerTrial;
3562:     var trialLengthDays = vars.hasOwnProperty("trialLengthDaysX")
3563:       ? vars.trialLengthDaysX
3564:       : Math.round(Math.sqrt(parseInt(bD("NTU3Ng==").substr(0, 2))));
3565:     var betaMode = !!vars.hasOwnProperty("offerBeta") && vars.offerBeta;
3566:     if (betaMode) {
3567:       null == vars.betaStartDate &&
3568:         alert("betaStartDate variable missing in settings object");
3569:       var betaStartDate = vars.betaStartDate;
3570:       null == vars.betaExpirationDate &&
3571:         alert("betaExpirationDate variable missing in settings object");
3572:       var betaExpirationDate = vars.betaExpirationDate;
3573:     }
3574:     var supportEmail =
3575:       vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
3576:         ? vars.externalSupportURL
3577:         : "http://aescripts.com/contact";
3578:     betaMode && "" != betaSupportEmail && (supportEmail = betaSupportEmail);
3579:     var aescriptsSupportUrl = "https://aescripts.com/contact";
3580:     var supportUrl =
3581:       vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
3582:         ? vars.externalSupportURL
3583:         : aescriptsSupportUrl;
3584:     var isAescriptsSupportUrl = supportUrl === aescriptsSupportUrl;
3585:     isAescriptsSupportUrl &&
3586:       (supportUrl = supportUrl.replace(/\/*/, "") + "/?direct=1&sku=");
3587:     var aescriptsRetrieveUrl =
3588:       "https://aescripts.com/downloadable/customer/products";
3589:     var retrieveUrl =
3590:       vars.hasOwnProperty("retrieveLicenseURL") && "" != vars.retrieveLicenseURL
3591:         ? vars.retrieveLicenseURL
3592:         : aescriptsRetrieveUrl;
3593:     var exchangeUrl = "https://license.aescripts.com/exchange";
3594:     var useLegacyPrefsHeader =
3595:       !!vars.hasOwnProperty("useLegacyPrefsHeader") &&
3596:       vars.useLegacyPrefsHeader;
3597:     var managerAppUrl =
3598:       "https://aescripts.com/learn/aescripts-aeplugins-manager-app/";
3599:     var remindMeLaterDays = 7;
3600:     var doUpdateCheck =
3601:       !vars.hasOwnProperty("doUpdateCheck") || vars.doUpdateCheck;
3602:     var updateCheckInterval = 5;
3603:     var maxUIButtons = 3;
3604:     var licV = 2;
3605:     var wx = __BLOB__BLOB_000135__;
3606:     var mx = __BLOB__BLOB_000136__;
3607:     function JSONify(string, mode, prettyJSON) {
3608:       if (typeof JSON !== "object") {
3609:         JSON = {};
3610:       }
3611:       (function () {
3612:         function f(n) {
3613:           return n < 10 ? "0" + n : n;
3614:         }
3615:         function this_value() {
3616:           return this.valueOf();
3617:         }
3618:         function quote(string) {
3619:           rx_escapable.lastIndex = 0;
3620:           return rx_escapable.test(string)
3621:             ? '"' +
3622:                 string.replace(rx_escapable, function (a) {
3623:                   var c = meta[a];
3624:                   return typeof c === "string"
3625:                     ? c
3626:                     : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
3627:                 }) +
3628:                 '"'
3629:             : '"' + string + '"';
3630:         }
3631:         function str(key, holder) {
3632:           var mind = gap;
3633:           var value = holder[key];
3634:           if (
3635:             value &&
3636:             typeof value === "object" &&
3637:             typeof value.toJSON === "function"
3638:           ) {
3639:             value = value.toJSON(key);
3640:           }
3641:           if (typeof rep === "function") {
3642:             value = rep.call(holder, key, value);
3643:           }
3644:           switch (typeof value) {
3645:             case "string":
3646:               return quote(value);
3647:             case "number":
3648:               return isFinite(value) ? String(value) : "null";
3649:             case "boolean":
3650:             case "null":
3651:               return String(value);
3652:             case "object":
3653:               if (!value) {
3654:                 return "null";
3655:               }
3656:               gap += indent;
3657:               partial = [];
3658:               if (Object.prototype.toString.apply(value) === "[object Array]") {
3659:                 length = value.length;
3660:                 for (var i = 0; i < length; i += 1) {
3661:                   partial[i] = str(i, value) || "null";
3662:                 }
3663:                 v =
3664:                   partial.length === 0
3665:                     ? "[]"
3666:                     : gap
3667:                       ? "[\n" +
3668:                         gap +
3669:                         partial.join(",\n" + gap) +
3670:                         "\n" +
3671:                         mind +
3672:                         "]"
3673:                       : "[" + partial.join(",") + "]";
3674:                 gap = mind;
3675:                 return v;
3676:               }
3677:               if (rep && typeof rep === "object") {
3678:                 length = rep.length;
3679:                 for (var i = 0; i < length; i += 1) {
3680:                   if (typeof rep[i] === "string") {
3681:                     k = rep[i];
3682:                     v = str(k, value);
3683:                     if (v) {
3684:                       partial.push(quote(k) + gap ? ": " : ":" + v);
3685:                     }
3686:                   }
3687:                 }
3688:               } else {
3689:                 for (var k in value) {
3690:                   if (Object.prototype.hasOwnProperty.call(value, k)) {
3691:                     v = str(k, value);
3692:                     if (v) {
3693:                       partial.push(quote(k) + gap ? ": " : ":" + v);
3694:                     }
3695:                   }
3696:                 }
3697:               }
3698:               v =
3699:                 partial.length === 0
3700:                   ? "{}"
3701:                   : gap
3702:                     ? "{\n" +
3703:                       gap +
3704:                       partial.join(",\n" + gap) +
3705:                       "\n" +
3706:                       mind +
3707:                       "}"
3708:                     : "{" + partial.join(",") + "}";
3709:               gap = mind;
3710:               return v;
3711:           }
3712:         }
3713:         ("use strict");
3714:         var rx_one = /^[\],:{}\s]*$/;
3715:         var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
3716:         var rx_three =
3717:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
3718:         var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
3719:         var rx_escapable =
3720:           /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
3721:         var rx_dangerous =
3722:           /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
3723:         if (typeof Date.prototype.toJSON !== "function") {
3724:           Date.prototype.toJSON = function () {
3725:             return isFinite(this.valueOf())
3726:               ? this.getUTCFullYear() +
3727:                   "-" +
3728:                   f(this.getUTCMonth() + 1) +
3729:                   "-" +
3730:                   f(this.getUTCDate()) +
3731:                   "T" +
3732:                   f(this.getUTCHours()) +
3733:                   ":" +
3734:                   f(this.getUTCMinutes()) +
3735:                   ":" +
3736:                   f(this.getUTCSeconds()) +
3737:                   "Z"
3738:               : null;
3739:           };
3740:           Boolean.prototype.toJSON = this_value;
3741:           Number.prototype.toJSON = this_value;
3742:           String.prototype.toJSON = this_value;
3743:         }
3744:         if (typeof JSON.stringify !== "function") {
3745:           meta = {
3746:             "\b": "\\b",
3747:             "\t": "\\t",
3748:             "\n": "\\n",
3749:             "\f": "\\f",
3750:             "\r": "\\r",
3751:             '"': '\\"',
3752:             "\\": "\\\\",
3753:           };
3754:           JSON.stringify = function (value, replacer, space) {
3755:             gap = "";
3756:             indent = "";
3757:             if (typeof space === "number") {
3758:               for (var i = 0; i < space; i += 1) {
3759:                 indent += " ";
3760:               }
3761:             } else {
3762:               if (typeof space === "string") {
3763:                 indent = space;
3764:               }
3765:             }
3766:             rep = replacer;
3767:             if (
3768:               replacer &&
3769:               typeof replacer !== "function" &&
3770:               (typeof replacer !== "object" ||
3771:                 typeof replacer.length !== "number")
3772:             ) {
3773:               throw new Error("JSON.stringify");
3774:             }
3775:             return str("", { "": value });
3776:           };
3777:         }
3778:       })();
3779:       var jsonParse = (function () {
3780:         function v(h, j, e) {
3781:           return j ? u[j] : String.fromCharCode(parseInt(e, 16));
3782:         }
3783:         var r =
3784:           "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
3785:         var k =
3786:           '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
3787:         k = '(?:"' + k + '*")';
3788:         var s = new RegExp(
3789:           "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
3790:           "g",
3791:         );
3792:         var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
3793:         var u = {
3794:           '"': '"',
3795:           "/": "/",
3796:           "\\": "\\",
3797:           b: "\b",
3798:           f: "\f",
3799:           n: "\n",
3800:           r: "\r",
3801:           t: "\t",
3802:         };
3803:         var w = new String("");
3804:         var x = Object.hasOwnProperty;
3805:         return function (h, j) {
3806:           h = h.match(s);
3807:           var c = h[0];
3808:           var l = false;
3809:           if ("{" === c) {
3810:             e = {};
3811:           } else if ("[" === c) {
3812:             e = [];
3813:           } else {
3814:             e = [];
3815:             l = true;
3816:           }
3817:           for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
3818:             c = h[m];
3819:             switch (c.charCodeAt(0)) {
3820:               default:
3821:                 a = d[0];
3822:                 a[b || a.length] = c;
3823:                 b = void 0;
3824:                 break;
3825:               case 34:
3826:                 c = c.substring(1, c.length - 1);
3827:                 if (c.indexOf("\\") !== -1) {
3828:                   c = c.replace(t, v);
3829:                 }
3830:                 a = d[0];
3831:                 if (!b) {
3832:                   if (a instanceof Array) {
3833:                     b = a.length;
3834:                   } else {
3835:                     b = c || w;
3836:                     break;
3837:                   }
3838:                 }
3839:                 a[b] = c;
3840:                 b = void 0;
3841:                 break;
3842:               case 91:
3843:                 a = d[0];
3844:                 d.unshift((a[b || a.length] = []));
3845:                 b = void 0;
3846:                 break;
3847:               case 93:
3848:                 d.shift();
3849:                 break;
3850:               case 102:
3851:                 a = d[0];
3852:                 a[b || a.length] = false;
3853:                 b = void 0;
3854:                 break;
3855:               case 110:
3856:                 a = d[0];
3857:                 a[b || a.length] = null;
3858:                 b = void 0;
3859:                 break;
3860:               case 116:
3861:                 a = d[0];
3862:                 a[b || a.length] = true;
3863:                 b = void 0;
3864:                 break;
3865:               case 123:
3866:                 a = d[0];
3867:                 d.unshift((a[b || a.length] = {}));
3868:                 b = void 0;
3869:                 break;
3870:               case 125:
3871:                 d.shift();
3872:                 break;
3873:             }
3874:           }
3875:           if (l) {
3876:             if (d.length !== 1) {
3877:               throw new Error();
3878:             }
3879:             e = e[0];
3880:           } else {
3881:             if (d.length) {
3882:               throw new Error();
3883:             }
3884:           }
3885:           if (j) {
3886:             var p = function (n, o) {
3887:               var f = n[o];
3888:               if (f && typeof f === "object") {
3889:                 var i = null;
3890:                 for (var g in f) {
3891:                   if (x.call(f, g) && f !== n) {
3892:                     var q = p(f, g);
3893:                     if (q !== void 0) {
3894:                       f[g] = q;
3895:                     } else {
3896:                       i || (i = []);
3897:                       i.push(g);
3898:                     }
3899:                   }
3900:                 }
3901:                 if (i) {
3902:                   for (g = i.length; --g >= 0; ) {
3903:                     delete f[i[g]];
3904:                   }
3905:                 }
3906:               }
3907:               return j.call(n, o, f);
3908:             };
3909:             e = p({ "": e }, "");
3910:           }
3911:           return e;
3912:         };
3913:       })();
3914:       try {
3915:         switch (mode) {
3916:           case "parse":
3917:             if (
3918:               /^[\],:{}\s]*$/.test(
3919:                 string
3920:                   .replace(/\\["\\\/bfnrtu]/g, "@")
3921:                   .replace(
3922:                     /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
3923:                     "]",
3924:                   )
3925:                   .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
3926:               )
3927:             ) {
3928:               return jsonParse(string);
3929:             } else {
3930:               alert("JSON validation error\n" + string.substring(0, 1000));
3931:             }
3932:             break;
3933:           case "stringify":
3934:             return JSON.stringify(string, undefined, prettyJSON);
3935:             break;
3936:         }
3937:       } catch (e) {
3938:         alert(e.toString());
3939:       }
3940:     }
3941:     $.locale = isAE() ? app.isoLanguage : $.locale;
3942:     var locale = $.locale.split("_")[0];
3943:     ("fr" == locale && "de" == locale && "es" == locale) || (locale = "en");
3944:     var strTempCode = localize({
3945:       de:
3946:         "Du hast eine tempor\xe4re Seriennummer eingegeben, die gegen eine permanente Lizenz eingetauscht werden muss.\n\nSobald Du eine permanente Lizenz erhalten hast, kannst Du sie verwenden um" +
3947:         strScriptName +
3948:         " zu registrieren.  Der Austausch ist schnell und unkompliziert, gehe einfach zu:\n\n" +
3949:         exchangeUrl +
3950:         "\n\nWillst Du jetzt dorthin gehen?",
3951:       en:
3952:         "You entered a temporary serial number that needs to be exchanged for a permanent license.\n\nOnce you obtain your permanent license you can use it to register " +
3953:         strScriptName +
3954:         ".  It is quick and easy to exchange it, simply go to:\n\n" +
3955:         exchangeUrl +
3956:         "\n\nWould you like to go there now?",
3957:       es:
3958:         "Ha introducido un n\xfamero de serie provisional que necesita ser sustituido por una licencia permanente.\n\nUna vez obtenga una licencia permamente puede usarla para registrar " +
3959:         strScriptName +
3960:         ". Reemplazarla es r\xe1pido y sencillo, simplemente vaya a:\n\n" +
3961:         exchangeUrl +
3962:         "\n\n\xbfQuiere ir all\xed ahora?",
3963:       fr:
3964:         "Vous avez entr\xe9 un num\xe9ro de s\xe9rie temporaire devant \xeatre \xe9chang\xe9 contre une licence permanente.\n\nUne fois votre licence permanente acquise, vous pouvez l\'utiliser pour vous enregistrer " +
3965:         strScriptName +
3966:         ".  Le changement est rapide et facile,  allez simplement \xe0:\n\n" +
3967:         exchangeUrl +
3968:         "\n\nVoulez-vous y aller maintenant?",
3969:     });
3970:     var strExpiredAlert = localize({
3971:       de:
3972:         "Die Testversion ist leider abgelaufen.\nDu kannst unter " +
3973:         strTrialUrl +
3974:         " eine Lizenz erwerben.\n\nM\xf6chtest Du jetzt dorthin gehen?",
3975:       en:
3976:         "Sorry, this trial version has expired. \nYou can purchase a license at " +
3977:         strTrialUrl +
3978:         "\n\nWould you like to go there now?",
3979:       es:
3980:         "Lo siento, esta versi\xf3n de prueba ha expirado.\nPuede obtener una licencia en" +
3981:         strTrialUrl +
3982:         "\n\n\xbfQuiere ir all\xed ahora?",
3983:       fr:
3984:         "D\xe9sol\xe9, la p\xe9riode d\'essai a expir\xe9.\nPour acheter une licence, veuillez vous rendre sur la page " +
3985:         strTrialUrl +
3986:         "\n\nVoulez-vous ouvrir cette page maintenant ?",
3987:     });
3988:     var strBetaExpiredAlert = localize({
3989:       de: "Die Betaversion ist leider abgelaufen",
3990:       en: "Sorry, this beta version has expired",
3991:       es: "Lo siento est\xe1 versi\xf3n beta ha expirado",
3992:       fr: "D\xe9sol\xe9, la p\xe9riode beta a expir\xe9",
3993:     });
3994:     var strBetaCodeAlert = localize({
3995:       de:
3996:         "Beta Lizenzcode erkannt f\xfcr " +
3997:         strScriptName +
3998:         "\nBeta Lizenzen k\xf6nnen nur f\xfcr Betaversionen verwendet werden. Bitte verwende eine normale Lizenz f\xfcr diese Version.",
3999:       en:
4000:         "Beta license code detected for " +
4001:         strScriptName +
4002:         "\nBeta license codes can only be used on beta versions, please obtain a normal license to use this version.",
4003:       es:
4004:         "Licencia beta detectada para " +
4005:         strScriptName +
4006:         "\nLas licencias beta s\xf3lo pueden ser usadas con versiones beta, por favor obtenga una licencia normal para usar esta versi\xf3n.",
4007:       fr:
4008:         "Licence beta d\xe9tect\xe9e pour " +
4009:         strScriptName +
4010:         "\nLes codes pour licence beta ne peuvent \xeatre utilis\xe9s que pour les versions beta, merci de demander une licence r\xe9guli\xe8re pour utiliser cette version.",
4011:     });
4012:     var strBetaLicReq = localize({
4013:       de: "F\xfcr diese Betaversion wird eine Lizenz ben\xf6tigt.\nBitte kontaktiere den Autor f\xfcr eine Betatester-Lizenz.",
4014:       en: "A license is required to run this beta version\nPlease contact the author for a beta testing license.",
4015:       es: "Es necesaria una licencia para utilizar esta versi\xf3n beta.\nPor favor, p\xf3ngase en contacto con el autor para obtener una licencia beta.",
4016:       fr: "Une licence est requise pour ex\xe9cuter cette version beta\nMerci de contacter l\'auteur pour une licence beta de test.",
4017:     });
4018:     var strUsers = localize({
4019:       de: "f\xfcr %u Nutzer",
4020:       en: "for %u user",
4021:       es: "para %u usuario",
4022:       fr: "pour %u utilisateur",
4023:     });
4024:     var strRegSuccess = localize({
4025:       de: "Registrierung erfolgreich " + strUsers,
4026:       en: "Registration successful " + strUsers,
4027:       es: "Registro completado " + strUsers,
4028:       fr: "Enregistrement r\xe9ussi " + strUsers,
4029:     });
4030:     var strRegSuccess1 = localize({
4031:       de: "Danke f\xfcr den Kauf von " + strScriptName,
4032:       en: "Thank you for purchasing " + strScriptName,
4033:       es: "Gracias por comprar " + strScriptName,
4034:       fr: "Merci d\'avoir achet\xe9 " + strScriptName,
4035:     });
4036:     var strInvalidCode = localize({
4037:       de: "Entschuldigung, der Lizenzcode ist nicht g\xfcltig.",
4038:       en: "Sorry, the license code is not valid",
4039:       es: "Lo siento, la licencia no es v\xe1lida",
4040:       fr: "D\xe9sol\xe9, ce num\xe9ro de licence n\'est pas valide.",
4041:     });
4042:     var strFirewall = localize({
4043:       de: "Eine Firewall oder ein Antivirus-Programm blockiert den Lizenz-Prozess. Bitte deaktiviere das Antivirus-Programm oder konfiguriere das System so, dass die Lizenz verifiziert werden kann.",
4044:       en: "A firewall or virus protection software is blocking the licensing process.  Please disable this or configure it to allow this process so that the license can be verified.",
4045:       es: 'Un software de "firewall" o de protecci\xf3n antivirus est\xe1 bloqueando el proceso de concesi\xf3n de licencias. Desactivela o configurela para permitir este proceso para que la licencia puede ser verificada.',
4046:       fr: "Un logiciel pare-feu ou un logiciel antivirus bloque le processus de v\xe9rification de licence. Veuillez le d\xe9sactiver ou le configurer pour permettre \xe0 ce processus de v\xe9rifier la licence.",
4047:     });
4048:     var strContactSupport = localize({
4049:       de: "Wenn Du Hilfe ben\xf6tigst, kontaktiere bitte " + supportEmail,
4050:       en: "If you require assistance please contact " + supportEmail,
4051:       es: "Si necesita ayuda, por favor contacte " + supportEmail,
4052:       fr: "Si vous avez besoin d\'aide, merci de contacter " + supportEmail,
4053:     });
4054:     var strCorruptedCode = localize({
4055:       de:
4056:         "Entschuldigung, irgendetwas ist mit dem " +
4057:         strScriptName +
4058:         " Lizenzcode passiert. Bitte gebe ihn erneut ein.\n\n" +
4059:         strContactSupport,
4060:       en:
4061:         "Sorry, something must have happened to the " +
4062:         strScriptName +
4063:         " license code.  Please re-enter it at the prompt.\n" +
4064:         strContactSupport,
4065:       es:
4066:         "Lo siento, algo ha ocurrido con la licencia de " +
4067:         strScriptName +
4068:         ". Por favor, vuelva a introducirla en la casilla.\n" +
4069:         strContactSupport,
4070:       fr:
4071:         "D\xe9sol\xe9, il y a eu un probl\xe8me avec le num\xe9ro de licence pour " +
4072:         strScriptName +
4073:         ". Merci de bien vouloir le saisir \xe0 nouveau.n\n" +
4074:         strContactSupport,
4075:     });
4076:     var strTrialThanks = localize({
4077:       de: "Danke, dass Du " + strScriptName + " ausprobierst!",
4078:       en: "Thanks for trying " + strScriptName + "!",
4079:       es: "\xa1Gracias por probar " + strScriptName + "!",
4080:       fr: "Merci d\'avoir essay\xe9 " + strScriptName + "!",
4081:     });
4082:     var strTrialTxt = localize({
4083:       de: "Testversion - noch %E Tage g\xfcltig",
4084:       en: "Trial version - %E days left",
4085:       es: "Versi\xf3n de prueba - faltan %E d\xedas",
4086:       fr: "Version d\'\xe9valuation - %E jour(s) restant",
4087:     });
4088:     var strTrialTxt2 = localize({
4089:       de: "%E Programmstarts \xfcbrig f\xfcr die Testversion",
4090:       en: "%E launches left in the trial",
4091:       es: "%E usos restantes de la versi\xf3n de prueba",
4092:       fr: "Il vous reste %E essais",
4093:     });
4094:     var strTrialWelcomeHeader = localize({
4095:       de: "Willkommen bei " + strScriptName,
4096:       en: "Welcome to " + strScriptName,
4097:       es: "Bienvenido a " + strScriptName,
4098:       fr: "Bienvenue sur " + strScriptName,
4099:     });
4100:     var strOK = localize({ de: "OK", en: "OK", es: "OK", fr: "OK" });
4101:     var strCancel = localize({
4102:       de: "Abbrechen",
4103:       en: "Cancel",
4104:       es: "Cancelar",
4105:       fr: "Annuler",
4106:     });
4107:     var strGetSupport = localize({
4108:       de: "Support zu erhalten",
4109:       en: "Get support",
4110:       es: "Obtener apoyo",
4111:       fr: "Contacter le support client",
4112:     });
4113:     var strRetrieveLic = localize({
4114:       de: "%t vergessen?",
4115:       en: "Retrieve %t",
4116:       es: "Recuperar %t",
4117:       fr: "Retrouver votre %t",
4118:     });
4119:     var strBuyLic = localize({
4120:       de: "%t Kaufen",
4121:       en: "Buy %t",
4122:       es: "Compra %t",
4123:       fr: "Acheter une %t",
4124:     });
4125:     var strLicense = localize({
4126:       de: "Lizenz",
4127:       en: "License",
4128:       es: "licencia",
4129:       fr: "Licence",
4130:     });
4131:     var strDownloads = localize({
4132:       de: "Download",
4133:       en: "Download",
4134:       es: "Descarga",
4135:       fr: "T\xe9l\xe9chargement",
4136:     });
4137:     var strPpcNotSupported = localize({
4138:       de: "PowerPC (PPC) Prozessoren werden leider nicht unterst\xfctzt. Bitte kontaktiere den Support f\xfcr weitere Informationen.",
4139:       en: "Sorry, PowerPC (PPC) processors are not supported, please contact support for further assistance.",
4140:       es: "Lo siendto, los procesadores PowerPC (PPC) no est\xe1n soportados, por favor contacte con soporte para m\xe1s informaci\xf3n.",
4141:       fr: "D\xe9sol\xe9, les processeurs PowerPC (PPC) ne sont pas support\xe9s, veuillez contacter le service client\xe8le pour plus de d\xe9tails.",
4142:     });
4143:     var strAllowScriptsPrefsSection =
4144:       parseFloat(app.version) < 16.1
4145:         ? localize({
4146:             de: "Allgemein",
4147:             en: "General",
4148:             es: "General",
4149:             fr: "G\xe9n\xe9ral",
4150:           })
4151:         : localize({
4152:             de: "Skripterstellung und Expression",
4153:             en: "Scripting & Expressions",
4154:             es: "Escripts y expresi\xf3nes",
4155:             fr: "Scripts et expressions",
4156:           });
4157:     var strErrScriptAccess = localize({
4158:       de:
4159:         strScriptName +
4160:         ' ben\xf6tigt die Erlaubnis Dateien zu schreiben\n Gehe in Voreinstellungen von After Effects in die Rubrik "' +
4161:         strAllowScriptsPrefsSection +
4162:         '" und aktiviere die Option "Skripten k\xf6nnen Dateien schreiben und haben Netzwerkzugang".',
4163:       en:
4164:         strScriptName +
4165:         ' requires access to write files\nGo to the "' +
4166:         strAllowScriptsPrefsSection +
4167:         '" panel of the application preferences and make sure "Allow Scripts to Write Files and Access Network" is checked.',
4168:       es:
4169:         strScriptName +
4170:         ' necesita poder escribir archivos\nVaya al panel "' +
4171:         strAllowScriptsPrefsSection +
4172:         '" de las Preferencias y aseg\xfarese de que "Permitir que los scripts puedan escribir archivos y acceder a la red" est\xe1 marcado.\n',
4173:       fr:
4174:         strScriptName +
4175:         " n\xe9cessite les droits d\'\xe9criture de fichiers\nAllez dans le panneau \"" +
4176:         strAllowScriptsPrefsSection +
4177:         '" des pr\xe9f\xe9rences de l\'application et cochez \n"Autoriser les scripts \xe0 \xe9crire des fichiers et \xe0 acc\xe9der au r\xe9seau"',
4178:     });
4179:     var strUpdateLicenseHeader = localize({
4180:       de: strScriptName + " Lizenz-Update ben\xf6tigt",
4181:       en: strScriptName + " License Update Required",
4182:       es: strScriptName + " necesita actualizar la licencia",
4183:       fr: "La licence de " + strScriptName + " doit \xeatre mise \xe0 jour",
4184:     });
4185:     var strLicenseDownloadOptions = localize({
4186:       de: 'Alle Deine %t findest Du unter "My Downloads & Licenses" in Deinem aescripts.com Benutzer-Account, oder \xfcber unsere Manager-App.',
4187:       en: 'All your %t are in the "My Downloads & Licenses" section of your aescripts.com user account, or via our Manager App.',
4188:       es: 'Todas sus %t est\xe1n en la secci\xf3n "My Downloads & Licenses" de su cuenta de usuario en aescripts.com, o a trav\xe9s de nuestra App Manager.',
4189:       fr: 'Toutes vos %t se trouvent dans la section "My Downloads & Licenses" de votre compte utilisateur sur aescripts.com, ou via notre App Manager.',
4190:     });
4191:     var strMyDownloads = localize({
4192:       de: "Gehen Sie zu My Downloads & Licenses",
4193:       en: "Go to My Downloads & Licenses",
4194:       es: "Ir a My Downloads & Licenses",
4195:       fr: "Aller \xe0 My Downloads & Licenses",
4196:     });
4197:     var strDownloadManager = localize({
4198:       de: "Laden Sie die Manager-App herunter",
4199:       en: "Download Manager App",
4200:       es: "Descargar App Manager",
4201:       fr: "T\xe9l\xe9charger App Manager",
4202:     });
4203:     var strOldLicenseFormat = localize({
4204:       de: "Die Lizenz sollte so aussehen:\n\nFirstname**Lastname**111111111SUL",
4205:       en: "License should look like this:\n\nFirstname**Lastname**111111111SUL",
4206:       es: "La licencia debe tener este aspecto:\n\nNombre**Apellido**111111111SUL",
4207:       fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPr\xe9nom**Nom**111111111SUL",
4208:     });
4209:     var strNewLicenseFormat = localize({
4210:       de: "Die Lizenz sollte so aussehen:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
4211:       en: "License should look like this:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
4212:       es: "La licencia debe tener este aspecto:\n\nPRODUCTID*NOMBRE*APELLIDO*1111111SUL1",
4213:       fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPRODUCTID*PRENOM*NOM*1111111SUL1",
4214:     });
4215:     var strRegistration = localize({
4216:       de: "Registriert f\xfcr: ",
4217:       en: "Registered to: ",
4218:       es: "Registrado a: ",
4219:       fr: "Enregistr\xe9 pour: ",
4220:     });
4221:     var strUnknownError = localize({
4222:       de:
4223:         "Es gab einen unerwarteten Fehler\nBitte \xf6ffne hier ein Support-Ticket:\n" +
4224:         supportEmail +
4225:         "\n\nund f\xfcge einen Screenshot der Fehlermeldung bei\n\n",
4226:       en:
4227:         "There was an unexpected error\nPlease please open a support ticket here:\n" +
4228:         supportEmail +
4229:         "\n\nand submit screenshot of this error message\n\n",
4230:       es:
4231:         "Se ha producido un error desconocido\nPor favor habra un ticket de soporte aqui:\n" +
4232:         supportEmail +
4233:         "\n\ny presente una captura de pantalla con este mensaje de error\n\n",
4234:       fr:
4235:         "Une erreur vient de se produire \nVeuillez ouvrir un ticket de service client \xe0 cette adresse:\n" +
4236:         supportEmail +
4237:         "\n\net n\'oubliez pas d\'y joindre une capture d\'\xe9cran de ce message\n\n",
4238:     });
4239:     var strWrongProduct = localize({
4240:       de: "Dieser Lizenz-Code ist f\xfcr ein anderes Produkt, bitte stelle sicher, dass du den richtigen Lizenzcode eingibst\n\n",
4241:       en: "This license code is for a different product, please double check that you are entering the correct license\n\n",
4242:       es: "Este c\xf3digo de licencia es para un producto diferente, por favor, comprobar que esta introduciendo la licencia correcta\n\n",
4243:       fr: "Vous venez d\'entrer la cl\xe9 de licence d\'un autre produit, assurez-vous d\'utiliser la bonne cl\xe9 de licence\n\n",
4244:     });
4245:     var strNewVersionAvailableHdr = localize({
4246:       de: strScriptName + " Update verf\xfcgbar",
4247:       en: strScriptName + " Update Available",
4248:       es: strScriptName + " Actualizaci\xf3n disponible",
4249:       fr: strScriptName + " Mise \xe0 jour disponible",
4250:     });
4251:     var strNewVersionAvailable = localize({
4252:       de:
4253:         "Eine neuere Version von " + strScriptName + " ist verf\xfcgbar: v%\n",
4254:       en: "A newer version of " + strScriptName + " is available: %v\n",
4255:       es:
4256:         "Una versi\xf3n nueva de " +
4257:         strScriptName +
4258:         " est\xe1 disponible: v%\n",
4259:       fr: "Une version plus de " + strScriptName + " est disponible: v%\n",
4260:     });
4261:     var strCurrentVersion = localize({
4262:       de: "Votre version install\xe9e est: v%",
4263:       en: "Your installed version is: %v",
4264:       es: "Su versi\xf3n instalada es: v%",
4265:       fr: "Votre version install\xe9e est: v%",
4266:     });
4267:     var strDownload = localize({
4268:       de: "Download",
4269:       en: "Download",
4270:       es: "Descargar",
4271:       fr: "T\xe9l\xe9charger",
4272:     });
4273:     var strVersion = localize({
4274:       de: "Version",
4275:       en: "version",
4276:       es: "versi\xf3n",
4277:       fr: "version",
4278:     });
4279:     var strSkipVersion = localize({
4280:       de: "Diese Version \xdcberspringen",
4281:       en: "Skip this Version",
4282:       es: "Salta esta versi\xf3n",
4283:       fr: "Ignorer cette version",
4284:     });
4285:     var strRemindMeLater = localize({
4286:       de: "Erinnere mich sp\xe4ter",
4287:       en: "Remind Me Later",
4288:       es: "Recu\xe9rdame m\xe1s tarde",
4289:       fr: "Rappelle-moi plus tard",
4290:     });
4291:     var strNewestVersionAvailable = localize({
4292:       de: "Neueste verf\xfcgbare Version",
4293:       en: "Newest available version",
4294:       es: "Versi\xf3n mas nueva disponible",
4295:       fr: "Nouvelle version disponible",
4296:     });
4297:     var strVersionRev = localize({
4298:       de: "v%a%b - %c",
4299:       en: "v%a%b - %c",
4300:       es: "v%a%b - %c",
4301:       fr: "v%a%b - %c",
4302:     });
4303:     var strDeactivate = localize({
4304:       de: "Lizenz Deaktivieren",
4305:       en: "Deactivate License",
4306:       es: "Desactivar Licencia",
4307:       fr: "D\xe9sactiver la licence",
4308:     });
4309:     var strVersionCheck = localize({
4310:       de: "Automatisch nach Aktualisierungen suchen",
4311:       en: "Check for updates automatically",
4312:       es: "Revisar actualizaciones automaticamente",
4313:       fr: "V\xe9rifier les mises \xe0 jour automatiquement",
4314:     });
4315:     var strCheckNow = localize({
4316:       de: "Jetzt nach Update suchenn",
4317:       en: "Check for update now",
4318:       es: "Buscar actualizaci\xf3n ahora",
4319:       fr: "V\xe9rifier les mise \xe0 jour maintenant",
4320:     });
4321:     var strUpdateCheckError = localize({
4322:       de: "Bei der Suche nach Updates ist ein Fehler aufgetreten.\nBitte vergewissern Sie sich, dass Sie \xfcber eine g\xfcltige Internetverbindung verf\xfcgen und diese nicht durch Firewalls blockiert wird.",
4323:       en: "There was an error when checking for updates.\nPlease verify that you have a valid internet connection and that it is not blocked by any firewalls.",
4324:       es: "Hubo un error en la comprobaci\xf3n de actualizaciones.\nPor favor compruebe que tiene una conexi\xf3n a Internet v\xe1lida y que no est\xe9 bloqueada por un cortafuegos.",
4325:       fr: "Une erreur s\'est produite lors de la recherche de mises \xe0 jour.\nV\xe9rifiez que votre connexion Internet est valide et qu\'elle n\'est bloqu\xe9e par aucun pare-feu.",
4326:     });
4327:     var strUpToDate = localize({
4328:       de:
4329:         "Sie sind auf dem neuesten Stand! \n" +
4330:         strScriptName +
4331:         " " +
4332:         strVersion +
4333:         " " +
4334:         strScriptVersion +
4335:         " ist derzeit die neueste Version verf\xfcgbar.",
4336:       en:
4337:         "You are up to date!\n" +
4338:         strScriptName +
4339:         " " +
4340:         strVersion +
4341:         " " +
4342:         strScriptVersion +
4343:         " is currently the latest version available.",
4344:       es:
4345:         "\xa1Est\xe1 actualizado! \n" +
4346:         strScriptName +
4347:         " " +
4348:         strVersion +
4349:         " " +
4350:         strScriptVersion +
4351:         " es actualmente la \xfaltima versi\xf3n disponible.",
4352:       fr:
4353:         "Vous \xeates \xe0 jour!\n" +
4354:         strScriptName +
4355:         " " +
4356:         strVersion +
4357:         " " +
4358:         strScriptVersion +
4359:         " est actuellement la derni\xe8re version disponible.",
4360:     });
4361:     var strInvalidLicense = localize({
4362:       de: "Ung\xfcltige Lizenz",
4363:       en: "Invalid license",
4364:       es: "La licencia no es v\xe1lida",
4365:       fr: "Licence non valide",
4366:     });
4367:     var strLicenseRemoved = localize({
4368:       de: "Lizenz entfernt",
4369:       en: "License removed",
4370:       es: "Licencia eliminada",
4371:       fr: "Licence supprim\xe9e",
4372:     });
4373:     var strLicense = localize({
4374:       de: "Lizenz",
4375:       en: "License",
4376:       es: "Licencia",
4377:       fr: "Licence",
4378:     });
4379:     var strBTA = localize({
4380:       de: "Beta-Lizenz",
4381:       en: "Beta License",
4382:       es: "Licencia Beta",
4383:       fr: "Licence Beta",
4384:     });
4385:     var strEDU = localize({
4386:       de: "EDU-Lizenz",
4387:       en: "Educational License",
4388:       es: "Licencia Educacional",
4389:       fr: "T\xe9l\xe9charger",
4390:     });
4391:     var strFLT = localize({
4392:       de: "Floating-Lizenz",
4393:       en: "Floating License",
4394:       es: "Licencia flotante",
4395:       fr: "Licence flottante",
4396:     });
4397:     var strUNKNOWN = localize({
4398:       de: "License mit unbekanntem Typ",
4399:       en: "License of unknown type",
4400:       es: "Licencia de tipo desconocido",
4401:       fr: "Licence inconnue",
4402:     });
4403:     var strTrialExpired = localize({
4404:       de: "Testversion abgelaufen",
4405:       en: "MONTER GROUP\xa9",
4406:       es: "Termino de prueba expirado",
4407:       fr: "\xc9valuation termin\xe9e",
4408:     });
4409:     var licErrors = {
4410:       de: {
4411:         "-1": { detail: "", title: "Ung\xfcltige Lizenz (-1)" },
4412:         "-10": {
4413:           detail: "Auf dem Lizenzserver sind alle Lizenzen bereits vergeben",
4414:           title: "Keine freien Slots (-10)",
4415:         },
4416:         "-100": {
4417:           detail:
4418:             "Eine Lizenz kann \xfcber den Button \'Lizenz Kaufen\' erworben werden",
4419:           title: "Testversion abgelaufen",
4420:         },
4421:         "-101": {
4422:           detail:
4423:             "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
4424:           title: "Zugriff blockiert (-101)",
4425:         },
4426:         "-102": {
4427:           detail:
4428:             "Bitte kontaktieren Sie den Support und senden Sie einen Screenshot dieses Fehlers. " +
4429:             supportEmail,
4430:           title: "Kein Ergebnis (-102)",
4431:         },
4432:         "-103": {
4433:           detail: "Could not find the number of trial days",
4434:           title: "Anzahl der Test-Tage nicht festgelegt (-103)",
4435:         },
4436:         "-104": {
4437:           detail: "Die Lizenz ist nicht f\xfcr dieses Produkt",
4438:           title: "Ung\xfcltige Lizenz (-104)",
4439:         },
4440:         "-105": {
4441:           detail:
4442:             "Eine Beta-Lizenz kann f\xfcr diese Vollversion nicht verwendet werden",
4443:           title: "Beta-Lizenz nicht verwendbar (-105)",
4444:         },
4445:         "-106": {
4446:           detail:
4447:             "Dieses Produkt beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
4448:           title: "Bitte Lizenz installieren (-106)",
4449:         },
4450:         "-107": {
4451:           detail:
4452:             "Diese Beta beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
4453:           title: "Bitte Lizenz installieren (-107)",
4454:         },
4455:         "-108": {
4456:           detail:
4457:             "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
4458:           title: "Nicht in der Lage, auf den Home-Ordner zuzugreifen (-108)",
4459:         },
4460:         "-11": {
4461:           detail: "Die Lizenz kann auf dem Lizenzserver nicht gefunden werden",
4462:           title: "Unbekannte Lizenz (-11)",
4463:         },
4464:         "-12": {
4465:           detail:
4466:             "Die Lizenz konnte nicht deaktiviert werden, da sie dem Server unbekannt ist",
4467:           title: "Unbekannte Lizenz (-12)",
4468:         },
4469:         "-13": {
4470:           detail:
4471:             "Die IP-Adresse dieses Rechners ist \xfcber eine Blacklist auf dem Lizenzserver gesperrt",
4472:           title: "Klient ist auf Blacklist (-13)",
4473:         },
4474:         "-14": {
4475:           detail: "Konnte keine Netzwerkkarte finden",
4476:           title: "Keine Netzwerkkarte (-14)",
4477:         },
4478:         "-2": { detail: "", title: "Ung\xfcltige Lizenz (-2)" },
4479:         "-20": {
4480:           detail: "Lizenzlaufzeit beginnt am ",
4481:           title: "Lizenzlaufzeit hat noch nicht begonnen (-20)",
4482:         },
4483:         "-21": {
4484:           detail: "Lizenzlaufzeit endete am ",
4485:           title: "Lizenzlaufzeit ist abgelaufen (-21)",
4486:         },
4487:         "-22": {
4488:           detail:
4489:             "Weitere Informationen zum Einrichten und Lizenzieren von Client-Computern finden Sie in den Anweisungen zum Server.",
4490:           title:
4491:             "Floating-Lizenzen k\xf6nnen nur mit dem Floating License Server verwendet werden (-22)",
4492:         },
4493:         "-3": { detail: "", title: "Lizenzdatei nicht gefunden (-3)" },
4494:         "-4": { detail: "", title: "Lizenzdatei besch\xe4digt (-4)" },
4495:         "-5": { detail: "", title: "Generischer Fehler (-5)" },
4496:         "-6": { detail: "", title: "Ung\xfcltiger Produktname (-6)" },
4497:         "-7": { detail: "", title: "Testversion (-7)" },
4498:         "-8": { detail: "", title: "Ung\xfcltige Lizenz (-8)" },
4499:         "-9": {
4500:           detail:
4501:             "Bitte stellen Sie sicher, dass der Lizenzserver ordnungsgem\xe4\xdf arbeitet",
4502:           title: "Kann Server nicht kontaktieren (-9)",
4503:         },
4504:         "-99": { detail: "", title: "Unbekannter Fehler (-99)" },
4505:         unknown: { detail: "", title: "Unbekannter Fehler (0)" },
4506:       },
4507:       en: {
4508:         "-1": { detail: "", title: "Invalid license (-1)" },
4509:         "-10": {
4510:           detail: "There are no more free slots on the license server",
4511:           title: "No free slots (-10)",
4512:         },
4513:         "-100": {
4514:           detail:
4515:             "You can purchase a license by clicking the button \'Buy License\'",
4516:           title: "MONTER GROUP\xa9",
4517:         },
4518:         "-101": {
4519:           detail:
4520:             "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
4521:           title: "Access Blocked(-101)",
4522:         },
4523:         "-102": {
4524:           detail:
4525:             "Please contact support " +
4526:             supportEmail +
4527:             " and send a screenshot of this error.\n\n",
4528:           title: "No result code (-102)",
4529:         },
4530:         "-103": {
4531:           detail: "Could not find the number of trial days",
4532:           title: "No trial days found (-103)",
4533:         },
4534:         "-104": {
4535:           detail: "The license is not for this product",
4536:           title: "License mismatch (-104)",
4537:         },
4538:         "-105": {
4539:           detail: "A beta license cannot be used for the full version",
4540:           title: "Cannot use beta license (-105)",
4541:         },
4542:         "-106": {
4543:           detail: "This product does not offer a trial and requires a license",
4544:           title: "Please install a license (-106)",
4545:         },
4546:         "-107": {
4547:           detail:
4548:             "The beta version does not offer a trial and requires a license",
4549:           title: "Please install a license (-107)",
4550:         },
4551:         "-108": {
4552:           detail:
4553:             "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
4554:           title: "Not able to access home folder (-108)",
4555:         },
4556:         "-11": {
4557:           detail: "The license cannot be found on the license server",
4558:           title: "Unknown license (-11)",
4559:         },
4560:         "-12": {
4561:           detail:
4562:             "The license you are trying to deactivate is not found on the license server",
4563:           title: "Unknown license (-12)",
4564:         },
4565:         "-13": {
4566:           detail: "Your client IP is blacklisted on the license server",
4567:           title: "Client blacklisted (-13)",
4568:         },
4569:         "-14": {
4570:           detail: "Could not find a network adapter",
4571:           title: "No network adapter (-14)",
4572:         },
4573:         "-2": { detail: "", title: "Invalid license (-2)" },
4574:         "-20": {
4575:           detail: "License period starts on ",
4576:           title: "License period has not started yet (-20)",
4577:         },
4578:         "-21": {
4579:           detail: "License period ended on ",
4580:           title: "License period has ended (-21)",
4581:         },
4582:         "-22": {
4583:           detail:
4584:             "Please refer to the server instructions on how to setup and license client machines.",
4585:           title:
4586:             "Floating licenses can only be used with the Floating License Server (-22)",
4587:         },
4588:         "-3": { detail: "", title: "License file not found (-3)" },
4589:         "-4": { detail: "", title: "License file corrupted (-4)" },
4590:         "-5": { detail: "", title: "Generic error (-5)" },
4591:         "-6": { detail: "", title: "Invalid product name (-6)" },
4592:         "-7": { detail: "", title: "Trial (-7)" },
4593:         "-8": { detail: "", title: "Invalid license (-8)" },
4594:         "-9": {
4595:           detail: "Please make sure the license server is running properly",
4596:           title: "Cannot connect to server (-9)",
4597:         },
4598:         "-99": { detail: "", title: "Unknown error (-99)" },
4599:         unknown: { detail: "", title: "Unknown error (0)" },
4600:       },
4601:       es: {
4602:         "-1": { detail: "", title: "La licencia no es v\xe1lida (-1)" },
4603:         "-10": {
4604:           detail: "No hay m\xe1s espacios libres en el servidor de licencias",
4605:           title: "No hay espacios libres (-10)",
4606:         },
4607:         "-100": {
4608:           detail:
4609:             "Puede adquirir una licencia haciendo clic en el bot\xf3n \'Comprar Licencia\'",
4610:           title: "Esta versi\xf3n de prueba se ha expirado",
4611:         },
4612:         "-101": {
4613:           detail:
4614:             "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
4615:           title: "Acceso bloqueado (-101)",
4616:         },
4617:         "-102": {
4618:           detail:
4619:             "Por favor, p\xf3ngase en contacto con soporte y env\xede una captura de pantalla de este error. " +
4620:             supportEmail,
4621:           title: "No hay c\xf3digo de resultado (-102)",
4622:         },
4623:         "-103": {
4624:           detail: "No se pudo encontrar el n\xfamero de d\xedas de prueba",
4625:           title: "No se encontraron d\xedas de prueba (-103)",
4626:         },
4627:         "-104": {
4628:           detail: "La licencia no es para este producto",
4629:           title: "La licencia no es la correcta (-104)",
4630:         },
4631:         "-105": {
4632:           detail:
4633:             "No se puede utilizar una licencia \'beta\' con esta versi\xf3n",
4634:           title: "No se puede usar licencia beta (-105)",
4635:         },
4636:         "-106": {
4637:           detail:
4638:             "Este producto no ofrece una version de prueba y requiere una licencia",
4639:           title: "Por favor, instale una licencia (-106)",
4640:         },
4641:         "-107": {
4642:           detail:
4643:             "La versi\xf3n beta no ofrece una versi\xf3n de prueba y requiere una licencia",
4644:           title: "Por favor, instale una licencia (-107)",
4645:         },
4646:         "-108": {
4647:           detail:
4648:             "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
4649:           title: "No se puede acceder a la carpeta de inicio (-108)",
4650:         },
4651:         "-11": {
4652:           detail:
4653:             "No se puede encontrar esta licencia en el servidor de licencias",
4654:           title: "Licencia desconocida (-11)",
4655:         },
4656:         "-12": {
4657:           detail:
4658:             "La licencia que est\xe1 intentando de desactivar no se encuentra en el servidor de licencias",
4659:           title: "Licencia desconocida (-12)",
4660:         },
4661:         "-13": {
4662:           detail: "Su IP est\xe1 en la lista negra del servidor de licencias",
4663:           title: "IP en la lista negra (-13)",
4664:         },
4665:         "-14": {
4666:           detail: "No se pudo encontrar un adaptador de red",
4667:           title: "No hay adaptador de red (-14)",
4668:         },
4669:         "-2": { detail: "", title: "La licencia no es v\xe1lida (-2)" },
4670:         "-20": {
4671:           detail: "El per\xedodo de licencia comienza en ",
4672:           title: "El periodo de licencia no ha comenzado (-20)",
4673:         },
4674:         "-21": {
4675:           detail: "El per\xedodo de licencia termin\xf3 en ",
4676:           title: "El per\xedodo de licencia ha terminado (-21)",
4677:         },
4678:         "-22": {
4679:           detail:
4680:             "Consulte las instrucciones del servidor sobre c\xf3mo configurar y licenciar las m\xe1quinas cliente.",
4681:           title:
4682:             "Las licencias flotantes solo se pueden utilizar con el Servidor de licencias flotantes (-22)",
4683:         },
4684:         "-3": {
4685:           detail: "",
4686:           title: "No se encontr\xf3 el archivo de licencia (-3)",
4687:         },
4688:         "-4": {
4689:           detail: "",
4690:           title: "El archivo de licencia esta da\xf1ado (-4)",
4691:         },
4692:         "-5": { detail: "", title: "Error generico (-5)" },
4693:         "-6": {
4694:           detail: "",
4695:           title: "El nombre de el producto no v\xe1lido (-6)",
4696:         },
4697:         "-7": { detail: "", title: "Versi\xf3n de prueba (-7)" },
4698:         "-8": { detail: "", title: "La licencia no es v\xe1lida (-8)" },
4699:         "-9": {
4700:           detail:
4701:             "Aseg\xfarese de que el servidor de licencias est\xe1 funcionando correctamente",
4702:           title: "No es posible conectar con el servidor (-9)",
4703:         },
4704:         "-99": { detail: "", title: "Error desconocido (-99)" },
4705:         unknown: { detail: "", title: "Error desconocido (0)" },
4706:       },
4707:       fr: {
4708:         "-1": { detail: "", title: "Licence non valide (-1)" },
4709:         "-10": {
4710:           detail: "Il n\'y a plus de place sur le serveur de licence",
4711:           title: "Plus de place (-10)",
4712:         },
4713:         "-100": {
4714:           detail:
4715:             "Vous pouvez acqu\xe9rir une licence en cliquant sur le bouton \'Acheter une Licence\' ci-dessous",
4716:           title: "P\xe9riode d\'\xe9valuation expir\xe9e",
4717:         },
4718:         "-101": {
4719:           detail:
4720:             "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
4721:           title: "Acc\xe8s bloqu\xe9 (-101)",
4722:         },
4723:         "-102": {
4724:           detail:
4725:             "S\'il vous pla\xeet contacter le support et envoyer une capture d\'\xe9cran de cette erreur. " +
4726:             supportEmail,
4727:           title: "Pas de code de r\xe9sultat (-102)",
4728:         },
4729:         "-103": {
4730:           detail:
4731:             "Echec d\'identification du nombre de jour de p\xe9riode d\'essai disponible",
4732:           title: "Impossible de trouver des jours d\'essai (-103)",
4733:         },
4734:         "-104": {
4735:           detail: "Cette licence n\'est pas valable pour ce produit",
4736:           title: "Mauvaise licence (-104)",
4737:         },
4738:         "-105": {
4739:           detail:
4740:             "Une licence de version Beta ne peut \xeatre utilis\xe9e pour le produit final",
4741:           title: "Licence Beta invalide (-105)",
4742:         },
4743:         "-106": {
4744:           detail:
4745:             "Ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
4746:           title: "Licence n\xe9cessaire (-106)",
4747:         },
4748:         "-107": {
4749:           detail:
4750:             "La version Beta de ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
4751:           title: "Licence n\xe9cessaire (-107)",
4752:         },
4753:         "-108": {
4754:           detail:
4755:             "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
4756:           title: "Impossible d\'acc\xe9der au dossier de d\xe9part (-108)",
4757:         },
4758:         "-11": {
4759:           detail: "La licence est introuvable sur le serveur",
4760:           title: "Licence inconnue (-11)",
4761:         },
4762:         "-12": {
4763:           detail:
4764:             "La licence que vous essayez de d\xe9sactiver est introuvable sur le serveur",
4765:           title: "Licence inconnue (-12)",
4766:         },
4767:         "-13": {
4768:           detail:
4769:             "L\'adresse ip de votre client est bannie du serveur de licence",
4770:           title: "Client sur liste noire (-13)",
4771:         },
4772:         "-14": {
4773:           detail: "Impossible de trouver une carte r\xe9seau",
4774:           title: "Pas de carte r\xe9seau (-14)",
4775:         },
4776:         "-2": { detail: "", title: "Licence non valide (-2)" },
4777:         "-20": {
4778:           detail: "La p\xe9riode de licence commence ",
4779:           title: "La p\xe9riode de licence n\'a pas encore commenc\xe9 (-20)",
4780:         },
4781:         "-21": {
4782:           detail: "La p\xe9riode de licence s\'est termin\xe9e le ",
4783:           title: "La p\xe9riode de licence est termin\xe9e (-21)",
4784:         },
4785:         "-22": {
4786:           detail:
4787:             "Veuillez vous reporter aux instructions du serveur pour savoir comment configurer et attribuer une licence aux ordinateurs clients.",
4788:           title:
4789:             "Les licences flottantes ne peuvent \xeatre utilis\xe9es qu\'avec le serveur de licences flottantes (-22)",
4790:         },
4791:         "-3": { detail: "", title: "Fichier de licence introuvable (-3)" },
4792:         "-4": { detail: "", title: "Fichier de licence corrompu (-4)" },
4793:         "-5": { detail: "", title: "Erreur g\xe9n\xe9rique (-5)" },
4794:         "-6": { detail: "", title: "Nom de produit invalide (-6)" },
4795:         "-7": { detail: "", title: "P\xe9riode d\'\xe9valuation (-7)" },
4796:         "-8": { detail: "", title: "Licence non valide (-8)" },
4797:         "-9": {
4798:           detail: "Verifiez que le serveur de licence fonctionne correctement",
4799:           title: "Impossible de se connecter au serveur (-9)",
4800:         },
4801:         "-99": { detail: "", title: "Erreur inconnue (-99)" },
4802:         unknown: { detail: "", title: "Erreur inconnue (0)" },
4803:       },
4804:     };
4805:     var prefsSectionName = vars.hasOwnProperty("legacyPrefsGroup")
4806:       ? vars.legacyPrefsGroup
4807:       : "aescripts";
4808:     var prefsName = useLegacyPrefsHeader
4809:       ? strScriptName
4810:       : strHeader + "_Registration";
4811:     var prefsVersionName = strHeader + "_Version";
4812:     var prefsLicVersion = strHeader + "_LicVersion";
4813:     var prefsVersionCheckInit = strHeader + "_VersionCheckInit";
4814:     var prefsLastVersionChecked = strHeader + "_LastVersionChecked";
4815:     var prefsLastServerVersionChecked = strHeader + "_LastServerVersionChecked";
4816:     var prefsLastTimeVersionChecked = strHeader + "_LastTimeVersionChecked";
4817:     var prefsNextTimeVersionChecked = strHeader + "_NextTimeVersionChecked";
4818:     var prefsNextTimeVersionCheckedSkipVersion =
4819:       strHeader + "_NextTimeVersionCheckedSkipVersion";
4820:     var prefsDoUpdateCheck = strHeader + "_doUpdateCheck";
4821:     haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
4822:       (doUpdateCheck = !(
4823:         "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
4824:       ));
4825:     ScriptUI.environment.keyboardState.shiftKey &&
4826:       ScriptUI.environment.keyboardState.altKey &&
4827:       !ScriptUI.environment.keyboardState.ctrlKey &&
4828:       !ScriptUI.environment.keyboardState.metaKey &&
4829:       ((doUpdateCheck = false),
4830:       saveSettings(prefsSectionName, prefsDoUpdateCheck, false),
4831:       alert("New version update checks disabled"));
4832:     saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
4833:     saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
4834:     cmdKey = -1 != $.os.indexOf("Mac") ? "cmd" : "Ctrl";
4835:     var strEnterLicenseCode = localize({
4836:       de: "Bitte gebe den Lizenzcode ein.",
4837:       en: "Please enter the license code.",
4838:       es: "Por favor, introduzca el c\xf3digo de licencia.",
4839:       fr: "Veuillez entrer votre num\xe9ro de licence.",
4840:     });
4841:     var strPasteHelp = localize({
4842:       de:
4843:         "(Wenn das Einf\xfcgen mit " +
4844:         cmdKey +
4845:         "+V nicht funktioniert, versuche Bearbeiten->Einf\xfcgen.)",
4846:       en:
4847:         "(If pasting the code with " + cmdKey + "+V doesn\'t work try " + 10 <=
4848:         parseFloat(app.version)
4849:           ? "Right-Click and Paste)"
4850:           : "Edit->Paste)",
4851:       es:
4852:         "(Si pegar la licencia usando " +
4853:           cmdKey +
4854:           "+V no funciona, pruebe " +
4855:           10 <=
4856:         parseFloat(app.version)
4857:           ? "Clic derecho y pegar)"
4858:           : "Edici\xf3n->Pegar)",
4859:       fr:
4860:         "(Si vous ne parvenez pas \xe0 coller le code avec " +
4861:           cmdKey +
4862:           "+V essayez " +
4863:           10 <=
4864:         parseFloat(app.version)
4865:           ? "Clique droit et Coller)"
4866:           : "Edition->Coller)",
4867:     });
4868:     var strTrialInstructMsg = localize({
4869:       de: 'Um die Testversion zu starten, gebe "trial" ein.',
4870:       en: "To run in trial mode type: trial",
4871:       es: "Para ejecutar el modo Trial, escriba: trial",
4872:       fr: "Pour lancer la version de d\xe9monstration, tapez : trial",
4873:     });
4874:     var strOr = localize({ de: "oder", en: "or", es: "o", fr: "ou" });
4875:     var strServerInstructMsg = localize({
4876:       de: "Aktivieren Sie eine Lizenz vom Server mit @REMOTE",
4877:       en: "Activate a license from the server with @REMOTE",
4878:       es: "Activar una licencia del servidor con @REMOTE",
4879:       fr: "Activer une licence du serveur avec @REMOTE",
4880:     });
4881:     var strServerNotRunning = localize({
4882:       de: "Der Client ist konfiguriert, aber der Floating License Server l\xe4uft nicht oder ist nicht erreichbar.",
4883:       en: "Client configured but floating license server is either not running or not accessible.",
4884:       es: "Cliente configurado pero servidor de licencias flotantes o no est\xe1 ejecutado o no es accesible.",
4885:       fr: "Client configur\xe9 mais le serveur de licence flottante est soit en cours d\'ex\xe9cution ou ne pas accessible.",
4886:     });
4887:     var prefHeader = "Initialization Fragments";
4888:     var prefSection1 = (
4889:       string_encode(
4890:         Math.floor(parseFloat(app.version))
4891:           .toString()
4892:           .charAt(
4893:             Math.max(
4894:               0,
4895:               Math.floor(parseFloat(app.version)).toString().length - 1,
4896:             ),
4897:           ) +
4898:           strScriptName.substring(
4899:             Math.max(0, strScriptName.length - 15),
4900:             strScriptName.length,
4901:           ) +
4902:           strScriptVersion,
4903:       ) *
4904:       0.457 *
4905:       privateNum
4906:     ).toString(36);
4907:     var prefSection2 = (
4908:       string_encode(
4909:         Math.floor(parseFloat(app.version))
4910:           .toString()
4911:           .charAt(
4912:             Math.max(
4913:               0,
4914:               Math.floor(parseFloat(app.version)).toString().length - 1,
4915:             ),
4916:           ) +
4917:           strScriptName.substring(
4918:             Math.max(0, strScriptName.length - 15),
4919:             strScriptName.length,
4920:           ) +
4921:           strScriptVersion,
4922:       ) *
4923:       (privateNum / 3.981)
4924:     ).toString(36);
4925:     var prefsLocation = Folder.userData.fsName + "/Aescripts/";
4926:     var prefsPrefix = "pref_";
4927:     isAE() || Folder(prefsLocation).exists || Folder(prefsLocation).create();
4928:     var sanitizedName = sanitizeProductName(strScriptName);
4929:     this.getSetting = function (e, t) {
4930:       return getSettings((e = strHeader + "_" + e), t, "settings");
4931:     };
4932:     this.readJSON = function (e) {
4933:       return readJSON(e);
4934:     };
4935:     this.writeJSON = function (e, t) {
4936:       return writeJSON(e, t);
4937:     };
4938:     this.JSONify = function (e, t, i) {
4939:       return JSONify(e, t, i);
4940:     };
4941:     this.haveSetting = function (e, t) {
4942:       return haveSettings((e = strHeader + "_" + e), t, "settings");
4943:     };
4944:     this.saveSetting = function (e, t, i) {
4945:       return saveSettings((e = strHeader + "_" + e), t, i, "settings");
4946:     };
4947:     function compareVersions(a, b) {
4948:       if (a === b) {
4949:         return 0;
4950:       }
4951:       var a_components = a.toString().split(".");
4952:       var b_components = b.toString().split(".");
4953:       if (a_components.length <= 2 && b_components.length <= 2) {
4954:         if (a > b) {
4955:           return 1;
4956:         }
4957:         if (a < b) {
4958:           return -1;
4959:         }
4960:       } else {
4961:         var len = Math.min(a_components.length, b_components.length);
4962:         for (var i = 0; i < len; i += 1) {
4963:           if (parseInt(a_components[i]) > parseInt(b_components[i])) {
4964:             return 1;
4965:           }
4966:           if (parseInt(a_components[i]) < parseInt(b_components[i])) {
4967:             return -1;
4968:           }
4969:         }
4970:         if (a_components.length > b_components.length) {
4971:           return 1;
4972:         }
4973:         if (a_components.length < b_components.length) {
4974:           return -1;
4975:         }
4976:         return 0;
4977:       }
4978:     }
4979:     function JSONify(string, mode, prettyJSON) {
4980:       if (typeof JSON !== "object") {
4981:         JSON = {};
4982:       }
4983:       (function () {
4984:         function f(n) {
4985:           return n < 10 ? "0" + n : n;
4986:         }
4987:         function this_value() {
4988:           return this.valueOf();
4989:         }
4990:         function quote(string) {
4991:           rx_escapable.lastIndex = 0;
4992:           return rx_escapable.test(string)
4993:             ? '"' +
4994:                 string.replace(rx_escapable, function (a) {
4995:                   var c = meta[a];
4996:                   return typeof c === "string"
4997:                     ? c
4998:                     : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
4999:                 }) +
5000:                 '"'
5001:             : '"' + string + '"';
5002:         }
5003:         function str(key, holder) {
5004:           var mind = gap;
5005:           var value = holder[key];
5006:           if (
5007:             value &&
5008:             typeof value === "object" &&
5009:             typeof value.toJSON === "function"
5010:           ) {
5011:             value = value.toJSON(key);
5012:           }
5013:           if (typeof rep === "function") {
5014:             value = rep.call(holder, key, value);
5015:           }
5016:           switch (typeof value) {
5017:             case "string":
5018:               return quote(value);
5019:             case "number":
5020:               return isFinite(value) ? String(value) : "null";
5021:             case "boolean":
5022:             case "null":
5023:               return String(value);
5024:             case "object":
5025:               if (!value) {
5026:                 return "null";
5027:               }
5028:               gap += indent;
5029:               partial = [];
5030:               if (Object.prototype.toString.apply(value) === "[object Array]") {
5031:                 length = value.length;
5032:                 for (var i = 0; i < length; i += 1) {
5033:                   partial[i] = str(i, value) || "null";
5034:                 }
5035:                 v =
5036:                   partial.length === 0
5037:                     ? "[]"
5038:                     : gap
5039:                       ? "[\n" +
5040:                         gap +
5041:                         partial.join(",\n" + gap) +
5042:                         "\n" +
5043:                         mind +
5044:                         "]"
5045:                       : "[" + partial.join(",") + "]";
5046:                 gap = mind;
5047:                 return v;
5048:               }
5049:               if (rep && typeof rep === "object") {
5050:                 length = rep.length;
5051:                 for (var i = 0; i < length; i += 1) {
5052:                   if (typeof rep[i] === "string") {
5053:                     k = rep[i];
5054:                     v = str(k, value);
5055:                     if (v) {
5056:                       partial.push(quote(k) + gap ? ": " : ":" + v);
5057:                     }
5058:                   }
5059:                 }
5060:               } else {
5061:                 for (var k in value) {
5062:                   if (Object.prototype.hasOwnProperty.call(value, k)) {
5063:                     v = str(k, value);
5064:                     if (v) {
5065:                       partial.push(quote(k) + gap ? ": " : ":" + v);
5066:                     }
5067:                   }
5068:                 }
5069:               }
5070:               v =
5071:                 partial.length === 0
5072:                   ? "{}"
5073:                   : gap
5074:                     ? "{\n" +
5075:                       gap +
5076:                       partial.join(",\n" + gap) +
5077:                       "\n" +
5078:                       mind +
5079:                       "}"
5080:                     : "{" + partial.join(",") + "}";
5081:               gap = mind;
5082:               return v;
5083:           }
5084:         }
5085:         ("use strict");
5086:         var rx_one = /^[\],:{}\s]*$/;
5087:         var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
5088:         var rx_three =
5089:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
5090:         var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
5091:         var rx_escapable =
5092:           /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
5093:         var rx_dangerous =
5094:           /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
5095:         if (typeof Date.prototype.toJSON !== "function") {
5096:           Date.prototype.toJSON = function () {
5097:             return isFinite(this.valueOf())
5098:               ? this.getUTCFullYear() +
5099:                   "-" +
5100:                   f(this.getUTCMonth() + 1) +
5101:                   "-" +
5102:                   f(this.getUTCDate()) +
5103:                   "T" +
5104:                   f(this.getUTCHours()) +
5105:                   ":" +
5106:                   f(this.getUTCMinutes()) +
5107:                   ":" +
5108:                   f(this.getUTCSeconds()) +
5109:                   "Z"
5110:               : null;
5111:           };
5112:           Boolean.prototype.toJSON = this_value;
5113:           Number.prototype.toJSON = this_value;
5114:           String.prototype.toJSON = this_value;
5115:         }
5116:         if (typeof JSON.stringify !== "function") {
5117:           meta = {
5118:             "\b": "\\b",
5119:             "\t": "\\t",
5120:             "\n": "\\n",
5121:             "\f": "\\f",
5122:             "\r": "\\r",
5123:             '"': '\\"',
5124:             "\\": "\\\\",
5125:           };
5126:           JSON.stringify = function (value, replacer, space) {
5127:             gap = "";
5128:             indent = "";
5129:             if (typeof space === "number") {
5130:               for (var i = 0; i < space; i += 1) {
5131:                 indent += " ";
5132:               }
5133:             } else {
5134:               if (typeof space === "string") {
5135:                 indent = space;
5136:               }
5137:             }
5138:             rep = replacer;
5139:             if (
5140:               replacer &&
5141:               typeof replacer !== "function" &&
5142:               (typeof replacer !== "object" ||
5143:                 typeof replacer.length !== "number")
5144:             ) {
5145:               throw new Error("JSON.stringify");
5146:             }
5147:             return str("", { "": value });
5148:           };
5149:         }
5150:       })();
5151:       var jsonParse = (function () {
5152:         function v(h, j, e) {
5153:           return j ? u[j] : String.fromCharCode(parseInt(e, 16));
5154:         }
5155:         var r =
5156:           "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
5157:         var k =
5158:           '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
5159:         k = '(?:"' + k + '*")';
5160:         var s = new RegExp(
5161:           "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
5162:           "g",
5163:         );
5164:         var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
5165:         var u = {
5166:           '"': '"',
5167:           "/": "/",
5168:           "\\": "\\",
5169:           b: "\b",
5170:           f: "\f",
5171:           n: "\n",
5172:           r: "\r",
5173:           t: "\t",
5174:         };
5175:         var w = new String("");
5176:         var x = Object.hasOwnProperty;
5177:         return function (h, j) {
5178:           h = h.match(s);
5179:           var c = h[0];
5180:           var l = false;
5181:           if ("{" === c) {
5182:             e = {};
5183:           } else if ("[" === c) {
5184:             e = [];
5185:           } else {
5186:             e = [];
5187:             l = true;
5188:           }
5189:           for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
5190:             c = h[m];
5191:             switch (c.charCodeAt(0)) {
5192:               default:
5193:                 a = d[0];
5194:                 a[b || a.length] = c;
5195:                 b = void 0;
5196:                 break;
5197:               case 34:
5198:                 c = c.substring(1, c.length - 1);
5199:                 if (c.indexOf("\\") !== -1) {
5200:                   c = c.replace(t, v);
5201:                 }
5202:                 a = d[0];
5203:                 if (!b) {
5204:                   if (a instanceof Array) {
5205:                     b = a.length;
5206:                   } else {
5207:                     b = c || w;
5208:                     break;
5209:                   }
5210:                 }
5211:                 a[b] = c;
5212:                 b = void 0;
5213:                 break;
5214:               case 91:
5215:                 a = d[0];
5216:                 d.unshift((a[b || a.length] = []));
5217:                 b = void 0;
5218:                 break;
5219:               case 93:
5220:                 d.shift();
5221:                 break;
5222:               case 102:
5223:                 a = d[0];
5224:                 a[b || a.length] = false;
5225:                 b = void 0;
5226:                 break;
5227:               case 110:
5228:                 a = d[0];
5229:                 a[b || a.length] = null;
5230:                 b = void 0;
5231:                 break;
5232:               case 116:
5233:                 a = d[0];
5234:                 a[b || a.length] = true;
5235:                 b = void 0;
5236:                 break;
5237:               case 123:
5238:                 a = d[0];
5239:                 d.unshift((a[b || a.length] = {}));
5240:                 b = void 0;
5241:                 break;
5242:               case 125:
5243:                 d.shift();
5244:                 break;
5245:             }
5246:           }
5247:           if (l) {
5248:             if (d.length !== 1) {
5249:               throw new Error();
5250:             }
5251:             e = e[0];
5252:           } else {
5253:             if (d.length) {
5254:               throw new Error();
5255:             }
5256:           }
5257:           if (j) {
5258:             var p = function (n, o) {
5259:               var f = n[o];
5260:               if (f && typeof f === "object") {
5261:                 var i = null;
5262:                 for (var g in f) {
5263:                   if (x.call(f, g) && f !== n) {
5264:                     var q = p(f, g);
5265:                     if (q !== void 0) {
5266:                       f[g] = q;
5267:                     } else {
5268:                       i || (i = []);
5269:                       i.push(g);
5270:                     }
5271:                   }
5272:                 }
5273:                 if (i) {
5274:                   for (g = i.length; --g >= 0; ) {
5275:                     delete f[i[g]];
5276:                   }
5277:                 }
5278:               }
5279:               return j.call(n, o, f);
5280:             };
5281:             e = p({ "": e }, "");
5282:           }
5283:           return e;
5284:         };
5285:       })();
5286:       try {
5287:         switch (mode) {
5288:           case "parse":
5289:             if (validateJSON(string)) {
5290:               return jsonParse(string);
5291:             } else {
5292:               alert("JSON validation error\n" + string.substring(0, 1000));
5293:               return null;
5294:             }
5295:             break;
5296:           case "stringify":
5297:             return JSON.stringify(string, undefined, prettyJSON);
5298:             break;
5299:         }
5300:       } catch (e) {
5301:         alert(e.toString());
5302:       }
5303:     }
5304:     function validateJSON(string) {
5305:       return /^[\],:{}\s]*$/.test(
5306:         string
5307:           .replace(/\\["\\\/bfnrtu]/g, "@")
5308:           .replace(
5309:             /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
5310:             "]",
5311:           )
5312:           .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
5313:       );
5314:     }
5315:     this.c = function () {
5316:       return mainFunc("l");
5317:     };
5318:     this.s = function () {
5319:       return (
5320:         (void 0 !== licenseValidity &&
5321:           licenseValidity.hasOwnProperty("result")) ||
5322:           (licenseValidity = getVerifCode("")),
5323:         isResultValidLicense(licenseValidity)
5324:       );
5325:     };
5326:     this.r = function () {
5327:       return !mainFunc("r");
5328:     };
5329:     this.t = function () {
5330:       return (
5331:         (void 0 !== licenseValidity &&
5332:           licenseValidity.hasOwnProperty("result")) ||
5333:           (licenseValidity = getVerifCode("")),
5334:         isResultTrial(licenseValidity.result)
5335:       );
5336:     };
5337:     this.l = function () {
5338:       return (
5339:         (void 0 !== licenseValidity &&
5340:           licenseValidity.hasOwnProperty("result")) ||
5341:           (licenseValidity = getVerifCode("")),
5342:         licenseValidity.license
5343:       );
5344:     };
5345:     this.ss = function () {
5346:       return (
5347:         (void 0 !== licenseValidity &&
5348:           licenseValidity.hasOwnProperty("result")) ||
5349:           (licenseValidity = getVerifCode("")),
5350:         isResultValidLicense(licenseValidity) &&
5351:           !isResultTrial(licenseValidity.result)
5352:       );
5353:     };
5354:     this.vt = function () {
5355:       return isVT();
5356:     };
5357:     this.helpUI = function (e) {
5358:       helpUI(e);
5359:     };
5360:     this.getRegistration = function (e) {
5361:       return getRegistration(e);
5362:     };
5363:     this.openSupportTicket = function (e) {
5364:       openSupportTicket(e);
5365:     };
5366:     this.openURL = function (e) {
5367:       openURL(e);
5368:     };
5369:     this.doUpdateCheck = function (e) {
5370:       setUpdateCheck(e);
5371:     };
5372:     this.getUpdateCheckStatus = function () {
5373:       return doUpdateCheck;
5374:     };
5375:     this.doUpdateCheckNow = function () {
5376:       return doUpdateCheckNow();
5377:     };
5378:     this.frameworkVersion = function () {
5379:       return licensingVersion;
5380:     };
5381:   }
5382:   var easyClonesLicencing = new a(easyClones_settings);
5383:   if (easyClonesLicencing.c()) {
5384:     function easyClonesUI(trialMode, checkLicense) {
5385:       function getUserDataFolder() {
5386:         var userDataFolder = Folder.userData;
5387:         var aescriptsFolder = Folder(
5388:           userDataFolder.toString() + "/Aescripts/Easy Clones/",
5389:         );
5390:         if (!aescriptsFolder.exists) {
5391:           var checkFolder = aescriptsFolder.create();
5392:           if (!checkFolder) {
5393:             alert("Error creating");
5394:             aescriptsFolder = Folder.temp;
5395:           }
5396:         }
5397:         return aescriptsFolder.toString();
5398:       }
5399:       function createResourceFile(filename, binaryString, resourceFolder) {
5400:         var myFile = new File(resourceFolder + "/" + filename);
5401:         if (!File(myFile).exists) {
5402:           if (!isSecurityPrefSet()) {
5403:             alert(
5404:               "This script requires access to write files. Go to the General panel of the application preferences and make sure Allow Scripts to Write Files and Access Network is checked.",
5405:             );
5406:             try {
5407:               app.executeCommand(2359);
5408:             } catch (e) {
5409:               alert(e);
5410:             }
5411:             if (!isSecurityPrefSet()) {
5412:               return null;
5413:             }
5414:           }
5415:           myFile.encoding = "BINARY";
5416:           myFile.open("w");
5417:           myFile.write(binaryString);
5418:           myFile.close();
5419:         }
5420:         return myFile;
5421:       }
5422:       function isSecurityPrefSet() {
5423:         try {
5424:           var securitySetting = app.preferences.getPrefAsLong(
5425:             "Main Pref Section",
5426:             "Pref_SCRIPTING_FILE_NETWORK_SECURITY",
5427:           );
5428:           return securitySetting == 1;
5429:         } catch (e) {
5430:           return (securitySetting = 1);
5431:         }
5432:       }
5433:       var win =
5434:         thisObj instanceof Panel
5435:           ? thisObj
5436:           : new Window("palette", "Easy Clones", undefined, {
5437:               resizeable: true,
5438:             });
5439:       win.orientation = "row";
5440:       var createClonesImage = __BLOB__BLOB_000137__;
5441:       var createClonesBtn = win.add(
5442:         "iconbutton",
5443:         [5, 5, 40, 40],
5444:         ScriptUI.newImage(
5445:           createResourceFile(
5446:             "createClonesImage.png",
5447:             createClonesImage,
5448:             getUserDataFolder(),
5449:           ),
5450:         ),
5451:         { style: "toolbutton", toggle: 0 },
5452:       );
5453:       createClonesBtn.onClick = function () {
5454:         checkLicense;
5455:         isTrial = !checkLicense;
5456:         createClones(trialMode);
5457:       };
5458:       createClonesBtn.helpTip = "Click to create a Clone System.";
5459:       var addClonesImage = __BLOB__BLOB_000138__;
5460:       var addClonesBtn = win.add(
5461:         "iconbutton",
5462:         [40, 5, 75, 40],
5463:         ScriptUI.newImage(
5464:           createResourceFile(
5465:             "addClonesImage.png",
5466:             addClonesImage,
5467:             getUserDataFolder(),
5468:           ),
5469:         ),
5470:         { style: "toolbutton", toggle: 0 },
5471:       );
5472:       addClonesBtn.onClick = function () {
5473:         checkLicense;
5474:         isTrial = !checkLicense;
5475:         addClones(trialMode);
5476:       };
5477:       addClonesBtn.helpTip =
5478:         "Click to add new Clones to an existing Clone System.";
5479:       var renumberClonesImage = __BLOB__BLOB_000139__;
5480:       var renumberClonesBtn = win.add(
5481:         "iconbutton",
5482:         [75, 5, 110, 40],
5483:         ScriptUI.newImage(
5484:           createResourceFile(
5485:             "renumberClonesImage.png",
5486:             renumberClonesImage,
5487:             getUserDataFolder(),
5488:           ),
5489:         ),
5490:         { style: "toolbutton", toggle: 0 },
5491:       );
5492:       renumberClonesBtn.onClick = function () {
5493:         checkLicense;
5494:         isTrial = !checkLicense;
5495:         renumberClones();
5496:       };
5497:       renumberClonesBtn.helpTip = "Click to renumber selected Clones.";
5498:       var shuffleClonesImage = __BLOB__BLOB_000140__;
5499:       var shuffleClonesBtn = win.add(
5500:         "iconbutton",
5501:         [110, 5, 145, 40],
5502:         ScriptUI.newImage(
5503:           createResourceFile(
5504:             "shuffleClonesImage.png",
5505:             shuffleClonesImage,
5506:             getUserDataFolder(),
5507:           ),
5508:         ),
5509:         { style: "toolbutton", toggle: 0 },
5510:       );
5511:       shuffleClonesBtn.onClick = function () {
5512:         checkLicense;
5513:         isTrial = !checkLicense;
5514:         shuffleClones();
5515:       };
5516:       shuffleClonesBtn.helpTip = "Click to shuffle selected Clone layer order.";
5517:       var centreClonesImage = __BLOB__BLOB_000141__;
5518:       var centreClonesBtn = win.add(
5519:         "iconbutton",
5520:         [145, 5, 180, 40],
5521:         ScriptUI.newImage(
5522:           createResourceFile(
5523:             "centreClonesImage.png",
5524:             centreClonesImage,
5525:             getUserDataFolder(),
5526:           ),
5527:         ),
5528:         { style: "toolbutton", toggle: 0 },
5529:       );
5530:       centreClonesBtn.onClick = function () {
5531:         checkLicense;
5532:         isTrial = !checkLicense;
5533:         centreClones();
5534:       };
5535:       centreClonesBtn.helpTip =
5536:         "Click to centre Clones position to their controller.";
5537:       var delayExpressionImage = __BLOB__BLOB_000142__;
5538:       var delayExpressionBtn = win.add(
5539:         "iconbutton",
5540:         [180, 5, 215, 40],
5541:         ScriptUI.newImage(
5542:           createResourceFile(
5543:             "delayExpressionImage.png",
5544:             delayExpressionImage,
5545:             getUserDataFolder(),
5546:           ),
5547:         ),
5548:         { style: "toolbutton", toggle: 0 },
5549:       );
5550:       delayExpressionBtn.onClick = function () {
5551:         checkLicense;
5552:         isTrial = !checkLicense;
5553:         delayExpression(trialMode);
5554:       };
5555:       delayExpressionBtn.helpTip =
5556:         "Click to add Delay Expressions to selected Properties.";
5557:       var helpImage = __BLOB__BLOB_000143__;
5558:       var helpBtn = win.add(
5559:         "iconbutton",
5560:         [215, 5, 250, 40],
5561:         ScriptUI.newImage(
5562:           createResourceFile("help.png", helpImage, getUserDataFolder()),
5563:         ),
5564:         { style: "toolbutton", toggle: 0 },
5565:       );
5566:       helpBtn.onClick = function () {
5567:         checkLicense;
5568:         isTrial = !checkLicense;
5569:         easyClonesLicencing.helpUI();
5570:       };
5571:       helpBtn.helpTip = "Click for help.";
5572:       if (win instanceof Window) {
5573:         win.show();
5574:       } else {
5575:         win.layout.layout(true);
5576:       }
5577:     }
5578:     function kBar(trialMode, checkLicense) {
5579:       var kbarArgument = kbar.button.argument;
5580:       switch (kbarArgument.toLowerCase()) {
5581:         case "create clones":
5582:           createClones(trialMode, "create clones");
5583:           checkLicense;
5584:           break;
5585:         case "add clones":
5586:           addClones(trialMode, "add clones");
5587:           checkLicense;
5588:           break;
5589:         case "renumber clones":
5590:           renumberClones("renumber clones");
5591:           checkLicense;
5592:           break;
5593:         case "shuffle clones":
5594:           shuffleClones("shuffle clones");
5595:           checkLicense;
5596:           break;
5597:         case "centre clones":
5598:           centreClones("centre clones");
5599:           checkLicense;
5600:           break;
5601:         case "delay expression":
5602:           delayExpression(trialMode, "delay expression");
5603:           checkLicense;
5604:           break;
5605:         default:
5606:           alert(
5607:             "Easy Clones\nInvalid argument. Valid arguments are: \n\ncreate clones\nadd clones\nrenumber clones\nshuffle clones\ncentre clones\ndelay expression\n\nPlease check your KBar settings.",
5608:           );
5609:           break;
5610:       }
5611:     }
5612:     var trialMode = easyClonesLicencing.t();
5613:     var checkLicense = easyClonesLicencing.s();
5614:     if (typeof kbar !== "undefined" && kbar.button) {
5615:       kBar(trialMode, checkLicense);
5616:     } else {
5617:       easyClonesUI(trialMode, checkLicense);
5618:     }
5619:   }
5620: }
5621: MW_EasyClones(this);
```

## File: Aescripts-easyRulers 2 v2.01/easyRulers.jsx
```javascript
    1: /*
    2:  * Decompiled with Jsxer
    3:  * Version: 1.7.4
    4:  * JSXBIN 2.0
    5:  */
    6: 
    7: function easyRulers(thisObj) {
    8:   var af_settings = {
    9:     betaExpirationDate: new Date("Dec 1, 2017"),
   10:     betaStartDate: new Date("Nov 1, 2017"),
   11:     betaSupportEmail: "http://aescripts.com/contact",
   12:     helpButtons: [
   13:       {
   14:         name: "Check out more products from Real Creations",
   15:         url: "http://aescripts.com/authors/q-r/real-creations",
   16:       },
   17:     ],
   18:     helpText:
   19:       "Here is a short explanation of easyRulers interface.\nFor more detailed information, please read the included .PDF user guide.\nIf you like our work, please visit: www.realcreations.gr\n\n--\n\n[ Ruler lines ]\n   adjusts the total number of lines\n\n[ Gap ]\n   adjusts the gap between the lines - this affects the total length/arc of the ruler\n\n\n______Type - tab______\n\n[ Linear or Arc/circle ruler ]\n    select if the ruler would be created in a straight line or an arc/circle\n\n[ Side ]\n    select which side of the ruler to populate\n\n[ Baseline ]\n    select the type of baseline(s) to create\n\n__None: does not create any baselines\n__Bottom Only: creates one main base line at the bottom of the ruler\n__Multiple: creates a baseline for each subdivision\n\n\n_____Lines - tab______\n\n[ Shapes of divisions ]\n    select whether the shapes of the divisions are going to be stripes or dots\n\n[ Type of ruler ]\n    select between 9 different types of subdivisions\n\n\n______Numbers - tab______\n\n[ Create text numbers ? ]\n    check it, if you want to create text numbers\n\n[ Text Alignment ]\n    align text layers left, center or right\n\n\n[ Start From ]\n    starting point of the numbering\n\n[ Stepping ]\n    stepping of numbering.\n    Starting from 0, a stepping of 5 will create the following numbers: e.g. 0, 5, 10, 15...\n    This field also accepts decimal points separated with either a comma (,) or a dot (.)\n\n[ Text Size ]\n    size of the text numbers\n\n[ Text Color ]\n    color of the text numbers\n\n[ Prefix ]\n    inserts a prefix in front of each text number\n\n[ Suffix ]\n    inserts a suffix after each text number\n\n[ Anchor Point Grouping Per Character ]\n    this setting will affect texts with more than 2 digits on circular rulers. If checked, texts will curve around the circle/arc on per character basis.\n    Otherwise texts will be treated as whole words and will not curve around the circle\n\n\n______? - settings tab______\n\n[ Shy Text Layers ? ]\n    enables the shy switch, on all generated text layers\n\n[ Reset to defaults ]\n    resets all parameters of easyRulers back to their default values\n\n\n______\n\n[ Create Ruler Button]\n   creates the ruler and shows the range of numbers to be created\n",
   20:     offerBeta: false,
   21:     offerTrial: true,
   22:     privateNumber: 6641755466680374,
   23:     productSKU: "TTER2-SUL",
   24:     scriptAuthor: "Real Creations",
   25:     scriptName: "easyRulers 2",
   26:     scriptURL: "https://aescripts.com/easyrulers/",
   27:     scriptVersion: "2.01",
   28:   };
   29:   function a(vars) {
   30:     function licUI() {
   31:       var e = new Window(
   32:         "dialog",
   33:         strTrialWelcomeHeader + " - " + strVersion + " " + strScriptVersion,
   34:         void 0,
   35:         { resizeable: true },
   36:       );
   37:       if (null != e) {
   38:         var i =
   39:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\tinfoGrp: Group { \t\t\t\t\talignment: [\'fill\',\'top\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\torientation: \'column\', \t\t\t\t\t\thdrGrp: Group {\t\t\t\t\t\t\ttxt: StaticText {}, \t\t\t\t\t\t\tpaste: StaticText {}, \t\t\t\t\t\t}\t\t\t\t\t\ttrial: StaticText {}, \t\t\t\t\t} \t\t\t\t\tlicGrp: Group { \t\t\t\t\t\ttxt: EditText {alignment: [\'fill\',\'fill\'], properties:{multiline:false}}, \t\t\t\t\t} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'],                             buyGrp: Group {                             alignment: [\'left\',\'fill\'],                             alignChildren: [\'left\',\'fill\'],                             orientation: \'column\',                             spacing:1,                                  retrieveReg: Button {text:\'" +
   40:           strRetrieveLic.replace(/%t/, strLicense) +
   41:           "\', name:\'retrieve\',preferredSize:[130,25]}                                   buyLic: Button {text:\'" +
   42:           strBuyLic.replace(/%t/, strLicense) +
   43:           "\', name:\'buy\',preferredSize:[130,25]}                                   }\t\t\t\t\t\tcancelBtn: Button {text:\'" +
   44:           strCancel +
   45:           "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t\tokBtn: Button {text:\'" +
   46:           strOK +
   47:           "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
   48:         e.grp = e.add(i);
   49:         var t = ScriptUI.newFont(
   50:           "dialog || palette",
   51:           ScriptUI.FontStyle.BOLD,
   52:           12,
   53:         );
   54:         var n = ScriptUI.newFont(
   55:           "dialog || palette",
   56:           ScriptUI.FontStyle.REGULAR,
   57:           9,
   58:         );
   59:         return (
   60:           (e.grp.licGrp.txt.preferredSize = [600, 30]),
   61:           (e.grp.infoGrp.hdrGrp.txt.text = strEnterLicenseCode),
   62:           (e.grp.infoGrp.hdrGrp.txt.graphics.font = t),
   63:           (e.grp.infoGrp.hdrGrp.paste.text = ""),
   64:           (e.grp.infoGrp.hdrGrp.paste.graphics.font = n),
   65:           (e.grp.infoGrp.trial.text =
   66:             betaMode || !offerTrial ? "" : strTrialInstructMsg),
   67:           isServerConfigured(licenseValidity) &&
   68:             (isServerRunning(licenseValidity)
   69:               ? (e.grp.infoGrp.hdrGrp.txt.text = strServerInstructMsg)
   70:               : (e.grp.infoGrp.hdrGrp.txt.text =
   71:                   strEnterLicenseCode + " " + strServerNotRunning),
   72:             (e.grp.infoGrp.trial.text = strTrialInstructMsg)),
   73:           (e.grp.licGrp.txt.text = betaMode || !offerTrial ? "" : "trial"),
   74:           isServerConfigured(licenseValidity) &&
   75:             isServerRunning(licenseValidity) &&
   76:             (e.grp.licGrp.txt.text = "@REMOTE"),
   77:           (e.grp.okGrp.buyGrp.retrieveReg.visible =
   78:             e.grp.okGrp.buyGrp.buyLic.visible =
   79:               !betaMode),
   80:           (e.grp.okGrp.buyGrp.buyLic.onClick = function () {
   81:             openURL(strTrialUrl);
   82:             e.close(false);
   83:           }),
   84:           (e.grp.okGrp.buyGrp.retrieveReg.onClick = function () {
   85:             retrieveLicenseUI(strLicense);
   86:             e.close(false);
   87:           }),
   88:           (e.grp.okGrp.cancelBtn.onClick = function () {
   89:             e.close(false);
   90:           }),
   91:           (e.grp.okGrp.okBtn.onClick = function () {
   92:             license = e.grp.licGrp.txt.text
   93:               .replace(/^\s\s*/, "")
   94:               .replace(/\s\s*$/, "");
   95:             e.close(true);
   96:           }),
   97:           e.layout.layout(true),
   98:           e.layout.resize(),
   99:           (e.onResizing = e.onResize =
  100:             function () {
  101:               this.layout.resize();
  102:             }),
  103:           e
  104:         );
  105:       }
  106:     }
  107:     function retrieveLicenseUI(e) {
  108:       var i = new Window("dialog", strRetrieveLic.replace(/%t/, e), void 0, {
  109:         resizeable: true,
  110:       });
  111:       if (null != i) {
  112:         var t =
  113:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'],                     hdrGrp: Group {                         orientation: \'column\',                         alignment: [\'fill\',\'fill\'],                         alignChildren: [\'fill\',\'fill\'],                                 hdr: StaticText {text:\'" +
  114:           strLicenseDownloadOptions.replace(
  115:             /%t/,
  116:             e.toLowerCase() + "de" == locale ? "n" : "s",
  117:           ) +
  118:           "\', alignment: [\'fill\',\'top\'], properties:{multiline:true} },                                },                     buttonsGrp: Group {                         alignment: [\'fill\',\'bottom\'],                         alignChildren: [\'fill\',\'fill\'],                             myDownloadsBtn: Button {text:\'" +
  119:           strMyDownloads +
  120:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                             downloadManagerBtn: Button {text:\'" +
  121:           strDownloadManager +
  122:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                         }, \t\t\t\t}";
  123:         i.grp = i.add(t);
  124:         i.grp.buttonsGrp.myDownloadsBtn.onClick = function () {
  125:           openURL(retrieveUrl);
  126:           i.close(false);
  127:         };
  128:         i.grp.buttonsGrp.downloadManagerBtn.onClick = function () {
  129:           openURL(managerAppUrl);
  130:           i.close(false);
  131:         };
  132:         i.layout.layout(true);
  133:         i.layout.resize();
  134:         i.onResizing = i.onResize = function () {
  135:           this.layout.resize();
  136:         };
  137:         i.show();
  138:       }
  139:     }
  140:     function checkBeta(e, i) {
  141:       return new Date() < i || new Date() > e;
  142:     }
  143:     function helpUI() {
  144:       var e = new Window(
  145:         "dialog",
  146:         strScriptName + " - " + strVersion + " " + strScriptVersion,
  147:         void 0,
  148:         { resizeable: true },
  149:       );
  150:       if (null != e) {
  151:         for (
  152:           var i =
  153:               -1 != $.os.indexOf("Windows") &&
  154:               12 <= parseFloat(app.version) &&
  155:               parseFloat(app.version) < 14
  156:                 ? ["left", "top"]
  157:                 : ["fill", "fill"],
  158:             t =
  159:               "group { \t\torientation: \'column\', \t\talignment: [\'" +
  160:               i[0] +
  161:               "\',\'" +
  162:               i[1] +
  163:               "\'], \t\talignChildren: [\'fill\',\'fill\'],                    infoGrp: Group {                    alignment: [\'fill\',\'top\'],                    alignChildren: [\'fill\',\'top\'], \t\t\t\t\ttxt: StaticText {properties:{multiline:true}, preferredSize:[150,50]},                       hdr: StaticText {properties:{multiline:true}},                       removeLic: Button {text:\'" +
  164:               strDeactivate +
  165:               "\', preferredSize:[40,30]} \t\t\t\t} \t\t\t\thelpGrp: Group {                    alignment: [\'" +
  166:               i[0] +
  167:               "\',\'" +
  168:               i[1] +
  169:               "\'],                    alignChildren: [\'fill\',\'fill\'],                     txt: EditText {properties:{multiline:true, readonly:true}}, \t\t\t\t}                 prefsGrp: Group {                       alignment: [\'fill\',\'bottom\'],                        alignChildren: [\'left\',\'center\'],                        orientation: \'row\',                        checkNow: Button {text:\'" +
  170:               strCheckNow +
  171:               "\', preferredSize:[150,25]}                        doUpdateCheck: Checkbox {text:\'" +
  172:               strVersionCheck +
  173:               "\', preferredSize:[-1,25]}                        }\t\t\tokGrp: Group {                 alignment: [\'fill\',\'bottom\'],                 alignChildren: [\'fill\',\'center\'],                 supportBtn: Button {text:\'" +
  174:               strGetSupport +
  175:               "\', preferredSize:[150,30], alignment: [\'left\',\'center\']}                 ",
  176:             n = 0;
  177:           n < Math.min(maxUIButtons, vars.helpButtons.length);
  178:           n++
  179:         ) {
  180:           if (vars.helpButtons[n].hasOwnProperty("name")) {
  181:             t +=
  182:               "btn" + n + ": " + vars.helpButtons[n].hasOwnProperty("type") &&
  183:               validateButtonType(vars.helpButtons[n].type)
  184:                 ? vars.helpButtons[n].type
  185:                 : "Button" +
  186:                   " {id: \'" +
  187:                   n +
  188:                   "\', alignment: [\'left\',\'center\']}";
  189:           }
  190:         }
  191:         t +=
  192:           "\t\t\t\t\tokBtn: Button {text:\'" +
  193:           strOK +
  194:           "\', preferredSize:[150,30], alignment: [\'right\',\'center\']} \t\t\t\t} \t\t}";
  195:         e.grp = e.add(t);
  196:         e.grp.helpGrp.txt.preferredSize = [800, 500];
  197:         var r = "\xa9" + (new Date().getYear() + 1900).toString();
  198:         e.grp.infoGrp.txt.text =
  199:           strScriptName +
  200:           " - " +
  201:           strVersion +
  202:           " " +
  203:           strScriptVersion +
  204:           "\n" +
  205:           r +
  206:           " " +
  207:           vars.scriptAuthor +
  208:           "\n\n";
  209:         e.grp.infoGrp.hdr.text = getRegistration();
  210:         e.grp.helpGrp.txt.text = vars.helpText;
  211:         haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
  212:           (doUpdateCheck = !(
  213:             "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
  214:           ));
  215:         e.grp.prefsGrp.doUpdateCheck.value = doUpdateCheck;
  216:         e.grp.prefsGrp.doUpdateCheck.onClick = function () {
  217:           setUpdateCheck(this.value);
  218:         };
  219:         e.grp.prefsGrp.checkNow.onClick = function () {
  220:           ScriptUI.environment.keyboardState.altKey
  221:             ? alert(
  222:                 "aescripts licensing framework version\n" + licensingVersion,
  223:               )
  224:             : doUpdateCheckNow();
  225:         };
  226:         for (
  227:           var n = 0;
  228:           n < Math.min(maxUIButtons, vars.helpButtons.length);
  229:           n += 1
  230:         ) {
  231:           vars.helpButtons[n].hasOwnProperty("name") &&
  232:             ((e.grp.okGrp["btn" + n].text = vars.helpButtons[n].name),
  233:             vars.helpButtons[n].hasOwnProperty("url")
  234:               ? (e.grp.okGrp["btn" + n].onClick = function () {
  235:                   openURL(vars.helpButtons[this.id].url);
  236:                 })
  237:               : vars.helpButtons[n].hasOwnProperty("onClickFunction") &&
  238:                 (e.grp.okGrp["btn" + n].onClick =
  239:                   vars.helpButtons[n].onClickFunction),
  240:             vars.helpButtons[n].hasOwnProperty("btnValue") &&
  241:               (e.grp.okGrp["btn" + n].value = vars.helpButtons[n].btnValue));
  242:         }
  243:         e.grp.infoGrp.removeLic.visible = !isResultTrial(
  244:           licenseValidity.result,
  245:         );
  246:         e.grp.infoGrp.removeLic.onClick = function () {
  247:           removeLic() &&
  248:             ((e.grp.infoGrp.hdr.text = getRegistration()),
  249:             (this.visible = false));
  250:         };
  251:         e.grp.okGrp.supportBtn.onClick = function () {
  252:           ScriptUI.environment.keyboardState.shiftKey &&
  253:           ScriptUI.environment.keyboardState.altKey
  254:             ? alert(
  255:                 "aescripts + aeplugins\nFramework version: " +
  256:                   licensingVersion +
  257:                   "\n" +
  258:                   strScriptName +
  259:                   " - " +
  260:                   strVersion +
  261:                   " " +
  262:                   strScriptVersion,
  263:               )
  264:             : (openSupportTicket({}), e.close());
  265:         };
  266:         e.grp.okGrp.okBtn.onClick = function () {
  267:           e.close();
  268:         };
  269:         -1 != $.os.indexOf("Windows") &&
  270:           12 <= parseFloat(app.version) &&
  271:           parseFloat(app.version) < 14 &&
  272:           (e.maximumSize = [840, 670]);
  273:         e.layout.layout(true);
  274:         e.layout.resize();
  275:         e.onResizing = e.onResize = function () {
  276:           this.layout.resize();
  277:         };
  278:         e.show();
  279:       }
  280:     }
  281:     function validateButtonType(e) {
  282:       return "Button" === e || "Checkbox" === e;
  283:     }
  284:     function openSupportTicket(e) {
  285:       t = n = "";
  286:       i = "&subject=";
  287:       null != e &&
  288:         void 0 !== e &&
  289:         (e.hasOwnProperty("subject") && (i += File.encode(e.subject)),
  290:         e.hasOwnProperty("message") && (t = File.encode(e.message)),
  291:         e.hasOwnProperty("diagnostic") &&
  292:           (n = File.encode(e.diagnostic + "\n--\n")));
  293:       var r =
  294:         true === isAescriptsSupportUrl
  295:           ? strSKU + i + "&message="
  296:           : i.replace(/\&/, "?") + "&body=";
  297:       var a =
  298:         "" != r
  299:           ? t +
  300:             "%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A-------%0D%0A" +
  301:             n +
  302:             getDiagnosticData(true)
  303:           : "";
  304:       supportUrl.toString().match(/@/) &&
  305:         !supportUrl.toString().match(/^mailto:/) &&
  306:         (supportUrl = "mailto:" + supportUrl);
  307:       openURL(supportUrl + r + a);
  308:     }
  309:     function getDiagnosticData(e) {
  310:       var i = $.os.toString();
  311:       var t =
  312:         BridgeTalk.getDisplayName(BridgeTalk.appName) +
  313:         " (" +
  314:         app.version +
  315:         ") - " +
  316:         $.locale.toString();
  317:       var n =
  318:         strScriptName.replace(/&/, "and") +
  319:         " - " +
  320:         strVersion +
  321:         " " +
  322:         strScriptVersion;
  323:       var r = "Lic. fw v" + licensingVersion + isVT() ? " (Trial)" : "";
  324:       return e
  325:         ? File.encode(n) +
  326:             "%0D%0A" +
  327:             File.encode(i) +
  328:             "%0D%0A" +
  329:             File.encode(t) +
  330:             "%0D%0A" +
  331:             File.encode(r)
  332:         : n + "\n" + i + "\n" + t + "\n" + r;
  333:     }
  334:     function setUpdateCheck(e) {
  335:       saveSettings(prefsSectionName, prefsDoUpdateCheck, (doUpdateCheck = e));
  336:     }
  337:     function doUpdateCheckNow() {
  338:       checkForNewVersion((doUpdateCheck = true));
  339:     }
  340:     function newVersionUI(i) {
  341:       var t = new Window("dialog", strNewVersionAvailableHdr, void 0, {
  342:         resizeable: true,
  343:       });
  344:       if (null != t) {
  345:         var e =
  346:           "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t   hdrGrp: Group { \t\t\t\t   alignment: [\'fill\',\'fill\'], \t\t\t\t   alignChildren: [\'fill\',\'fill\'], \t\t\t\t   orientation: \'column\',                         hdr: StaticText {alignment: [\'fill\',\'top\'], properties:{multiline:true}}, ";
  347:         i.hasOwnProperty("header") &&
  348:           (e +=
  349:             "   infoGrp: Panel {                            alignment: [\'fill\',\'fill\'],                            alignChildren: [\'fill\',\'fill\'],                            orientation: \'column\',                               info: StaticText {properties:{multiline:true}},                               } ");
  350:         e +=
  351:           "} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\t\tskipVersionBtn: Button {text:\'" +
  352:           strSkipVersion +
  353:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']}                            remindMeLaterBtn: Button {text:\'" +
  354:           strRemindMeLater +
  355:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t\tdownloadBtn: Button {text:\'" +
  356:           strDownload +
  357:           "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
  358:         t.grp = t.add(e);
  359:         var n = ScriptUI.newFont(
  360:           "dialog || palette",
  361:           ScriptUI.FontStyle.BOLD,
  362:           12,
  363:         );
  364:         ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.BOLD, 11);
  365:         ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.REGULAR, 9);
  366:         t.grp.hdrGrp.hdr.graphics.font = n;
  367:         t.grp.hdrGrp.hdr.text = strNewVersionAvailable.replace(
  368:           /%v/,
  369:           i.version + "\n" + strCurrentVersion.replace(/%v/, strScriptVersion),
  370:         );
  371:         i.hasOwnProperty("header") &&
  372:           (t.grp.hdrGrp.infoGrp.info.text = i.header + "\n\n" + i.detail);
  373:         t.grp.okGrp.skipVersionBtn.onClick = function () {
  374:           saveSettings(
  375:             prefsSectionName,
  376:             prefsLastVersionChecked,
  377:             strScriptVersion,
  378:           );
  379:           saveSettings(
  380:             prefsSectionName,
  381:             prefsLastTimeVersionChecked,
  382:             new Date().toString(),
  383:           );
  384:           saveSettings(
  385:             prefsSectionName,
  386:             prefsNextTimeVersionCheckedSkipVersion,
  387:             i.version,
  388:           );
  389:           saveSettings(
  390:             prefsSectionName,
  391:             prefsLastServerVersionChecked,
  392:             i.version,
  393:           );
  394:           t.close(false);
  395:         };
  396:         t.grp.okGrp.remindMeLaterBtn.onClick = function () {
  397:           try {
  398:             var e = new Date();
  399:             e = dateAddDays(remindMeLaterDays);
  400:             saveSettings(
  401:               prefsSectionName,
  402:               prefsLastVersionChecked,
  403:               strScriptVersion,
  404:             );
  405:             saveSettings(
  406:               prefsSectionName,
  407:               prefsLastTimeVersionChecked,
  408:               new Date().toString(),
  409:             );
  410:             saveSettings(
  411:               prefsSectionName,
  412:               prefsNextTimeVersionChecked,
  413:               e.toString(),
  414:             );
  415:             saveSettings(
  416:               prefsSectionName,
  417:               prefsLastServerVersionChecked,
  418:               i.version,
  419:             );
  420:             t.close(false);
  421:           } catch (e) {
  422:             alert(e.toString());
  423:           }
  424:         };
  425:         t.grp.okGrp.downloadBtn.onClick = function () {
  426:           retrieveLicenseUI(strDownload);
  427:           t.close(true);
  428:         };
  429:         t.layout.layout(true);
  430:         t.layout.resize();
  431:         t.onResizing = t.onResize = function () {
  432:           this.layout.resize();
  433:         };
  434:         i.hasOwnProperty("header") &&
  435:           ((t.grp.hdrGrp.infoGrp.size.height = Math.min(
  436:             t.grp.hdrGrp.infoGrp.size.height,
  437:             300,
  438:           )),
  439:           t.layout.layout(true),
  440:           t.layout.resize());
  441:         t.show();
  442:       }
  443:     }
  444:     function dateAddDays(e) {
  445:       var i = new Date().getTime() + 86400000 * e;
  446:       return new Date(i);
  447:     }
  448:     function checkForNewVersion(e) {
  449:       if ((null == e && (e = false), doUpdateCheck)) {
  450:         haveSettings(prefsSectionName, prefsLastVersionChecked) &&
  451:           (t = getSettings(prefsSectionName, prefsLastVersionChecked));
  452:         haveSettings(prefsSectionName, prefsLastServerVersionChecked) &&
  453:           (n = getSettings(prefsSectionName, prefsLastServerVersionChecked));
  454:         haveSettings(prefsSectionName, prefsLastTimeVersionChecked) &&
  455:           (r = new Date(
  456:             getSettings(prefsSectionName, prefsLastTimeVersionChecked),
  457:           ));
  458:         haveSettings(
  459:           prefsSectionName,
  460:           prefsNextTimeVersionCheckedSkipVersion,
  461:         ) &&
  462:           (s = getSettings(
  463:             prefsSectionName,
  464:             prefsNextTimeVersionCheckedSkipVersion,
  465:           ));
  466:         haveSettings(prefsSectionName, prefsNextTimeVersionChecked) &&
  467:           (a = new Date(
  468:             getSettings(prefsSectionName, prefsNextTimeVersionChecked),
  469:           ));
  470:         haveSettings(prefsSectionName, prefsVersionCheckInit) &&
  471:           (i = getSettings(prefsSectionName, prefsVersionCheckInit));
  472:         var o = new Date();
  473:         if (e || null == i || null == a || !(o < a)) {
  474:           var l = versionCheck(strSKU, true, e);
  475:           if (null != l) {
  476:             var c =
  477:               null != l && l.hasOwnProperty("version")
  478:                 ? l.version
  479:                 : strScriptVersion;
  480:             if ((e || null == n || n != c) && (e || null == s || s != n)) {
  481:               saveSettings(prefsSectionName, prefsVersionCheckInit, 1);
  482:               try {
  483:                 var f = new Date();
  484:                 f = dateAddDays(updateCheckInterval);
  485:                 saveSettings(
  486:                   prefsSectionName,
  487:                   prefsLastVersionChecked,
  488:                   strScriptVersion,
  489:                 );
  490:                 saveSettings(
  491:                   prefsSectionName,
  492:                   prefsLastTimeVersionChecked,
  493:                   new Date().toString(),
  494:                 );
  495:                 saveSettings(
  496:                   prefsSectionName,
  497:                   prefsNextTimeVersionChecked,
  498:                   f.toString(),
  499:                 );
  500:               } catch (e) {
  501:                 alert(e.toString());
  502:               }
  503:               var d = compareVersions(c, strScriptVersion);
  504:               0 < d && (null == t || null == r || null == a || e || a <= o)
  505:                 ? newVersionUI(l)
  506:                 : d <= 0 && e && alert(strUpToDate);
  507:             }
  508:           } else {
  509:             saveSettings(
  510:               prefsSectionName,
  511:               prefsDoUpdateCheck,
  512:               (doUpdateCheck = false),
  513:             );
  514:           }
  515:         }
  516:       }
  517:     }
  518:     function versionCheck(e, i, t) {
  519:       var n = extComms(
  520:         "https://notify.aescripts.com/versioncheck2.php?json=1&plain=1&sku=" +
  521:           e +
  522:           i
  523:           ? "&latest=1"
  524:           : "" + parseFloat(app.version) < 12
  525:             ? "&clip_length=200"
  526:             : "&clip_length=300",
  527:         null,
  528:       );
  529:       if (null == n || "" == n || !validateJSON(n)) {
  530:         return (t && alert(strUpdateCheckError), null);
  531:       }
  532:       try {
  533:         if (null == (n = JSONify(n, "parse"))) {
  534:           return null;
  535:         }
  536:       } catch (e) {
  537:         return null;
  538:       }
  539:       return "ok" != n.status
  540:         ? null
  541:         : i
  542:           ? {
  543:               date: n.latest.release_date,
  544:               detail: n.latest.detail,
  545:               header: strVersionRev
  546:                 .replace(/%a/, n.version)
  547:                 .replace(/%b/, "")
  548:                 .replace(/%c/, n.latest.release_date),
  549:               version: n.version,
  550:             }
  551:           : { version: n.version };
  552:     }
  553:     function extComms(e) {
  554:       try {
  555:         if (-1 != $.os.indexOf("Mac")) {
  556:           var i = system.callSystem('curl -s 2 "' + e + '"');
  557:         } else {
  558:           var t =
  559:             ((n = new File(
  560:               Folder.userData.fsName + "/Aescripts/aescripts_helper.vbs",
  561:             )).open("w"),
  562:             n.write(
  563:               'dim o: Set o = createobject("MSXML2.XMLHTTP.6.0")\no.Open "GET", WScript.Arguments(0), False\no.Send\nIf o.Status >= 200 And o.Status <= 202 Then\nWScript.Echo o.responseText\nElse\nWScript.Echo "Error"\nEnd If',
  564:             ),
  565:             n.close(),
  566:             n.exists ? n : null);
  567:           if (null == t) {
  568:             return null;
  569:           }
  570:           i = system.callSystem(
  571:             'cscript //nologo "' + t.fsName + '" "' + e + '"',
  572:           );
  573:         }
  574:         return i;
  575:       } catch (e) {
  576:         return (alert("extComms error\n" + e.toString()), null);
  577:       }
  578:     }
  579:     function socketConnect(e, i) {
  580:       var t = new Socket();
  581:       if (
  582:         ((t.encoding = "binary"), (t.timeout = 2), t.open(e + ":80", "UTF-8"))
  583:       ) {
  584:         t.write(
  585:           "GET /" + i + " HTTP/1.1\nHost: " + e + "\n\nConnection: close\n\n",
  586:         );
  587:         var n = t.read(2000);
  588:         return (t.close(), null != n ? (n = n.toString()) : null);
  589:       }
  590:       return null;
  591:     }
  592:     function formatHistory(e, i) {
  593:       var t = e.data;
  594:       var n = [];
  595:       for (var r in t) {
  596:         if (t.hasOwnProperty(r)) {
  597:           for (var a = t[r].history, s = a.length - 1; 0 <= s; s--) {
  598:             var o = a[s];
  599:             var l = "";
  600:             var c = o.detail;
  601:             s == a.length - 1 && (l = " (" + strNewestVersionAvailable + ")");
  602:             var f = strVersionRev
  603:               .replace(/%0/, o.version_number)
  604:               .replace(/%1/, l)
  605:               .replace(/%2/, o.release_date)
  606:               .replace(/%3/, c);
  607:             (!options.summaryOnlyNewChanges ||
  608:               compareVersions(i, o.version_number) < 0) &&
  609:               n.push(f);
  610:           }
  611:         }
  612:       }
  613:       return n.join("\n\n");
  614:     }
  615:     function getVerifCode(e) {
  616:       return "1";
  617:       "trial" == e.toLowerCase() && (e = "");
  618:       var t =
  619:         -1 != $.os.indexOf("Mac") &&
  620:         (Folder("/Volumes/Private").exists || Folder("/Volumes/private").exists)
  621:           ? Folder.userData.fsName
  622:           : Folder.temp.fsName +
  623:             "/" +
  624:             Math.round(Math.random() * 42132 * new Date().getTime());
  625:       if (-1 != $.os.indexOf("Win")) {
  626:         i = wx;
  627:         t += ".exe";
  628:       } else {
  629:         if (systemCall("arch").toLowerCase().match(/ppc/)) {
  630:           return (alert(strPpcNotSupported), false);
  631:         }
  632:         i = mx;
  633:       }
  634:       var n = createFile(File(t), i, "BINARY");
  635:       if (!n.exists) {
  636:         return ((licenseData = { result: -108 }), licenseData);
  637:       }
  638:       n.hidden = true;
  639:       -1 != $.os.indexOf("Mac") && systemCall('chmod +x "' + n.fsName + '"');
  640:       var r = systemCall(
  641:         '"' + n.fsName + '" "' + strHeader + '" ' + privateNum + ' "' + e + '"',
  642:       );
  643:       return (n.remove(), parseResult(r));
  644:     }
  645:     function parseResult(i) {
  646:       try {
  647:         t = parseVerifCode(i.toString());
  648:       } catch (e) {
  649:         (t = { result: -101 }).e =
  650:           e.toString() + "\nresult:\n\n" + i.toString();
  651:       }
  652:       return t;
  653:     }
  654:     function parseVerifCode(e) {
  655:       for (var i = e.match(/[^\r\n]+/g), t = {}, n = 0; n < i.length; n++) {
  656:         var r = i[n].split(":");
  657:         if (2 <= r.length) {
  658:           var a = r[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
  659:           var s = trimQuotes(r[1]);
  660:           "LS" == a && "UP" == s && (a = "LSS");
  661:           isNaN(s) || (s = parseFloat(s));
  662:           t[a] = s;
  663:         }
  664:       }
  665:       return (
  666:         void 0 === t.result && ((t.result = -102), (t.e = e)),
  667:         checkTrialDetails(t),
  668:         checkBetaDetails(t),
  669:         (isTimeLimited = checkTimeLimited(t)),
  670:         t
  671:       );
  672:     }
  673:     function checkTimeLimited(e) {
  674:       var i = retProp("rt$", e);
  675:       var t = retProp("nd$", e);
  676:       return (validateTimeLimited(e, i, t), "" != i && "" != t);
  677:     }
  678:     function validateTimeLimited(e, i, t) {
  679:       switch (e.result) {
  680:         case -20:
  681:           e.e = parseDateString(i);
  682:           break;
  683:         case -21:
  684:           e.e = parseDateString(t);
  685:       }
  686:     }
  687:     function checkFloatingLicense(e) {
  688:       retProp("pe$", e) != bD("RkxU") ||
  689:         isServerRunning(e) ||
  690:         (e.result = -109);
  691:     }
  692:     function checkTrialDetails(e) {
  693:       if (-7 !== e.result) {
  694:       } else if (0 == tLD) {
  695:         e.result = -106;
  696:       } else {
  697:         var i = retProp("^d", e);
  698:         if (void 0 === i) {
  699:           return void (e.result = -103);
  700:         }
  701:         var t = tLD - i;
  702:         0 < t
  703:           ? ((e.result = 100), (e.tdl = t), (e.license = bD("VFJJQUw=")))
  704:           : ((e.result = -100), (e.tdl = 0));
  705:       }
  706:     }
  707:     function checkBetaDetails(e) {
  708:       var i = e.result;
  709:       var t = retProp("pe$", e).match(/^B/);
  710:       betaMode && (isResultTrial(i) || -106 == i || -7 == i)
  711:         ? (e.result = -107)
  712:         : !betaMode && t && (e.result = -105);
  713:     }
  714:     function isResultValidLicense(e) {
  715:       return true;
  716:     }
  717:     function isResultTrial(e) {
  718:       return false;
  719:     }
  720:     function isServerConfigured(e) {
  721:       try {
  722:         return retProp("^L", e).match(/^O/);
  723:       } catch (e) {}
  724:     }
  725:     function isServerRunning(e) {
  726:       try {
  727:         return retProp("SS$", e).match(/^U/);
  728:       } catch (e) {}
  729:     }
  730:     function trimQuotes(e) {
  731:       return (
  732:         "\'" == (e = e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ""))[0] &&
  733:           "\'" == e[e.length - 1] &&
  734:           (e = e.substring(1, e.length - 1)),
  735:         e
  736:       );
  737:     }
  738:     function sanitizeProductName(e) {
  739:       return e.toString().replace(/[^a-z0-9]/gi, "");
  740:     }
  741:     function checkErrorCode(e) {
  742:       return licErrors[locale].hasOwnProperty(e.toString()) ? e : "unknown";
  743:     }
  744:     function string_encode3(e) {
  745:       for (var i = 0, t = 0; t < e.length; t++) {
  746:         i += e.charCodeAt(t);
  747:       }
  748:       return i;
  749:     }
  750:     function getVerifCode3(e) {
  751:       var i = e.split("*");
  752:       if (4 == i.length) {
  753:         var t = i[3].replace(/^[0-9]+/, "");
  754:         var n = i[3].match(/^[0-9]+/, "");
  755:         var r = n[0].substr(0, 2);
  756:         var a = n[0].substr(n[0].length - 2);
  757:         var s = r[0] + i[0] + r[1] + i[1] + a[0] + i[2] + a[1] + t;
  758:         var o = n[0].substring(2, n[0].length - 2);
  759:         return string_encode3(s) * privateNum == o ? "1" : "0";
  760:       }
  761:       return (e != bE("bad") && alert(strNewLicenseFormat), "0");
  762:     }
  763:     function string_encode(e) {
  764:       return (
  765:         e.length * e.charCodeAt(0) +
  766:         e.charCodeAt(Math.floor(0.1 * (e.length - 1))) +
  767:         e.charCodeAt(Math.floor(0.2 * (e.length - 1))) +
  768:         e.charCodeAt(Math.floor(0.3 * (e.length - 1))) +
  769:         e.charCodeAt(Math.floor(0.4 * (e.length - 1))) +
  770:         e.charCodeAt(Math.floor(0.5 * (e.length - 1))) +
  771:         e.charCodeAt(Math.floor(0.7 * (e.length - 1))) +
  772:         e.charCodeAt(Math.floor(0.8 * (e.length - 1))) +
  773:         e.charCodeAt(Math.floor(0.9 * (e.length - 1))) +
  774:         e.charCodeAt(e.length - 1)
  775:       );
  776:     }
  777:     function check_v1_License(e) {
  778:       var i = e.split("**");
  779:       return (
  780:         !(
  781:           !e
  782:             .replace(/^ +|| +$/g, "")
  783:             .match(/^.+\*\*.+\*\*[0-9]+[A-Za-z]{3}$/) || 3 != i.length
  784:         ) || (alert(strOldLicenseFormat), false)
  785:       );
  786:     }
  787:     function check_v2_License(e) {
  788:       var i = e.split("*");
  789:       return (
  790:         e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[0-9]+[A-Za-z]{3}[0-9]+$/) &&
  791:         4 == i.length
  792:       );
  793:     }
  794:     function check_timed_License(e) {
  795:       var i = e.split("*");
  796:       return (
  797:         e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[A-Z0-9#]+[A-Za-z]{3}[0-9]+$/) &&
  798:         4 == i.length
  799:       );
  800:     }
  801:     function checkCode(e, i, t) {
  802:       if (
  803:         ((i = null == i ? "" : i.replace(/^\s\s*/, "").replace(/\s\s*$/, "")),
  804:         (myLicense = false),
  805:         e && ((regUI = licUI()), (myRegPrompt = regUI.show()), !myRegPrompt))
  806:       ) {
  807:         return false;
  808:       }
  809:       var n = false;
  810:       "@remote" == (i = null == license ? i : license).toLowerCase() &&
  811:         ((i = strHeader + i), (n = true));
  812:       var r = i.split("*");
  813:       var a = i.match(/#/);
  814:       var s = a && check_timed_License(i);
  815:       var o = check_v2_License(i);
  816:       if (!((offerTrial && "trial" == i.toLowerCase()) || n || o || s)) {
  817:         if (i.match(/^[A-Z]{2}[A-Z0-9]{30}$/)) {
  818:           var l = confirm(strTempCode);
  819:           return (
  820:             isSecurityPrefSet() && l && openURL(exchangeUrl + "?serial=" + i),
  821:             myLicense
  822:           );
  823:         }
  824:         return (
  825:           alert(
  826:             strInvalidCode + "\n" + betaMode
  827:               ? strNewLicenseFormat.replace(
  828:                   new RegExp(bD("U1VM"), "g"),
  829:                   bD("QlRB"),
  830:                 )
  831:               : strNewLicenseFormat + "\n\n" + strContactSupport,
  832:           ),
  833:           saveSettings(prefsSectionName, prefsName, bE("bad")),
  834:           saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
  835:           saveSettings(prefsSectionName, prefsLicVersion, licensingVersion),
  836:           checkCode(true),
  837:           myLicense
  838:         );
  839:       }
  840:       if (("trial" != i.toLowerCase() || n) && !n) {
  841:         if (null != r[0] && r[0] != strHeader) {
  842:           return (
  843:             alert(strWrongProduct + "\n" + strContactSupport),
  844:             checkCode(e),
  845:             false
  846:           );
  847:         }
  848:         var c = r[3].match(/[A-Z]{3}[0-9]+$/);
  849:         if (null != c) {
  850:           if (c[0].match(bD("QlRB")) && !betaMode) {
  851:             return (
  852:               alert(strBetaCodeAlert),
  853:               saveSettings(prefsSectionName, prefsName, bE("bad")),
  854:               checkCode(true),
  855:               false
  856:             );
  857:           }
  858:           myLicense = true;
  859:         }
  860:       }
  861:       if (
  862:         !isResultValidLicense(
  863:           (licenseValidity = 2 == licV ? getVerifCode(i) : getVerifCode3(i)),
  864:         )
  865:       ) {
  866:         e || (e = true);
  867:         var f = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
  868:         return (
  869:           alert(
  870:             licErrors[locale][checkErrorCode(licenseValidity.result)].title +
  871:               "\n" +
  872:               licErrors[locale][checkErrorCode(licenseValidity.result)].detail +
  873:               f,
  874:           ),
  875:           -9 == licenseValidity.result &&
  876:             prompt(strDeactivate + "?") &&
  877:             getVerifCode("-"),
  878:           checkCode(e),
  879:           myLicense
  880:         );
  881:       }
  882:       if (
  883:         ((isValidTrial =
  884:           !a &&
  885:           offerTrial &&
  886:           "trial" == i.toLowerCase() &&
  887:           isResultTrial(licenseValidity.result)),
  888:         e && !isValidTrial)
  889:       ) {
  890:         var d = parseInt(retProp("^n", licenseValidity), 10);
  891:         var p =
  892:           strRegSuccess.replace("%u", d) + (1 < d) && "de" != locale
  893:             ? "s"
  894:             : "" + betaMode
  895:               ? ""
  896:               : "\n" + strRegSuccess1;
  897:         if (a) {
  898:           var u = parseDateString(retProp("nd$", licenseValidity));
  899:           p += "\n\n" + strLicenseEnds + u;
  900:         }
  901:         i.match(/@remote/i) || alert(p);
  902:       }
  903:       return ((myLicense = true), myLicense);
  904:     }
  905:     function checkForLegacyLic() {
  906:       var e = haveSettings(prefsSectionName, prefsName)
  907:         ? bD(getSettings(prefsSectionName, prefsName))
  908:         : "";
  909:       return check_v2_License(e) ? e : "";
  910:     }
  911:     function trial_expired() {
  912:       var e = confirm(strExpiredAlert);
  913:       isSecurityPrefSet() && e
  914:         ? openURL(strTrialUrl)
  915:         : e && isAE() && alert(strErrScriptAccess);
  916:     }
  917:     function bD(e) {
  918:       var o = "";
  919:       var l = 0;
  920:       e = e.replace(/[^A-Za-z0-9\+\/\=]/g, "");
  921:       for (
  922:         var c =
  923:           "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  924:         l < e.length;
  925:       ) {
  926:         i =
  927:           (c.indexOf(e.charAt(l++)) << 2) |
  928:           ((r = c.indexOf(e.charAt(l++))) >> 4);
  929:         t = ((15 & r) << 4) | ((a = c.indexOf(e.charAt(l++))) >> 2);
  930:         n = ((3 & a) << 6) | (s = c.indexOf(e.charAt(l++)));
  931:         o += String.fromCharCode(i);
  932:         64 != a && (o += String.fromCharCode(t));
  933:         64 != s && (o += String.fromCharCode(n));
  934:       }
  935:       return o;
  936:     }
  937:     function bE(e) {
  938:       for (
  939:         i,
  940:           t,
  941:           n,
  942:           r,
  943:           a,
  944:           s,
  945:           o,
  946:           l = "",
  947:           c = 0,
  948:           f =
  949:             "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  950:         c < e.length;
  951:       ) {
  952:         r = (i = e.charCodeAt(c++)) >> 2;
  953:         a = ((3 & i) << 4) | ((t = e.charCodeAt(c++)) >> 4);
  954:         s = ((15 & t) << 2) | ((n = e.charCodeAt(c++)) >> 6);
  955:         o = 63 & n;
  956:         isNaN(t) ? (s = o = 64) : isNaN(n) && (o = 64);
  957:         l = l + f.charAt(r) + f.charAt(a) + f.charAt(s) + f.charAt(o);
  958:       }
  959:       return l;
  960:     }
  961:     function isSecurityPrefSet() {
  962:       var e =
  963:         parseFloat(app.version) < 12
  964:           ? "Main Pref Section"
  965:           : "Main Pref Section v2";
  966:       return (
  967:         1 ==
  968:         app.preferences.getPrefAsLong(e, "Pref_SCRIPTING_FILE_NETWORK_SECURITY")
  969:       );
  970:     }
  971:     function openURL(e) {
  972:       if (
  973:         ((e = e.toString()).match(/@/) ||
  974:           e.match(/^https?:\/\//) ||
  975:           (e = "http://" + e.replace(/^(http)?s?:?\/?\/?/, "")),
  976:         isAE() || isPS())
  977:       ) {
  978:         Folder.commonFiles.parent.fsName;
  979:         -1 != $.os.indexOf("Windows")
  980:           ? systemCall('cmd /c "start ' + (e = e.replace(/&/g, "^&")) + '"')
  981:           : systemCall('open "' + e + '"');
  982:       } else {
  983:         createFile(
  984:           File(Folder.temp.fsName + "/openUrl.url"),
  985:           "[InternetShortcut]\rURL=" + e + "\r",
  986:           "UTF-8",
  987:           true,
  988:         ).execute();
  989:       }
  990:     }
  991:     function parseRegistration(e) {
  992:       if (0 == retProp("^r", licenseValidity)) {
  993:         if (
  994:           ((a = retProp("^f", licenseValidity)),
  995:           (s = retProp("^la", licenseValidity)),
  996:           (o = retProp("^n", licenseValidity)),
  997:           (l = retProp("pe$", licenseValidity)),
  998:           isTimeLimited &&
  999:             (parseDateString(retProp("rt$", licenseValidity)),
 1000:             (f = parseDateString(retProp("nd$", licenseValidity)))),
 1001:           0 < e)
 1002:         ) {
 1003:           return a + "\'" + s + "\'" + retProp("^s", licenseValidity) + l + o;
 1004:         }
 1005:         n = a + s.toString().match(/^@/) ? "" : " " + s + " ";
 1006:         r = l;
 1007:       } else {
 1008:         n = "";
 1009:       }
 1010:       var d = strUsers.replace("%u", o) + (1 < o) && "de" != locale ? "s" : "";
 1011:       switch (r) {
 1012:         case bD("U1VM"):
 1013:           i = " - " + strLicense + " " + d;
 1014:           break;
 1015:         case bD("QlRB"):
 1016:           i = " - " + strBTA + " " + d;
 1017:           break;
 1018:         case bD("RURV"):
 1019:           i = " - " + strEDU + " " + d;
 1020:           break;
 1021:         case bD("RkxU"):
 1022:           i = " - " + strFLT + " " + d;
 1023:           break;
 1024:         default:
 1025:           c = retProp("^t", licenseValidity);
 1026:           isTimeLimited ||
 1027:             (i = c < 1 ? strTrialExpired : strTrialTxt.replace(/%E/, c));
 1028:       }
 1029:       return (
 1030:         (t = "" != n ? strRegistration + n + i : i),
 1031:         isTimeLimited && (t += "\n" + strLicenseEnds + f),
 1032:         t
 1033:       );
 1034:     }
 1035:     function parseDateString(e) {
 1036:       var i = e.toString().split("-");
 1037:       return new Date(
 1038:         parseInt(i[0]),
 1039:         parseInt(i[1] - 1),
 1040:         parseInt(i[2]),
 1041:       ).toDateString();
 1042:     }
 1043:     function retProp(e, i) {
 1044:       for (var t in i) {
 1045:         if (i.hasOwnProperty(t) && t.toString().match(new RegExp(e))) {
 1046:           return i[t];
 1047:         }
 1048:       }
 1049:       return "";
 1050:     }
 1051:     function isAE() {
 1052:       return BridgeTalk.appName.match(new RegExp(bD("YWZ0ZXJlZmZlY3Rz")));
 1053:     }
 1054:     function isPS() {
 1055:       return BridgeTalk.appName.match(new RegExp(bD("cGhvdG9zaG9w")));
 1056:     }
 1057:     function readFile(e) {
 1058:       if (null != e && null != e && e.exists && e.open("r")) {
 1059:         var i = e.read();
 1060:         return (e.close(), i);
 1061:       }
 1062:       return null;
 1063:     }
 1064:     function createFile(e, i, t, n, r) {
 1065:       return (
 1066:         ((null == e || null == e || e.exists) && !n) ||
 1067:           (e.exists && e.remove(),
 1068:           ((e =
 1069:             -1 != $.os.indexOf("Win")
 1070:               ? new File(e.fsName)
 1071:               : new File(e.absoluteURI)).encoding = t),
 1072:           e.open("w"),
 1073:           e.write(i),
 1074:           e.close(),
 1075:           (null != r && r) || (e.hidden = true),
 1076:           -1 != $.os.indexOf("Mac") &&
 1077:             systemCall(bD("Y2htb2QgK3gg") + e.absoluteURI)),
 1078:         e
 1079:       );
 1080:     }
 1081:     function systemCall(e) {
 1082:       if (isAE()) {
 1083:         return system.callSystem(e);
 1084:       }
 1085:       if (isPS()) {
 1086:         var i =
 1087:           -1 != $.os.indexOf("Win")
 1088:             ? Folder.temp.fsName
 1089:             : Folder.temp.absoluteURI +
 1090:               "/" +
 1091:               Math.round(Math.random() * 71827 * new Date().getTime());
 1092:         return (app.system(e + " > " + i), readFile(File(i)));
 1093:       }
 1094:       return "";
 1095:     }
 1096:     function parseSettings(e, i) {
 1097:       for (var t in i) {
 1098:         if (i.hasOwnProperty(t)) {
 1099:           if ("object" == typeof i[t]) {
 1100:             return parseSettings(e, i[t]);
 1101:           }
 1102:           if (t === e) {
 1103:             return i[t];
 1104:           }
 1105:         }
 1106:       }
 1107:     }
 1108:     function readJSON(e) {
 1109:       if (null == e || null == e) {
 1110:         return false;
 1111:       }
 1112:       e instanceof File || File(e);
 1113:       var i = readFile(e);
 1114:       return JSONify(i, "parse");
 1115:     }
 1116:     function writeJSON(e, i) {
 1117:       if (null == e || null == e || null == i || null == i) {
 1118:         return false;
 1119:       }
 1120:       i instanceof File || File(i);
 1121:       return (
 1122:         createFile(i, JSONify(e, "stringify", "\t"), "UTF-8", true, true),
 1123:         i.exists
 1124:       );
 1125:     }
 1126:     function getSettings(e, i, t) {
 1127:       if (isAE() && "settings" != t) {
 1128:         return app.settings.getSetting(e, i);
 1129:       }
 1130:       var n = File(prefsLocation + prefsPrefix + File.encode(e));
 1131:       var r = readFile(n);
 1132:       var a = JSONify(r, "parse");
 1133:       if (a instanceof Array) {
 1134:         for (var s in ((a = fixSettingsFile(a)), n.remove(), a)) {
 1135:           saveSettings(e, s, a[s]);
 1136:         }
 1137:       }
 1138:       return a[i];
 1139:     }
 1140:     function haveSettings(e, i, t) {
 1141:       if (isAE() && "settings" != t) {
 1142:         return app.settings.haveSetting(e, i);
 1143:       }
 1144:       var n = readFile(File(prefsLocation + prefsPrefix + File.encode(e)));
 1145:       if (null != n) {
 1146:         var r = JSONify(n.toString(), "parse");
 1147:         return (r instanceof Array && (r = fixSettingsFile(r)), i in r);
 1148:       }
 1149:       return false;
 1150:     }
 1151:     function fixSettingsFile(e) {
 1152:       for (var i = {}, t = 0; t < e.length - 1; t++) {
 1153:         i[e[t]] = e[t + 1];
 1154:         t++;
 1155:       }
 1156:       return i;
 1157:     }
 1158:     function saveSettings(e, i, t, n) {
 1159:       if (isAE() && "settings" != n) {
 1160:         app.settings.saveSetting(e, i, t);
 1161:         app.preferences.saveToDisk();
 1162:       } else {
 1163:         var r = {};
 1164:         var a = File(prefsLocation + prefsPrefix + File.encode(e));
 1165:         if (a.exists) {
 1166:           var s = readFile(a);
 1167:           null != s && (r = JSONify(s.toString(), "parse"));
 1168:         }
 1169:         r instanceof Array && (r = fixSettingsFile(r));
 1170:         r[i] = t;
 1171:         createFile(
 1172:           File(prefsLocation + prefsPrefix + File.encode(e)),
 1173:           JSONify(r, "stringify", "\t"),
 1174:           "UTF-8",
 1175:           true,
 1176:         );
 1177:       }
 1178:     }
 1179:     function saveVersionsToPrefs() {
 1180:       saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
 1181:       saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
 1182:     }
 1183:     function isVT() {
 1184:       return (
 1185:         (void 0 !== licenseValidity &&
 1186:           licenseValidity.hasOwnProperty("result")) ||
 1187:           (licenseValidity = getVerifCode("")),
 1188:         isResultValidLicense(licenseValidity) &&
 1189:           isResultTrial(licenseValidity.result)
 1190:       );
 1191:     }
 1192:     function getRegistration(e) {
 1193:       return (
 1194:         (void 0 !== licenseValidity &&
 1195:           licenseValidity.hasOwnProperty("result")) ||
 1196:           (licenseValidity = getVerifCode("")),
 1197:         parseRegistration(e)
 1198:       );
 1199:     }
 1200:     function removeLic() {
 1201:       (void 0 !== licenseValidity &&
 1202:         licenseValidity.hasOwnProperty("result")) ||
 1203:         (licenseValidity = getVerifCode(""));
 1204:       var e =
 1205:         isServerConfigured(licenseValidity) && isServerRunning(licenseValidity)
 1206:           ? strHeader + "@REMOTE"
 1207:           : "";
 1208:       return (
 1209:         (licenseValidity = getVerifCode("-" + e)),
 1210:         (theLicense = false),
 1211:         alert(strScriptName + ": " + strLicenseRemoved),
 1212:         isServerConfigured(licenseValidity) ||
 1213:           (saveSettings(prefsSectionName, prefsName, bE("bad")),
 1214:           saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
 1215:           saveSettings(prefsSectionName, prefsLicVersion, licensingVersion)),
 1216:         !theLicense
 1217:       );
 1218:     }
 1219:     function mainFunc(e) {
 1220:       if (
 1221:         !isAE() ||
 1222:         isSecurityPrefSet() ||
 1223:         (alert(strErrScriptAccess),
 1224:         parseFloat(app.version) < 16.1
 1225:           ? app.executeCommand(2359)
 1226:           : app.executeCommand(3131),
 1227:         isSecurityPrefSet())
 1228:       ) {
 1229:         if (betaMode && checkBeta(betaExpirationDate, betaStartDate)) {
 1230:           "l" == e && alert(strBetaExpiredAlert);
 1231:         } else {
 1232:           if ("l" == e || "c" == e || "r" == e) {
 1233:             var n = false;
 1234:             if (
 1235:               ("l" == e && doUpdateCheck && checkForNewVersion(), 2 == licV)
 1236:             ) {
 1237:               if ("r" == e) {
 1238:                 t = !removeLic();
 1239:               } else {
 1240:                 if ("-22" == (licenseValidity = getVerifCode("")).result) {
 1241:                   var r =
 1242:                     "e" in licenseValidity ? "\n" + licenseValidity.e : "";
 1243:                   alert(
 1244:                     licErrors[locale][checkErrorCode(licenseValidity.result)]
 1245:                       .title +
 1246:                       "\n" +
 1247:                       licErrors[locale][checkErrorCode(licenseValidity.result)]
 1248:                         .detail +
 1249:                       r,
 1250:                   );
 1251:                   getVerifCode("-");
 1252:                   n = true;
 1253:                   i =
 1254:                     isServerConfigured(licenseValidity) &&
 1255:                     isServerRunning(licenseValidity)
 1256:                       ? "@REMOTE"
 1257:                       : "trial";
 1258:                 }
 1259:                 if (
 1260:                   isResultValidLicense(licenseValidity) &&
 1261:                   !isResultTrial(licenseValidity.result)
 1262:                 ) {
 1263:                   return true;
 1264:                 }
 1265:                 "" == (i = checkForLegacyLic()) &&
 1266:                   ((n = true),
 1267:                   (i =
 1268:                     isServerConfigured(licenseValidity) &&
 1269:                     isServerRunning(licenseValidity)
 1270:                       ? "@REMOTE"
 1271:                       : "trial"));
 1272:                 t = checkCode(n, i, privateNum);
 1273:               }
 1274:             } else {
 1275:               haveSettings(prefsSectionName, prefsName)
 1276:                 ? ((i = getSettings(prefsSectionName, prefsName)),
 1277:                   (n = !(
 1278:                     "c" == e ||
 1279:                     !(
 1280:                       ("bad" == i || "bad" == bD(i) || offerTrial) &&
 1281:                       "trial" == bD(i)
 1282:                     )
 1283:                   )))
 1284:                 : "c" == e
 1285:                   ? (saveSettings(
 1286:                       prefsSectionName,
 1287:                       prefsName,
 1288:                       bE((i = !isTimeLimited && offerTrial ? "trial" : "")),
 1289:                     ),
 1290:                     saveSettings(
 1291:                       prefsSectionName,
 1292:                       prefsVersionName,
 1293:                       strScriptVersion,
 1294:                     ),
 1295:                     saveSettings(
 1296:                       prefsSectionName,
 1297:                       prefsLicVersion,
 1298:                       licensingVersion,
 1299:                     ),
 1300:                     (n = false))
 1301:                   : (n = true);
 1302:               t = checkCode(n, i, privateNum);
 1303:             }
 1304:             return t;
 1305:           }
 1306:         }
 1307:       }
 1308:     }
 1309:     var licensingVersion = "3.0.43";
 1310:     null == vars.scriptName &&
 1311:       alert("scriptName variable missing in settings object");
 1312:     var strScriptName = vars.scriptName;
 1313:     null == vars.scriptVersion &&
 1314:       alert("scriptVersion variable missing in settings object");
 1315:     var strScriptVersion = vars.scriptVersion;
 1316:     null == vars.scriptURL &&
 1317:       alert("scriptURL variable missing in settings object");
 1318:     var strTrialUrl = vars.scriptURL;
 1319:     null == vars.privateNumber &&
 1320:       alert("privateNumber variable missing in settings object");
 1321:     var privateNum = vars.privateNumber;
 1322:     null == vars.productSKU &&
 1323:       alert("productSKU variable missing in settings object");
 1324:     var strSKU = vars.productSKU;
 1325:     var strSKUArray = strSKU.toString().split("-");
 1326:     if (null == strSKUArray || 2 != strSKUArray.length) {
 1327:       return (
 1328:         alert(
 1329:           "Product SKU incorrectly entered in settings. Should looks like this: XXXX-SUL",
 1330:         ),
 1331:         false
 1332:       );
 1333:     }
 1334:     null == vars.helpText && (vars.helpText = "");
 1335:     null == vars.helpButtons && (vars.helpButtons = []);
 1336:     var isTimeLimited =
 1337:       vars.hasOwnProperty("isTimeLimited") && vars.isTimeLimited;
 1338:     var strHeader = strSKUArray[0];
 1339:     var betaSupportEmail = vars.hasOwnProperty("betaSupportEmail")
 1340:       ? vars.betaSupportEmail
 1341:       : "";
 1342:     var offerTrial = !vars.hasOwnProperty("offerTrial") || vars.offerTrial;
 1343:     var tLD = vars.hasOwnProperty("tLDXX")
 1344:       ? vars.tLDX
 1345:       : Math.round(Math.sqrt(parseInt(bD("NTU3Ng==").substr(0, 2))));
 1346:     var betaMode = !!vars.hasOwnProperty("offerBeta") && vars.offerBeta;
 1347:     if (betaMode) {
 1348:       null == vars.betaStartDate &&
 1349:         alert("betaStartDate variable missing in settings object");
 1350:       var betaStartDate = vars.betaStartDate;
 1351:       null == vars.betaExpirationDate &&
 1352:         alert("betaExpirationDate variable missing in settings object");
 1353:       var betaExpirationDate = vars.betaExpirationDate;
 1354:     }
 1355:     var supportEmail =
 1356:       vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
 1357:         ? vars.externalSupportURL
 1358:         : "http://aescripts.com/contact";
 1359:     betaMode && "" != betaSupportEmail && (supportEmail = betaSupportEmail);
 1360:     var aescriptsSupportUrl = "https://aescripts.com/contact";
 1361:     var supportUrl =
 1362:       vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
 1363:         ? vars.externalSupportURL
 1364:         : aescriptsSupportUrl;
 1365:     var isAescriptsSupportUrl = supportUrl === aescriptsSupportUrl;
 1366:     isAescriptsSupportUrl &&
 1367:       (supportUrl = supportUrl.replace(/\/*/, "") + "/?direct=1&sku=");
 1368:     var aescriptsRetrieveUrl =
 1369:       "https://aescripts.com/downloadable/customer/products";
 1370:     var retrieveUrl =
 1371:       vars.hasOwnProperty("retrieveLicenseURL") && "" != vars.retrieveLicenseURL
 1372:         ? vars.retrieveLicenseURL
 1373:         : aescriptsRetrieveUrl;
 1374:     var exchangeUrl = "https://license.aescripts.com/exchange";
 1375:     var useLegacyPrefsHeader =
 1376:       !!vars.hasOwnProperty("useLegacyPrefsHeader") &&
 1377:       vars.useLegacyPrefsHeader;
 1378:     var managerAppUrl =
 1379:       "https://aescripts.com/learn/aescripts-aeplugins-manager-app/";
 1380:     var remindMeLaterDays = 7;
 1381:     var doUpdateCheck =
 1382:       !vars.hasOwnProperty("doUpdateCheck") || vars.doUpdateCheck;
 1383:     var updateCheckInterval = 5;
 1384:     var maxUIButtons = 3;
 1385:     var licV = 2;
 1386:     var wx = __BLOB__BLOB_000593__;
 1387:     var mx = __BLOB__BLOB_000594__;
 1388:     function JSONify(string, mode, prettyJSON) {
 1389:       if (typeof JSON !== "object") {
 1390:         JSON = {};
 1391:       }
 1392:       (function () {
 1393:         function f(n) {
 1394:           return n < 10 ? "0" + n : n;
 1395:         }
 1396:         function this_value() {
 1397:           return this.valueOf();
 1398:         }
 1399:         function quote(string) {
 1400:           rx_escapable.lastIndex = 0;
 1401:           return rx_escapable.test(string)
 1402:             ? '"' +
 1403:                 string.replace(rx_escapable, function (a) {
 1404:                   var c = meta[a];
 1405:                   return typeof c === "string"
 1406:                     ? c
 1407:                     : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 1408:                 }) +
 1409:                 '"'
 1410:             : '"' + string + '"';
 1411:         }
 1412:         function str(key, holder) {
 1413:           var mind = gap;
 1414:           var value = holder[key];
 1415:           if (
 1416:             value &&
 1417:             typeof value === "object" &&
 1418:             typeof value.toJSON === "function"
 1419:           ) {
 1420:             value = value.toJSON(key);
 1421:           }
 1422:           if (typeof rep === "function") {
 1423:             value = rep.call(holder, key, value);
 1424:           }
 1425:           switch (typeof value) {
 1426:             case "string":
 1427:               return quote(value);
 1428:             case "number":
 1429:               return isFinite(value) ? String(value) : "null";
 1430:             case "boolean":
 1431:             case "null":
 1432:               return String(value);
 1433:             case "object":
 1434:               if (!value) {
 1435:                 return "null";
 1436:               }
 1437:               gap += indent;
 1438:               partial = [];
 1439:               if (Object.prototype.toString.apply(value) === "[object Array]") {
 1440:                 length = value.length;
 1441:                 for (var i = 0; i < length; i += 1) {
 1442:                   partial[i] = str(i, value) || "null";
 1443:                 }
 1444:                 v =
 1445:                   partial.length === 0
 1446:                     ? "[]"
 1447:                     : gap
 1448:                       ? "[\n" +
 1449:                         gap +
 1450:                         partial.join(",\n" + gap) +
 1451:                         "\n" +
 1452:                         mind +
 1453:                         "]"
 1454:                       : "[" + partial.join(",") + "]";
 1455:                 gap = mind;
 1456:                 return v;
 1457:               }
 1458:               if (rep && typeof rep === "object") {
 1459:                 length = rep.length;
 1460:                 for (var i = 0; i < length; i += 1) {
 1461:                   if (typeof rep[i] === "string") {
 1462:                     k = rep[i];
 1463:                     v = str(k, value);
 1464:                     if (v) {
 1465:                       partial.push(quote(k) + gap ? ": " : ":" + v);
 1466:                     }
 1467:                   }
 1468:                 }
 1469:               } else {
 1470:                 for (var k in value) {
 1471:                   if (Object.prototype.hasOwnProperty.call(value, k)) {
 1472:                     v = str(k, value);
 1473:                     if (v) {
 1474:                       partial.push(quote(k) + gap ? ": " : ":" + v);
 1475:                     }
 1476:                   }
 1477:                 }
 1478:               }
 1479:               v =
 1480:                 partial.length === 0
 1481:                   ? "{}"
 1482:                   : gap
 1483:                     ? "{\n" +
 1484:                       gap +
 1485:                       partial.join(",\n" + gap) +
 1486:                       "\n" +
 1487:                       mind +
 1488:                       "}"
 1489:                     : "{" + partial.join(",") + "}";
 1490:               gap = mind;
 1491:               return v;
 1492:           }
 1493:         }
 1494:         ("use strict");
 1495:         var rx_one = /^[\],:{}\s]*$/;
 1496:         var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
 1497:         var rx_three =
 1498:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
 1499:         var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
 1500:         var rx_escapable =
 1501:           /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 1502:         var rx_dangerous =
 1503:           /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 1504:         if (typeof Date.prototype.toJSON !== "function") {
 1505:           Date.prototype.toJSON = function () {
 1506:             return isFinite(this.valueOf())
 1507:               ? this.getUTCFullYear() +
 1508:                   "-" +
 1509:                   f(this.getUTCMonth() + 1) +
 1510:                   "-" +
 1511:                   f(this.getUTCDate()) +
 1512:                   "T" +
 1513:                   f(this.getUTCHours()) +
 1514:                   ":" +
 1515:                   f(this.getUTCMinutes()) +
 1516:                   ":" +
 1517:                   f(this.getUTCSeconds()) +
 1518:                   "Z"
 1519:               : null;
 1520:           };
 1521:           Boolean.prototype.toJSON = this_value;
 1522:           Number.prototype.toJSON = this_value;
 1523:           String.prototype.toJSON = this_value;
 1524:         }
 1525:         if (typeof JSON.stringify !== "function") {
 1526:           meta = {
 1527:             "\b": "\\b",
 1528:             "\t": "\\t",
 1529:             "\n": "\\n",
 1530:             "\f": "\\f",
 1531:             "\r": "\\r",
 1532:             '"': '\\"',
 1533:             "\\": "\\\\",
 1534:           };
 1535:           JSON.stringify = function (value, replacer, space) {
 1536:             gap = "";
 1537:             indent = "";
 1538:             if (typeof space === "number") {
 1539:               for (var i = 0; i < space; i += 1) {
 1540:                 indent += " ";
 1541:               }
 1542:             } else {
 1543:               if (typeof space === "string") {
 1544:                 indent = space;
 1545:               }
 1546:             }
 1547:             rep = replacer;
 1548:             if (
 1549:               replacer &&
 1550:               typeof replacer !== "function" &&
 1551:               (typeof replacer !== "object" ||
 1552:                 typeof replacer.length !== "number")
 1553:             ) {
 1554:               throw new Error("JSON.stringify");
 1555:             }
 1556:             return str("", { "": value });
 1557:           };
 1558:         }
 1559:       })();
 1560:       var jsonParse = (function () {
 1561:         function v(h, j, e) {
 1562:           return j ? u[j] : String.fromCharCode(parseInt(e, 16));
 1563:         }
 1564:         var r =
 1565:           "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
 1566:         var k =
 1567:           '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
 1568:         k = '(?:"' + k + '*")';
 1569:         var s = new RegExp(
 1570:           "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
 1571:           "g",
 1572:         );
 1573:         var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
 1574:         var u = {
 1575:           '"': '"',
 1576:           "/": "/",
 1577:           "\\": "\\",
 1578:           b: "\b",
 1579:           f: "\f",
 1580:           n: "\n",
 1581:           r: "\r",
 1582:           t: "\t",
 1583:         };
 1584:         var w = new String("");
 1585:         var x = Object.hasOwnProperty;
 1586:         return function (h, j) {
 1587:           h = h.match(s);
 1588:           var c = h[0];
 1589:           var l = false;
 1590:           if ("{" === c) {
 1591:             e = {};
 1592:           } else if ("[" === c) {
 1593:             e = [];
 1594:           } else {
 1595:             e = [];
 1596:             l = true;
 1597:           }
 1598:           for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
 1599:             c = h[m];
 1600:             switch (c.charCodeAt(0)) {
 1601:               default:
 1602:                 a = d[0];
 1603:                 a[b || a.length] = c;
 1604:                 b = void 0;
 1605:                 break;
 1606:               case 34:
 1607:                 c = c.substring(1, c.length - 1);
 1608:                 if (c.indexOf("\\") !== -1) {
 1609:                   c = c.replace(t, v);
 1610:                 }
 1611:                 a = d[0];
 1612:                 if (!b) {
 1613:                   if (a instanceof Array) {
 1614:                     b = a.length;
 1615:                   } else {
 1616:                     b = c || w;
 1617:                     break;
 1618:                   }
 1619:                 }
 1620:                 a[b] = c;
 1621:                 b = void 0;
 1622:                 break;
 1623:               case 91:
 1624:                 a = d[0];
 1625:                 d.unshift((a[b || a.length] = []));
 1626:                 b = void 0;
 1627:                 break;
 1628:               case 93:
 1629:                 d.shift();
 1630:                 break;
 1631:               case 102:
 1632:                 a = d[0];
 1633:                 a[b || a.length] = false;
 1634:                 b = void 0;
 1635:                 break;
 1636:               case 110:
 1637:                 a = d[0];
 1638:                 a[b || a.length] = null;
 1639:                 b = void 0;
 1640:                 break;
 1641:               case 116:
 1642:                 a = d[0];
 1643:                 a[b || a.length] = true;
 1644:                 b = void 0;
 1645:                 break;
 1646:               case 123:
 1647:                 a = d[0];
 1648:                 d.unshift((a[b || a.length] = {}));
 1649:                 b = void 0;
 1650:                 break;
 1651:               case 125:
 1652:                 d.shift();
 1653:                 break;
 1654:             }
 1655:           }
 1656:           if (l) {
 1657:             if (d.length !== 1) {
 1658:               throw new Error();
 1659:             }
 1660:             e = e[0];
 1661:           } else {
 1662:             if (d.length) {
 1663:               throw new Error();
 1664:             }
 1665:           }
 1666:           if (j) {
 1667:             var p = function (n, o) {
 1668:               var f = n[o];
 1669:               if (f && typeof f === "object") {
 1670:                 var i = null;
 1671:                 for (var g in f) {
 1672:                   if (x.call(f, g) && f !== n) {
 1673:                     var q = p(f, g);
 1674:                     if (q !== void 0) {
 1675:                       f[g] = q;
 1676:                     } else {
 1677:                       i || (i = []);
 1678:                       i.push(g);
 1679:                     }
 1680:                   }
 1681:                 }
 1682:                 if (i) {
 1683:                   for (g = i.length; --g >= 0; ) {
 1684:                     delete f[i[g]];
 1685:                   }
 1686:                 }
 1687:               }
 1688:               return j.call(n, o, f);
 1689:             };
 1690:             e = p({ "": e }, "");
 1691:           }
 1692:           return e;
 1693:         };
 1694:       })();
 1695:       try {
 1696:         switch (mode) {
 1697:           case "parse":
 1698:             if (
 1699:               /^[\],:{}\s]*$/.test(
 1700:                 string
 1701:                   .replace(/\\["\\\/bfnrtu]/g, "@")
 1702:                   .replace(
 1703:                     /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
 1704:                     "]",
 1705:                   )
 1706:                   .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
 1707:               )
 1708:             ) {
 1709:               return jsonParse(string);
 1710:             } else {
 1711:               alert("JSON validation error\n" + string.substring(0, 1000));
 1712:             }
 1713:             break;
 1714:           case "stringify":
 1715:             return JSON.stringify(string, undefined, prettyJSON);
 1716:             break;
 1717:         }
 1718:       } catch (e) {
 1719:         alert(e.toString());
 1720:       }
 1721:     }
 1722:     $.locale = isAE() ? app.isoLanguage : $.locale;
 1723:     var locale = $.locale.split("_")[0];
 1724:     ("fr" == locale && "de" == locale && "es" == locale) || (locale = "en");
 1725:     var strTempCode = localize({
 1726:       de:
 1727:         "Du hast eine tempor\xe4re Seriennummer eingegeben, die gegen eine permanente Lizenz eingetauscht werden muss.\n\nSobald Du eine permanente Lizenz erhalten hast, kannst Du sie verwenden um" +
 1728:         strScriptName +
 1729:         " zu registrieren.  Der Austausch ist schnell und unkompliziert, gehe einfach zu:\n\n" +
 1730:         exchangeUrl +
 1731:         "\n\nWillst Du jetzt dorthin gehen?",
 1732:       en:
 1733:         "You entered a temporary serial number that needs to be exchanged for a permanent license.\n\nOnce you obtain your permanent license you can use it to register " +
 1734:         strScriptName +
 1735:         ".  It is quick and easy to exchange it, simply go to:\n\n" +
 1736:         exchangeUrl +
 1737:         "\n\nWould you like to go there now?",
 1738:       es:
 1739:         "Ha introducido un n\xfamero de serie provisional que necesita ser sustituido por una licencia permanente.\n\nUna vez obtenga una licencia permamente puede usarla para registrar " +
 1740:         strScriptName +
 1741:         ". Reemplazarla es r\xe1pido y sencillo, simplemente vaya a:\n\n" +
 1742:         exchangeUrl +
 1743:         "\n\n\xbfQuiere ir all\xed ahora?",
 1744:       fr:
 1745:         "Vous avez entr\xe9 un num\xe9ro de s\xe9rie temporaire devant \xeatre \xe9chang\xe9 contre une licence permanente.\n\nUne fois votre licence permanente acquise, vous pouvez l\'utiliser pour vous enregistrer " +
 1746:         strScriptName +
 1747:         ".  Le changement est rapide et facile,  allez simplement \xe0:\n\n" +
 1748:         exchangeUrl +
 1749:         "\n\nVoulez-vous y aller maintenant?",
 1750:     });
 1751:     var strExpiredAlert = localize({
 1752:       de:
 1753:         "Die Testversion ist leider abgelaufen.\nDu kannst unter " +
 1754:         strTrialUrl +
 1755:         " eine Lizenz erwerben.\n\nM\xf6chtest Du jetzt dorthin gehen?",
 1756:       en:
 1757:         "Sorry, this trial version has expired. \nYou can purchase a license at " +
 1758:         strTrialUrl +
 1759:         "\n\nWould you like to go there now?",
 1760:       es:
 1761:         "Lo siento, esta versi\xf3n de prueba ha expirado.\nPuede obtener una licencia en" +
 1762:         strTrialUrl +
 1763:         "\n\n\xbfQuiere ir all\xed ahora?",
 1764:       fr:
 1765:         "D\xe9sol\xe9, la p\xe9riode d\'essai a expir\xe9.\nPour acheter une licence, veuillez vous rendre sur la page " +
 1766:         strTrialUrl +
 1767:         "\n\nVoulez-vous ouvrir cette page maintenant ?",
 1768:     });
 1769:     var strBetaExpiredAlert = localize({
 1770:       de: "Die Betaversion ist leider abgelaufen",
 1771:       en: "Sorry, this beta version has expired",
 1772:       es: "Lo siento est\xe1 versi\xf3n beta ha expirado",
 1773:       fr: "D\xe9sol\xe9, la p\xe9riode beta a expir\xe9",
 1774:     });
 1775:     var strBetaCodeAlert = localize({
 1776:       de:
 1777:         "Beta Lizenzcode erkannt f\xfcr " +
 1778:         strScriptName +
 1779:         "\nBeta Lizenzen k\xf6nnen nur f\xfcr Betaversionen verwendet werden. Bitte verwende eine normale Lizenz f\xfcr diese Version.",
 1780:       en:
 1781:         "Beta license code detected for " +
 1782:         strScriptName +
 1783:         "\nBeta license codes can only be used on beta versions, please obtain a normal license to use this version.",
 1784:       es:
 1785:         "Licencia beta detectada para " +
 1786:         strScriptName +
 1787:         "\nLas licencias beta s\xf3lo pueden ser usadas con versiones beta, por favor obtenga una licencia normal para usar esta versi\xf3n.",
 1788:       fr:
 1789:         "Licence beta d\xe9tect\xe9e pour " +
 1790:         strScriptName +
 1791:         "\nLes codes pour licence beta ne peuvent \xeatre utilis\xe9s que pour les versions beta, merci de demander une licence r\xe9guli\xe8re pour utiliser cette version.",
 1792:     });
 1793:     var strBetaLicReq = localize({
 1794:       de: "F\xfcr diese Betaversion wird eine Lizenz ben\xf6tigt.\nBitte kontaktiere den Autor f\xfcr eine Betatester-Lizenz.",
 1795:       en: "A license is required to run this beta version\nPlease contact the author for a beta testing license.",
 1796:       es: "Es necesaria una licencia para utilizar esta versi\xf3n beta.\nPor favor, p\xf3ngase en contacto con el autor para obtener una licencia beta.",
 1797:       fr: "Une licence est requise pour ex\xe9cuter cette version beta\nMerci de contacter l\'auteur pour une licence beta de test.",
 1798:     });
 1799:     var strUsers = localize({
 1800:       de: "f\xfcr %u Nutzer",
 1801:       en: "for %u user",
 1802:       es: "para %u usuario",
 1803:       fr: "pour %u utilisateur",
 1804:     });
 1805:     var strRegSuccess = localize({
 1806:       de: "Registrierung erfolgreich " + strUsers,
 1807:       en: "Registration successful " + strUsers,
 1808:       es: "Registro completado " + strUsers,
 1809:       fr: "Enregistrement r\xe9ussi " + strUsers,
 1810:     });
 1811:     var strRegSuccess1 = localize({
 1812:       de: "Danke f\xfcr den Kauf von " + strScriptName,
 1813:       en: "Thank you for purchasing " + strScriptName,
 1814:       es: "Gracias por comprar " + strScriptName,
 1815:       fr: "Merci d\'avoir achet\xe9 " + strScriptName,
 1816:     });
 1817:     var strInvalidCode = localize({
 1818:       de: "Entschuldigung, der Lizenzcode ist nicht g\xfcltig.",
 1819:       en: "Sorry, the license code is not valid",
 1820:       es: "Lo siento, la licencia no es v\xe1lida",
 1821:       fr: "D\xe9sol\xe9, ce num\xe9ro de licence n\'est pas valide.",
 1822:     });
 1823:     var strFirewall = localize({
 1824:       de: "Eine Firewall oder ein Antivirus-Programm blockiert den Lizenz-Prozess. Bitte deaktiviere das Antivirus-Programm oder konfiguriere das System so, dass die Lizenz verifiziert werden kann.",
 1825:       en: "A firewall or virus protection software is blocking the licensing process.  Please disable this or configure it to allow this process so that the license can be verified.",
 1826:       es: 'Un software de "firewall" o de protecci\xf3n antivirus est\xe1 bloqueando el proceso de concesi\xf3n de licencias. Desactivela o configurela para permitir este proceso para que la licencia puede ser verificada.',
 1827:       fr: "Un logiciel pare-feu ou un logiciel antivirus bloque le processus de v\xe9rification de licence. Veuillez le d\xe9sactiver ou le configurer pour permettre \xe0 ce processus de v\xe9rifier la licence.",
 1828:     });
 1829:     var strContactSupport = localize({
 1830:       de: "Wenn Du Hilfe ben\xf6tigst, kontaktiere bitte " + supportEmail,
 1831:       en: "If you require assistance please contact " + supportEmail,
 1832:       es: "Si necesita ayuda, por favor contacte " + supportEmail,
 1833:       fr: "Si vous avez besoin d\'aide, merci de contacter " + supportEmail,
 1834:     });
 1835:     var strCorruptedCode = localize({
 1836:       de:
 1837:         "Entschuldigung, irgendetwas ist mit dem " +
 1838:         strScriptName +
 1839:         " Lizenzcode passiert. Bitte gebe ihn erneut ein.\n\n" +
 1840:         strContactSupport,
 1841:       en:
 1842:         "Sorry, something must have happened to the " +
 1843:         strScriptName +
 1844:         " license code.  Please re-enter it at the prompt.\n" +
 1845:         strContactSupport,
 1846:       es:
 1847:         "Lo siento, algo ha ocurrido con la licencia de " +
 1848:         strScriptName +
 1849:         ". Por favor, vuelva a introducirla en la casilla.\n" +
 1850:         strContactSupport,
 1851:       fr:
 1852:         "D\xe9sol\xe9, il y a eu un probl\xe8me avec le num\xe9ro de licence pour " +
 1853:         strScriptName +
 1854:         ". Merci de bien vouloir le saisir \xe0 nouveau.n\n" +
 1855:         strContactSupport,
 1856:     });
 1857:     var strTrialThanks = localize({
 1858:       de: "Danke, dass Du " + strScriptName + " ausprobierst!",
 1859:       en: "Thanks for trying " + strScriptName + "!",
 1860:       es: "\xa1Gracias por probar " + strScriptName + "!",
 1861:       fr: "Merci d\'avoir essay\xe9 " + strScriptName + "!",
 1862:     });
 1863:     var strTrialTxt = localize({
 1864:       de: "Testversion - noch %E Tage g\xfcltig",
 1865:       en: "Trial version - %E days left",
 1866:       es: "Versi\xf3n de prueba - faltan %E d\xedas",
 1867:       fr: "Version d\'\xe9valuation - %E jour(s) restant",
 1868:     });
 1869:     var strTrialTxt2 = localize({
 1870:       de: "%E Programmstarts \xfcbrig f\xfcr die Testversion",
 1871:       en: "%E launches left in the trial",
 1872:       es: "%E usos restantes de la versi\xf3n de prueba",
 1873:       fr: "Il vous reste %E essais",
 1874:     });
 1875:     var strTrialWelcomeHeader = localize({
 1876:       de: "Willkommen bei " + strScriptName,
 1877:       en: "Welcome to " + strScriptName,
 1878:       es: "Bienvenido a " + strScriptName,
 1879:       fr: "Bienvenue sur " + strScriptName,
 1880:     });
 1881:     var strOK = localize({ de: "OK", en: "OK", es: "OK", fr: "OK" });
 1882:     var strCancel = localize({
 1883:       de: "Abbrechen",
 1884:       en: "Cancel",
 1885:       es: "Cancelar",
 1886:       fr: "Annuler",
 1887:     });
 1888:     var strGetSupport = localize({
 1889:       de: "Support zu erhalten",
 1890:       en: "Get support",
 1891:       es: "Obtener apoyo",
 1892:       fr: "Contacter le support client",
 1893:     });
 1894:     var strRetrieveLic = localize({
 1895:       de: "%t vergessen?",
 1896:       en: "Retrieve %t",
 1897:       es: "Recuperar %t",
 1898:       fr: "Retrouver votre %t",
 1899:     });
 1900:     var strBuyLic = localize({
 1901:       de: "%t Kaufen",
 1902:       en: "Buy %t",
 1903:       es: "Compra %t",
 1904:       fr: "Acheter une %t",
 1905:     });
 1906:     var strLicense = localize({
 1907:       de: "Lizenz",
 1908:       en: "License",
 1909:       es: "licencia",
 1910:       fr: "Licence",
 1911:     });
 1912:     var strDownloads = localize({
 1913:       de: "Download",
 1914:       en: "Download",
 1915:       es: "Descarga",
 1916:       fr: "T\xe9l\xe9chargement",
 1917:     });
 1918:     var strPpcNotSupported = localize({
 1919:       de: "PowerPC (PPC) Prozessoren werden leider nicht unterst\xfctzt. Bitte kontaktiere den Support f\xfcr weitere Informationen.",
 1920:       en: "Sorry, PowerPC (PPC) processors are not supported, please contact support for further assistance.",
 1921:       es: "Lo siendto, los procesadores PowerPC (PPC) no est\xe1n soportados, por favor contacte con soporte para m\xe1s informaci\xf3n.",
 1922:       fr: "D\xe9sol\xe9, les processeurs PowerPC (PPC) ne sont pas support\xe9s, veuillez contacter le service client\xe8le pour plus de d\xe9tails.",
 1923:     });
 1924:     var strAllowScriptsPrefsSection =
 1925:       parseFloat(app.version) < 16.1
 1926:         ? localize({
 1927:             de: "Allgemein",
 1928:             en: "General",
 1929:             es: "General",
 1930:             fr: "G\xe9n\xe9ral",
 1931:           })
 1932:         : localize({
 1933:             de: "Skripterstellung und Expression",
 1934:             en: "Scripting & Expressions",
 1935:             es: "Escripts y expresi\xf3nes",
 1936:             fr: "Scripts et expressions",
 1937:           });
 1938:     var strErrScriptAccess = localize({
 1939:       de:
 1940:         strScriptName +
 1941:         ' ben\xf6tigt die Erlaubnis Dateien zu schreiben\n Gehe in Voreinstellungen von After Effects in die Rubrik "' +
 1942:         strAllowScriptsPrefsSection +
 1943:         '" und aktiviere die Option "Skripten k\xf6nnen Dateien schreiben und haben Netzwerkzugang".',
 1944:       en:
 1945:         strScriptName +
 1946:         ' requires access to write files\nGo to the "' +
 1947:         strAllowScriptsPrefsSection +
 1948:         '" panel of the application preferences and make sure "Allow Scripts to Write Files and Access Network" is checked.',
 1949:       es:
 1950:         strScriptName +
 1951:         ' necesita poder escribir archivos\nVaya al panel "' +
 1952:         strAllowScriptsPrefsSection +
 1953:         '" de las Preferencias y aseg\xfarese de que "Permitir que los scripts puedan escribir archivos y acceder a la red" est\xe1 marcado.\n',
 1954:       fr:
 1955:         strScriptName +
 1956:         " n\xe9cessite les droits d\'\xe9criture de fichiers\nAllez dans le panneau \"" +
 1957:         strAllowScriptsPrefsSection +
 1958:         '" des pr\xe9f\xe9rences de l\'application et cochez \n"Autoriser les scripts \xe0 \xe9crire des fichiers et \xe0 acc\xe9der au r\xe9seau"',
 1959:     });
 1960:     var strUpdateLicenseHeader = localize({
 1961:       de: strScriptName + " Lizenz-Update ben\xf6tigt",
 1962:       en: strScriptName + " License Update Required",
 1963:       es: strScriptName + " necesita actualizar la licencia",
 1964:       fr: "La licence de " + strScriptName + " doit \xeatre mise \xe0 jour",
 1965:     });
 1966:     var strLicenseDownloadOptions = localize({
 1967:       de: 'Alle Deine %t findest Du unter "My Downloads & Licenses" in Deinem aescripts.com Benutzer-Account, oder \xfcber unsere Manager-App.',
 1968:       en: 'All your %t are in the "My Downloads & Licenses" section of your aescripts.com user account, or via our Manager App.',
 1969:       es: 'Todas sus %t est\xe1n en la secci\xf3n "My Downloads & Licenses" de su cuenta de usuario en aescripts.com, o a trav\xe9s de nuestra App Manager.',
 1970:       fr: 'Toutes vos %t se trouvent dans la section "My Downloads & Licenses" de votre compte utilisateur sur aescripts.com, ou via notre App Manager.',
 1971:     });
 1972:     var strMyDownloads = localize({
 1973:       de: "Gehen Sie zu My Downloads & Licenses",
 1974:       en: "Go to My Downloads & Licenses",
 1975:       es: "Ir a My Downloads & Licenses",
 1976:       fr: "Aller \xe0 My Downloads & Licenses",
 1977:     });
 1978:     var strDownloadManager = localize({
 1979:       de: "Laden Sie die Manager-App herunter",
 1980:       en: "Download Manager App",
 1981:       es: "Descargar App Manager",
 1982:       fr: "T\xe9l\xe9charger App Manager",
 1983:     });
 1984:     var strOldLicenseFormat = localize({
 1985:       de: "Die Lizenz sollte so aussehen:\n\nFirstname**Lastname**111111111SUL",
 1986:       en: "License should look like this:\n\nFirstname**Lastname**111111111SUL",
 1987:       es: "La licencia debe tener este aspecto:\n\nNombre**Apellido**111111111SUL",
 1988:       fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPr\xe9nom**Nom**111111111SUL",
 1989:     });
 1990:     var strNewLicenseFormat = localize({
 1991:       de: "Die Lizenz sollte so aussehen:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
 1992:       en: "License should look like this:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
 1993:       es: "La licencia debe tener este aspecto:\n\nPRODUCTID*NOMBRE*APELLIDO*1111111SUL1",
 1994:       fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPRODUCTID*PRENOM*NOM*1111111SUL1",
 1995:     });
 1996:     var strRegistration = localize({
 1997:       de: "Registriert f\xfcr: ",
 1998:       en: "Registered to: ",
 1999:       es: "Registrado a: ",
 2000:       fr: "Enregistr\xe9 pour: ",
 2001:     });
 2002:     var strUnknownError = localize({
 2003:       de:
 2004:         "Es gab einen unerwarteten Fehler\nBitte \xf6ffne hier ein Support-Ticket:\n" +
 2005:         supportEmail +
 2006:         "\n\nund f\xfcge einen Screenshot der Fehlermeldung bei\n\n",
 2007:       en:
 2008:         "There was an unexpected error\nPlease please open a support ticket here:\n" +
 2009:         supportEmail +
 2010:         "\n\nand submit screenshot of this error message\n\n",
 2011:       es:
 2012:         "Se ha producido un error desconocido\nPor favor habra un ticket de soporte aqui:\n" +
 2013:         supportEmail +
 2014:         "\n\ny presente una captura de pantalla con este mensaje de error\n\n",
 2015:       fr:
 2016:         "Une erreur vient de se produire \nVeuillez ouvrir un ticket de service client \xe0 cette adresse:\n" +
 2017:         supportEmail +
 2018:         "\n\net n\'oubliez pas d\'y joindre une capture d\'\xe9cran de ce message\n\n",
 2019:     });
 2020:     var strWrongProduct = localize({
 2021:       de: "Dieser Lizenz-Code ist f\xfcr ein anderes Produkt, bitte stelle sicher, dass du den richtigen Lizenzcode eingibst\n\n",
 2022:       en: "This license code is for a different product, please double check that you are entering the correct license\n\n",
 2023:       es: "Este c\xf3digo de licencia es para un producto diferente, por favor, comprobar que esta introduciendo la licencia correcta\n\n",
 2024:       fr: "Vous venez d\'entrer la cl\xe9 de licence d\'un autre produit, assurez-vous d\'utiliser la bonne cl\xe9 de licence\n\n",
 2025:     });
 2026:     var strNewVersionAvailableHdr = localize({
 2027:       de: strScriptName + " Update verf\xfcgbar",
 2028:       en: strScriptName + " Update Available",
 2029:       es: strScriptName + " Actualizaci\xf3n disponible",
 2030:       fr: strScriptName + " Mise \xe0 jour disponible",
 2031:     });
 2032:     var strNewVersionAvailable = localize({
 2033:       de:
 2034:         "Eine neuere Version von " + strScriptName + " ist verf\xfcgbar: v%\n",
 2035:       en: "A newer version of " + strScriptName + " is available: %v\n",
 2036:       es:
 2037:         "Una versi\xf3n nueva de " +
 2038:         strScriptName +
 2039:         " est\xe1 disponible: v%\n",
 2040:       fr: "Une version plus de " + strScriptName + " est disponible: v%\n",
 2041:     });
 2042:     var strCurrentVersion = localize({
 2043:       de: "Votre version install\xe9e est: v%",
 2044:       en: "Your installed version is: %v",
 2045:       es: "Su versi\xf3n instalada es: v%",
 2046:       fr: "Votre version install\xe9e est: v%",
 2047:     });
 2048:     var strDownload = localize({
 2049:       de: "Download",
 2050:       en: "Download",
 2051:       es: "Descargar",
 2052:       fr: "T\xe9l\xe9charger",
 2053:     });
 2054:     var strVersion = localize({
 2055:       de: "Version",
 2056:       en: "version",
 2057:       es: "versi\xf3n",
 2058:       fr: "version",
 2059:     });
 2060:     var strSkipVersion = localize({
 2061:       de: "Diese Version \xdcberspringen",
 2062:       en: "Skip this Version",
 2063:       es: "Salta esta versi\xf3n",
 2064:       fr: "Ignorer cette version",
 2065:     });
 2066:     var strRemindMeLater = localize({
 2067:       de: "Erinnere mich sp\xe4ter",
 2068:       en: "Remind Me Later",
 2069:       es: "Recu\xe9rdame m\xe1s tarde",
 2070:       fr: "Rappelle-moi plus tard",
 2071:     });
 2072:     var strNewestVersionAvailable = localize({
 2073:       de: "Neueste verf\xfcgbare Version",
 2074:       en: "Newest available version",
 2075:       es: "Versi\xf3n mas nueva disponible",
 2076:       fr: "Nouvelle version disponible",
 2077:     });
 2078:     var strVersionRev = localize({
 2079:       de: "v%a%b - %c",
 2080:       en: "v%a%b - %c",
 2081:       es: "v%a%b - %c",
 2082:       fr: "v%a%b - %c",
 2083:     });
 2084:     var strDeactivate = localize({
 2085:       de: "Lizenz Deaktivieren",
 2086:       en: "Deactivate License",
 2087:       es: "Desactivar Licencia",
 2088:       fr: "D\xe9sactiver la licence",
 2089:     });
 2090:     var strVersionCheck = localize({
 2091:       de: "Automatisch nach Aktualisierungen suchen",
 2092:       en: "Check for updates automatically",
 2093:       es: "Revisar actualizaciones automaticamente",
 2094:       fr: "V\xe9rifier les mises \xe0 jour automatiquement",
 2095:     });
 2096:     var strCheckNow = localize({
 2097:       de: "Jetzt nach Update suchenn",
 2098:       en: "Check for update now",
 2099:       es: "Buscar actualizaci\xf3n ahora",
 2100:       fr: "V\xe9rifier les mise \xe0 jour maintenant",
 2101:     });
 2102:     var strUpdateCheckError = localize({
 2103:       de: "Bei der Suche nach Updates ist ein Fehler aufgetreten.\nBitte vergewissern Sie sich, dass Sie \xfcber eine g\xfcltige Internetverbindung verf\xfcgen und diese nicht durch Firewalls blockiert wird.",
 2104:       en: "There was an error when checking for updates.\nPlease verify that you have a valid internet connection and that it is not blocked by any firewalls.",
 2105:       es: "Hubo un error en la comprobaci\xf3n de actualizaciones.\nPor favor compruebe que tiene una conexi\xf3n a Internet v\xe1lida y que no est\xe9 bloqueada por un cortafuegos.",
 2106:       fr: "Une erreur s\'est produite lors de la recherche de mises \xe0 jour.\nV\xe9rifiez que votre connexion Internet est valide et qu\'elle n\'est bloqu\xe9e par aucun pare-feu.",
 2107:     });
 2108:     var strUpToDate = localize({
 2109:       de:
 2110:         "Sie sind auf dem neuesten Stand! \n" +
 2111:         strScriptName +
 2112:         " " +
 2113:         strVersion +
 2114:         " " +
 2115:         strScriptVersion +
 2116:         " ist derzeit die neueste Version verf\xfcgbar.",
 2117:       en:
 2118:         "You are up to date!\n" +
 2119:         strScriptName +
 2120:         " " +
 2121:         strVersion +
 2122:         " " +
 2123:         strScriptVersion +
 2124:         " is currently the latest version available.",
 2125:       es:
 2126:         "\xa1Est\xe1 actualizado! \n" +
 2127:         strScriptName +
 2128:         " " +
 2129:         strVersion +
 2130:         " " +
 2131:         strScriptVersion +
 2132:         " es actualmente la \xfaltima versi\xf3n disponible.",
 2133:       fr:
 2134:         "Vous \xeates \xe0 jour!\n" +
 2135:         strScriptName +
 2136:         " " +
 2137:         strVersion +
 2138:         " " +
 2139:         strScriptVersion +
 2140:         " est actuellement la derni\xe8re version disponible.",
 2141:     });
 2142:     var strInvalidLicense = localize({
 2143:       de: "Ung\xfcltige Lizenz",
 2144:       en: "Invalid license",
 2145:       es: "La licencia no es v\xe1lida",
 2146:       fr: "Licence non valide",
 2147:     });
 2148:     var strLicenseRemoved = localize({
 2149:       de: "Lizenz entfernt",
 2150:       en: "License removed",
 2151:       es: "Licencia eliminada",
 2152:       fr: "Licence supprim\xe9e",
 2153:     });
 2154:     var strLicense = localize({
 2155:       de: "Lizenz",
 2156:       en: "License",
 2157:       es: "Licencia",
 2158:       fr: "Licence",
 2159:     });
 2160:     var strLicenseEnds = localize({
 2161:       de: "Lizenzlaufzeit endet: ",
 2162:       en: "License expires: ",
 2163:       es: "Licencia expira: ",
 2164:       fr: "Licence expir\xe9e: ",
 2165:     });
 2166:     var strBTA = localize({
 2167:       de: "Beta-Lizenz",
 2168:       en: "Beta License",
 2169:       es: "Licencia Beta",
 2170:       fr: "Licence Beta",
 2171:     });
 2172:     var strEDU = localize({
 2173:       de: "EDU-Lizenz",
 2174:       en: "Educational License",
 2175:       es: "Licencia Educacional",
 2176:       fr: "T\xe9l\xe9charger",
 2177:     });
 2178:     var strFLT = localize({
 2179:       de: "Floating-Lizenz",
 2180:       en: "Floating License",
 2181:       es: "Licencia flotante",
 2182:       fr: "Licence flottante",
 2183:     });
 2184:     var strUNKNOWN = localize({
 2185:       de: "License mit unbekanntem Typ",
 2186:       en: "License of unknown type",
 2187:       es: "Licencia de tipo desconocido",
 2188:       fr: "Licence inconnue",
 2189:     });
 2190:     var strTrialExpired = localize({
 2191:       de: "Testversion abgelaufen",
 2192:       en: "MONTER GROUP\xa9",
 2193:       es: "Termino de prueba expirado",
 2194:       fr: "\xc9valuation termin\xe9e",
 2195:     });
 2196:     var licErrors = {
 2197:       de: {
 2198:         "-1": { detail: "", title: "Ung\xfcltige Lizenz (-1)" },
 2199:         "-10": {
 2200:           detail: "Auf dem Lizenzserver sind alle Lizenzen bereits vergeben",
 2201:           title: "Keine freien Slots (-10)",
 2202:         },
 2203:         "-100": {
 2204:           detail:
 2205:             "Eine Lizenz kann \xfcber den Button \'Lizenz Kaufen\' erworben werden",
 2206:           title: "Testversion abgelaufen",
 2207:         },
 2208:         "-101": {
 2209:           detail:
 2210:             "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
 2211:           title: "Zugriff blockiert (-101)",
 2212:         },
 2213:         "-102": {
 2214:           detail:
 2215:             "Bitte kontaktieren Sie den Support und senden Sie einen Screenshot dieses Fehlers. " +
 2216:             supportEmail,
 2217:           title: "Kein Ergebnis (-102)",
 2218:         },
 2219:         "-103": {
 2220:           detail: "Could not find the number of trial days",
 2221:           title: "Anzahl der Test-Tage nicht festgelegt (-103)",
 2222:         },
 2223:         "-104": {
 2224:           detail: "Die Lizenz ist nicht f\xfcr dieses Produkt",
 2225:           title: "Ung\xfcltige Lizenz (-104)",
 2226:         },
 2227:         "-105": {
 2228:           detail:
 2229:             "Eine Beta-Lizenz kann f\xfcr diese Vollversion nicht verwendet werden",
 2230:           title: "Beta-Lizenz nicht verwendbar (-105)",
 2231:         },
 2232:         "-106": {
 2233:           detail:
 2234:             "Dieses Produkt beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
 2235:           title: "Bitte Lizenz installieren (-106)",
 2236:         },
 2237:         "-107": {
 2238:           detail:
 2239:             "Diese Beta beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
 2240:           title: "Bitte Lizenz installieren (-107)",
 2241:         },
 2242:         "-108": {
 2243:           detail:
 2244:             "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
 2245:           title: "Nicht in der Lage, auf den Home-Ordner zuzugreifen (-108)",
 2246:         },
 2247:         "-11": {
 2248:           detail: "Die Lizenz kann auf dem Lizenzserver nicht gefunden werden",
 2249:           title: "Unbekannte Lizenz (-11)",
 2250:         },
 2251:         "-12": {
 2252:           detail:
 2253:             "Die Lizenz konnte nicht deaktiviert werden, da sie dem Server unbekannt ist",
 2254:           title: "Unbekannte Lizenz (-12)",
 2255:         },
 2256:         "-13": {
 2257:           detail:
 2258:             "Die IP-Adresse dieses Rechners ist \xfcber eine Blacklist auf dem Lizenzserver gesperrt",
 2259:           title: "Klient ist auf Blacklist (-13)",
 2260:         },
 2261:         "-14": {
 2262:           detail: "Konnte keine Netzwerkkarte finden",
 2263:           title: "Keine Netzwerkkarte (-14)",
 2264:         },
 2265:         "-2": { detail: "", title: "Ung\xfcltige Lizenz (-2)" },
 2266:         "-20": {
 2267:           detail: "Lizenzlaufzeit beginnt am ",
 2268:           title: "Lizenzlaufzeit hat noch nicht begonnen (-20)",
 2269:         },
 2270:         "-21": {
 2271:           detail: "Lizenzlaufzeit endete am ",
 2272:           title: "Lizenzlaufzeit ist abgelaufen (-21)",
 2273:         },
 2274:         "-22": {
 2275:           detail:
 2276:             "Weitere Informationen zum Einrichten und Lizenzieren von Client-Computern finden Sie in den Anweisungen zum Server.",
 2277:           title:
 2278:             "Floating-Lizenzen k\xf6nnen nur mit dem Floating License Server verwendet werden (-22)",
 2279:         },
 2280:         "-3": { detail: "", title: "Lizenzdatei nicht gefunden (-3)" },
 2281:         "-4": { detail: "", title: "Lizenzdatei besch\xe4digt (-4)" },
 2282:         "-5": { detail: "", title: "Generischer Fehler (-5)" },
 2283:         "-6": { detail: "", title: "Ung\xfcltiger Produktname (-6)" },
 2284:         "-7": { detail: "", title: "Testversion (-7)" },
 2285:         "-8": { detail: "", title: "Ung\xfcltige Lizenz (-8)" },
 2286:         "-9": {
 2287:           detail:
 2288:             "Bitte stellen Sie sicher, dass der Lizenzserver ordnungsgem\xe4\xdf arbeitet",
 2289:           title: "Kann Server nicht kontaktieren (-9)",
 2290:         },
 2291:         "-99": { detail: "", title: "Unbekannter Fehler (-99)" },
 2292:         unknown: { detail: "", title: "Unbekannter Fehler (0)" },
 2293:       },
 2294:       en: {
 2295:         "-1": { detail: "", title: "Invalid license (-1)" },
 2296:         "-10": {
 2297:           detail: "There are no more free slots on the license server",
 2298:           title: "No free slots (-10)",
 2299:         },
 2300:         "-100": {
 2301:           detail:
 2302:             "You can purchase a license by clicking the button \'Buy License\'",
 2303:           title: "MONTER GROUP\xa9",
 2304:         },
 2305:         "-101": {
 2306:           detail:
 2307:             "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
 2308:           title: "Access Blocked(-101)",
 2309:         },
 2310:         "-102": {
 2311:           detail:
 2312:             "Please contact support " +
 2313:             supportEmail +
 2314:             " and send a screenshot of this error.\n\n",
 2315:           title: "No result code (-102)",
 2316:         },
 2317:         "-103": {
 2318:           detail: "Could not find the number of trial days",
 2319:           title: "No trial days found (-103)",
 2320:         },
 2321:         "-104": {
 2322:           detail: "The license is not for this product",
 2323:           title: "License mismatch (-104)",
 2324:         },
 2325:         "-105": {
 2326:           detail: "A beta license cannot be used for the full version",
 2327:           title: "Cannot use beta license (-105)",
 2328:         },
 2329:         "-106": {
 2330:           detail: "This product does not offer a trial and requires a license",
 2331:           title: "Please install a license (-106)",
 2332:         },
 2333:         "-107": {
 2334:           detail:
 2335:             "The beta version does not offer a trial and requires a license",
 2336:           title: "Please install a license (-107)",
 2337:         },
 2338:         "-108": {
 2339:           detail:
 2340:             "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
 2341:           title: "Not able to access home folder (-108)",
 2342:         },
 2343:         "-11": {
 2344:           detail: "The license cannot be found on the license server",
 2345:           title: "Unknown license (-11)",
 2346:         },
 2347:         "-12": {
 2348:           detail:
 2349:             "The license you are trying to deactivate is not found on the license server",
 2350:           title: "Unknown license (-12)",
 2351:         },
 2352:         "-13": {
 2353:           detail: "Your client IP is blacklisted on the license server",
 2354:           title: "Client blacklisted (-13)",
 2355:         },
 2356:         "-14": {
 2357:           detail: "Could not find a network adapter",
 2358:           title: "No network adapter (-14)",
 2359:         },
 2360:         "-2": { detail: "", title: "Invalid license (-2)" },
 2361:         "-20": {
 2362:           detail: "License period starts on ",
 2363:           title: "License period has not started yet (-20)",
 2364:         },
 2365:         "-21": {
 2366:           detail: "License period ended on ",
 2367:           title: "License period has ended (-21)",
 2368:         },
 2369:         "-22": {
 2370:           detail:
 2371:             "Please refer to the server instructions on how to setup and license client machines.",
 2372:           title:
 2373:             "Floating licenses can only be used with the Floating License Server (-22)",
 2374:         },
 2375:         "-3": { detail: "", title: "License file not found (-3)" },
 2376:         "-4": { detail: "", title: "License file corrupted (-4)" },
 2377:         "-5": { detail: "", title: "Generic error (-5)" },
 2378:         "-6": { detail: "", title: "Invalid product name (-6)" },
 2379:         "-7": { detail: "", title: "Trial (-7)" },
 2380:         "-8": { detail: "", title: "Invalid license (-8)" },
 2381:         "-9": {
 2382:           detail: "Please make sure the license server is running properly",
 2383:           title: "Cannot connect to server (-9)",
 2384:         },
 2385:         "-99": { detail: "", title: "Unknown error (-99)" },
 2386:         unknown: { detail: "", title: "Unknown error (0)" },
 2387:       },
 2388:       es: {
 2389:         "-1": { detail: "", title: "La licencia no es v\xe1lida (-1)" },
 2390:         "-10": {
 2391:           detail: "No hay m\xe1s espacios libres en el servidor de licencias",
 2392:           title: "No hay espacios libres (-10)",
 2393:         },
 2394:         "-100": {
 2395:           detail:
 2396:             "Puede adquirir una licencia haciendo clic en el bot\xf3n \'Comprar Licencia\'",
 2397:           title: "Esta versi\xf3n de prueba se ha expirado",
 2398:         },
 2399:         "-101": {
 2400:           detail:
 2401:             "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
 2402:           title: "Acceso bloqueado (-101)",
 2403:         },
 2404:         "-102": {
 2405:           detail:
 2406:             "Por favor, p\xf3ngase en contacto con soporte y env\xede una captura de pantalla de este error. " +
 2407:             supportEmail,
 2408:           title: "No hay c\xf3digo de resultado (-102)",
 2409:         },
 2410:         "-103": {
 2411:           detail: "No se pudo encontrar el n\xfamero de d\xedas de prueba",
 2412:           title: "No se encontraron d\xedas de prueba (-103)",
 2413:         },
 2414:         "-104": {
 2415:           detail: "La licencia no es para este producto",
 2416:           title: "La licencia no es la correcta (-104)",
 2417:         },
 2418:         "-105": {
 2419:           detail:
 2420:             "No se puede utilizar una licencia \'beta\' con esta versi\xf3n",
 2421:           title: "No se puede usar licencia beta (-105)",
 2422:         },
 2423:         "-106": {
 2424:           detail:
 2425:             "Este producto no ofrece una version de prueba y requiere una licencia",
 2426:           title: "Por favor, instale una licencia (-106)",
 2427:         },
 2428:         "-107": {
 2429:           detail:
 2430:             "La versi\xf3n beta no ofrece una versi\xf3n de prueba y requiere una licencia",
 2431:           title: "Por favor, instale una licencia (-107)",
 2432:         },
 2433:         "-108": {
 2434:           detail:
 2435:             "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
 2436:           title: "No se puede acceder a la carpeta de inicio (-108)",
 2437:         },
 2438:         "-11": {
 2439:           detail:
 2440:             "No se puede encontrar esta licencia en el servidor de licencias",
 2441:           title: "Licencia desconocida (-11)",
 2442:         },
 2443:         "-12": {
 2444:           detail:
 2445:             "La licencia que est\xe1 intentando de desactivar no se encuentra en el servidor de licencias",
 2446:           title: "Licencia desconocida (-12)",
 2447:         },
 2448:         "-13": {
 2449:           detail: "Su IP est\xe1 en la lista negra del servidor de licencias",
 2450:           title: "IP en la lista negra (-13)",
 2451:         },
 2452:         "-14": {
 2453:           detail: "No se pudo encontrar un adaptador de red",
 2454:           title: "No hay adaptador de red (-14)",
 2455:         },
 2456:         "-2": { detail: "", title: "La licencia no es v\xe1lida (-2)" },
 2457:         "-20": {
 2458:           detail: "El per\xedodo de licencia comienza en ",
 2459:           title: "El periodo de licencia no ha comenzado (-20)",
 2460:         },
 2461:         "-21": {
 2462:           detail: "El per\xedodo de licencia termin\xf3 en ",
 2463:           title: "El per\xedodo de licencia ha terminado (-21)",
 2464:         },
 2465:         "-22": {
 2466:           detail:
 2467:             "Consulte las instrucciones del servidor sobre c\xf3mo configurar y licenciar las m\xe1quinas cliente.",
 2468:           title:
 2469:             "Las licencias flotantes solo se pueden utilizar con el Servidor de licencias flotantes (-22)",
 2470:         },
 2471:         "-3": {
 2472:           detail: "",
 2473:           title: "No se encontr\xf3 el archivo de licencia (-3)",
 2474:         },
 2475:         "-4": {
 2476:           detail: "",
 2477:           title: "El archivo de licencia esta da\xf1ado (-4)",
 2478:         },
 2479:         "-5": { detail: "", title: "Error generico (-5)" },
 2480:         "-6": {
 2481:           detail: "",
 2482:           title: "El nombre de el producto no v\xe1lido (-6)",
 2483:         },
 2484:         "-7": { detail: "", title: "Versi\xf3n de prueba (-7)" },
 2485:         "-8": { detail: "", title: "La licencia no es v\xe1lida (-8)" },
 2486:         "-9": {
 2487:           detail:
 2488:             "Aseg\xfarese de que el servidor de licencias est\xe1 funcionando correctamente",
 2489:           title: "No es posible conectar con el servidor (-9)",
 2490:         },
 2491:         "-99": { detail: "", title: "Error desconocido (-99)" },
 2492:         unknown: { detail: "", title: "Error desconocido (0)" },
 2493:       },
 2494:       fr: {
 2495:         "-1": { detail: "", title: "Licence non valide (-1)" },
 2496:         "-10": {
 2497:           detail: "Il n\'y a plus de place sur le serveur de licence",
 2498:           title: "Plus de place (-10)",
 2499:         },
 2500:         "-100": {
 2501:           detail:
 2502:             "Vous pouvez acqu\xe9rir une licence en cliquant sur le bouton \'Acheter une Licence\' ci-dessous",
 2503:           title: "P\xe9riode d\'\xe9valuation expir\xe9e",
 2504:         },
 2505:         "-101": {
 2506:           detail:
 2507:             "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
 2508:           title: "Acc\xe8s bloqu\xe9 (-101)",
 2509:         },
 2510:         "-102": {
 2511:           detail:
 2512:             "S\'il vous pla\xeet contacter le support et envoyer une capture d\'\xe9cran de cette erreur. " +
 2513:             supportEmail,
 2514:           title: "Pas de code de r\xe9sultat (-102)",
 2515:         },
 2516:         "-103": {
 2517:           detail:
 2518:             "Echec d\'identification du nombre de jour de p\xe9riode d\'essai disponible",
 2519:           title: "Impossible de trouver des jours d\'essai (-103)",
 2520:         },
 2521:         "-104": {
 2522:           detail: "Cette licence n\'est pas valable pour ce produit",
 2523:           title: "Mauvaise licence (-104)",
 2524:         },
 2525:         "-105": {
 2526:           detail:
 2527:             "Une licence de version Beta ne peut \xeatre utilis\xe9e pour le produit final",
 2528:           title: "Licence Beta invalide (-105)",
 2529:         },
 2530:         "-106": {
 2531:           detail:
 2532:             "Ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
 2533:           title: "Licence n\xe9cessaire (-106)",
 2534:         },
 2535:         "-107": {
 2536:           detail:
 2537:             "La version Beta de ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
 2538:           title: "Licence n\xe9cessaire (-107)",
 2539:         },
 2540:         "-108": {
 2541:           detail:
 2542:             "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
 2543:           title: "Impossible d\'acc\xe9der au dossier de d\xe9part (-108)",
 2544:         },
 2545:         "-11": {
 2546:           detail: "La licence est introuvable sur le serveur",
 2547:           title: "Licence inconnue (-11)",
 2548:         },
 2549:         "-12": {
 2550:           detail:
 2551:             "La licence que vous essayez de d\xe9sactiver est introuvable sur le serveur",
 2552:           title: "Licence inconnue (-12)",
 2553:         },
 2554:         "-13": {
 2555:           detail:
 2556:             "L\'adresse ip de votre client est bannie du serveur de licence",
 2557:           title: "Client sur liste noire (-13)",
 2558:         },
 2559:         "-14": {
 2560:           detail: "Impossible de trouver une carte r\xe9seau",
 2561:           title: "Pas de carte r\xe9seau (-14)",
 2562:         },
 2563:         "-2": { detail: "", title: "Licence non valide (-2)" },
 2564:         "-20": {
 2565:           detail: "La p\xe9riode de licence commence ",
 2566:           title: "La p\xe9riode de licence n\'a pas encore commenc\xe9 (-20)",
 2567:         },
 2568:         "-21": {
 2569:           detail: "La p\xe9riode de licence s\'est termin\xe9e le ",
 2570:           title: "La p\xe9riode de licence est termin\xe9e (-21)",
 2571:         },
 2572:         "-22": {
 2573:           detail:
 2574:             "Veuillez vous reporter aux instructions du serveur pour savoir comment configurer et attribuer une licence aux ordinateurs clients.",
 2575:           title:
 2576:             "Les licences flottantes ne peuvent \xeatre utilis\xe9es qu\'avec le serveur de licences flottantes (-22)",
 2577:         },
 2578:         "-3": { detail: "", title: "Fichier de licence introuvable (-3)" },
 2579:         "-4": { detail: "", title: "Fichier de licence corrompu (-4)" },
 2580:         "-5": { detail: "", title: "Erreur g\xe9n\xe9rique (-5)" },
 2581:         "-6": { detail: "", title: "Nom de produit invalide (-6)" },
 2582:         "-7": { detail: "", title: "P\xe9riode d\'\xe9valuation (-7)" },
 2583:         "-8": { detail: "", title: "Licence non valide (-8)" },
 2584:         "-9": {
 2585:           detail: "Verifiez que le serveur de licence fonctionne correctement",
 2586:           title: "Impossible de se connecter au serveur (-9)",
 2587:         },
 2588:         "-99": { detail: "", title: "Erreur inconnue (-99)" },
 2589:         unknown: { detail: "", title: "Erreur inconnue (0)" },
 2590:       },
 2591:     };
 2592:     var prefsSectionName = vars.hasOwnProperty("legacyPrefsGroup")
 2593:       ? vars.legacyPrefsGroup
 2594:       : "aescripts";
 2595:     var prefsName = useLegacyPrefsHeader
 2596:       ? strScriptName
 2597:       : strHeader + "_Registration";
 2598:     var prefsVersionName = strHeader + "_Version";
 2599:     var prefsLicVersion = strHeader + "_LicVersion";
 2600:     var prefsVersionCheckInit = strHeader + "_VersionCheckInit";
 2601:     var prefsLastVersionChecked = strHeader + "_LastVersionChecked";
 2602:     var prefsLastServerVersionChecked = strHeader + "_LastServerVersionChecked";
 2603:     var prefsLastTimeVersionChecked = strHeader + "_LastTimeVersionChecked";
 2604:     var prefsNextTimeVersionChecked = strHeader + "_NextTimeVersionChecked";
 2605:     var prefsNextTimeVersionCheckedSkipVersion =
 2606:       strHeader + "_NextTimeVersionCheckedSkipVersion";
 2607:     var prefsDoUpdateCheck = strHeader + "_doUpdateCheck";
 2608:     haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
 2609:       (doUpdateCheck = !(
 2610:         "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
 2611:       ));
 2612:     ScriptUI.environment.keyboardState.shiftKey &&
 2613:       ScriptUI.environment.keyboardState.altKey &&
 2614:       !ScriptUI.environment.keyboardState.ctrlKey &&
 2615:       !ScriptUI.environment.keyboardState.metaKey &&
 2616:       ((doUpdateCheck = false),
 2617:       saveSettings(prefsSectionName, prefsDoUpdateCheck, false),
 2618:       alert("New version update checks disabled"));
 2619:     saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
 2620:     saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
 2621:     cmdKey = -1 != $.os.indexOf("Mac") ? "cmd" : "Ctrl";
 2622:     var strEnterLicenseCode = localize({
 2623:       de: "Bitte gebe den Lizenzcode ein.",
 2624:       en: "Please enter the license code.",
 2625:       es: "Por favor, introduzca el c\xf3digo de licencia.",
 2626:       fr: "Veuillez entrer votre num\xe9ro de licence.",
 2627:     });
 2628:     var strPasteHelp = localize({
 2629:       de:
 2630:         "(Wenn das Einf\xfcgen mit " +
 2631:         cmdKey +
 2632:         "+V nicht funktioniert, versuche Bearbeiten->Einf\xfcgen.)",
 2633:       en:
 2634:         "(If pasting the code with " + cmdKey + "+V doesn\'t work try " + 10 <=
 2635:         parseFloat(app.version)
 2636:           ? "Right-Click and Paste)"
 2637:           : "Edit->Paste)",
 2638:       es:
 2639:         "(Si pegar la licencia usando " +
 2640:           cmdKey +
 2641:           "+V no funciona, pruebe " +
 2642:           10 <=
 2643:         parseFloat(app.version)
 2644:           ? "Clic derecho y pegar)"
 2645:           : "Edici\xf3n->Pegar)",
 2646:       fr:
 2647:         "(Si vous ne parvenez pas \xe0 coller le code avec " +
 2648:           cmdKey +
 2649:           "+V essayez " +
 2650:           10 <=
 2651:         parseFloat(app.version)
 2652:           ? "Clique droit et Coller)"
 2653:           : "Edition->Coller)",
 2654:     });
 2655:     var strTrialInstructMsg = localize({
 2656:       de: 'Um die Testversion zu starten, gebe "trial" ein.',
 2657:       en: "To run in trial mode type: trial",
 2658:       es: "Para ejecutar el modo Trial, escriba: trial",
 2659:       fr: "Pour lancer la version de d\xe9monstration, tapez : trial",
 2660:     });
 2661:     var strOr = localize({ de: "oder", en: "or", es: "o", fr: "ou" });
 2662:     var strServerInstructMsg = localize({
 2663:       de: "Aktivieren Sie eine Lizenz vom Server mit @REMOTE",
 2664:       en: "Activate a license from the server with @REMOTE",
 2665:       es: "Activar una licencia del servidor con @REMOTE",
 2666:       fr: "Activer une licence du serveur avec @REMOTE",
 2667:     });
 2668:     var strServerNotRunning = localize({
 2669:       de: "Der Client ist konfiguriert, aber der Floating License Server l\xe4uft nicht oder ist nicht erreichbar.",
 2670:       en: "Client configured but floating license server is either not running or not accessible.",
 2671:       es: "Cliente configurado pero servidor de licencias flotantes o no est\xe1 ejecutado o no es accesible.",
 2672:       fr: "Client configur\xe9 mais le serveur de licence flottante est soit en cours d\'ex\xe9cution ou ne pas accessible.",
 2673:     });
 2674:     var prefHeader = "Initialization Fragments";
 2675:     var prefSection1 = (
 2676:       string_encode(
 2677:         Math.floor(parseFloat(app.version))
 2678:           .toString()
 2679:           .charAt(
 2680:             Math.max(
 2681:               0,
 2682:               Math.floor(parseFloat(app.version)).toString().length - 1,
 2683:             ),
 2684:           ) +
 2685:           strScriptName.substring(
 2686:             Math.max(0, strScriptName.length - 15),
 2687:             strScriptName.length,
 2688:           ) +
 2689:           strScriptVersion,
 2690:       ) *
 2691:       0.457 *
 2692:       privateNum
 2693:     ).toString(36);
 2694:     var prefSection2 = (
 2695:       string_encode(
 2696:         Math.floor(parseFloat(app.version))
 2697:           .toString()
 2698:           .charAt(
 2699:             Math.max(
 2700:               0,
 2701:               Math.floor(parseFloat(app.version)).toString().length - 1,
 2702:             ),
 2703:           ) +
 2704:           strScriptName.substring(
 2705:             Math.max(0, strScriptName.length - 15),
 2706:             strScriptName.length,
 2707:           ) +
 2708:           strScriptVersion,
 2709:       ) *
 2710:       (privateNum / 3.981)
 2711:     ).toString(36);
 2712:     var prefsLocation = Folder.userData.fsName + "/Aescripts/";
 2713:     var prefsPrefix = "pref_";
 2714:     isAE() || Folder(prefsLocation).exists || Folder(prefsLocation).create();
 2715:     var sanitizedName = sanitizeProductName(strScriptName);
 2716:     this.getSetting = function (e, i) {
 2717:       return getSettings((e = strHeader + "_" + e), i, "settings");
 2718:     };
 2719:     this.readJSON = function (e) {
 2720:       return readJSON(e);
 2721:     };
 2722:     this.writeJSON = function (e, i) {
 2723:       return writeJSON(e, i);
 2724:     };
 2725:     this.JSONify = function (e, i, t) {
 2726:       return JSONify(e, i, t);
 2727:     };
 2728:     this.haveSetting = function (e, i) {
 2729:       return haveSettings((e = strHeader + "_" + e), i, "settings");
 2730:     };
 2731:     this.saveSetting = function (e, i, t) {
 2732:       return saveSettings((e = strHeader + "_" + e), i, t, "settings");
 2733:     };
 2734:     function compareVersions(a, b) {
 2735:       if (a === b) {
 2736:         return 0;
 2737:       }
 2738:       var a_components = a.toString().split(".");
 2739:       var b_components = b.toString().split(".");
 2740:       if (a_components.length <= 2 && b_components.length <= 2) {
 2741:         if (a > b) {
 2742:           return 1;
 2743:         }
 2744:         if (a < b) {
 2745:           return -1;
 2746:         }
 2747:       } else {
 2748:         var len = Math.min(a_components.length, b_components.length);
 2749:         for (var i = 0; i < len; i += 1) {
 2750:           if (parseInt(a_components[i]) > parseInt(b_components[i])) {
 2751:             return 1;
 2752:           }
 2753:           if (parseInt(a_components[i]) < parseInt(b_components[i])) {
 2754:             return -1;
 2755:           }
 2756:         }
 2757:         if (a_components.length > b_components.length) {
 2758:           return 1;
 2759:         }
 2760:         if (a_components.length < b_components.length) {
 2761:           return -1;
 2762:         }
 2763:         return 0;
 2764:       }
 2765:     }
 2766:     function JSONify(string, mode, prettyJSON) {
 2767:       if (typeof JSON !== "object") {
 2768:         JSON = {};
 2769:       }
 2770:       (function () {
 2771:         function f(n) {
 2772:           return n < 10 ? "0" + n : n;
 2773:         }
 2774:         function this_value() {
 2775:           return this.valueOf();
 2776:         }
 2777:         function quote(string) {
 2778:           rx_escapable.lastIndex = 0;
 2779:           return rx_escapable.test(string)
 2780:             ? '"' +
 2781:                 string.replace(rx_escapable, function (a) {
 2782:                   var c = meta[a];
 2783:                   return typeof c === "string"
 2784:                     ? c
 2785:                     : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 2786:                 }) +
 2787:                 '"'
 2788:             : '"' + string + '"';
 2789:         }
 2790:         function str(key, holder) {
 2791:           var mind = gap;
 2792:           var value = holder[key];
 2793:           if (
 2794:             value &&
 2795:             typeof value === "object" &&
 2796:             typeof value.toJSON === "function"
 2797:           ) {
 2798:             value = value.toJSON(key);
 2799:           }
 2800:           if (typeof rep === "function") {
 2801:             value = rep.call(holder, key, value);
 2802:           }
 2803:           switch (typeof value) {
 2804:             case "string":
 2805:               return quote(value);
 2806:             case "number":
 2807:               return isFinite(value) ? String(value) : "null";
 2808:             case "boolean":
 2809:             case "null":
 2810:               return String(value);
 2811:             case "object":
 2812:               if (!value) {
 2813:                 return "null";
 2814:               }
 2815:               gap += indent;
 2816:               partial = [];
 2817:               if (Object.prototype.toString.apply(value) === "[object Array]") {
 2818:                 length = value.length;
 2819:                 for (var i = 0; i < length; i += 1) {
 2820:                   partial[i] = str(i, value) || "null";
 2821:                 }
 2822:                 v =
 2823:                   partial.length === 0
 2824:                     ? "[]"
 2825:                     : gap
 2826:                       ? "[\n" +
 2827:                         gap +
 2828:                         partial.join(",\n" + gap) +
 2829:                         "\n" +
 2830:                         mind +
 2831:                         "]"
 2832:                       : "[" + partial.join(",") + "]";
 2833:                 gap = mind;
 2834:                 return v;
 2835:               }
 2836:               if (rep && typeof rep === "object") {
 2837:                 length = rep.length;
 2838:                 for (var i = 0; i < length; i += 1) {
 2839:                   if (typeof rep[i] === "string") {
 2840:                     k = rep[i];
 2841:                     v = str(k, value);
 2842:                     if (v) {
 2843:                       partial.push(quote(k) + gap ? ": " : ":" + v);
 2844:                     }
 2845:                   }
 2846:                 }
 2847:               } else {
 2848:                 for (var k in value) {
 2849:                   if (Object.prototype.hasOwnProperty.call(value, k)) {
 2850:                     v = str(k, value);
 2851:                     if (v) {
 2852:                       partial.push(quote(k) + gap ? ": " : ":" + v);
 2853:                     }
 2854:                   }
 2855:                 }
 2856:               }
 2857:               v =
 2858:                 partial.length === 0
 2859:                   ? "{}"
 2860:                   : gap
 2861:                     ? "{\n" +
 2862:                       gap +
 2863:                       partial.join(",\n" + gap) +
 2864:                       "\n" +
 2865:                       mind +
 2866:                       "}"
 2867:                     : "{" + partial.join(",") + "}";
 2868:               gap = mind;
 2869:               return v;
 2870:           }
 2871:         }
 2872:         ("use strict");
 2873:         var rx_one = /^[\],:{}\s]*$/;
 2874:         var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
 2875:         var rx_three =
 2876:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
 2877:         var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
 2878:         var rx_escapable =
 2879:           /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 2880:         var rx_dangerous =
 2881:           /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 2882:         if (typeof Date.prototype.toJSON !== "function") {
 2883:           Date.prototype.toJSON = function () {
 2884:             return isFinite(this.valueOf())
 2885:               ? this.getUTCFullYear() +
 2886:                   "-" +
 2887:                   f(this.getUTCMonth() + 1) +
 2888:                   "-" +
 2889:                   f(this.getUTCDate()) +
 2890:                   "T" +
 2891:                   f(this.getUTCHours()) +
 2892:                   ":" +
 2893:                   f(this.getUTCMinutes()) +
 2894:                   ":" +
 2895:                   f(this.getUTCSeconds()) +
 2896:                   "Z"
 2897:               : null;
 2898:           };
 2899:           Boolean.prototype.toJSON = this_value;
 2900:           Number.prototype.toJSON = this_value;
 2901:           String.prototype.toJSON = this_value;
 2902:         }
 2903:         if (typeof JSON.stringify !== "function") {
 2904:           meta = {
 2905:             "\b": "\\b",
 2906:             "\t": "\\t",
 2907:             "\n": "\\n",
 2908:             "\f": "\\f",
 2909:             "\r": "\\r",
 2910:             '"': '\\"',
 2911:             "\\": "\\\\",
 2912:           };
 2913:           JSON.stringify = function (value, replacer, space) {
 2914:             gap = "";
 2915:             indent = "";
 2916:             if (typeof space === "number") {
 2917:               for (var i = 0; i < space; i += 1) {
 2918:                 indent += " ";
 2919:               }
 2920:             } else {
 2921:               if (typeof space === "string") {
 2922:                 indent = space;
 2923:               }
 2924:             }
 2925:             rep = replacer;
 2926:             if (
 2927:               replacer &&
 2928:               typeof replacer !== "function" &&
 2929:               (typeof replacer !== "object" ||
 2930:                 typeof replacer.length !== "number")
 2931:             ) {
 2932:               throw new Error("JSON.stringify");
 2933:             }
 2934:             return str("", { "": value });
 2935:           };
 2936:         }
 2937:       })();
 2938:       var jsonParse = (function () {
 2939:         function v(h, j, e) {
 2940:           return j ? u[j] : String.fromCharCode(parseInt(e, 16));
 2941:         }
 2942:         var r =
 2943:           "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
 2944:         var k =
 2945:           '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
 2946:         k = '(?:"' + k + '*")';
 2947:         var s = new RegExp(
 2948:           "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
 2949:           "g",
 2950:         );
 2951:         var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
 2952:         var u = {
 2953:           '"': '"',
 2954:           "/": "/",
 2955:           "\\": "\\",
 2956:           b: "\b",
 2957:           f: "\f",
 2958:           n: "\n",
 2959:           r: "\r",
 2960:           t: "\t",
 2961:         };
 2962:         var w = new String("");
 2963:         var x = Object.hasOwnProperty;
 2964:         return function (h, j) {
 2965:           h = h.match(s);
 2966:           var c = h[0];
 2967:           var l = false;
 2968:           if ("{" === c) {
 2969:             e = {};
 2970:           } else if ("[" === c) {
 2971:             e = [];
 2972:           } else {
 2973:             e = [];
 2974:             l = true;
 2975:           }
 2976:           for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
 2977:             c = h[m];
 2978:             switch (c.charCodeAt(0)) {
 2979:               default:
 2980:                 a = d[0];
 2981:                 a[b || a.length] = c;
 2982:                 b = void 0;
 2983:                 break;
 2984:               case 34:
 2985:                 c = c.substring(1, c.length - 1);
 2986:                 if (c.indexOf("\\") !== -1) {
 2987:                   c = c.replace(t, v);
 2988:                 }
 2989:                 a = d[0];
 2990:                 if (!b) {
 2991:                   if (a instanceof Array) {
 2992:                     b = a.length;
 2993:                   } else {
 2994:                     b = c || w;
 2995:                     break;
 2996:                   }
 2997:                 }
 2998:                 a[b] = c;
 2999:                 b = void 0;
 3000:                 break;
 3001:               case 91:
 3002:                 a = d[0];
 3003:                 d.unshift((a[b || a.length] = []));
 3004:                 b = void 0;
 3005:                 break;
 3006:               case 93:
 3007:                 d.shift();
 3008:                 break;
 3009:               case 102:
 3010:                 a = d[0];
 3011:                 a[b || a.length] = false;
 3012:                 b = void 0;
 3013:                 break;
 3014:               case 110:
 3015:                 a = d[0];
 3016:                 a[b || a.length] = null;
 3017:                 b = void 0;
 3018:                 break;
 3019:               case 116:
 3020:                 a = d[0];
 3021:                 a[b || a.length] = true;
 3022:                 b = void 0;
 3023:                 break;
 3024:               case 123:
 3025:                 a = d[0];
 3026:                 d.unshift((a[b || a.length] = {}));
 3027:                 b = void 0;
 3028:                 break;
 3029:               case 125:
 3030:                 d.shift();
 3031:                 break;
 3032:             }
 3033:           }
 3034:           if (l) {
 3035:             if (d.length !== 1) {
 3036:               throw new Error();
 3037:             }
 3038:             e = e[0];
 3039:           } else {
 3040:             if (d.length) {
 3041:               throw new Error();
 3042:             }
 3043:           }
 3044:           if (j) {
 3045:             var p = function (n, o) {
 3046:               var f = n[o];
 3047:               if (f && typeof f === "object") {
 3048:                 var i = null;
 3049:                 for (var g in f) {
 3050:                   if (x.call(f, g) && f !== n) {
 3051:                     var q = p(f, g);
 3052:                     if (q !== void 0) {
 3053:                       f[g] = q;
 3054:                     } else {
 3055:                       i || (i = []);
 3056:                       i.push(g);
 3057:                     }
 3058:                   }
 3059:                 }
 3060:                 if (i) {
 3061:                   for (g = i.length; --g >= 0; ) {
 3062:                     delete f[i[g]];
 3063:                   }
 3064:                 }
 3065:               }
 3066:               return j.call(n, o, f);
 3067:             };
 3068:             e = p({ "": e }, "");
 3069:           }
 3070:           return e;
 3071:         };
 3072:       })();
 3073:       try {
 3074:         switch (mode) {
 3075:           case "parse":
 3076:             if (validateJSON(string)) {
 3077:               return jsonParse(string);
 3078:             } else {
 3079:               alert("JSON validation error\n" + string.substring(0, 1000));
 3080:               return null;
 3081:             }
 3082:             break;
 3083:           case "stringify":
 3084:             return JSON.stringify(string, undefined, prettyJSON);
 3085:             break;
 3086:         }
 3087:       } catch (e) {
 3088:         alert(e.toString());
 3089:       }
 3090:     }
 3091:     function validateJSON(string) {
 3092:       return /^[\],:{}\s]*$/.test(
 3093:         string
 3094:           .replace(/\\["\\\/bfnrtu]/g, "@")
 3095:           .replace(
 3096:             /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
 3097:             "]",
 3098:           )
 3099:           .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
 3100:       );
 3101:     }
 3102:     this.c = function () {
 3103:       return mainFunc("l");
 3104:     };
 3105:     this.s = function () {
 3106:       return (
 3107:         (void 0 !== licenseValidity &&
 3108:           licenseValidity.hasOwnProperty("result")) ||
 3109:           (licenseValidity = getVerifCode("")),
 3110:         isResultValidLicense(licenseValidity)
 3111:       );
 3112:     };
 3113:     this.r = function () {
 3114:       return !mainFunc("r");
 3115:     };
 3116:     this.t = function () {
 3117:       return (
 3118:         (void 0 !== licenseValidity &&
 3119:           licenseValidity.hasOwnProperty("result")) ||
 3120:           (licenseValidity = getVerifCode("")),
 3121:         isResultTrial(licenseValidity.result)
 3122:       );
 3123:     };
 3124:     this.l = function () {
 3125:       return (
 3126:         (void 0 !== licenseValidity &&
 3127:           licenseValidity.hasOwnProperty("result")) ||
 3128:           (licenseValidity = getVerifCode("")),
 3129:         licenseValidity.license
 3130:       );
 3131:     };
 3132:     this.ss = function () {
 3133:       return (
 3134:         (void 0 !== licenseValidity &&
 3135:           licenseValidity.hasOwnProperty("result")) ||
 3136:           (licenseValidity = getVerifCode("")),
 3137:         isResultValidLicense(licenseValidity) &&
 3138:           !isResultTrial(licenseValidity.result)
 3139:       );
 3140:     };
 3141:     this.vt = function () {
 3142:       return isVT();
 3143:     };
 3144:     this.helpUI = function (e) {
 3145:       helpUI(e);
 3146:     };
 3147:     this.getRegistration = function (e) {
 3148:       return getRegistration(e);
 3149:     };
 3150:     this.openSupportTicket = function (e) {
 3151:       openSupportTicket(e);
 3152:     };
 3153:     this.openURL = function (e) {
 3154:       openURL(e);
 3155:     };
 3156:     this.doUpdateCheck = function (e) {
 3157:       setUpdateCheck(e);
 3158:     };
 3159:     this.getUpdateCheckStatus = function () {
 3160:       return doUpdateCheck;
 3161:     };
 3162:     this.doUpdateCheckNow = function () {
 3163:       return doUpdateCheckNow();
 3164:     };
 3165:     this.frameworkVersion = function () {
 3166:       return licensingVersion;
 3167:     };
 3168:   }
 3169:   var FF092D = new a(af_settings);
 3170:   if (FF092D.c()) {
 3171:     function GETrulerType() {
 3172:       return easyRulers_params.rulerType;
 3173:     }
 3174:     function GETsides() {
 3175:       return easyRulers_params.sides;
 3176:     }
 3177:     function GETbaseline() {
 3178:       return easyRulers_params.baseline;
 3179:     }
 3180:     function GETshapeOfDivisions() {
 3181:       return easyRulers_params.shapeOfDivisions;
 3182:     }
 3183:     function GETtypeOfDivisions() {
 3184:       return easyRulers_params.typeOfDivisions;
 3185:     }
 3186:     function GETenableNumbers() {
 3187:       return easyRulers_params.enableNumbers;
 3188:     }
 3189:     function GETenableTracking() {
 3190:       return easyRulers_params.enableTracking;
 3191:     }
 3192:     function checkIfInstalled() {
 3193:       var e = app.effects;
 3194:       for (var i = 0; i < e.length; i += 1) {
 3195:         if (e[i].displayName == "easyRulers") {
 3196:           return true;
 3197:         }
 3198:       }
 3199:       return false;
 3200:     }
 3201:     function arrowsPressed(e) {
 3202:       if (ScriptUI.environment.keyboardState.keyName == "Up") {
 3203:         e.text.match(/[,]+/g) == null
 3204:           ? (e.text = Number(e.text) + 1)
 3205:           : (e.text = String(Number(e.text.replace(",", ".")) + 1).replace(
 3206:               ".",
 3207:               ",",
 3208:             ));
 3209:         InfoFunction();
 3210:         CopiesSlider.value = EditTextCopies.text;
 3211:         GapSlider.value = EditTextGap.text;
 3212:       }
 3213:       if (ScriptUI.environment.keyboardState.keyName == "Down") {
 3214:         e.text.match(/[,]+/g) == null
 3215:           ? (e.text = Number(e.text) - 1)
 3216:           : (e.text = String(Number(e.text.replace(",", ".")) - 1).replace(
 3217:               ".",
 3218:               ",",
 3219:             ));
 3220:         InfoFunction();
 3221:         CopiesSlider.value = EditTextCopies.text;
 3222:         GapSlider.value = EditTextGap.text;
 3223:       }
 3224:     }
 3225:     function fillRect() {
 3226:       with (this) {
 3227:         graphics.drawOSControl();
 3228:         graphics.rectPath(0, 0, size[0], size[1]);
 3229:         graphics.fillPath(fillBrush);
 3230:       }
 3231:     }
 3232:     function setColor(e, r) {
 3233:       NumbersColor.enabled = false;
 3234:       var t = myDecColor2;
 3235:       myDecColor2 = $.colorPicker(r.red * 65536 + r.green * 256 + r.blue);
 3236:       if (myDecColor2 != -1) {
 3237:         r.red = myDecColor2 >> 16;
 3238:         r.green = (myDecColor2 & 65280) >> 8;
 3239:         r.blue = myDecColor2 & 255;
 3240:       } else {
 3241:         myDecColor2 = t;
 3242:       }
 3243:       e.fillBrush = e.graphics.newBrush(e.graphics.BrushType.SOLID_COLOR, [
 3244:         r.red / 255,
 3245:         r.green / 255,
 3246:         r.blue / 255,
 3247:         1,
 3248:       ]);
 3249:       e.onDraw = fillRect;
 3250:       NumbersColor.enabled = true;
 3251:     }
 3252:     function createNumbers() {
 3253:       iNumbers = Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1;
 3254:       PB.maxvalue = iNumbers;
 3255:       var e = Number(StartFrom.text);
 3256:       var r = 0;
 3257:       PB.value = r + 1;
 3258:       if (mainPalette instanceof Window) {
 3259:         mainPalette.update();
 3260:       }
 3261:       app.project.activeItem.layers.addText(
 3262:         PrefixCheckbox.value
 3263:           ? Prefix.text.toString()
 3264:           : "" + e.toString() + SuffixCheckbox.value
 3265:             ? Suffix.text.toString()
 3266:             : "",
 3267:       );
 3268:       var t =
 3269:         shapeLayer.name + " - " + PrefixCheckbox.value
 3270:           ? Prefix.text.toString()
 3271:           : "" + e.toString() + SuffixCheckbox.value
 3272:             ? Suffix.text.toString()
 3273:             : "";
 3274:       app.project.activeItem.layer(
 3275:         PrefixCheckbox.value
 3276:           ? Prefix.text.toString()
 3277:           : "" + e.toString() + SuffixCheckbox.value
 3278:             ? Suffix.text.toString()
 3279:             : "",
 3280:       ).name = t;
 3281:       app.project.activeItem.layer(t).parent = app.project.activeItem.layer(
 3282:         shapeLayer.name,
 3283:       );
 3284:       app.project.activeItem.layer(t).label = labelColor;
 3285:       app.project.activeItem
 3286:         .layer(t)("ADBE Transform Group")("ADBE Position")
 3287:         .setValue([EditTextGap.text * divideBy * r, -40]);
 3288:       app.project.activeItem
 3289:         .layer(
 3290:           t,
 3291:         )("ADBE Text Properties")("ADBE Text More Options")("ADBE Text Anchor Point Option")
 3292:         .setValue(2);
 3293:       if (ShyTextLayers.value) {
 3294:         app.project.activeItem.layer(t).shy = true;
 3295:       }
 3296:       app.project.activeItem
 3297:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3298:         .addProperty("ADBE Text Animator").name = "Fill + Tracking";
 3299:       app.project.activeItem
 3300:         .layer(
 3301:           t,
 3302:         )("ADBE Text Properties")("ADBE Text Animators")("Fill + Tracking")("ADBE Text Animator Properties")
 3303:         .addProperty("ADBE Text Opacity").expression =
 3304:         'try { thisComp.layer("' +
 3305:         shapeLayer.name +
 3306:         '").effect("ADBE easyRulers")("ADBE easyRulers-0080") } catch(e) { value }';
 3307:       app.project.activeItem
 3308:         .layer(
 3309:           t,
 3310:         )("ADBE Text Properties")("ADBE Text Animators")("Fill + Tracking")("ADBE Text Animator Properties")
 3311:         .addProperty("ADBE Text Tracking Amount");
 3312:       app.project.activeItem
 3313:         .layer(
 3314:           t,
 3315:         )("ADBE Text Properties")("ADBE Text Animators")("Fill + Tracking")("ADBE Text Animator Properties")
 3316:         .addProperty("ADBE Text Fill Color").expression =
 3317:         'try { thisComp.layer("' +
 3318:         shapeLayer.name +
 3319:         '").effect("ADBE easyRulers")("ADBE easyRulers-0011") } catch(e) { value }';
 3320:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3321:         "ADBE Position",
 3322:       ).expression =
 3323:         'try { [(thisComp.layer("' +
 3324:         shapeLayer.name +
 3325:         '").effect("ADBE easyRulers")("Gap") * ' +
 3326:         divideBy +
 3327:         ")* " +
 3328:         r +
 3329:         "-((" +
 3330:         EditTextGap.text * divideBy +
 3331:         ")*" +
 3332:         r +
 3333:         ' - value[0]) + thisComp.layer("' +
 3334:         shapeLayer.name +
 3335:         '").effect("ADBE easyRulers")("Position Offset X"), value[1] + thisComp.layer("' +
 3336:         shapeLayer.name +
 3337:         '").effect("ADBE easyRulers")("Position Offset Y")] } catch(e) { value };';
 3338:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3339:         "ADBE Scale",
 3340:       ).expression =
 3341:         'try { [value[0] -100 + thisComp.layer("' +
 3342:         shapeLayer.name +
 3343:         '").effect("ADBE easyRulers")("ADBE easyRulers-0012").value, value[1] - 100 + thisComp.layer("' +
 3344:         shapeLayer.name +
 3345:         '").effect("ADBE easyRulers")("ADBE easyRulers-0012").value]  } catch(e) { value }';
 3346:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3347:         "ADBE Rotate Z",
 3348:       ).expression =
 3349:         'try { value + thisComp.layer("' +
 3350:         shapeLayer.name +
 3351:         '").effect("ADBE easyRulers")("ADBE easyRulers-0016") } catch(e) { value }';
 3352:       app.project.activeItem
 3353:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3354:         .addProperty("ADBE Text Animator").name = "Scale Effector";
 3355:       app.project.activeItem
 3356:         .layer(
 3357:           t,
 3358:         )("ADBE Text Properties")("ADBE Text Animators")("Scale Effector")("ADBE Text Animator Properties")
 3359:         .addProperty("ADBE Text Scale 3D").expression =
 3360:         'try { num_value = 0;        range = thisComp.layer("' +
 3361:         shapeLayer.name +
 3362:         '").effect("ADBE easyRulers")("ADBE easyRulers-0063");        scale_fx = thisComp.layer("' +
 3363:         shapeLayer.name +
 3364:         '").effect("ADBE easyRulers")("ADBE easyRulers-0062");        completion = thisComp.layer("' +
 3365:         shapeLayer.name +
 3366:         '").effect("ADBE easyRulers")("Completion");        x_before = range==0?0:(completion + range) / range;        x_after = range==0?0:-(completion - range) / range;        if (completion >= -range && thisComp.layer("' +
 3367:         shapeLayer.name +
 3368:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= range) {            if (completion > 0) {                 switch(thisComp.layer("' +
 3369:         shapeLayer.name +
 3370:         '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                            case 1:                            case 2: try { [value[0] + x_after * scale_fx,                                                value[1] + x_after * scale_fx] } catch(e) {value}                                        break;                            case 3: value;                                        break;                            case 4: try { [value[0] + scale_fx * (Math.pow(x_after, 4)),                                                value[1] + scale_fx * (Math.pow(x_after, 4))] } catch(e) {value};                                        break;                            case 5: try { [value[0] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1),                                                 value[1] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1)] } catch(e) {value};                                        break;                            case 6: try { [value[0] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after),                                                value[1] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }            } else {                 switch(thisComp.layer("' +
 3371:         shapeLayer.name +
 3372:         '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                            case 1:                            case 3: try { [value[0] + x_before * scale_fx,                                                value[1] + x_before * scale_fx] } catch(e) {value}                                       break;                            case 2: value;                                       break;                            case 4: try { [value[0] + scale_fx * (Math.pow(x_before, 4)),                                                value[1] + scale_fx * (Math.pow(x_before, 4))] } catch(e) {value};                            case 5: try { [value[0] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1),                                                value[1] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1)] } catch(e) {value};                                       break;                            case 6: try { [value[0] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before),                                                value[1] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }            }} else { value }         } catch(e) { value }';
 3373:       app.project.activeItem
 3374:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3375:         .addProperty("ADBE Text Animator").name = "Fill Effector";
 3376:       app.project.activeItem
 3377:         .layer(
 3378:           t,
 3379:         )("ADBE Text Properties")("ADBE Text Animators")("Fill Effector")("ADBE Text Animator Properties")
 3380:         .addProperty("ADBE Text Fill Color").expression =
 3381:         'try { thisComp.layer("' +
 3382:         shapeLayer.name +
 3383:         '").effect("ADBE easyRulers")("ADBE easyRulers-0067") } catch(e) { value }';
 3384:       app.project.activeItem
 3385:         .layer(
 3386:           t,
 3387:         )("ADBE Text Properties")("ADBE Text Animators")("Fill Effector")("ADBE Text Selectors")
 3388:         .addProperty("ADBE Text Selector")("ADBE Text Range Advanced")(
 3389:         "ADBE Text Selector Max Amount",
 3390:       ).expression =
 3391:         'try { num_value = 0;         range = thisComp.layer("' +
 3392:         shapeLayer.name +
 3393:         '").effect("ADBE easyRulers")("ADBE easyRulers-0068");         completion = thisComp.layer("' +
 3394:         shapeLayer.name +
 3395:         '").effect("ADBE easyRulers")("Completion");         x_before = range==0?0: -(num_value - completion - range) / range;         x_after = range==0?0:(num_value - completion + range) / range;         if (completion >= -range && thisComp.layer("' +
 3396:         shapeLayer.name +
 3397:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= range) {             if (completion > 0) {                 switch(thisComp.layer("' +
 3398:         shapeLayer.name +
 3399:         '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                            case 1:                            case 2: try { (range - completion) / range * 100 } catch(e) {0}                                       break;                            case 3: 0;                                       break;                            case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                       break;                           case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                       break;                           case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }             } else {                 switch(thisComp.layer("' +
 3400:         shapeLayer.name +
 3401:         '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                            case 1:                            case 3: try { (-range - completion) / range * -100 } catch(e) {0}                                       break;                            case 2: 0;                                       break;                            case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                       break;                           case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                       break;                           case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }         }} else { 0 }        } catch(e) { value }';
 3402:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3403:         "ADBE Anchor Point",
 3404:       ).expression =
 3405:         'try { num_value = 0;         range = thisComp.layer("' +
 3406:         shapeLayer.name +
 3407:         '").effect("ADBE easyRulers")("ADBE easyRulers-0058");         distance = thisComp.layer("' +
 3408:         shapeLayer.name +
 3409:         '").effect("ADBE easyRulers")("ADBE easyRulers-0057");         completion = thisComp.layer("' +
 3410:         shapeLayer.name +
 3411:         '").effect("ADBE easyRulers")("Completion");         x_before = range==0?0:(completion + range) / range;         x_after = range==0?0:-(completion - range) / range;         if (completion >= - range && thisComp.layer("' +
 3412:         shapeLayer.name +
 3413:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <=  range) {             if (completion > num_value) {               switch(thisComp.layer("' +
 3414:         shapeLayer.name +
 3415:         '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                         case 1:                         case 2: try { [value[0], value[1] + (range - completion) / range * distance] } catch(e) {value};                                    break;                         case 3: value;                                    break;                         case 4: try { [value[0], distance*(Math.pow(x_after, 4))] } catch(e) {value};                                    break;                         case 5: try { [value[0], distance*((--x_after)*x_after*x_after+1)] } catch(e) {value};                                    break;                         case 6: try { [value[0], distance*(x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }             } else {                 switch(thisComp.layer("' +
 3416:         shapeLayer.name +
 3417:         '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                         case 1:                         case 3: try { [value[0], value[1]  - (-range - completion) / range * distance] } catch(e) {value};                                    break;                         case 2: value;                                    break;                         case 4: try { [value[0], distance*(Math.pow(x_before, 4))] } catch(e) {value};                                    break;                         case 5: try { [value[0], distance*((--x_before)*x_before*x_before+1)] } catch(e) {value};                                    break;                         case 6: try { [value[0], distance*(x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }             }} else { value }          } catch(e) { value }';
 3418:       app.project.activeItem
 3419:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3420:         .addProperty("ADBE Text Animator").name = "Opacity Effector";
 3421:       app.project.activeItem
 3422:         .layer(
 3423:           t,
 3424:         )("ADBE Text Properties")("ADBE Text Animators")("Opacity Effector")("ADBE Text Animator Properties")
 3425:         .addProperty("ADBE Text Opacity").expression =
 3426:         'try { thisComp.layer("' +
 3427:         shapeLayer.name +
 3428:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value?thisComp.layer("' +
 3429:         shapeLayer.name +
 3430:         '").effect("ADBE easyRulers")("ADBE easyRulers-0072"):100 } catch(e) { value }';
 3431:       app.project.activeItem
 3432:         .layer(
 3433:           t,
 3434:         )("ADBE Text Properties")("ADBE Text Animators")("Opacity Effector")("ADBE Text Selectors")
 3435:         .addProperty("ADBE Text Selector")("ADBE Text Range Advanced")(
 3436:         "ADBE Text Selector Max Amount",
 3437:       ).expression =
 3438:         'try { num_value = 0;         range = thisComp.layer("' +
 3439:         shapeLayer.name +
 3440:         '").effect("ADBE easyRulers")("ADBE easyRulers-0074");         completion = thisComp.layer("' +
 3441:         shapeLayer.name +
 3442:         '").effect("ADBE easyRulers")("Completion");         x_before = range==0?0: -(num_value - completion - range) / range;         x_after = range==0?0:(num_value - completion + range) / range;         if (completion >= -range && thisComp.layer("' +
 3443:         shapeLayer.name +
 3444:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= range) {             if (completion > 0) {                 switch(thisComp.layer("' +
 3445:         shapeLayer.name +
 3446:         '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                            case 1:                            case 2: try { (range - completion) / range * 100 } catch(e) {0}                                        break;                            case 3: 0;                                        break;                            case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                       break;                           case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                       break;                           case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }             } else {                switch(thisComp.layer("' +
 3447:         shapeLayer.name +
 3448:         '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                            case 1:                            case 3: try { (-range - completion) / range * -100} catch(e) {0}                                        break;                            case 2: 0;                                        break;                            case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                       break;                           case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                       break;                           case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }         }} else { 0 }       } catch(e) { value }';
 3449:       app.project.activeItem.layer(t)("ADBE Text Properties")(
 3450:         "ADBE Text Animators",
 3451:       )("Opacity Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 3452:         "ADBE Text Range Advanced",
 3453:       )("ADBE Text Selector Mode").expression =
 3454:         'try { thisComp.layer("' +
 3455:         shapeLayer.name +
 3456:         '").effect("ADBE easyRulers")("ADBE easyRulers-0073").value?1:2; } catch(e) { value }';
 3457:       if (
 3458:         (PrefixCheckbox.value
 3459:           ? Prefix.text.toString()
 3460:           : "" + e.toString() + SuffixCheckbox.value
 3461:             ? Suffix.text.toString()
 3462:             : ""
 3463:         ).length > 1
 3464:       ) {
 3465:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 3466:           "ADBE Text Animators",
 3467:         )("Fill + Tracking")("ADBE Text Animator Properties")(
 3468:           "ADBE Text Tracking Amount",
 3469:         ).expression =
 3470:           'try { thisComp.layer("' +
 3471:           shapeLayer.name +
 3472:           '").effect("ADBE easyRulers")("Tracking") } catch(e) { value }';
 3473:       }
 3474:       var s = app.project.activeItem.layer(t)("Source Text");
 3475:       var o = s.value;
 3476:       o.resetParagraphStyle();
 3477:       o.justification = ParagraphJustification.CENTER_JUSTIFY;
 3478:       if (alignLeft.value) {
 3479:         o.justification = ParagraphJustification.LEFT_JUSTIFY;
 3480:       }
 3481:       if (alignRight.value) {
 3482:         o.justification = ParagraphJustification.RIGHT_JUSTIFY;
 3483:       }
 3484:       o.fontSize = NumbersSize.text;
 3485:       o.fillColor = [
 3486:         NumbersColorRGB.red / 255,
 3487:         NumbersColorRGB.green / 255,
 3488:         NumbersColorRGB.blue / 255,
 3489:       ];
 3490:       s.setValue(o);
 3491:       e = e + Number(Stepping.text.replace(",", "."));
 3492:       for (var r = 1; r < iNumbers; r += 1) {
 3493:         PB.value = r + 1;
 3494:         if (mainPalette instanceof Window) {
 3495:           mainPalette.update();
 3496:         }
 3497:         app.project.activeItem.layer(t).duplicate();
 3498:         var t =
 3499:           shapeLayer.name + " - " + PrefixCheckbox.value
 3500:             ? Prefix.text.toString()
 3501:             : "" + e.toString() + SuffixCheckbox.value
 3502:               ? Suffix.text.toString()
 3503:               : "";
 3504:         app.project.activeItem.layer(1).name = t;
 3505:         app.project.activeItem
 3506:           .layer(t)("ADBE Transform Group")("ADBE Position")
 3507:           .setValue([EditTextGap.text * divideBy * r, -40]);
 3508:         app.project.activeItem.layer(t)("ADBE Transform Group")(
 3509:           "ADBE Position",
 3510:         ).expression =
 3511:           'try { [(thisComp.layer("' +
 3512:           shapeLayer.name +
 3513:           '").effect("ADBE easyRulers")("Gap") * ' +
 3514:           divideBy +
 3515:           ")* " +
 3516:           r +
 3517:           "-((" +
 3518:           EditTextGap.text * divideBy +
 3519:           ")*" +
 3520:           r +
 3521:           ' - value[0]) + thisComp.layer("' +
 3522:           shapeLayer.name +
 3523:           '").effect("ADBE easyRulers")("Position Offset X"),             value[1] + thisComp.layer("' +
 3524:           shapeLayer.name +
 3525:           '").effect("ADBE easyRulers")("Position Offset Y")] } catch(e) { value }';
 3526:         app.project.activeItem
 3527:           .layer(
 3528:             t,
 3529:           )("ADBE Text Properties")("ADBE Text Animators")("Scale Effector")("ADBE Text Animator Properties")
 3530:           .addProperty("ADBE Text Scale 3D").expression =
 3531:           "try { num_value = " +
 3532:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * r +
 3533:           ';              range = thisComp.layer("' +
 3534:           shapeLayer.name +
 3535:           '").effect("ADBE easyRulers")("ADBE easyRulers-0063");              scale_fx = thisComp.layer("' +
 3536:           shapeLayer.name +
 3537:           '").effect("ADBE easyRulers")("ADBE easyRulers-0062");              completion = thisComp.layer("' +
 3538:           shapeLayer.name +
 3539:           '").effect("ADBE easyRulers")("Completion");              x_before = range==0?0:(completion - (num_value - range)) / range;              x_after = range==0?0:-(completion - (num_value + range)) / range;              if  (completion >= num_value - range && thisComp.layer("' +
 3540:           shapeLayer.name +
 3541:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= num_value + range) {                 if (completion > num_value) {                      switch(thisComp.layer("' +
 3542:           shapeLayer.name +
 3543:           '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                                 case 1:                                 case 2: try { [value[0] + x_after * scale_fx,                                                     value[1] + x_after * scale_fx ] } catch(e) {value}                                            break;                                 case 3: value;                                            break;                                 case 4:try { [value[0] + scale_fx*(Math.pow(x_after, 4)),                                                    value[1] + scale_fx*(Math.pow(x_after, 4))] } catch(e) {value};                                            break;                                 case 5: try { [value[0] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1),                                                     value[1] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1)] } catch(e) {value};                                             break;                                 case 6: try { [value[0] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after),                                                     value[1] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }                  } else {                     switch(thisComp.layer("' +
 3544:           shapeLayer.name +
 3545:           '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                                 case 1:                                 case 3: try { [value[0] + x_before * scale_fx,                                                     value[1] + x_before * scale_fx ] } catch(e) {value}                                             break;                                 case 2: value;                                            break;                                 case 4: try { [value[0] + scale_fx * (Math.pow(x_before, 4)),                                                     value[1] + scale_fx * (Math.pow(x_before, 4))] } catch(e) {value};                                             break;                                 case 5: try { [value[0] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1),                                                     value[1] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1)] } catch(e) {value};                                             break;                                 case 6: try { [value[0] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before),                                                     value[1] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }                  }} else { value }              } catch(e) { value }';
 3546:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 3547:           "ADBE Text Animators",
 3548:         )("Fill Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 3549:           "ADBE Text Range Advanced",
 3550:         )("ADBE Text Selector Max Amount").expression =
 3551:           "try { num_value = " +
 3552:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * r +
 3553:           ';               range = thisComp.layer("' +
 3554:           shapeLayer.name +
 3555:           '").effect("ADBE easyRulers")("ADBE easyRulers-0068");               completion = thisComp.layer("' +
 3556:           shapeLayer.name +
 3557:           '").effect("ADBE easyRulers")("Completion");               x_before = range==0?0: -(num_value - completion - range) / range;               x_after = range==0?0:(num_value - completion + range) / range;               if (completion >= num_value - range && thisComp.layer("' +
 3558:           shapeLayer.name +
 3559:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {                  if (completion > num_value) {                       switch(thisComp.layer("' +
 3560:           shapeLayer.name +
 3561:           '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                                  case 1:                                  case 2: try { ((num_value + range) - completion) / range * 100 } catch(e) {0}                                             break;                                  case 3: 0;                                             break;                                  case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                             break;                                  case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                             break;                                  case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }                   } else {                         switch(thisComp.layer("' +
 3562:           shapeLayer.name +
 3563:           '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                                    case 1:                                    case 3: try { ((num_value - range) - completion) / range * -100 } catch(e) {0}                                               break;                                    case 2: 0;                                               break;                                    case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                                break;                                    case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                               break;                                    case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }               }} else { 0 }              } catch(e) { value }';
 3564:         app.project.activeItem.layer(t)("ADBE Transform Group")(
 3565:           "ADBE Anchor Point",
 3566:         ).expression =
 3567:           "try { num_value = " +
 3568:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * r +
 3569:           ';              range = thisComp.layer("' +
 3570:           shapeLayer.name +
 3571:           '").effect("ADBE easyRulers")("ADBE easyRulers-0058");              distance = thisComp.layer("' +
 3572:           shapeLayer.name +
 3573:           '").effect("ADBE easyRulers")("ADBE easyRulers-0057");              completion = thisComp.layer("' +
 3574:           shapeLayer.name +
 3575:           '").effect("ADBE easyRulers")("Completion");              x_before = range==0?0:(completion - num_value + range) / range;              x_after = range==0?0:-(completion - num_value - range) / range;              if (completion >= num_value - range && thisComp.layer("' +
 3576:           shapeLayer.name +
 3577:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= num_value + range) {                  if (completion > num_value) {                    switch(thisComp.layer("' +
 3578:           shapeLayer.name +
 3579:           '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                              case 1:                              case 2: try { [value[0], value[1] + (num_value + range - completion) / range * distance] } catch(e) {value};                                         break;                              case 3: value;                                         break;                              case 4: try { [value[0], distance*(Math.pow(x_after, 4))] } catch(e) {value};                                          break;                              case 5: try { [value[0], distance*((--x_after)*x_after*x_after+1)] } catch(e) {value};                                          break;                              case 6: try { [value[0], distance*(x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }                  } else {                      switch(thisComp.layer("' +
 3580:           shapeLayer.name +
 3581:           '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                              case 1:                              case 3: try { [value[0], value[1]  - (num_value - range - completion) / range * distance] } catch(e) {value};                                         break;                              case 2: value;                                         break;                              case 4: try { [value[0], distance*(Math.pow(x_before, 4))] } catch(e) {value};                                          break;                              case 5: try { [value[0], distance*((--x_before)*x_before*x_before+1)] } catch(e) {value};                                          break;                              case 6: try { [value[0], distance*(x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }                  }} else { value }               } catch(e) { value }';
 3582:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 3583:           "ADBE Text Animators",
 3584:         )("Opacity Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 3585:           "ADBE Text Range Advanced",
 3586:         )("ADBE Text Selector Max Amount").expression =
 3587:           "try { num_value = " +
 3588:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * r +
 3589:           ';             range = thisComp.layer("' +
 3590:           shapeLayer.name +
 3591:           '").effect("ADBE easyRulers")("ADBE easyRulers-0074");             completion = thisComp.layer("' +
 3592:           shapeLayer.name +
 3593:           '").effect("ADBE easyRulers")("Completion");             x_before = range==0?0: -(num_value - completion - range) / range;             x_after = range==0?0:(num_value - completion + range) / range;             if (completion >= num_value - range && thisComp.layer("' +
 3594:           shapeLayer.name +
 3595:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {                if (completion > num_value) {                    switch(thisComp.layer("' +
 3596:           shapeLayer.name +
 3597:           '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                               case 1:                               case 2: try { (num_value + range - completion) / range * 100 } catch(e) {0}                                           break;                               case 3: 0;                                           break;                               case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                          break;                               case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                          break;                               case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }                 } else {                    switch(thisComp.layer("' +
 3598:           shapeLayer.name +
 3599:           '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                               case 1:                               case 3: try { (num_value - range - completion) / range * -100 } catch(e) {0}                                          break;                               case 2: 0;                                           break;                               case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                           break;                               case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                          break;                               case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }             }} else { 0 }            } catch(e) { value }';
 3600:         if (
 3601:           (PrefixCheckbox.value
 3602:             ? Prefix.text.toString()
 3603:             : "" + e.toString() + SuffixCheckbox.value
 3604:               ? Suffix.text.toString()
 3605:               : ""
 3606:           ).length > 1
 3607:         ) {
 3608:           app.project.activeItem.layer(t)("ADBE Text Properties")(
 3609:             "ADBE Text Animators",
 3610:           )("Fill + Tracking")("ADBE Text Animator Properties")(
 3611:             "ADBE Text Tracking Amount",
 3612:           ).expression =
 3613:             'try { thisComp.layer("' +
 3614:             shapeLayer.name +
 3615:             '").effect("ADBE easyRulers")("Tracking") } catch(e) { value }';
 3616:         }
 3617:         app.project.activeItem
 3618:           .layer(t)("Source Text")
 3619:           .setValue(
 3620:             PrefixCheckbox.value
 3621:               ? Prefix.text.toString()
 3622:               : "" + Stepping.text.indexOf(".") == -1
 3623:                 ? e.toString().replace(".", ",")
 3624:                 : e.toString() + SuffixCheckbox.value
 3625:                   ? Suffix.text.toString()
 3626:                   : "",
 3627:           );
 3628:         e = e + Number(Stepping.text.replace(",", "."));
 3629:       }
 3630:       app.activeViewer.setActive();
 3631:       app.executeCommand(2771);
 3632:       app.executeCommand(2387);
 3633:       app.executeCommand(2004);
 3634:       app.project.activeItem.layer(shapeLayer.name).selected = true;
 3635:       PB.value = 0;
 3636:       easyRulers_params.enableTracking = 0;
 3637:       if (parseFloat(app.version) < 14) {
 3638:         app.purge(PurgeTarget.UNDO_CACHES);
 3639:         app.beginUndoGroup("temp");
 3640:         app.endUndoGroup();
 3641:       }
 3642:     }
 3643:     function createNumbers_circle() {
 3644:       shape = new Shape();
 3645:       shape.vertices = [
 3646:         [0, 250],
 3647:         [-250, 0],
 3648:         [0, -250],
 3649:         [250, 0],
 3650:       ];
 3651:       shape.inTangents = [
 3652:         [138.071182250977, 0],
 3653:         [0, 138.071182250977],
 3654:         [-138.071166992188, 0],
 3655:         [0, -138.071166992188],
 3656:       ];
 3657:       shape.outTangents = [
 3658:         [-138.071166992188, 0],
 3659:         [0, -138.071166992188],
 3660:         [138.071182250977, 0],
 3661:         [0, 138.071182250977],
 3662:       ];
 3663:       shape.closed = true;
 3664:       iNumbers = Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1;
 3665:       PB.maxvalue = iNumbers;
 3666:       var e = 0;
 3667:       var r = Number(StartFrom.text);
 3668:       PB.value = e + 1;
 3669:       if (mainPalette instanceof Window) {
 3670:         mainPalette.update();
 3671:       }
 3672:       app.project.activeItem.layers.addText(
 3673:         PrefixCheckbox.value
 3674:           ? Prefix.text.toString()
 3675:           : "" + r.toString() + SuffixCheckbox.value
 3676:             ? Suffix.text.toString()
 3677:             : "",
 3678:       );
 3679:       var t =
 3680:         shapeLayer.name + " - " + PrefixCheckbox.value
 3681:           ? Prefix.text.toString()
 3682:           : "" + r + SuffixCheckbox.value
 3683:             ? Suffix.text.toString()
 3684:             : "";
 3685:       app.project.activeItem.layer(
 3686:         PrefixCheckbox.value
 3687:           ? Prefix.text.toString()
 3688:           : "" + r.toString() + SuffixCheckbox.value
 3689:             ? Suffix.text.toString()
 3690:             : "",
 3691:       ).name = t;
 3692:       app.project.activeItem.layer(t).parent = app.project.activeItem.layer(
 3693:         shapeLayer.name,
 3694:       );
 3695:       app.project.activeItem.layer(t).label = labelColor;
 3696:       app.project.activeItem
 3697:         .layer(t)("ADBE Transform Group")("ADBE Rotate Z")
 3698:         .setValue((EditTextGap.text / 10) * divideBy * e);
 3699:       if (ShyTextLayers.value) {
 3700:         app.project.activeItem.layer(t).shy = true;
 3701:       }
 3702:       app.project.activeItem
 3703:         .layer(t)("ADBE Mask Parade")
 3704:         .addProperty("ADBE Mask Atom")
 3705:         .maskPath.setValue(shape);
 3706:       app.project.activeItem
 3707:         .layer(
 3708:           t,
 3709:         )("ADBE Text Properties")("ADBE Text Path Options")("ADBE Text Path")
 3710:         .setValue(1);
 3711:       app.project.activeItem
 3712:         .layer(
 3713:           t,
 3714:         )("ADBE Text Properties")("ADBE Text Path Options")("ADBE Text Reverse Path")
 3715:         .setValue(0);
 3716:       app.project.activeItem
 3717:         .layer(t)("ADBE Text Properties")("ADBE Text More Options")(
 3718:           "ADBE Text Anchor Point Option",
 3719:         )
 3720:         .setValue(AnchorGroupCheckBox.value ? 1 : 4);
 3721:       app.project.activeItem
 3722:         .layer(t)("ADBE Transform Group")("ADBE Scale")
 3723:         .setValue([100 + tempDistance, 100 + tempDistance]);
 3724:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3725:         "ADBE Rotate Z",
 3726:       ).expression = alignCenter.value
 3727:         ? 'try { ((thisComp.layer("' +
 3728:           shapeLayer.name +
 3729:           '").effect("ADBE easyRulers")("Gap")/10) * ' +
 3730:           divideBy +
 3731:           ")* " +
 3732:           e +
 3733:           " } catch(e) { value }"
 3734:         : 'try { ((thisComp.layer("' +
 3735:           shapeLayer.name +
 3736:           '").effect("ADBE easyRulers")("Gap")/10) * ' +
 3737:           divideBy +
 3738:           ")* " +
 3739:           e +
 3740:           "+ 180 } catch(e) { value }";
 3741:       app.project.activeItem
 3742:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3743:         .addProperty("ADBE Text Animator")("ADBE Text Animator Properties")
 3744:         .addProperty("ADBE Text Scale 3D");
 3745:       app.project.activeItem
 3746:         .layer(
 3747:           t,
 3748:         )("ADBE Text Properties")("ADBE Text Animators")("ADBE Text Animator")("ADBE Text Animator Properties")
 3749:         .addProperty("ADBE Text Rotation").expression =
 3750:         'try { (thisComp.layer("' +
 3751:         shapeLayer.name +
 3752:         '").effect("ADBE easyRulers")("Rotation Follow") == 0 ? value : -((thisComp.layer("' +
 3753:         shapeLayer.name +
 3754:         '").effect("ADBE easyRulers")("Gap")/10) * ' +
 3755:         divideBy +
 3756:         ")* " +
 3757:         e +
 3758:         ') + thisComp.layer("' +
 3759:         shapeLayer.name +
 3760:         '").effect("ADBE easyRulers")("ADBE easyRulers-0016") } catch(e) { value }';
 3761:       app.project.activeItem
 3762:         .layer(
 3763:           t,
 3764:         )("ADBE Text Properties")("ADBE Text Animators")("ADBE Text Animator")("ADBE Text Animator Properties")
 3765:         .addProperty("ADBE Text Fill Color").expression =
 3766:         'try { thisComp.layer("' +
 3767:         shapeLayer.name +
 3768:         '").effect("ADBE easyRulers")("ADBE easyRulers-0011") } catch(e) { value }';
 3769:       app.project.activeItem
 3770:         .layer(
 3771:           t,
 3772:         )("ADBE Text Properties")("ADBE Text Animators")("ADBE Text Animator")("ADBE Text Animator Properties")
 3773:         .addProperty("ADBE Text Opacity").expression =
 3774:         'try { thisComp.layer("' +
 3775:         shapeLayer.name +
 3776:         '").effect("ADBE easyRulers")("ADBE easyRulers-0080") } catch(e) { value }';
 3777:       app.project.activeItem
 3778:         .layer(
 3779:           t,
 3780:         )("ADBE Text Properties")("ADBE Text Animators")("ADBE Text Animator")("ADBE Text Animator Properties")
 3781:         .addProperty("ADBE Text Tracking Amount");
 3782:       app.project.activeItem
 3783:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3784:         .addProperty("ADBE Text Animator").name = "Scale Effector";
 3785:       app.project.activeItem
 3786:         .layer(
 3787:           t,
 3788:         )("ADBE Text Properties")("ADBE Text Animators")("Scale Effector")("ADBE Text Animator Properties")
 3789:         .addProperty("ADBE Text Scale 3D").expression =
 3790:         'try { num_value = 0;     range = thisComp.layer("' +
 3791:         shapeLayer.name +
 3792:         '").effect("ADBE easyRulers")("ADBE easyRulers-0063");     scale_fx = thisComp.layer("' +
 3793:         shapeLayer.name +
 3794:         '").effect("ADBE easyRulers")("ADBE easyRulers-0062");     completion = thisComp.layer("' +
 3795:         shapeLayer.name +
 3796:         '").effect("ADBE easyRulers")("Completion");     x_before = range==0?0:(completion + range) / range;     x_after = range==0?0:-(completion - range) / range;     if (completion >= -range && thisComp.layer("' +
 3797:         shapeLayer.name +
 3798:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= range) {        if (completion > 0) {              switch(thisComp.layer("' +
 3799:         shapeLayer.name +
 3800:         '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                         case 1:                         case 2: try { [value[0] + x_after * scale_fx,                                             value[1] + x_after * scale_fx] } catch(e) {value}                                     break;                         case 3: value;                                     break;                         case 4: try { [value[0] + scale_fx * (Math.pow(x_after, 4)),                                             value[1] + scale_fx * (Math.pow(x_after, 4))] } catch(e) {value};                                     break;                         case 5: try { [value[0] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1),                                              value[1] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1)] } catch(e) {value};                                     break;                         case 6: try { [value[0] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after),                                             value[1] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }         } else {              switch(thisComp.layer("' +
 3801:         shapeLayer.name +
 3802:         '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                         case 1:                         case 3: try { [value[0] + x_before * scale_fx,                                             value[1] + x_before * scale_fx] } catch(e) {value}                                    break;                         case 2: value;                                    break;                         case 4: try { [value[0] + scale_fx * (Math.pow(x_before, 4)),                                             value[1] + scale_fx * (Math.pow(x_before, 4))] } catch(e) {value};                         case 5: try { [value[0] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1),                                             value[1] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1)] } catch(e) {value};                                    break;                         case 6: try { [value[0] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before),                                             value[1] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }         }} else { value }     } catch(e) { value }';
 3803:       app.project.activeItem
 3804:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3805:         .addProperty("ADBE Text Animator").name = "Fill Effector";
 3806:       app.project.activeItem
 3807:         .layer(
 3808:           t,
 3809:         )("ADBE Text Properties")("ADBE Text Animators")("Fill Effector")("ADBE Text Animator Properties")
 3810:         .addProperty("ADBE Text Fill Color").expression =
 3811:         'try { thisComp.layer("' +
 3812:         shapeLayer.name +
 3813:         '").effect("ADBE easyRulers")("ADBE easyRulers-0067") } catch(e) { value }';
 3814:       app.project.activeItem
 3815:         .layer(
 3816:           t,
 3817:         )("ADBE Text Properties")("ADBE Text Animators")("Fill Effector")("ADBE Text Selectors")
 3818:         .addProperty("ADBE Text Selector")("ADBE Text Range Advanced")(
 3819:         "ADBE Text Selector Max Amount",
 3820:       ).expression =
 3821:         'try { num_value = 0;     range = thisComp.layer("' +
 3822:         shapeLayer.name +
 3823:         '").effect("ADBE easyRulers")("ADBE easyRulers-0068");     completion = thisComp.layer("' +
 3824:         shapeLayer.name +
 3825:         '").effect("ADBE easyRulers")("Completion");     x_before = range==0?0: -(num_value - completion - range) / range;     x_after = range==0?0:(num_value - completion + range) / range;     if (completion >= -range && thisComp.layer("' +
 3826:         shapeLayer.name +
 3827:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= range) {        if (completion > 0) {             switch(thisComp.layer("' +
 3828:         shapeLayer.name +
 3829:         '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                       case 1:                       case 2: try { (range - completion) / range * 100 } catch(e) {0}                                  break;                       case 3: 0;                                  break;                       case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                  break;                      case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                  break;                      case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }         } else {            switch(thisComp.layer("' +
 3830:         shapeLayer.name +
 3831:         '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                       case 1:                       case 3: try { (-range - completion) / range * -100 } catch(e) {0}                                  break;                       case 2: 0;                                  break;                       case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                  break;                      case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                  break;                      case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }     }} else { 0 }     } catch(e) { value }';
 3832:       app.project.activeItem.layer(t)("ADBE Transform Group")(
 3833:         "ADBE Anchor Point",
 3834:       ).expression =
 3835:         'try { num_value = 0;     range = thisComp.layer("' +
 3836:         shapeLayer.name +
 3837:         '").effect("ADBE easyRulers")("ADBE easyRulers-0058");     distance = thisComp.layer("' +
 3838:         shapeLayer.name +
 3839:         '").effect("ADBE easyRulers")("ADBE easyRulers-0057");     completion = thisComp.layer("' +
 3840:         shapeLayer.name +
 3841:         '").effect("ADBE easyRulers")("Completion");     x_before = (completion + range) / range;     x_after = -(completion - range) / range;     if (completion >= num_value - range && thisComp.layer("' +
 3842:         shapeLayer.name +
 3843:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {        if (completion > num_value) {            switch(thisComp.layer("' +
 3844:         shapeLayer.name +
 3845:         '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                       case 1:                       case 2: try { [value[0], value[1] ' +
 3846:         alignCenter.value
 3847:           ? "+"
 3848:           : "-" +
 3849:               ' thisComp.layer("' +
 3850:               shapeLayer.name +
 3851:               '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (num_value + range - completion) / range * distance] } catch(e) {[value[0], value[1] ' +
 3852:               alignCenter.value
 3853:             ? "+"
 3854:             : "-" +
 3855:                 ' thisComp.layer("' +
 3856:                 shapeLayer.name +
 3857:                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];};                                   break;                       case 3: [value[0], value[1] ' +
 3858:                 alignCenter.value
 3859:               ? "+"
 3860:               : "-" +
 3861:                   ' thisComp.layer("' +
 3862:                   shapeLayer.name +
 3863:                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];                                   break;                       case 4: try { [value[0], value[1] ' +
 3864:                   alignCenter.value
 3865:                 ? "+"
 3866:                 : "-" +
 3867:                     ' thisComp.layer("' +
 3868:                     shapeLayer.name +
 3869:                     '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(Math.pow(x_after, 4)))] } catch(e) {[value[0], value[1] ' +
 3870:                     alignCenter.value
 3871:                   ? "+"
 3872:                   : "-" +
 3873:                       ' thisComp.layer("' +
 3874:                       shapeLayer.name +
 3875:                       '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                  break;                       case 5: try { [value[0], value[1] ' +
 3876:                       alignCenter.value
 3877:                     ? "+"
 3878:                     : "-" +
 3879:                         ' thisComp.layer("' +
 3880:                         shapeLayer.name +
 3881:                         '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*((--x_after)*x_after*x_after+1))] } catch(e) {[value[0], value[1] ' +
 3882:                         alignCenter.value
 3883:                       ? "+"
 3884:                       : "-" +
 3885:                           ' thisComp.layer("' +
 3886:                           shapeLayer.name +
 3887:                           '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                  break;                      case 6: try { [value[0], value[1] ' +
 3888:                           alignCenter.value
 3889:                         ? "+"
 3890:                         : "-" +
 3891:                             ' thisComp.layer("' +
 3892:                             shapeLayer.name +
 3893:                             '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after))] } catch(e) {[value[0], value[1] ' +
 3894:                             alignCenter.value
 3895:                           ? "+"
 3896:                           : "-" +
 3897:                               ' thisComp.layer("' +
 3898:                               shapeLayer.name +
 3899:                               '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]}; }        } else {              switch(thisComp.layer("' +
 3900:                               shapeLayer.name +
 3901:                               '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                        case 1:                        case 3: try { [value[0], value[1] ' +
 3902:                               alignCenter.value
 3903:                             ? "+"
 3904:                             : "-" +
 3905:                                 ' thisComp.layer("' +
 3906:                                 shapeLayer.name +
 3907:                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value - (num_value - range - completion) / range * distance] } catch(e) {[value[0], value[1] ' +
 3908:                                 alignCenter.value
 3909:                               ? "+"
 3910:                               : "-" +
 3911:                                   ' thisComp.layer("' +
 3912:                                   shapeLayer.name +
 3913:                                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];};                                  break;                        case 2: [value[0], value[1] ' +
 3914:                                   alignCenter.value
 3915:                                 ? "+"
 3916:                                 : "-" +
 3917:                                     ' thisComp.layer("' +
 3918:                                     shapeLayer.name +
 3919:                                     '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];                                    break;                       case 4: try { [value[0], value[1] ' +
 3920:                                     alignCenter.value
 3921:                                   ? "+"
 3922:                                   : "-" +
 3923:                                       ' thisComp.layer("' +
 3924:                                       shapeLayer.name +
 3925:                                       '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(Math.pow(x_before, 4)))] } catch(e) {[value[0], value[1] ' +
 3926:                                       alignCenter.value
 3927:                                     ? "+"
 3928:                                     : "-" +
 3929:                                         ' thisComp.layer("' +
 3930:                                         shapeLayer.name +
 3931:                                         '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                   break;                       case 5: try { [value[0], value[1] ' +
 3932:                                         alignCenter.value
 3933:                                       ? "+"
 3934:                                       : "-" +
 3935:                                           ' thisComp.layer("' +
 3936:                                           shapeLayer.name +
 3937:                                           '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*((--x_before)*x_before*x_before+1))] } catch(e) {[value[0], value[1] ' +
 3938:                                           alignCenter.value
 3939:                                         ? "+"
 3940:                                         : "-" +
 3941:                                             ' thisComp.layer("' +
 3942:                                             shapeLayer.name +
 3943:                                             '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                   break;                       case 6: try { [value[0], value[1] ' +
 3944:                                             alignCenter.value
 3945:                                           ? "+"
 3946:                                           : "-" +
 3947:                                               ' thisComp.layer("' +
 3948:                                               shapeLayer.name +
 3949:                                               '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before))] } catch(e) {[value[0], value[1] ' +
 3950:                                               alignCenter.value
 3951:                                             ? "+"
 3952:                                             : "-" +
 3953:                                                 ' thisComp.layer("' +
 3954:                                                 shapeLayer.name +
 3955:                                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]}; }         } } else { [value[0], value[1] ' +
 3956:                                                 alignCenter.value
 3957:                                               ? "+"
 3958:                                               : "-" +
 3959:                                                 ' thisComp.layer("' +
 3960:                                                 shapeLayer.name +
 3961:                                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value] }      } catch(e) { value }';
 3962:       app.project.activeItem
 3963:         .layer(t)("ADBE Text Properties")("ADBE Text Animators")
 3964:         .addProperty("ADBE Text Animator").name = "Opacity Effector";
 3965:       app.project.activeItem
 3966:         .layer(
 3967:           t,
 3968:         )("ADBE Text Properties")("ADBE Text Animators")("Opacity Effector")("ADBE Text Animator Properties")
 3969:         .addProperty("ADBE Text Opacity").expression =
 3970:         'try { thisComp.layer("' +
 3971:         shapeLayer.name +
 3972:         '").effect("ADBE easyRulers")("ADBE easyRulers-0072") } catch(e) { value }';
 3973:       app.project.activeItem
 3974:         .layer(
 3975:           t,
 3976:         )("ADBE Text Properties")("ADBE Text Animators")("Opacity Effector")("ADBE Text Selectors")
 3977:         .addProperty("ADBE Text Selector")("ADBE Text Range Advanced")(
 3978:         "ADBE Text Selector Max Amount",
 3979:       ).expression =
 3980:         'try { num_value = 0;       range = thisComp.layer("' +
 3981:         shapeLayer.name +
 3982:         '").effect("ADBE easyRulers")("ADBE easyRulers-0074");       completion = thisComp.layer("' +
 3983:         shapeLayer.name +
 3984:         '").effect("ADBE easyRulers")("Completion");       x_before = range==0?0: -(num_value - completion - range) / range;       x_after = range==0?0:(num_value - completion + range) / range;       if (completion >= -range && thisComp.layer("' +
 3985:         shapeLayer.name +
 3986:         '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= range) {           if (completion > 0) {               switch(thisComp.layer("' +
 3987:         shapeLayer.name +
 3988:         '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                          case 1:                          case 2: try { (range - completion) / range * 100 } catch(e) {0}                                      break;                          case 3: 0;                                      break;                          case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                     break;                         case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                     break;                         case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }           } else {              switch(thisComp.layer("' +
 3989:         shapeLayer.name +
 3990:         '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                          case 1:                          case 3: try { (-range - completion) / range * -100} catch(e) {0}                                      break;                          case 2: 0;                                      break;                          case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                     break;                         case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                     break;                         case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }       }} else { 0 }      } catch(e) { value }';
 3991:       app.project.activeItem.layer(t)("ADBE Text Properties")(
 3992:         "ADBE Text Animators",
 3993:       )("Opacity Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 3994:         "ADBE Text Range Advanced",
 3995:       )("ADBE Text Selector Mode").expression =
 3996:         'try { thisComp.layer("' +
 3997:         shapeLayer.name +
 3998:         '").effect("ADBE easyRulers")("ADBE easyRulers-0073").value?1:2 } catch(e) { value }';
 3999:       app.project.activeItem
 4000:         .layer(
 4001:           t,
 4002:         )("ADBE Text Properties")("ADBE Text More Options")("ADBE Text Anchor Point Align")
 4003:         .setValue([0, -50]);
 4004:       app.project.activeItem.layer(t)("ADBE Text Properties")(
 4005:         "ADBE Text Animators",
 4006:       )("ADBE Text Animator")("ADBE Text Animator Properties")(
 4007:         "ADBE Text Scale 3D",
 4008:       ).expression =
 4009:         'try { [value[0] -100 + thisComp.layer("' +
 4010:         shapeLayer.name +
 4011:         '").effect("ADBE easyRulers")("ADBE easyRulers-0012").value, value[1] - 100 + thisComp.layer("' +
 4012:         shapeLayer.name +
 4013:         '").effect("ADBE easyRulers")("ADBE easyRulers-0012").value] } catch(e) { value }';
 4014:       if (
 4015:         (PrefixCheckbox.value
 4016:           ? Prefix.text.toString()
 4017:           : "" + r.toString() + SuffixCheckbox.value
 4018:             ? Suffix.text.toString()
 4019:             : ""
 4020:         ).length > 1
 4021:       ) {
 4022:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 4023:           "ADBE Text Animators",
 4024:         )("ADBE Text Animator")("ADBE Text Animator Properties")(
 4025:           "ADBE Text Tracking Amount",
 4026:         ).expression =
 4027:           'try { thisComp.layer("' +
 4028:           shapeLayer.name +
 4029:           '").effect("ADBE easyRulers")("Tracking") } catch(e) { value }';
 4030:       }
 4031:       var s = app.project.activeItem.layer(t)("Source Text");
 4032:       var o = s.value;
 4033:       o.resetParagraphStyle();
 4034:       o.justification = ParagraphJustification.CENTER_JUSTIFY;
 4035:       if (alignLeft.value) {
 4036:         o.justification = ParagraphJustification.LEFT_JUSTIFY;
 4037:       }
 4038:       if (alignRight.value) {
 4039:         o.justification = ParagraphJustification.RIGHT_JUSTIFY;
 4040:       }
 4041:       o.fontSize = NumbersSize.text;
 4042:       o.fillColor = [
 4043:         NumbersColorRGB.red / 255,
 4044:         NumbersColorRGB.green / 255,
 4045:         NumbersColorRGB.blue / 255,
 4046:       ];
 4047:       s.setValue(o);
 4048:       r = r + Number(Stepping.text.replace(",", "."));
 4049:       for (var e = 1; e < iNumbers; e += 1) {
 4050:         PB.value = e + 1;
 4051:         if (mainPalette instanceof Window) {
 4052:           mainPalette.update();
 4053:         }
 4054:         app.project.activeItem.layer(t).duplicate();
 4055:         var t =
 4056:           shapeLayer.name + " - " + PrefixCheckbox.value
 4057:             ? Prefix.text.toString()
 4058:             : "" + r + SuffixCheckbox.value
 4059:               ? Suffix.text.toString()
 4060:               : "";
 4061:         app.project.activeItem.layer(1).name = t;
 4062:         app.project.activeItem
 4063:           .layer(t)("ADBE Transform Group")("ADBE Rotate Z")
 4064:           .setValue((EditTextGap.text / 10) * divideBy * e);
 4065:         app.project.activeItem
 4066:           .layer(t)("ADBE Transform Group")("ADBE Scale")
 4067:           .setValue([100 + tempDistance, 100 + tempDistance]);
 4068:         app.project.activeItem.layer(t)("ADBE Transform Group")(
 4069:           "ADBE Rotate Z",
 4070:         ).expression = alignCenter.value
 4071:           ? 'try { ((thisComp.layer("' +
 4072:             shapeLayer.name +
 4073:             '").effect("ADBE easyRulers")("Gap")/10) * ' +
 4074:             divideBy +
 4075:             ")* " +
 4076:             e +
 4077:             " } catch(e) { value }"
 4078:           : 'try { ((thisComp.layer("' +
 4079:             shapeLayer.name +
 4080:             '").effect("ADBE easyRulers")("Gap")/10) * ' +
 4081:             divideBy +
 4082:             ")* " +
 4083:             e +
 4084:             "+ 180 } catch(e) { value }";
 4085:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 4086:           "ADBE Text Animators",
 4087:         )("ADBE Text Animator")("ADBE Text Animator Properties")(
 4088:           "ADBE Text Rotation",
 4089:         ).expression =
 4090:           'try { (thisComp.layer("' +
 4091:           shapeLayer.name +
 4092:           '").effect("ADBE easyRulers")("Rotation Follow") == 0 ? value : -((thisComp.layer("' +
 4093:           shapeLayer.name +
 4094:           '").effect("ADBE easyRulers")("Gap")/10) * ' +
 4095:           divideBy +
 4096:           ")* " +
 4097:           e +
 4098:           ') + thisComp.layer("' +
 4099:           shapeLayer.name +
 4100:           '").effect("ADBE easyRulers")("ADBE easyRulers-0016") } catch(e) { value }';
 4101:         app.project.activeItem
 4102:           .layer(
 4103:             t,
 4104:           )("ADBE Text Properties")("ADBE Text More Options")("ADBE Text Anchor Point Align")
 4105:           .setValue([0, -50]);
 4106:         app.project.activeItem
 4107:           .layer(
 4108:             t,
 4109:           )("ADBE Text Properties")("ADBE Text Animators")("Scale Effector")("ADBE Text Animator Properties")
 4110:           .addProperty("ADBE Text Scale 3D").expression =
 4111:           "try { num_value = " +
 4112:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * e +
 4113:           ';                  range = thisComp.layer("' +
 4114:           shapeLayer.name +
 4115:           '").effect("ADBE easyRulers")("ADBE easyRulers-0063");                  scale_fx = thisComp.layer("' +
 4116:           shapeLayer.name +
 4117:           '").effect("ADBE easyRulers")("ADBE easyRulers-0062");                  completion = thisComp.layer("' +
 4118:           shapeLayer.name +
 4119:           '").effect("ADBE easyRulers")("Completion");                  x_before = (completion - (num_value - range)) / range;                  x_after = -(completion - (num_value + range)) / range;                  if  (completion >= num_value - range && thisComp.layer("' +
 4120:           shapeLayer.name +
 4121:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043") && completion <= num_value + range) {                    if (completion > num_value) {                         switch(thisComp.layer("' +
 4122:           shapeLayer.name +
 4123:           '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                                    case 1:                                    case 2: try { [value[0] + x_after * scale_fx,                                                        value[1] + x_after * scale_fx ] } catch(e) {value}                                               break;                                    case 3: value;                                               break;                                    case 4:try { [value[0] + scale_fx*(Math.pow(x_after, 4)),                                                       value[1] + scale_fx*(Math.pow(x_after, 4))] } catch(e) {value};                                               break;                                    case 5: try { [value[0] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1),                                                        value[1] + scale_fx * ((x_after-1)*(x_after-1)*(x_after-1)+1)] } catch(e) {value};                                                break;                                    case 6: try { [value[0] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after),                                                        value[1] + scale_fx * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after)] } catch(e) {value}; }                     } else {                         switch(thisComp.layer("' +
 4124:           shapeLayer.name +
 4125:           '").effect("ADBE easyRulers")("ADBE easyRulers-0064").value) {                                    case 1:                                    case 3: try { [value[0] + x_before * scale_fx,                                                        value[1] + x_before * scale_fx ] } catch(e) {value}                                               break;                                    case 2: value;                                               break;                                    case 4: try { [value[0] + scale_fx * (Math.pow(x_before, 4)),                                                        value[1] + scale_fx * (Math.pow(x_before, 4))] } catch(e) {value};                                                break;                                    case 5: try { [value[0] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1),                                                        value[1] + scale_fx * ((x_before-1)*(x_before-1)*(x_before-1)+1)] } catch(e) {value};                                                break;                                    case 6: try { [value[0] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before),                                                        value[1] + scale_fx * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before)] } catch(e) {value}; }                     }} else { value }                } catch(e) { value }';
 4126:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 4127:           "ADBE Text Animators",
 4128:         )("Fill Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 4129:           "ADBE Text Range Advanced",
 4130:         )("ADBE Text Selector Max Amount").expression =
 4131:           "try { num_value = " +
 4132:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * e +
 4133:           ';                 range = thisComp.layer("' +
 4134:           shapeLayer.name +
 4135:           '").effect("ADBE easyRulers")("ADBE easyRulers-0068");                 completion = thisComp.layer("' +
 4136:           shapeLayer.name +
 4137:           '").effect("ADBE easyRulers")("Completion");                 x_before = range==0?0: -(num_value - completion - range) / range;                 x_after = range==0?0:(num_value - completion + range) / range;                 if (completion >= num_value - range && thisComp.layer("' +
 4138:           shapeLayer.name +
 4139:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {                    if (completion > num_value) {                         switch(thisComp.layer("' +
 4140:           shapeLayer.name +
 4141:           '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                                    case 1:                                    case 2: try { ((num_value + range) - completion) / range * 100 } catch(e) {0}                                               break;                                    case 3: 0;                                               break;                                    case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                               break;                                    case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                               break;                                    case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }                     } else {                           switch(thisComp.layer("' +
 4142:           shapeLayer.name +
 4143:           '").effect("ADBE easyRulers")("ADBE easyRulers-0069").value) {                                      case 1:                                      case 3: try { ((num_value - range) - completion) / range * -100 } catch(e) {0}                                                 break;                                      case 2: 0;                                                 break;                                      case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                                  break;                                      case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                                 break;                                      case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }                 }} else { 0 }               } catch(e) { value }';
 4144:         app.project.activeItem.layer(t)("ADBE Transform Group")(
 4145:           "ADBE Anchor Point",
 4146:         ).expression =
 4147:           "try { num_value = " +
 4148:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * e +
 4149:           ';                range = thisComp.layer("' +
 4150:           shapeLayer.name +
 4151:           '").effect("ADBE easyRulers")("ADBE easyRulers-0058");                distance = thisComp.layer("' +
 4152:           shapeLayer.name +
 4153:           '").effect("ADBE easyRulers")("ADBE easyRulers-0057");                completion = thisComp.layer("' +
 4154:           shapeLayer.name +
 4155:           '").effect("ADBE easyRulers")("Completion");                x_before = (completion - num_value + range) / range;                x_after = -(completion - num_value - range) / range;                if (completion >= num_value - range && thisComp.layer("' +
 4156:           shapeLayer.name +
 4157:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {                    if (completion > num_value) {                        switch(thisComp.layer("' +
 4158:           shapeLayer.name +
 4159:           '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                                   case 1:                                   case 2: try { [value[0], value[1] ' +
 4160:           alignCenter.value
 4161:             ? "+"
 4162:             : "-" +
 4163:                 ' thisComp.layer("' +
 4164:                 shapeLayer.name +
 4165:                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (num_value + range - completion) / range * distance] } catch(e) {[value[0], value[1] ' +
 4166:                 alignCenter.value
 4167:               ? "+"
 4168:               : "-" +
 4169:                   ' thisComp.layer("' +
 4170:                   shapeLayer.name +
 4171:                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];};                                               break;                                   case 3: [value[0], value[1] ' +
 4172:                   alignCenter.value
 4173:                 ? "+"
 4174:                 : "-" +
 4175:                     ' thisComp.layer("' +
 4176:                     shapeLayer.name +
 4177:                     '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];                                               break;                                   case 4: try { [value[0], value[1] ' +
 4178:                     alignCenter.value
 4179:                   ? "+"
 4180:                   : "-" +
 4181:                       ' thisComp.layer("' +
 4182:                       shapeLayer.name +
 4183:                       '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(Math.pow(x_after, 4)))] } catch(e) {[value[0], value[1] ' +
 4184:                       alignCenter.value
 4185:                     ? "+"
 4186:                     : "-" +
 4187:                         ' thisComp.layer("' +
 4188:                         shapeLayer.name +
 4189:                         '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                              break;                                  case 5: try { [value[0], value[1] ' +
 4190:                         alignCenter.value
 4191:                       ? "+"
 4192:                       : "-" +
 4193:                           ' thisComp.layer("' +
 4194:                           shapeLayer.name +
 4195:                           '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*((--x_after)*x_after*x_after+1))] } catch(e) {[value[0], value[1] ' +
 4196:                           alignCenter.value
 4197:                         ? "+"
 4198:                         : "-" +
 4199:                             ' thisComp.layer("' +
 4200:                             shapeLayer.name +
 4201:                             '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                              break;                                  case 6: try { [value[0], value[1] ' +
 4202:                             alignCenter.value
 4203:                           ? "+"
 4204:                           : "-" +
 4205:                               ' thisComp.layer("' +
 4206:                               shapeLayer.name +
 4207:                               '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after))] } catch(e) {[value[0], value[1] ' +
 4208:                               alignCenter.value
 4209:                             ? "+"
 4210:                             : "-" +
 4211:                                 ' thisComp.layer("' +
 4212:                                 shapeLayer.name +
 4213:                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]}; }                    } else {                         switch(thisComp.layer("' +
 4214:                                 shapeLayer.name +
 4215:                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0059").value) {                                   case 1:                                   case 3: try { [value[0], value[1] ' +
 4216:                                 alignCenter.value
 4217:                               ? "+"
 4218:                               : "-" +
 4219:                                   ' thisComp.layer("' +
 4220:                                   shapeLayer.name +
 4221:                                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value - (num_value - range - completion) / range * distance] } catch(e) {[value[0], value[1] ' +
 4222:                                   alignCenter.value
 4223:                                 ? "+"
 4224:                                 : "-" +
 4225:                                     ' thisComp.layer("' +
 4226:                                     shapeLayer.name +
 4227:                                     '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];};                                             break;                                   case 2: [value[0], value[1] ' +
 4228:                                     alignCenter.value
 4229:                                   ? "+"
 4230:                                   : "-" +
 4231:                                       ' thisComp.layer("' +
 4232:                                       shapeLayer.name +
 4233:                                       '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value];                                               break;                                  case 4: try { [value[0], value[1] ' +
 4234:                                       alignCenter.value
 4235:                                     ? "+"
 4236:                                     : "-" +
 4237:                                         ' thisComp.layer("' +
 4238:                                         shapeLayer.name +
 4239:                                         '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(Math.pow(x_before, 4)))] } catch(e) {[value[0], value[1] ' +
 4240:                                         alignCenter.value
 4241:                                       ? "+"
 4242:                                       : "-" +
 4243:                                           ' thisComp.layer("' +
 4244:                                           shapeLayer.name +
 4245:                                           '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                              break;                                  case 5: try { [value[0], value[1] ' +
 4246:                                           alignCenter.value
 4247:                                         ? "+"
 4248:                                         : "-" +
 4249:                                             ' thisComp.layer("' +
 4250:                                             shapeLayer.name +
 4251:                                             '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*((--x_before)*x_before*x_before+1))] } catch(e) {[value[0], value[1] ' +
 4252:                                             alignCenter.value
 4253:                                           ? "+"
 4254:                                           : "-" +
 4255:                                               ' thisComp.layer("' +
 4256:                                               shapeLayer.name +
 4257:                                               '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]};                                              break;                                  case 6: try { [value[0], value[1] ' +
 4258:                                               alignCenter.value
 4259:                                             ? "+"
 4260:                                             : "-" +
 4261:                                                 ' thisComp.layer("' +
 4262:                                                 shapeLayer.name +
 4263:                                                 '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value + (distance*(x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before))] } catch(e) {[value[0], value[1] ' +
 4264:                                                 alignCenter.value
 4265:                                               ? "+"
 4266:                                               : "-" +
 4267:                                                   ' thisComp.layer("' +
 4268:                                                   shapeLayer.name +
 4269:                                                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value]}; }                    } } else { [value[0], value[1] ' +
 4270:                                                   alignCenter.value
 4271:                                                 ? "+"
 4272:                                                 : "-" +
 4273:                                                   ' thisComp.layer("' +
 4274:                                                   shapeLayer.name +
 4275:                                                   '").effect("ADBE easyRulers")("ADBE easyRulers-0015").value] }              } catch(e) { value }';
 4276:         app.project.activeItem.layer(t)("ADBE Text Properties")(
 4277:           "ADBE Text Animators",
 4278:         )("Opacity Effector")("ADBE Text Selectors")("ADBE Text Selector")(
 4279:           "ADBE Text Range Advanced",
 4280:         )("ADBE Text Selector Max Amount").expression =
 4281:           "try { num_value = " +
 4282:           (100 / ((Number(EditTextCopies.text) - 1) / divideBy)) * e +
 4283:           ';               range = thisComp.layer("' +
 4284:           shapeLayer.name +
 4285:           '").effect("ADBE easyRulers")("ADBE easyRulers-0074");               completion = thisComp.layer("' +
 4286:           shapeLayer.name +
 4287:           '").effect("ADBE easyRulers")("Completion");               x_before = range==0?0: -(num_value - completion - range) / range;               x_after = range==0?0:(num_value - completion + range) / range;               if (completion >= num_value - range && thisComp.layer("' +
 4288:           shapeLayer.name +
 4289:           '").effect("ADBE easyRulers")("ADBE easyRulers-0043").value && completion <= num_value + range) {                  if (completion > num_value) {                      switch(thisComp.layer("' +
 4290:           shapeLayer.name +
 4291:           '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                                 case 1:                                 case 2: try { (num_value + range - completion) / range * 100 } catch(e) {0}                                             break;                                 case 3: 0;                                             break;                                 case 4: try { 100 * (Math.pow(x_after, 4)) } catch(e) {value};                                            break;                                 case 5: try { 100 * ((--x_after)*x_after*x_after+1) } catch(e) {value};                                            break;                                 case 6: try { 100 * (x_after<0.5?2*x_after*x_after: -1+(4-2*x_after)*x_after) } catch(e) {value}; }                   } else {                      switch(thisComp.layer("' +
 4292:           shapeLayer.name +
 4293:           '").effect("ADBE easyRulers")("ADBE easyRulers-0075").value) {                                 case 1:                                 case 3: try { (num_value - range - completion) / range * -100 } catch(e) {0}                                            break;                                 case 2: 0;                                             break;                                 case 4: try { 100 * (Math.pow(x_before, 4)) } catch(e) {value};                                             break;                                 case 5: try { 100 * ((--x_before)*x_before*x_before+1) } catch(e) {value};                                            break;                                 case 6: try { 100 * (x_before<0.5?2*x_before*x_before: -1+(4-2*x_before)*x_before) } catch(e) {value}; }               }} else { 0 }             } catch(e) { value }';
 4294:         if (
 4295:           (PrefixCheckbox.value
 4296:             ? Prefix.text.toString()
 4297:             : "" + r.toString() + SuffixCheckbox.value
 4298:               ? Suffix.text.toString()
 4299:               : ""
 4300:           ).length > 1
 4301:         ) {
 4302:           app.project.activeItem.layer(t)("ADBE Text Properties")(
 4303:             "ADBE Text Animators",
 4304:           )("ADBE Text Animator")("ADBE Text Animator Properties")(
 4305:             "ADBE Text Tracking Amount",
 4306:           ).expression =
 4307:             'try { thisComp.layer("' +
 4308:             shapeLayer.name +
 4309:             '").effect("ADBE easyRulers")("Tracking") } catch(e) { value }';
 4310:         }
 4311:         app.project.activeItem
 4312:           .layer(t)("Source Text")
 4313:           .setValue(
 4314:             PrefixCheckbox.value
 4315:               ? Prefix.text.toString()
 4316:               : "" + Stepping.text.indexOf(".") == -1
 4317:                 ? r.toString().replace(".", ",")
 4318:                 : r.toString() + SuffixCheckbox.value
 4319:                   ? Suffix.text.toString()
 4320:                   : "",
 4321:           );
 4322:         r = r + Number(Stepping.text.replace(",", "."));
 4323:       }
 4324:       app.activeViewer.setActive();
 4325:       app.executeCommand(2771);
 4326:       app.executeCommand(2387);
 4327:       app.executeCommand(2004);
 4328:       app.project.activeItem.layer(shapeLayer.name).selected = true;
 4329:       PB.value = 0;
 4330:       easyRulers_params.enableTracking = 0;
 4331:       tempDistance = 0;
 4332:       if (parseFloat(app.version) < 14) {
 4333:         app.purge(PurgeTarget.UNDO_CACHES);
 4334:         app.beginUndoGroup("temp");
 4335:         app.endUndoGroup();
 4336:       }
 4337:     }
 4338:     function createRuler() {
 4339:       var e = app.project.activeItem;
 4340:       if (e) {
 4341:         shapeLayer = e.layers.addShape();
 4342:         ruler = 1;
 4343:         shapeLayer.comment = "easyRulers v" + af_settings.scriptVersion;
 4344:         for (var r = 1; r < app.project.activeItem.numLayers; r += 1) {
 4345:           shapeLayer.name = "easyRuler " + ruler;
 4346:           if (app.project.activeItem.layer(r).name == shapeLayer.name) {
 4347:             ruler = ruler + 1;
 4348:             r = 1;
 4349:           }
 4350:         }
 4351:         if (labelColor + 1 == 17) {
 4352:           labelColor = 0;
 4353:         }
 4354:         labelColor = labelColor + 1;
 4355:         shapeLayer.name = "easyRuler " + ruler;
 4356:         shapeLayer.label = labelColor;
 4357:         var t = app.project.activeItem.layer(shapeLayer.name)(
 4358:           "ADBE Effect Parade",
 4359:         );
 4360:         if (rulerLine.value) {
 4361:           app.project.activeItem
 4362:             .layer(shapeLayer.name)("ADBE Transform Group")("ADBE Position")
 4363:             .setValue([
 4364:               e.width / 2 - (EditTextGap.text * EditTextCopies.text) / 2,
 4365:               e.height / 2,
 4366:             ]);
 4367:         }
 4368:         app.project.activeItem
 4369:           .layer(shapeLayer.name)("ADBE Root Vectors Group")
 4370:           .addProperty("ADBE Vector Group").name = "Ruler";
 4371:         shorten = app.project.activeItem.layer(shapeLayer.name)(
 4372:           "ADBE Root Vectors Group",
 4373:         )("Ruler")("ADBE Vectors Group");
 4374:         if (NumbersCheckBox.value && Stepping.text.match(/[,\.]+/g) == null) {
 4375:           var s = Number(StartFrom.text);
 4376:           iNumbers = Math.floor((Number(EditTextCopies.text) - 1) / divideBy);
 4377:           s = s + iNumbers * Number(Stepping.text.replace(",", "."));
 4378:           if (
 4379:             StartFrom.text.length < 2 &&
 4380:             (PrefixCheckbox.value
 4381:               ? Prefix.text.toString()
 4382:               : "" + s.toString() + SuffixCheckbox.value
 4383:                 ? Suffix.text.toString()
 4384:                 : ""
 4385:             ).length < 2
 4386:           ) {
 4387:             easyRulers_params.enableTracking = 1;
 4388:           }
 4389:         }
 4390:         t.addProperty("ADBE easyRulers");
 4391:         if (t("ADBE easyRulers")("ADBE easyRulers-0078").value != 2) {
 4392:           if ($.os.indexOf("Windows") == 0) {
 4393:             alert(
 4394:               "It seems that you have a different version of the easyRulers.aex file installed in your After Effects plug-ins folder. Please exit After Effects, replace easyRulers.aex with the one included in the .zip file you downloaded from aescripts.com and restart After Effects.",
 4395:             );
 4396:           } else {
 4397:             alert(
 4398:               "It seems that you have a different version of the easyRulers.plugin file installed in your After Effects plug-ins folder. Please exit After Effects, replace easyRulers.plugin with the one included in the .zip file you downloaded from aescripts.com and restart After Effects.",
 4399:             );
 4400:           }
 4401:         }
 4402:         t("ADBE easyRulers")("Number Of Divisions").setValue(
 4403:           EditTextCopies.text,
 4404:         );
 4405:         t("ADBE easyRulers")("default Number Of Divisions").setValue(
 4406:           EditTextCopies.text,
 4407:         );
 4408:         t("ADBE easyRulers")("ADBE easyRulers-0043").setValue(false);
 4409:         t("ADBE easyRulers")("Gap").setValue(EditTextGap.text);
 4410:         t("ADBE easyRulers")("default Gap").setValue(EditTextGap.text);
 4411:         if (NumbersCheckBox.value) {
 4412:           t("ADBE easyRulers")("ADBE easyRulers-0011").setValue([
 4413:             NumbersColorRGB.red / 255,
 4414:             NumbersColorRGB.green / 255,
 4415:             NumbersColorRGB.blue / 255,
 4416:             1,
 4417:           ]);
 4418:           t("ADBE easyRulers")("default Text Color").setValue([
 4419:             NumbersColorRGB.red / 255,
 4420:             NumbersColorRGB.green / 255,
 4421:             NumbersColorRGB.blue / 255,
 4422:             1,
 4423:           ]);
 4424:         }
 4425:         createPointerLinear = function () {
 4426:           shorten = app.project.activeItem.layer(shapeLayer.name)(
 4427:             "ADBE Root Vectors Group",
 4428:           )("Ruler")("ADBE Vectors Group");
 4429:           shorten.addProperty("ADBE Vector Group").name = "pointer";
 4430:           t("ADBE easyRulers")("ADBE easyRulers-0046").setValue(25);
 4431:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4432:             "ADBE Vector Shape - Star",
 4433:           ).name = "triangle";
 4434:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4435:             "ADBE Vector Star Type",
 4436:           ).setValue(2);
 4437:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4438:             "ADBE Vector Star Points",
 4439:           ).setValue(3);
 4440:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4441:             "ADBE Vector Star Outer Radius",
 4442:           ).expression =
 4443:             'try { if (effect("ADBE easyRulers")("Shape").value == 1) { effect("ADBE easyRulers")("ADBE easyRulers-0046")*2 < 0?-effect("ADBE easyRulers")("ADBE easyRulers-0046")*2:effect("ADBE easyRulers")("ADBE easyRulers-0046")*2; } else { 0 } } catch(e) { 0 };';
 4444:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4445:             "ADBE Vector Shape - Star",
 4446:           ).name = "dot";
 4447:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4448:             "ADBE Vector Star Type",
 4449:           ).setValue(2);
 4450:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4451:             "ADBE Vector Star Points",
 4452:           ).setValue(64);
 4453:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4454:             "ADBE Vector Star Outer Radius",
 4455:           ).expression =
 4456:             'try { effect("ADBE easyRulers")("Shape").value == 2?effect("ADBE easyRulers")("ADBE easyRulers-0046")*1.5:0; } catch(e) { value }';
 4457:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4458:             "ADBE Vector Shape - Rect",
 4459:           ).name = "line";
 4460:           shorten("pointer")("ADBE Vectors Group")("line")(
 4461:             "ADBE Vector Rect Size",
 4462:           ).expression =
 4463:             'try { effect("ADBE easyRulers")("Shape").value == 3?[effect("ADBE easyRulers")("ADBE easyRulers-0047"), effect("ADBE easyRulers")("ADBE easyRulers-0048")]:[0,0]; } catch(e) { value }';
 4464:           shape_pointer = new Shape();
 4465:           shape_pointer.vertices = [
 4466:             [17, -15],
 4467:             [0, -45],
 4468:             [-17, -15],
 4469:             [-17, 13],
 4470:             [17, 13],
 4471:           ];
 4472:           shape_pointer.closed = true;
 4473:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4474:             "ADBE Vector Group",
 4475:           ).name = "squared triangle";
 4476:           shorten("pointer")("ADBE Vectors Group")("squared triangle")(
 4477:             "ADBE Vectors Group",
 4478:           )
 4479:             .addProperty("ADBE Vector Shape - Group")("ADBE Vector Shape")
 4480:             .setValue(shape_pointer);
 4481:           shorten("pointer")("ADBE Vectors Group")("squared triangle")(
 4482:             "ADBE Vector Transform Group",
 4483:           )("ADBE Vector Scale").expression =
 4484:             'try { effect("ADBE easyRulers")("Shape").value == 4?[150,150]:[0,0]; } catch(e) { value }';
 4485:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4486:             "ADBE Vector Graphic - Fill",
 4487:           )("ADBE Vector Fill Color").expression =
 4488:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0051") } catch(e) { value }';
 4489:           shorten("pointer")("ADBE Vectors Group")(
 4490:             "ADBE Vector Graphic - Fill",
 4491:           )("ADBE Vector Fill Opacity").expression =
 4492:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0052") } catch(e) { value }';
 4493:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4494:             "ADBE Vector Graphic - Stroke",
 4495:           )("ADBE Vector Stroke Color").expression =
 4496:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0053") } catch(e) { value }';
 4497:           shorten("pointer")("ADBE Vectors Group")(
 4498:             "ADBE Vector Graphic - Stroke",
 4499:           )("ADBE Vector Stroke Opacity").expression =
 4500:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0055") } catch(e) { value }';
 4501:           shorten("pointer")("ADBE Vectors Group")(
 4502:             "ADBE Vector Graphic - Stroke",
 4503:           )("ADBE Vector Stroke Width").expression =
 4504:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0054") } catch(e) { value }';
 4505:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4506:             "ADBE Vector Filter - RC",
 4507:           )("ADBE Vector RoundCorner Radius").expression =
 4508:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0050") } catch(e) { value }';
 4509:           shorten("pointer")("ADBE Vector Transform Group")(
 4510:             "ADBE Vector Scale",
 4511:           ).expression =
 4512:             'try { [effect("ADBE easyRulers")("ADBE easyRulers-0046"), effect("ADBE easyRulers")("ADBE easyRulers-0046")] } catch(e) {[100,100]}';
 4513:           shorten("pointer")("ADBE Vector Transform Group")(
 4514:             "ADBE Vector Position",
 4515:           ).expression =
 4516:             'try { var er_completion = effect("ADBE easyRulers")("Completion");            if (er_completion < 0) { er_completion = 0;}            if (er_completion >100) { er_completion = 100;}            [(thisComp.layer("' +
 4517:             shapeLayer.name +
 4518:             '").effect("ADBE easyRulers")("Gap")*' +
 4519:             (EditTextCopies.text - 1) +
 4520:             ' - value[0])*er_completion/100, value[1]+effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { [0,0] };';
 4521:           shorten("pointer")("ADBE Vector Transform Group")(
 4522:             "ADBE Vector Group Opacity",
 4523:           ).expression =
 4524:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0043").value?100:0; } catch(e) { value }';
 4525:           shorten("pointer").moveTo(1);
 4526:         };
 4527:         createPointerCircular = function () {
 4528:           shorten = app.project.activeItem.layer(shapeLayer.name)(
 4529:             "ADBE Root Vectors Group",
 4530:           )("Ruler")("ADBE Vectors Group");
 4531:           shorten.addProperty("ADBE Vector Group").name = "pointer";
 4532:           t("ADBE easyRulers")("ADBE easyRulers-0046").setValue(10);
 4533:           if (SidesType.selection.index == 0) {
 4534:             t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(180);
 4535:             t("ADBE easyRulers")("default Pointer Distance").setValue(180);
 4536:           }
 4537:           if (SidesType.selection.index == 1) {
 4538:             t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(170);
 4539:             t("ADBE easyRulers")("default Pointer Distance").setValue(170);
 4540:           }
 4541:           if (SidesType.selection.index == 2) {
 4542:             t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(140);
 4543:             t("ADBE easyRulers")("default Pointer Distance").setValue(140);
 4544:           }
 4545:           shorten("pointer")("ADBE Vector Transform Group")(
 4546:             "ADBE Vector Anchor",
 4547:           ).expression =
 4548:             'try { [value[0], value[1]+effect("ADBE easyRulers")("ADBE easyRulers-0049")]; } catch(e) { value }';
 4549:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4550:             "ADBE Vector Shape - Star",
 4551:           ).name = "triangle";
 4552:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4553:             "ADBE Vector Star Type",
 4554:           ).setValue(2);
 4555:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4556:             "ADBE Vector Star Points",
 4557:           ).setValue(3);
 4558:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4559:             "ADBE Vector Star Rotation",
 4560:           ).expression =
 4561:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0046") < 0?value-60:value; } catch(e) {value}';
 4562:           shorten("pointer")("ADBE Vectors Group")("triangle")(
 4563:             "ADBE Vector Star Outer Radius",
 4564:           ).expression =
 4565:             'try { if (effect("ADBE easyRulers")("Shape").value == 1) { effect("ADBE easyRulers")("ADBE easyRulers-0046")*1.5 < 0?-effect("ADBE easyRulers")("ADBE easyRulers-0046")*1.5:effect("ADBE easyRulers")("ADBE easyRulers-0046")*1.5; } else { 0 } } catch(e) { 0 };';
 4566:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4567:             "ADBE Vector Shape - Star",
 4568:           ).name = "dot";
 4569:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4570:             "ADBE Vector Star Type",
 4571:           ).setValue(2);
 4572:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4573:             "ADBE Vector Star Points",
 4574:           ).setValue(64);
 4575:           shorten("pointer")("ADBE Vectors Group")("dot")(
 4576:             "ADBE Vector Star Outer Radius",
 4577:           ).expression =
 4578:             'try { effect("ADBE easyRulers")("Shape").value == 2?effect("ADBE easyRulers")("ADBE easyRulers-0046"):0; } catch(e) { 0 }';
 4579:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4580:             "ADBE Vector Shape - Rect",
 4581:           ).name = "line";
 4582:           shorten("pointer")("ADBE Vectors Group")("line")(
 4583:             "ADBE Vector Rect Size",
 4584:           ).expression =
 4585:             'try { effect("ADBE easyRulers")("Shape").value == 3?[effect("ADBE easyRulers")("ADBE easyRulers-0047"), effect("ADBE easyRulers")("ADBE easyRulers-0048")]:[0,0]; } catch(e) { value }';
 4586:           shape_pointer = new Shape();
 4587:           shape_pointer.vertices = [
 4588:             [17, -5],
 4589:             [0, -35],
 4590:             [-17, -5],
 4591:             [-17, 23],
 4592:             [17, 23],
 4593:           ];
 4594:           shape_pointer.closed = true;
 4595:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4596:             "ADBE Vector Group",
 4597:           ).name = "squared triangle";
 4598:           shorten("pointer")("ADBE Vectors Group")("squared triangle")(
 4599:             "ADBE Vectors Group",
 4600:           )
 4601:             .addProperty("ADBE Vector Shape - Group")("ADBE Vector Shape")
 4602:             .setValue(shape_pointer);
 4603:           shorten("pointer")("ADBE Vectors Group")("squared triangle")(
 4604:             "ADBE Vector Transform Group",
 4605:           )("ADBE Vector Scale").expression =
 4606:             'try { effect("ADBE easyRulers")("Shape").value == 4?[40+effect("ADBE easyRulers")("ADBE easyRulers-0046"),40+effect("ADBE easyRulers")("ADBE easyRulers-0046")]:[0,0]; } catch(e) { value }';
 4607:           shorten("pointer")("ADBE Vector Transform Group")(
 4608:             "ADBE Vector Rotation",
 4609:           ).expression =
 4610:             'try { if (effect("ADBE easyRulers")("Completion") < 100 && effect("ADBE easyRulers")("Completion") > 0) {                  ' +
 4611:               ((Math.floor(Number(EditTextCopies.text) - 1) / divideBy) *
 4612:                 divideBy) /
 4613:                 10 +
 4614:               '* effect("ADBE easyRulers")("Gap") * effect("ADBE easyRulers")("Completion")/100 + effect("ADBE easyRulers")("Rotation Offset")' +
 4615:               LinesTypeDropdown.selection.index ==
 4616:             0
 4617:               ? ' + effect("ADBE easyRulers")("Width")/5.75'
 4618:               : "" +
 4619:                     '              } else {                  if (effect("ADBE easyRulers")("Completion") <= 0) {                      effect("ADBE easyRulers")("Rotation Offset")' +
 4620:                     LinesTypeDropdown.selection.index ==
 4621:                   0
 4622:                 ? ' + effect("ADBE easyRulers")("Width")/5.75'
 4623:                 : "" +
 4624:                       "                  } else {                      " +
 4625:                       ((Math.floor(Number(EditTextCopies.text) - 1) /
 4626:                         divideBy) *
 4627:                         divideBy) /
 4628:                         10 +
 4629:                       '* effect("ADBE easyRulers")("Gap") + effect("ADBE easyRulers")("Rotation Offset")' +
 4630:                       LinesTypeDropdown.selection.index ==
 4631:                     0
 4632:                   ? ' + effect("ADBE easyRulers")("Width")/5.75'
 4633:                   : "" + "              }}} catch(e) { value }";
 4634:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4635:             "ADBE Vector Graphic - Fill",
 4636:           )("ADBE Vector Fill Color").expression =
 4637:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0051") } catch(e) { value }';
 4638:           shorten("pointer")("ADBE Vectors Group")(
 4639:             "ADBE Vector Graphic - Fill",
 4640:           )("ADBE Vector Fill Opacity").expression =
 4641:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0052") } catch(e) { value }';
 4642:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4643:             "ADBE Vector Graphic - Stroke",
 4644:           )("ADBE Vector Stroke Color").expression =
 4645:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0053") } catch(e) { value }';
 4646:           shorten("pointer")("ADBE Vectors Group")(
 4647:             "ADBE Vector Graphic - Stroke",
 4648:           )("ADBE Vector Stroke Opacity").expression =
 4649:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0055") } catch(e) { value }';
 4650:           shorten("pointer")("ADBE Vectors Group")(
 4651:             "ADBE Vector Graphic - Stroke",
 4652:           )("ADBE Vector Stroke Width").expression =
 4653:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0054") } catch(e) { value }';
 4654:           shorten("pointer")("ADBE Vectors Group").addProperty(
 4655:             "ADBE Vector Filter - RC",
 4656:           )("ADBE Vector RoundCorner Radius").expression =
 4657:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0050") } catch(e) { value }';
 4658:           shorten("pointer")("ADBE Vector Transform Group")(
 4659:             "ADBE Vector Group Opacity",
 4660:           ).expression =
 4661:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0043").value?100:0; } catch(e) { value }';
 4662:           shorten("pointer").moveTo(1);
 4663:         };
 4664:         createBasicNoDivs_circle_DotLines = function () {
 4665:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 4666:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 4667:             "ADBE Vector Shape - Ellipse",
 4668:           )("ADBE Vector Ellipse Size").expression =
 4669:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 4670:           shorten("Main lines")("ADBE Vectors Group")(
 4671:             "ADBE Vector Shape - Ellipse",
 4672:           )("ADBE Vector Ellipse Position").setValue([0, -225]);
 4673:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 4674:             "ADBE Vector Graphic - Fill",
 4675:           )("ADBE Vector Fill Color").expression =
 4676:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 4677:           shorten("Main lines")("ADBE Vectors Group")
 4678:             .addProperty(
 4679:               "ADBE Vector Filter - Repeater",
 4680:             )("ADBE Vector Repeater Copies")
 4681:             .setValue(EditTextCopies.text);
 4682:           shorten("Main lines")("ADBE Vectors Group")(
 4683:             "ADBE Vector Filter - Repeater",
 4684:           )("ADBE Vector Repeater Transform")(
 4685:             "ADBE Vector Repeater Rotation",
 4686:           ).expression =
 4687:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 4688:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 4689:           shorten("Base line")("ADBE Vectors Group")
 4690:             .addProperty("ADBE Vector Shape - Group")
 4691:             .path.setValue(shape);
 4692:           shorten("Base line")("ADBE Vector Transform Group")(
 4693:             "ADBE Vector Scale",
 4694:           ).setValue([-90, -90]);
 4695:           shorten("Base line")("ADBE Vectors Group").addProperty(
 4696:             "ADBE Vector Graphic - Stroke",
 4697:           )("ADBE Vector Stroke Color").expression =
 4698:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 4699:           shorten("Base line")("ADBE Vectors Group")(
 4700:             "ADBE Vector Graphic - Stroke",
 4701:           )("ADBE Vector Stroke Width").setValue(2);
 4702:           shorten("Base line")("ADBE Vectors Group")
 4703:             .addProperty(
 4704:               "ADBE Vector Filter - Offset",
 4705:             )("ADBE Vector Offset Amount")
 4706:             .setValue(0);
 4707:           shorten("Base line")("ADBE Vectors Group")(
 4708:             "ADBE Vector Filter - Offset",
 4709:           )("ADBE Vector Offset Miter Limit").setValue(5);
 4710:           shorten("Base line")("ADBE Vectors Group").addProperty(
 4711:             "ADBE Vector Filter - Trim",
 4712:           )("ADBE Vector Trim End").expression =
 4713:             "try { Math.abs(" +
 4714:             (EditTextCopies.text - 1) +
 4715:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 4716:           shorten("Base line")("ADBE Vectors Group")(
 4717:             "ADBE Vector Filter - Trim",
 4718:           )("ADBE Vector Trim Start").setValue(0.001);
 4719:           shorten("Base line")("ADBE Vectors Group")(
 4720:             "ADBE Vector Filter - Trim",
 4721:           )("ADBE Vector Trim Offset").expression =
 4722:             'try { if (effect("ADBE easyRulers")("Gap") < 0) {-3.6*Math.abs(' +
 4723:             (EditTextCopies.text - 1) +
 4724:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 4725:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 4726:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 4727:           if (SidesType.selection.index == 2) {
 4728:             t("ADBE easyRulers")("Sides Distance").setValue(-10);
 4729:             t("ADBE easyRulers")("default Sides Distance").setValue(-10);
 4730:           }
 4731:           if (NumbersCheckBox.value) {
 4732:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 4733:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 4734:           }
 4735:           app.project.activeItem.layer(shapeLayer.name)(
 4736:             "ADBE Root Vectors Group",
 4737:           )("Ruler")("ADBE Vector Transform Group")(
 4738:             "ADBE Vector Rotation",
 4739:           ).expression =
 4740:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 4741:           createPointerCircular();
 4742:           secondary_lines = app.project.activeItem
 4743:             .layer(
 4744:               shapeLayer.name,
 4745:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 4746:             .duplicate();
 4747:           secondary_lines.name = "Main lines - Secondary Color";
 4748:           secondary_lines("ADBE Vectors Group")(
 4749:             "ADBE Vector Filter - Repeater",
 4750:           )("ADBE Vector Repeater Copies").expression =
 4751:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 4752:             EditTextCopies.text +
 4753:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 4754:             (Number(EditTextCopies.text) - 1) +
 4755:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 4756:             (Number(EditTextCopies.text) - 1) +
 4757:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 4758:             EditTextCopies.text +
 4759:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 4760:             (Number(EditTextCopies.text) - 1) +
 4761:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 4762:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 4763:             "ADBE Vector Fill Opacity",
 4764:           ).expression =
 4765:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 4766:           secondary_lines("ADBE Vector Transform Group")(
 4767:             "ADBE Vector Group Opacity",
 4768:           ).expression =
 4769:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 4770:           secondary_lines("ADBE Vectors Group")(
 4771:             "ADBE Vector Graphic - Fill",
 4772:           ).name = "Fill Start";
 4773:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 4774:             "ADBE Vector Fill Color",
 4775:           ).expression =
 4776:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 4777:           secondary_lines("ADBE Vectors Group")(
 4778:             "ADBE Vector Filter - Repeater",
 4779:           )("ADBE Vector Repeater Offset").expression =
 4780:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 4781:             (Number(EditTextCopies.text) - 1) +
 4782:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 4783:             (Number(EditTextCopies.text) - 1) +
 4784:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
 4785:           secondary_lines("ADBE Vectors Group")(
 4786:             "ADBE Vector Filter - Repeater",
 4787:           )("ADBE Vector Repeater Transform")(
 4788:             "ADBE Vector Repeater Opacity 1",
 4789:           ).expression =
 4790:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 4791:           secondary_lines("ADBE Vectors Group")(
 4792:             "ADBE Vector Filter - Repeater",
 4793:           )("ADBE Vector Repeater Transform")(
 4794:             "ADBE Vector Repeater Opacity 2",
 4795:           ).expression =
 4796:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 4797:           secondary_lines("ADBE Vectors Group").addProperty(
 4798:             "ADBE Vector Graphic - Fill",
 4799:           ).name = "Fill End";
 4800:           secondary_lines("ADBE Vectors Group")("Fill End")(
 4801:             "ADBE Vector Fill Color",
 4802:           ).expression =
 4803:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 4804:           secondary_lines("ADBE Vectors Group")("Fill End")(
 4805:             "ADBE Vector Fill Opacity",
 4806:           ).expression =
 4807:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 4808:           app.project.activeItem
 4809:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 4810:             .duplicate().name = "Ruler Mirror";
 4811:           app.project.activeItem
 4812:             .layer(
 4813:               shapeLayer.name,
 4814:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 4815:             .setValue(60);
 4816:           app.project.activeItem
 4817:             .layer(
 4818:               shapeLayer.name,
 4819:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 4820:             .setValue(-180);
 4821:           app.project.activeItem
 4822:             .layer(
 4823:               shapeLayer.name,
 4824:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 4825:             .setValue([0, 425]);
 4826:           app.project.activeItem.layer(shapeLayer.name)(
 4827:             "ADBE Root Vectors Group",
 4828:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 4829:           if (SidesType.selection.index !== 0) {
 4830:             app.project.activeItem.layer(shapeLayer.name)(
 4831:               "ADBE Root Vectors Group",
 4832:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 4833:               "ADBE Vector Scale",
 4834:             ).expression =
 4835:               SidesType.selection.index == 2
 4836:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { value }'
 4837:                 : "[value[0] -10, value[1] -10]";
 4838:             app.project.activeItem.layer(shapeLayer.name)(
 4839:               "ADBE Root Vectors Group",
 4840:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 4841:               "ADBE Vector Transform Group",
 4842:             )("ADBE Vector Anchor").expression =
 4843:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 4844:           }
 4845:           if (BaseLineDropdown.selection.index == 0) {
 4846:             app.project.activeItem
 4847:               .layer(
 4848:                 shapeLayer.name,
 4849:               )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 4850:               .remove();
 4851:             app.project.activeItem
 4852:               .layer(
 4853:                 shapeLayer.name,
 4854:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 4855:               .remove();
 4856:           }
 4857:         };
 4858:         createBasic_circle_DotLines = function () {
 4859:           var e = -10;
 4860:           var r = -225;
 4861:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 4862:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 4863:             "ADBE Vector Shape - Ellipse",
 4864:           )("ADBE Vector Ellipse Size").expression =
 4865:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
 4866:           shorten("Big subdivisions")("ADBE Vectors Group")(
 4867:             "ADBE Vector Shape - Ellipse",
 4868:           )("ADBE Vector Ellipse Position").expression =
 4869:             "try { [value[0], " +
 4870:             r +
 4871:             ' - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
 4872:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 4873:             "ADBE Vector Graphic - Fill",
 4874:           )("ADBE Vector Fill Color").expression =
 4875:             'try{ effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 4876:           shorten("Big subdivisions")("ADBE Vectors Group")
 4877:             .addProperty("ADBE Vector Filter - Repeater")(
 4878:               "ADBE Vector Repeater Copies",
 4879:             )
 4880:             .setValue(
 4881:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 4882:             );
 4883:           shorten("Big subdivisions")("ADBE Vectors Group")(
 4884:             "ADBE Vector Filter - Repeater",
 4885:           )("ADBE Vector Repeater Transform")(
 4886:             "ADBE Vector Repeater Rotation",
 4887:           ).expression =
 4888:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 4889:             divideBy +
 4890:             " } catch(e) { value }";
 4891:           shorten.addProperty("ADBE Vector Group").name =
 4892:             "Big subdivisions Base Line";
 4893:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 4894:             .addProperty("ADBE Vector Shape - Group")
 4895:             .path.setValue(shape);
 4896:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 4897:             "ADBE Vector Scale",
 4898:           ).setValue([-90, -90]);
 4899:           shorten("Big subdivisions Base Line")(
 4900:             "ADBE Vectors Group",
 4901:           ).addProperty("ADBE Vector Graphic - Stroke")(
 4902:             "ADBE Vector Stroke Color",
 4903:           ).expression =
 4904:             'try{ effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 4905:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 4906:             "ADBE Vector Graphic - Stroke",
 4907:           )("ADBE Vector Stroke Width").setValue(2);
 4908:           shorten("Big subdivisions Base Line")(
 4909:             "ADBE Vectors Group",
 4910:           ).addProperty("ADBE Vector Filter - Offset")(
 4911:             "ADBE Vector Offset Amount",
 4912:           ).expression =
 4913:             'try { effect("ADBE easyRulers")("Height")*2.22 } catch(e) { value }';
 4914:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 4915:             "ADBE Vector Filter - Offset",
 4916:           )("ADBE Vector Offset Miter Limit").setValue(4);
 4917:           shorten("Big subdivisions Base Line")(
 4918:             "ADBE Vectors Group",
 4919:           ).addProperty("ADBE Vector Filter - Trim")(
 4920:             "ADBE Vector Trim End",
 4921:           ).expression =
 4922:             "try { Math.abs(" +
 4923:             (EditTextCopies.text - 1) +
 4924:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 4925:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 4926:             "ADBE Vector Filter - Trim",
 4927:           )("ADBE Vector Trim Start").setValue(0.001);
 4928:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 4929:             "ADBE Vector Filter - Trim",
 4930:           )("ADBE Vector Trim Offset").expression =
 4931:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 4932:             (EditTextCopies.text - 1) +
 4933:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 4934:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 4935:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 4936:             "ADBE Vector Shape - Ellipse",
 4937:           )("ADBE Vector Ellipse Size").expression =
 4938:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 4939:           shorten("Main lines")("ADBE Vectors Group")(
 4940:             "ADBE Vector Shape - Ellipse",
 4941:           )("ADBE Vector Ellipse Position").setValue([0, r]);
 4942:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 4943:             "ADBE Vector Graphic - Fill",
 4944:           )("ADBE Vector Fill Color").expression =
 4945:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 4946:           shorten("Main lines")("ADBE Vectors Group")
 4947:             .addProperty(
 4948:               "ADBE Vector Filter - Repeater",
 4949:             )("ADBE Vector Repeater Copies")
 4950:             .setValue(EditTextCopies.text);
 4951:           shorten("Main lines")("ADBE Vectors Group")(
 4952:             "ADBE Vector Filter - Repeater",
 4953:           )("ADBE Vector Repeater Transform")(
 4954:             "ADBE Vector Repeater Rotation",
 4955:           ).expression =
 4956:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 4957:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 4958:           shorten("Base line")("ADBE Vectors Group")
 4959:             .addProperty("ADBE Vector Shape - Group")
 4960:             .path.setValue(shape);
 4961:           shorten("Base line")("ADBE Vector Transform Group")(
 4962:             "ADBE Vector Scale",
 4963:           ).setValue([-90, -90]);
 4964:           shorten("Base line")("ADBE Vectors Group").addProperty(
 4965:             "ADBE Vector Graphic - Stroke",
 4966:           )("ADBE Vector Stroke Color").expression =
 4967:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 4968:           shorten("Base line")("ADBE Vectors Group")(
 4969:             "ADBE Vector Graphic - Stroke",
 4970:           )("ADBE Vector Stroke Width").setValue(2);
 4971:           shorten("Base line")("ADBE Vectors Group")
 4972:             .addProperty(
 4973:               "ADBE Vector Filter - Offset",
 4974:             )("ADBE Vector Offset Amount")
 4975:             .setValue(0);
 4976:           shorten("Base line")("ADBE Vectors Group")(
 4977:             "ADBE Vector Filter - Offset",
 4978:           )("ADBE Vector Offset Miter Limit").setValue(4);
 4979:           shorten("Base line")("ADBE Vectors Group").addProperty(
 4980:             "ADBE Vector Filter - Trim",
 4981:           )("ADBE Vector Trim End").expression =
 4982:             "try { Math.abs(" +
 4983:             (EditTextCopies.text - 1) +
 4984:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 4985:           shorten("Base line")("ADBE Vectors Group")(
 4986:             "ADBE Vector Filter - Trim",
 4987:           )("ADBE Vector Trim Start").setValue(0.001);
 4988:           shorten("Base line")("ADBE Vectors Group")(
 4989:             "ADBE Vector Filter - Trim",
 4990:           )("ADBE Vector Trim Offset").expression =
 4991:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 4992:             (EditTextCopies.text - 1) +
 4993:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 4994:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 4995:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 4996:           t("ADBE easyRulers")("Dots Scale Bias").setValue(0);
 4997:           t("ADBE easyRulers")("default Dots Scale Bias").setValue(0);
 4998:           t("ADBE easyRulers")("Height").setValue(5);
 4999:           t("ADBE easyRulers")("default Height").setValue(5);
 5000:           if (SidesType.selection.index == 2) {
 5001:             t("ADBE easyRulers")("Sides Distance").setValue(e);
 5002:             t("ADBE easyRulers")("default Sides Distance").setValue(e);
 5003:           }
 5004:           if (NumbersCheckBox.value) {
 5005:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 5006:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 5007:           }
 5008:           app.project.activeItem.layer(shapeLayer.name)(
 5009:             "ADBE Root Vectors Group",
 5010:           )("Ruler")("ADBE Vector Transform Group")(
 5011:             "ADBE Vector Rotation",
 5012:           ).expression =
 5013:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 5014:           createPointerCircular();
 5015:           secondary_lines = app.project.activeItem
 5016:             .layer(
 5017:               shapeLayer.name,
 5018:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 5019:             .duplicate();
 5020:           secondary_lines.name = "Main lines - Secondary Color";
 5021:           secondary_lines("ADBE Vectors Group")(
 5022:             "ADBE Vector Filter - Repeater",
 5023:           )("ADBE Vector Repeater Copies").expression =
 5024:             'try{ if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                 if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 5025:             EditTextCopies.text +
 5026:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 5027:             (Number(EditTextCopies.text) - 1) +
 5028:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                 } else { Math.ceil(' +
 5029:             (Number(EditTextCopies.text) - 1) +
 5030:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }              } else {                  if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 5031:             EditTextCopies.text +
 5032:             ' } else                  if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 5033:             (Number(EditTextCopies.text) - 1) +
 5034:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 5035:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 5036:             "ADBE Vector Fill Opacity",
 5037:           ).expression =
 5038:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0 } catch(e) { value }';
 5039:           secondary_lines("ADBE Vector Transform Group")(
 5040:             "ADBE Vector Group Opacity",
 5041:           ).expression =
 5042:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 5043:           secondary_lines("ADBE Vectors Group")(
 5044:             "ADBE Vector Graphic - Fill",
 5045:           ).name = "Fill Start";
 5046:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 5047:             "ADBE Vector Fill Color",
 5048:           ).expression =
 5049:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 5050:           secondary_lines("ADBE Vectors Group")(
 5051:             "ADBE Vector Filter - Repeater",
 5052:           )("ADBE Vector Repeater Offset").expression =
 5053:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 5054:             (Number(EditTextCopies.text) - 1) +
 5055:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 5056:             (Number(EditTextCopies.text) - 1) +
 5057:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
 5058:           secondary_lines("ADBE Vectors Group")(
 5059:             "ADBE Vector Filter - Repeater",
 5060:           )("ADBE Vector Repeater Transform")(
 5061:             "ADBE Vector Repeater Opacity 1",
 5062:           ).expression =
 5063:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5064:           secondary_lines("ADBE Vectors Group")(
 5065:             "ADBE Vector Filter - Repeater",
 5066:           )("ADBE Vector Repeater Transform")(
 5067:             "ADBE Vector Repeater Opacity 2",
 5068:           ).expression =
 5069:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5070:           secondary_lines("ADBE Vectors Group").addProperty(
 5071:             "ADBE Vector Graphic - Fill",
 5072:           ).name = "Fill End";
 5073:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5074:             "ADBE Vector Fill Color",
 5075:           ).expression =
 5076:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 5077:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5078:             "ADBE Vector Fill Opacity",
 5079:           ).expression =
 5080:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0 } catch(e) { value }';
 5081:           secondary_lines = app.project.activeItem
 5082:             .layer(
 5083:               shapeLayer.name,
 5084:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 5085:             .duplicate();
 5086:           secondary_lines.name = "Big subdivisions - Secondary Color";
 5087:           secondary_lines("ADBE Vectors Group")(
 5088:             "ADBE Vector Filter - Repeater",
 5089:           )("ADBE Vector Repeater Copies").expression =
 5090:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 5091:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5092:             1 +
 5093:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 5094:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5095:             1 +
 5096:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 5097:             (Number(EditTextCopies.text) - 1) +
 5098:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 5099:             divideBy +
 5100:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 5101:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5102:             1 +
 5103:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 5104:             divideBy +
 5105:             "*100/" +
 5106:             (Number(EditTextCopies.text) - 1) +
 5107:             ")) } else { 0 }              }} catch(e) { value }";
 5108:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 5109:             "ADBE Vector Fill Opacity",
 5110:           ).expression =
 5111:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0 } catch(e) { value }';
 5112:           secondary_lines("ADBE Vector Transform Group")(
 5113:             "ADBE Vector Group Opacity",
 5114:           ).expression =
 5115:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 5116:           secondary_lines("ADBE Vectors Group")(
 5117:             "ADBE Vector Graphic - Fill",
 5118:           ).name = "Fill Start";
 5119:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 5120:             "ADBE Vector Fill Color",
 5121:           ).expression =
 5122:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 5123:           secondary_lines("ADBE Vectors Group")(
 5124:             "ADBE Vector Filter - Repeater",
 5125:           )("ADBE Vector Repeater Offset").expression =
 5126:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 5127:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5128:             1 +
 5129:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 5130:             (Number(EditTextCopies.text) - 1) +
 5131:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 5132:             divideBy +
 5133:             ")} else { 0 }              }} catch(e) { value }";
 5134:           secondary_lines("ADBE Vectors Group")(
 5135:             "ADBE Vector Filter - Repeater",
 5136:           )("ADBE Vector Repeater Transform")(
 5137:             "ADBE Vector Repeater Opacity 1",
 5138:           ).expression =
 5139:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5140:           secondary_lines("ADBE Vectors Group")(
 5141:             "ADBE Vector Filter - Repeater",
 5142:           )("ADBE Vector Repeater Transform")(
 5143:             "ADBE Vector Repeater Opacity 2",
 5144:           ).expression =
 5145:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5146:           secondary_lines("ADBE Vectors Group").addProperty(
 5147:             "ADBE Vector Graphic - Fill",
 5148:           ).name = "Fill End";
 5149:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5150:             "ADBE Vector Fill Color",
 5151:           ).expression =
 5152:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 5153:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5154:             "ADBE Vector Fill Opacity",
 5155:           ).expression =
 5156:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0 } catch(e) { value }';
 5157:           app.project.activeItem
 5158:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 5159:             .duplicate().name = "Ruler Mirror";
 5160:           app.project.activeItem
 5161:             .layer(
 5162:               shapeLayer.name,
 5163:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 5164:             .setValue(60);
 5165:           app.project.activeItem
 5166:             .layer(
 5167:               shapeLayer.name,
 5168:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 5169:             .setValue(-180);
 5170:           app.project.activeItem
 5171:             .layer(
 5172:               shapeLayer.name,
 5173:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 5174:             .setValue([0, 425]);
 5175:           app.project.activeItem.layer(shapeLayer.name)(
 5176:             "ADBE Root Vectors Group",
 5177:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 5178:           if (SidesType.selection.index !== 0) {
 5179:             app.project.activeItem.layer(shapeLayer.name)(
 5180:               "ADBE Root Vectors Group",
 5181:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 5182:               "ADBE Vector Scale",
 5183:             ).expression =
 5184:               SidesType.selection.index == 2
 5185:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch (e) { value }'
 5186:                 : "[value[0] + (" + e + "), value[1] + (" + e + ")]";
 5187:             app.project.activeItem.layer(shapeLayer.name)(
 5188:               "ADBE Root Vectors Group",
 5189:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 5190:               "ADBE Vectors Group",
 5191:             )("ADBE Vector Shape - Ellipse")(
 5192:               "ADBE Vector Ellipse Position",
 5193:             ).expression =
 5194:               SidesType.selection.index == 2
 5195:                 ? 'try { [value[0], value[1] - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 5196:                 : "[value[0], value[1] - (" + e + ")]";
 5197:             app.project.activeItem
 5198:               .layer(
 5199:                 shapeLayer.name,
 5200:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 5201:               .setValue([0, r]);
 5202:             app.project.activeItem.layer(shapeLayer.name)(
 5203:               "ADBE Root Vectors Group",
 5204:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 5205:               "ADBE Vectors Group",
 5206:             )("ADBE Vector Shape - Ellipse")(
 5207:               "ADBE Vector Ellipse Position",
 5208:             ).expression =
 5209:               SidesType.selection.index == 2
 5210:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 5211:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - (' +
 5212:                   e +
 5213:                   ")] } catch(e) { value }";
 5214:             app.project.activeItem.layer(shapeLayer.name)(
 5215:               "ADBE Root Vectors Group",
 5216:             )("Ruler Mirror")("ADBE Vectors Group")("Base line")(
 5217:               "ADBE Vectors Group",
 5218:             )("ADBE Vector Filter - Offset")(
 5219:               "ADBE Vector Offset Amount",
 5220:             ).expression =
 5221:               SidesType.selection.index == 2
 5222:                 ? 'try { effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 5223:                 : "" + e + "*1.111";
 5224:             app.project.activeItem.layer(shapeLayer.name)(
 5225:               "ADBE Root Vectors Group",
 5226:             )("Ruler Mirror")("ADBE Vectors Group")(
 5227:               "Big subdivisions Base Line",
 5228:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 5229:               "ADBE Vector Offset Amount",
 5230:             ).expression =
 5231:               SidesType.selection.index == 2
 5232:                 ? 'try { -effect("ADBE easyRulers")("Height")*2.222 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 5233:                 : 'try { -effect("ADBE easyRulers")("Height")*2.222 + (' +
 5234:                   e +
 5235:                   ")*1.111 } catch (e) { value }";
 5236:             app.project.activeItem.layer(shapeLayer.name)(
 5237:               "ADBE Root Vectors Group",
 5238:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 5239:               "ADBE Vector Transform Group",
 5240:             )("ADBE Vector Anchor").expression =
 5241:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 5242:           }
 5243:           switch (BaseLineDropdown.selection.index) {
 5244:             case 0:
 5245:               app.project.activeItem
 5246:                 .layer(
 5247:                   shapeLayer.name,
 5248:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 5249:                 .remove();
 5250:               app.project.activeItem
 5251:                 .layer(
 5252:                   shapeLayer.name,
 5253:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 5254:                 .remove();
 5255:               app.project.activeItem
 5256:                 .layer(
 5257:                   shapeLayer.name,
 5258:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 5259:                 .remove();
 5260:               app.project.activeItem
 5261:                 .layer(
 5262:                   shapeLayer.name,
 5263:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 5264:                 .remove();
 5265:               break;
 5266:             case 1:
 5267:               app.project.activeItem
 5268:                 .layer(
 5269:                   shapeLayer.name,
 5270:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 5271:                 .remove();
 5272:               app.project.activeItem
 5273:                 .layer(
 5274:                   shapeLayer.name,
 5275:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 5276:                 .remove();
 5277:           }
 5278:         };
 5279:         createBasic10_circle_DotLines = function () {
 5280:           var e = -10;
 5281:           var r = -225;
 5282:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 5283:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 5284:             "ADBE Vector Shape - Ellipse",
 5285:           )("ADBE Vector Ellipse Size").expression =
 5286:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
 5287:           shorten("Big subdivisions")("ADBE Vectors Group")(
 5288:             "ADBE Vector Shape - Ellipse",
 5289:           )("ADBE Vector Ellipse Position").expression =
 5290:             "try { [value[0], " +
 5291:             r +
 5292:             ' - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
 5293:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 5294:             "ADBE Vector Graphic - Fill",
 5295:           )("ADBE Vector Fill Color").expression =
 5296:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 5297:           shorten("Big subdivisions")("ADBE Vectors Group")
 5298:             .addProperty("ADBE Vector Filter - Repeater")(
 5299:               "ADBE Vector Repeater Copies",
 5300:             )
 5301:             .setValue(
 5302:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 5303:             );
 5304:           shorten("Big subdivisions")("ADBE Vectors Group")(
 5305:             "ADBE Vector Filter - Repeater",
 5306:           )("ADBE Vector Repeater Transform")(
 5307:             "ADBE Vector Repeater Rotation",
 5308:           ).expression =
 5309:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 5310:             divideBy +
 5311:             " } catch(e) { value }";
 5312:           shorten.addProperty("ADBE Vector Group").name =
 5313:             "Big subdivisions Base Line";
 5314:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 5315:             .addProperty("ADBE Vector Shape - Group")
 5316:             .path.setValue(shape);
 5317:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 5318:             "ADBE Vector Scale",
 5319:           ).setValue([-90, -90]);
 5320:           shorten("Big subdivisions Base Line")(
 5321:             "ADBE Vectors Group",
 5322:           ).addProperty("ADBE Vector Graphic - Stroke")(
 5323:             "ADBE Vector Stroke Color",
 5324:           ).expression =
 5325:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 5326:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5327:             "ADBE Vector Graphic - Stroke",
 5328:           )("ADBE Vector Stroke Width").setValue(2);
 5329:           shorten("Big subdivisions Base Line")(
 5330:             "ADBE Vectors Group",
 5331:           ).addProperty("ADBE Vector Filter - Offset")(
 5332:             "ADBE Vector Offset Amount",
 5333:           ).expression =
 5334:             'try { effect("ADBE easyRulers")("Height")*4.444 } catch(e) { value }';
 5335:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5336:             "ADBE Vector Filter - Offset",
 5337:           )("ADBE Vector Offset Miter Limit").setValue(4);
 5338:           shorten("Big subdivisions Base Line")(
 5339:             "ADBE Vectors Group",
 5340:           ).addProperty("ADBE Vector Filter - Trim")(
 5341:             "ADBE Vector Trim End",
 5342:           ).expression =
 5343:             "try { Math.abs(" +
 5344:             (EditTextCopies.text - 1) +
 5345:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 5346:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5347:             "ADBE Vector Filter - Trim",
 5348:           )("ADBE Vector Trim Start").setValue(0.001);
 5349:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5350:             "ADBE Vector Filter - Trim",
 5351:           )("ADBE Vector Trim Offset").expression =
 5352:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 5353:             (EditTextCopies.text - 1) +
 5354:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 5355:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
 5356:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 5357:             "ADBE Vector Shape - Ellipse",
 5358:           )("ADBE Vector Ellipse Size").expression =
 5359:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
 5360:           shorten("Half subdivisions")("ADBE Vectors Group")(
 5361:             "ADBE Vector Shape - Ellipse",
 5362:           )("ADBE Vector Ellipse Position").expression =
 5363:             "try { [value[0], " +
 5364:             r +
 5365:             ' - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
 5366:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 5367:             "ADBE Vector Graphic - Fill",
 5368:           )("ADBE Vector Fill Color").expression =
 5369:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 5370:           shorten("Half subdivisions")("ADBE Vectors Group")
 5371:             .addProperty("ADBE Vector Filter - Repeater")(
 5372:               "ADBE Vector Repeater Copies",
 5373:             )
 5374:             .setValue(
 5375:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 5376:                 1,
 5377:             );
 5378:           shorten("Half subdivisions")("ADBE Vectors Group")(
 5379:             "ADBE Vector Filter - Repeater",
 5380:           )("ADBE Vector Repeater Transform")(
 5381:             "ADBE Vector Repeater Rotation",
 5382:           ).expression =
 5383:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 5384:             divideBy / 2 +
 5385:             " } catch(e) { value }";
 5386:           shorten.addProperty("ADBE Vector Group").name =
 5387:             "Half subdivisions Base Line";
 5388:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
 5389:             .addProperty("ADBE Vector Shape - Group")
 5390:             .path.setValue(shape);
 5391:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
 5392:             "ADBE Vector Scale",
 5393:           ).setValue([-90, -90]);
 5394:           shorten("Half subdivisions Base Line")(
 5395:             "ADBE Vectors Group",
 5396:           ).addProperty("ADBE Vector Graphic - Stroke")(
 5397:             "ADBE Vector Stroke Color",
 5398:           ).expression =
 5399:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 5400:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 5401:             "ADBE Vector Graphic - Stroke",
 5402:           )("ADBE Vector Stroke Width").setValue(2);
 5403:           shorten("Half subdivisions Base Line")(
 5404:             "ADBE Vectors Group",
 5405:           ).addProperty("ADBE Vector Filter - Offset")(
 5406:             "ADBE Vector Offset Amount",
 5407:           ).expression =
 5408:             'try { effect("ADBE easyRulers")("Height")*2.222 } catch(e) { value }';
 5409:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 5410:             "ADBE Vector Filter - Offset",
 5411:           )("ADBE Vector Offset Miter Limit").setValue(4);
 5412:           shorten("Half subdivisions Base Line")(
 5413:             "ADBE Vectors Group",
 5414:           ).addProperty("ADBE Vector Filter - Trim")(
 5415:             "ADBE Vector Trim End",
 5416:           ).expression =
 5417:             "try { Math.abs(" +
 5418:             (EditTextCopies.text - 1) +
 5419:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 5420:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 5421:             "ADBE Vector Filter - Trim",
 5422:           )("ADBE Vector Trim Start").setValue(0.001);
 5423:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 5424:             "ADBE Vector Filter - Trim",
 5425:           )("ADBE Vector Trim Offset").expression =
 5426:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 5427:             (EditTextCopies.text - 1) +
 5428:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 5429:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 5430:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 5431:             "ADBE Vector Shape - Ellipse",
 5432:           )("ADBE Vector Ellipse Size").expression =
 5433:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 5434:           shorten("Main lines")("ADBE Vectors Group")(
 5435:             "ADBE Vector Shape - Ellipse",
 5436:           )("ADBE Vector Ellipse Position").setValue([0, r]);
 5437:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 5438:             "ADBE Vector Graphic - Fill",
 5439:           )("ADBE Vector Fill Color").expression =
 5440:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 5441:           shorten("Main lines")("ADBE Vectors Group")
 5442:             .addProperty(
 5443:               "ADBE Vector Filter - Repeater",
 5444:             )("ADBE Vector Repeater Copies")
 5445:             .setValue(EditTextCopies.text);
 5446:           shorten("Main lines")("ADBE Vectors Group")(
 5447:             "ADBE Vector Filter - Repeater",
 5448:           )("ADBE Vector Repeater Transform")(
 5449:             "ADBE Vector Repeater Rotation",
 5450:           ).expression =
 5451:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 5452:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 5453:           shorten("Base line")("ADBE Vectors Group")
 5454:             .addProperty("ADBE Vector Shape - Group")
 5455:             .path.setValue(shape);
 5456:           shorten("Base line")("ADBE Vector Transform Group")(
 5457:             "ADBE Vector Scale",
 5458:           ).setValue([-90, -90]);
 5459:           shorten("Base line")("ADBE Vectors Group").addProperty(
 5460:             "ADBE Vector Graphic - Stroke",
 5461:           )("ADBE Vector Stroke Color").expression =
 5462:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 5463:           shorten("Base line")("ADBE Vectors Group")(
 5464:             "ADBE Vector Graphic - Stroke",
 5465:           )("ADBE Vector Stroke Width").setValue(2);
 5466:           shorten("Base line")("ADBE Vectors Group")
 5467:             .addProperty(
 5468:               "ADBE Vector Filter - Offset",
 5469:             )("ADBE Vector Offset Amount")
 5470:             .setValue(0);
 5471:           shorten("Base line")("ADBE Vectors Group")(
 5472:             "ADBE Vector Filter - Offset",
 5473:           )("ADBE Vector Offset Miter Limit").setValue(4);
 5474:           shorten("Base line")("ADBE Vectors Group").addProperty(
 5475:             "ADBE Vector Filter - Trim",
 5476:           )("ADBE Vector Trim End").expression =
 5477:             "try { Math.abs(" +
 5478:             (EditTextCopies.text - 1) +
 5479:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 5480:           shorten("Base line")("ADBE Vectors Group")(
 5481:             "ADBE Vector Filter - Trim",
 5482:           )("ADBE Vector Trim Start").setValue(0.001);
 5483:           shorten("Base line")("ADBE Vectors Group")(
 5484:             "ADBE Vector Filter - Trim",
 5485:           )("ADBE Vector Trim Offset").expression =
 5486:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 5487:             (EditTextCopies.text - 1) +
 5488:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 5489:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 5490:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 5491:           t("ADBE easyRulers")("Height").setValue(5);
 5492:           t("ADBE easyRulers")("default Height").setValue(5);
 5493:           if (SidesType.selection.index == 2) {
 5494:             t("ADBE easyRulers")("Sides Distance").setValue(e);
 5495:             t("ADBE easyRulers")("default Sides Distance").setValue(e);
 5496:           }
 5497:           if (NumbersCheckBox.value) {
 5498:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 5499:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 5500:           }
 5501:           app.project.activeItem.layer(shapeLayer.name)(
 5502:             "ADBE Root Vectors Group",
 5503:           )("Ruler")("ADBE Vector Transform Group")(
 5504:             "ADBE Vector Rotation",
 5505:           ).expression =
 5506:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 5507:           createPointerCircular();
 5508:           secondary_lines = app.project.activeItem
 5509:             .layer(
 5510:               shapeLayer.name,
 5511:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 5512:             .duplicate();
 5513:           secondary_lines.name = "Main lines - Secondary Color";
 5514:           secondary_lines("ADBE Vectors Group")(
 5515:             "ADBE Vector Filter - Repeater",
 5516:           )("ADBE Vector Repeater Copies").expression =
 5517:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 5518:             EditTextCopies.text +
 5519:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 5520:             (Number(EditTextCopies.text) - 1) +
 5521:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 5522:             (Number(EditTextCopies.text) - 1) +
 5523:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 5524:             EditTextCopies.text +
 5525:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 5526:             (Number(EditTextCopies.text) - 1) +
 5527:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 5528:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 5529:             "ADBE Vector Fill Opacity",
 5530:           ).expression =
 5531:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 5532:           secondary_lines("ADBE Vector Transform Group")(
 5533:             "ADBE Vector Group Opacity",
 5534:           ).expression =
 5535:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 5536:           secondary_lines("ADBE Vectors Group")(
 5537:             "ADBE Vector Graphic - Fill",
 5538:           ).name = "Fill Start";
 5539:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 5540:             "ADBE Vector Fill Color",
 5541:           ).expression =
 5542:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 5543:           secondary_lines("ADBE Vectors Group")(
 5544:             "ADBE Vector Filter - Repeater",
 5545:           )("ADBE Vector Repeater Offset").expression =
 5546:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 5547:             (Number(EditTextCopies.text) - 1) +
 5548:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 5549:             (Number(EditTextCopies.text) - 1) +
 5550:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
 5551:           secondary_lines("ADBE Vectors Group")(
 5552:             "ADBE Vector Filter - Repeater",
 5553:           )("ADBE Vector Repeater Transform")(
 5554:             "ADBE Vector Repeater Opacity 1",
 5555:           ).expression =
 5556:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5557:           secondary_lines("ADBE Vectors Group")(
 5558:             "ADBE Vector Filter - Repeater",
 5559:           )("ADBE Vector Repeater Transform")(
 5560:             "ADBE Vector Repeater Opacity 2",
 5561:           ).expression =
 5562:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5563:           secondary_lines("ADBE Vectors Group").addProperty(
 5564:             "ADBE Vector Graphic - Fill",
 5565:           ).name = "Fill End";
 5566:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5567:             "ADBE Vector Fill Color",
 5568:           ).expression =
 5569:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 5570:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5571:             "ADBE Vector Fill Opacity",
 5572:           ).expression =
 5573:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0 } catch(e) { value }';
 5574:           secondary_lines = app.project.activeItem
 5575:             .layer(
 5576:               shapeLayer.name,
 5577:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 5578:             .duplicate();
 5579:           secondary_lines.name = "Big subdivisions - Secondary Color";
 5580:           secondary_lines("ADBE Vectors Group")(
 5581:             "ADBE Vector Filter - Repeater",
 5582:           )("ADBE Vector Repeater Copies").expression =
 5583:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 5584:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5585:             1 +
 5586:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 5587:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5588:             1 +
 5589:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 5590:             (Number(EditTextCopies.text) - 1) +
 5591:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 5592:             divideBy +
 5593:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 5594:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5595:             1 +
 5596:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 5597:             divideBy +
 5598:             "*100/" +
 5599:             (Number(EditTextCopies.text) - 1) +
 5600:             ")) } else { 0 }              }} catch(e) { value }";
 5601:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 5602:             "ADBE Vector Fill Opacity",
 5603:           ).expression =
 5604:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0 } catch(e) { value }';
 5605:           secondary_lines("ADBE Vector Transform Group")(
 5606:             "ADBE Vector Group Opacity",
 5607:           ).expression =
 5608:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 5609:           secondary_lines("ADBE Vectors Group")(
 5610:             "ADBE Vector Graphic - Fill",
 5611:           ).name = "Fill Start";
 5612:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 5613:             "ADBE Vector Fill Color",
 5614:           ).expression =
 5615:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 5616:           secondary_lines("ADBE Vectors Group")(
 5617:             "ADBE Vector Filter - Repeater",
 5618:           )("ADBE Vector Repeater Offset").expression =
 5619:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 5620:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 5621:             1 +
 5622:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 5623:             (Number(EditTextCopies.text) - 1) +
 5624:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 5625:             divideBy +
 5626:             ")} else { 0 }              } } catch(e) { value }";
 5627:           secondary_lines("ADBE Vectors Group")(
 5628:             "ADBE Vector Filter - Repeater",
 5629:           )("ADBE Vector Repeater Transform")(
 5630:             "ADBE Vector Repeater Opacity 1",
 5631:           ).expression =
 5632:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5633:           secondary_lines("ADBE Vectors Group")(
 5634:             "ADBE Vector Filter - Repeater",
 5635:           )("ADBE Vector Repeater Transform")(
 5636:             "ADBE Vector Repeater Opacity 2",
 5637:           ).expression =
 5638:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5639:           secondary_lines("ADBE Vectors Group").addProperty(
 5640:             "ADBE Vector Graphic - Fill",
 5641:           ).name = "Fill End";
 5642:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5643:             "ADBE Vector Fill Color",
 5644:           ).expression =
 5645:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 5646:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5647:             "ADBE Vector Fill Opacity",
 5648:           ).expression =
 5649:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0 } catch(e) { value }';
 5650:           secondary_lines = app.project.activeItem
 5651:             .layer(
 5652:               shapeLayer.name,
 5653:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
 5654:             .duplicate();
 5655:           secondary_lines.name = "Half subdivisions - Secondary Color";
 5656:           secondary_lines("ADBE Vectors Group")(
 5657:             "ADBE Vector Filter - Repeater",
 5658:           )("ADBE Vector Repeater Copies").expression =
 5659:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 5660:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 5661:             1 +
 5662:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 5663:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 5664:             1 +
 5665:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 5666:             (Number(EditTextCopies.text) - 1) +
 5667:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 5668:             divideBy / 2 +
 5669:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 5670:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 5671:             1 +
 5672:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 5673:             divideBy / 2 +
 5674:             "*100/" +
 5675:             (Number(EditTextCopies.text) - 1) +
 5676:             ")) } else { 0 }              }} catch(e) { value }";
 5677:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 5678:             "ADBE Vector Fill Opacity",
 5679:           ).expression =
 5680:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 5681:           secondary_lines("ADBE Vector Transform Group")(
 5682:             "ADBE Vector Group Opacity",
 5683:           ).expression =
 5684:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 5685:           secondary_lines("ADBE Vectors Group")(
 5686:             "ADBE Vector Graphic - Fill",
 5687:           ).name = "Fill Start";
 5688:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 5689:             "ADBE Vector Fill Color",
 5690:           ).expression =
 5691:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 5692:           secondary_lines("ADBE Vectors Group")(
 5693:             "ADBE Vector Filter - Repeater",
 5694:           )("ADBE Vector Repeater Offset").expression =
 5695:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 5696:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 5697:             1 +
 5698:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 5699:             (Number(EditTextCopies.text) - 1) +
 5700:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 5701:             divideBy / 2 +
 5702:             ")} else { 0 }              }} catch(e) { value }";
 5703:           secondary_lines("ADBE Vectors Group")(
 5704:             "ADBE Vector Filter - Repeater",
 5705:           )("ADBE Vector Repeater Transform")(
 5706:             "ADBE Vector Repeater Opacity 1",
 5707:           ).expression =
 5708:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5709:           secondary_lines("ADBE Vectors Group")(
 5710:             "ADBE Vector Filter - Repeater",
 5711:           )("ADBE Vector Repeater Transform")(
 5712:             "ADBE Vector Repeater Opacity 2",
 5713:           ).expression =
 5714:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 5715:           secondary_lines("ADBE Vectors Group").addProperty(
 5716:             "ADBE Vector Graphic - Fill",
 5717:           ).name = "Fill End";
 5718:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5719:             "ADBE Vector Fill Color",
 5720:           ).expression =
 5721:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 5722:           secondary_lines("ADBE Vectors Group")("Fill End")(
 5723:             "ADBE Vector Fill Opacity",
 5724:           ).expression =
 5725:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0 } catch(e) { value }';
 5726:           app.project.activeItem
 5727:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 5728:             .duplicate().name = "Ruler Mirror";
 5729:           app.project.activeItem
 5730:             .layer(
 5731:               shapeLayer.name,
 5732:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 5733:             .setValue(60);
 5734:           app.project.activeItem
 5735:             .layer(
 5736:               shapeLayer.name,
 5737:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 5738:             .setValue(-180);
 5739:           app.project.activeItem
 5740:             .layer(
 5741:               shapeLayer.name,
 5742:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 5743:             .setValue([0, 425]);
 5744:           app.project.activeItem.layer(shapeLayer.name)(
 5745:             "ADBE Root Vectors Group",
 5746:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 5747:           if (SidesType.selection.index !== 0) {
 5748:             app.project.activeItem.layer(shapeLayer.name)(
 5749:               "ADBE Root Vectors Group",
 5750:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 5751:               "ADBE Vector Scale",
 5752:             ).expression =
 5753:               SidesType.selection.index == 2
 5754:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { value }'
 5755:                 : "[value[0] + (" + e + "), value[1] + (" + e + ")]";
 5756:             app.project.activeItem.layer(shapeLayer.name)(
 5757:               "ADBE Root Vectors Group",
 5758:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 5759:               "ADBE Vector Transform Group",
 5760:             )("ADBE Vector Anchor").expression =
 5761:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 5762:             app.project.activeItem.layer(shapeLayer.name)(
 5763:               "ADBE Root Vectors Group",
 5764:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 5765:               "ADBE Vectors Group",
 5766:             )("ADBE Vector Shape - Ellipse")(
 5767:               "ADBE Vector Ellipse Position",
 5768:             ).expression =
 5769:               SidesType.selection.index == 2
 5770:                 ? 'try { [value[0], value[1] - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 5771:                 : "[value[0], value[1] - (" + e + ")]";
 5772:             app.project.activeItem
 5773:               .layer(
 5774:                 shapeLayer.name,
 5775:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 5776:               .setValue([0, r]);
 5777:             app.project.activeItem.layer(shapeLayer.name)(
 5778:               "ADBE Root Vectors Group",
 5779:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 5780:               "ADBE Vectors Group",
 5781:             )("ADBE Vector Shape - Ellipse")(
 5782:               "ADBE Vector Ellipse Position",
 5783:             ).expression =
 5784:               SidesType.selection.index == 2
 5785:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 5786:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4-(' +
 5787:                   e +
 5788:                   ")] } catch(e) { value }";
 5789:             app.project.activeItem
 5790:               .layer(
 5791:                 shapeLayer.name,
 5792:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 5793:               .setValue([0, r]);
 5794:             app.project.activeItem.layer(shapeLayer.name)(
 5795:               "ADBE Root Vectors Group",
 5796:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
 5797:               "ADBE Vectors Group",
 5798:             )("ADBE Vector Shape - Ellipse")(
 5799:               "ADBE Vector Ellipse Position",
 5800:             ).expression =
 5801:               SidesType.selection.index == 2
 5802:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 5803:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2-(' +
 5804:                   e +
 5805:                   ")] } catch(e) { value }";
 5806:             app.project.activeItem.layer(shapeLayer.name)(
 5807:               "ADBE Root Vectors Group",
 5808:             )("Ruler Mirror")("ADBE Vectors Group")("Base line")(
 5809:               "ADBE Vectors Group",
 5810:             )("ADBE Vector Filter - Offset")(
 5811:               "ADBE Vector Offset Amount",
 5812:             ).expression =
 5813:               SidesType.selection.index == 2
 5814:                 ? 'try { effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 5815:                 : "" + e + "*1.111";
 5816:             app.project.activeItem.layer(shapeLayer.name)(
 5817:               "ADBE Root Vectors Group",
 5818:             )("Ruler Mirror")("ADBE Vectors Group")(
 5819:               "Half subdivisions Base Line",
 5820:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 5821:               "ADBE Vector Offset Amount",
 5822:             ).expression =
 5823:               SidesType.selection.index == 2
 5824:                 ? 'try {-effect("ADBE easyRulers")("Height")*2.222 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 5825:                 : ' try { -effect("ADBE easyRulers")("Height")*2.222 + (' +
 5826:                   e +
 5827:                   ")*1.111 } catch (e) { value }";
 5828:             app.project.activeItem.layer(shapeLayer.name)(
 5829:               "ADBE Root Vectors Group",
 5830:             )("Ruler Mirror")("ADBE Vectors Group")(
 5831:               "Big subdivisions Base Line",
 5832:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 5833:               "ADBE Vector Offset Amount",
 5834:             ).expression =
 5835:               SidesType.selection.index == 2
 5836:                 ? 'try {-effect("ADBE easyRulers")("Height")*4.444 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 5837:                 : ' try { -effect("ADBE easyRulers")("Height")*4.444 + (' +
 5838:                   e +
 5839:                   ")*1.111 } catch(e) { value }";
 5840:           }
 5841:           switch (BaseLineDropdown.selection.index) {
 5842:             case 0:
 5843:               app.project.activeItem
 5844:                 .layer(
 5845:                   shapeLayer.name,
 5846:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 5847:                 .remove();
 5848:               app.project.activeItem
 5849:                 .layer(
 5850:                   shapeLayer.name,
 5851:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 5852:                 .remove();
 5853:               app.project.activeItem
 5854:                 .layer(
 5855:                   shapeLayer.name,
 5856:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 5857:                 .remove();
 5858:               app.project.activeItem
 5859:                 .layer(
 5860:                   shapeLayer.name,
 5861:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 5862:                 .remove();
 5863:               app.project.activeItem
 5864:                 .layer(
 5865:                   shapeLayer.name,
 5866:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 5867:                 .remove();
 5868:               app.project.activeItem
 5869:                 .layer(
 5870:                   shapeLayer.name,
 5871:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 5872:                 .remove();
 5873:               break;
 5874:             case 1:
 5875:               app.project.activeItem
 5876:                 .layer(
 5877:                   shapeLayer.name,
 5878:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 5879:                 .remove();
 5880:               app.project.activeItem
 5881:                 .layer(
 5882:                   shapeLayer.name,
 5883:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 5884:                 .remove();
 5885:               app.project.activeItem
 5886:                 .layer(
 5887:                   shapeLayer.name,
 5888:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 5889:                 .remove();
 5890:               app.project.activeItem
 5891:                 .layer(
 5892:                   shapeLayer.name,
 5893:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 5894:                 .remove();
 5895:           }
 5896:         };
 5897:         createBasic10b_circle_DotLines = function () {
 5898:           var e = -10;
 5899:           var r = -225;
 5900:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 5901:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 5902:             "ADBE Vector Shape - Ellipse",
 5903:           )("ADBE Vector Ellipse Size").expression =
 5904:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
 5905:           shorten("Big subdivisions")("ADBE Vectors Group")(
 5906:             "ADBE Vector Shape - Ellipse",
 5907:           )("ADBE Vector Ellipse Position").expression =
 5908:             "try { [value[0], " +
 5909:             r +
 5910:             ' - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
 5911:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 5912:             "ADBE Vector Graphic - Fill",
 5913:           )("ADBE Vector Fill Color").expression =
 5914:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 5915:           shorten("Big subdivisions")("ADBE Vectors Group")
 5916:             .addProperty("ADBE Vector Filter - Repeater")(
 5917:               "ADBE Vector Repeater Copies",
 5918:             )
 5919:             .setValue(
 5920:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 5921:             );
 5922:           shorten("Big subdivisions")("ADBE Vectors Group")(
 5923:             "ADBE Vector Filter - Repeater",
 5924:           )("ADBE Vector Repeater Transform")(
 5925:             "ADBE Vector Repeater Rotation",
 5926:           ).expression =
 5927:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 5928:             divideBy +
 5929:             " } catch(e) { value }";
 5930:           shorten.addProperty("ADBE Vector Group").name =
 5931:             "Big subdivisions Base Line";
 5932:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 5933:             .addProperty("ADBE Vector Shape - Group")
 5934:             .path.setValue(shape);
 5935:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 5936:             "ADBE Vector Scale",
 5937:           ).setValue([-90, -90]);
 5938:           shorten("Big subdivisions Base Line")(
 5939:             "ADBE Vectors Group",
 5940:           ).addProperty("ADBE Vector Graphic - Stroke")(
 5941:             "ADBE Vector Stroke Color",
 5942:           ).expression =
 5943:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 5944:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5945:             "ADBE Vector Graphic - Stroke",
 5946:           )("ADBE Vector Stroke Width").setValue(2);
 5947:           shorten("Big subdivisions Base Line")(
 5948:             "ADBE Vectors Group",
 5949:           ).addProperty("ADBE Vector Filter - Offset")(
 5950:             "ADBE Vector Offset Amount",
 5951:           ).expression =
 5952:             'try { effect("ADBE easyRulers")("Height")*4.444 } catch(e) { value }';
 5953:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5954:             "ADBE Vector Filter - Offset",
 5955:           )("ADBE Vector Offset Miter Limit").setValue(4);
 5956:           shorten("Big subdivisions Base Line")(
 5957:             "ADBE Vectors Group",
 5958:           ).addProperty("ADBE Vector Filter - Trim")(
 5959:             "ADBE Vector Trim End",
 5960:           ).expression =
 5961:             "try { Math.abs(" +
 5962:             (EditTextCopies.text - 1) +
 5963:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 5964:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5965:             "ADBE Vector Filter - Trim",
 5966:           )("ADBE Vector Trim Start").setValue(0.001);
 5967:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 5968:             "ADBE Vector Filter - Trim",
 5969:           )("ADBE Vector Trim Offset").expression =
 5970:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 5971:             (EditTextCopies.text - 1) +
 5972:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 5973:           shorten.addProperty("ADBE Vector Group").name = "Fifth subdivisions";
 5974:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
 5975:             "ADBE Vector Shape - Ellipse",
 5976:           )("ADBE Vector Ellipse Size").expression =
 5977:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
 5978:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
 5979:             "ADBE Vector Shape - Ellipse",
 5980:           )("ADBE Vector Ellipse Position").expression =
 5981:             "try { [value[0], " +
 5982:             r +
 5983:             ' - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
 5984:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
 5985:             "ADBE Vector Graphic - Fill",
 5986:           )("ADBE Vector Fill Color").expression =
 5987:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
 5988:           shorten("Fifth subdivisions")("ADBE Vectors Group")
 5989:             .addProperty("ADBE Vector Filter - Repeater")(
 5990:               "ADBE Vector Repeater Copies",
 5991:             )
 5992:             .setValue(
 5993:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
 5994:                 1,
 5995:             );
 5996:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
 5997:             "ADBE Vector Filter - Repeater",
 5998:           )("ADBE Vector Repeater Transform")(
 5999:             "ADBE Vector Repeater Rotation",
 6000:           ).expression =
 6001:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 6002:             divideBy / 5 +
 6003:             " } catch(e) { value }";
 6004:           shorten.addProperty("ADBE Vector Group").name =
 6005:             "Fifth subdivisions Base Line";
 6006:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")
 6007:             .addProperty("ADBE Vector Shape - Group")
 6008:             .path.setValue(shape);
 6009:           shorten("Fifth subdivisions Base Line")(
 6010:             "ADBE Vector Transform Group",
 6011:           )("ADBE Vector Scale").setValue([-90, -90]);
 6012:           shorten("Fifth subdivisions Base Line")(
 6013:             "ADBE Vectors Group",
 6014:           ).addProperty("ADBE Vector Graphic - Stroke")(
 6015:             "ADBE Vector Stroke Color",
 6016:           ).expression =
 6017:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
 6018:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
 6019:             "ADBE Vector Graphic - Stroke",
 6020:           )("ADBE Vector Stroke Width").setValue(2);
 6021:           shorten("Fifth subdivisions Base Line")(
 6022:             "ADBE Vectors Group",
 6023:           ).addProperty("ADBE Vector Filter - Offset")(
 6024:             "ADBE Vector Offset Amount",
 6025:           ).expression =
 6026:             'try { effect("ADBE easyRulers")("Height")*2.222 } catch(e) { value }';
 6027:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
 6028:             "ADBE Vector Filter - Offset",
 6029:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6030:           shorten("Fifth subdivisions Base Line")(
 6031:             "ADBE Vectors Group",
 6032:           ).addProperty("ADBE Vector Filter - Trim")(
 6033:             "ADBE Vector Trim End",
 6034:           ).expression =
 6035:             "try { Math.abs(" +
 6036:             (EditTextCopies.text - 1) +
 6037:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6038:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
 6039:             "ADBE Vector Filter - Trim",
 6040:           )("ADBE Vector Trim Start").setValue(0.001);
 6041:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
 6042:             "ADBE Vector Filter - Trim",
 6043:           )("ADBE Vector Trim Offset").expression =
 6044:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 6045:             (EditTextCopies.text - 1) +
 6046:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6047:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 6048:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 6049:             "ADBE Vector Shape - Ellipse",
 6050:           )("ADBE Vector Ellipse Size").expression =
 6051:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 6052:           shorten("Main lines")("ADBE Vectors Group")(
 6053:             "ADBE Vector Shape - Ellipse",
 6054:           )("ADBE Vector Ellipse Position").setValue([0, r]);
 6055:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 6056:             "ADBE Vector Graphic - Fill",
 6057:           )("ADBE Vector Fill Color").expression =
 6058:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 6059:           shorten("Main lines")("ADBE Vectors Group")
 6060:             .addProperty(
 6061:               "ADBE Vector Filter - Repeater",
 6062:             )("ADBE Vector Repeater Copies")
 6063:             .setValue(EditTextCopies.text);
 6064:           shorten("Main lines")("ADBE Vectors Group")(
 6065:             "ADBE Vector Filter - Repeater",
 6066:           )("ADBE Vector Repeater Transform")(
 6067:             "ADBE Vector Repeater Rotation",
 6068:           ).expression =
 6069:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 6070:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 6071:           shorten("Base line")("ADBE Vectors Group")
 6072:             .addProperty("ADBE Vector Shape - Group")
 6073:             .path.setValue(shape);
 6074:           shorten("Base line")("ADBE Vector Transform Group")(
 6075:             "ADBE Vector Scale",
 6076:           ).setValue([-90, -90]);
 6077:           shorten("Base line")("ADBE Vectors Group").addProperty(
 6078:             "ADBE Vector Graphic - Stroke",
 6079:           )("ADBE Vector Stroke Color").expression =
 6080:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 6081:           shorten("Base line")("ADBE Vectors Group")(
 6082:             "ADBE Vector Graphic - Stroke",
 6083:           )("ADBE Vector Stroke Width").setValue(2);
 6084:           shorten("Base line")("ADBE Vectors Group")
 6085:             .addProperty(
 6086:               "ADBE Vector Filter - Offset",
 6087:             )("ADBE Vector Offset Amount")
 6088:             .setValue(0);
 6089:           shorten("Base line")("ADBE Vectors Group")(
 6090:             "ADBE Vector Filter - Offset",
 6091:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6092:           shorten("Base line")("ADBE Vectors Group").addProperty(
 6093:             "ADBE Vector Filter - Trim",
 6094:           )("ADBE Vector Trim End").expression =
 6095:             "try { Math.abs(" +
 6096:             (EditTextCopies.text - 1) +
 6097:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6098:           shorten("Base line")("ADBE Vectors Group")(
 6099:             "ADBE Vector Filter - Trim",
 6100:           )("ADBE Vector Trim Start").setValue(0.001);
 6101:           shorten("Base line")("ADBE Vectors Group")(
 6102:             "ADBE Vector Filter - Trim",
 6103:           )("ADBE Vector Trim Offset").expression =
 6104:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 6105:             (EditTextCopies.text - 1) +
 6106:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6107:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 6108:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 6109:           t("ADBE easyRulers")("Height").setValue(5);
 6110:           t("ADBE easyRulers")("default Height").setValue(5);
 6111:           if (SidesType.selection.index == 2) {
 6112:             t("ADBE easyRulers")("Sides Distance").setValue(e);
 6113:             t("ADBE easyRulers")("default Sides Distance").setValue(e);
 6114:           }
 6115:           if (NumbersCheckBox.value) {
 6116:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 6117:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 6118:           }
 6119:           app.project.activeItem.layer(shapeLayer.name)(
 6120:             "ADBE Root Vectors Group",
 6121:           )("Ruler")("ADBE Vector Transform Group")(
 6122:             "ADBE Vector Rotation",
 6123:           ).expression =
 6124:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 6125:           createPointerCircular();
 6126:           secondary_lines = app.project.activeItem
 6127:             .layer(
 6128:               shapeLayer.name,
 6129:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 6130:             .duplicate();
 6131:           secondary_lines.name = "Main lines - Secondary Color";
 6132:           secondary_lines("ADBE Vectors Group")(
 6133:             "ADBE Vector Filter - Repeater",
 6134:           )("ADBE Vector Repeater Copies").expression =
 6135:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6136:             EditTextCopies.text +
 6137:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6138:             (Number(EditTextCopies.text) - 1) +
 6139:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 6140:             (Number(EditTextCopies.text) - 1) +
 6141:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6142:             EditTextCopies.text +
 6143:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 6144:             (Number(EditTextCopies.text) - 1) +
 6145:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 6146:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6147:             "ADBE Vector Fill Opacity",
 6148:           ).expression =
 6149:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 6150:           secondary_lines("ADBE Vector Transform Group")(
 6151:             "ADBE Vector Group Opacity",
 6152:           ).expression =
 6153:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6154:           secondary_lines("ADBE Vectors Group")(
 6155:             "ADBE Vector Graphic - Fill",
 6156:           ).name = "Fill Start";
 6157:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 6158:             "ADBE Vector Fill Color",
 6159:           ).expression =
 6160:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 6161:           secondary_lines("ADBE Vectors Group")(
 6162:             "ADBE Vector Filter - Repeater",
 6163:           )("ADBE Vector Repeater Offset").expression =
 6164:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 6165:             (Number(EditTextCopies.text) - 1) +
 6166:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 6167:             (Number(EditTextCopies.text) - 1) +
 6168:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
 6169:           secondary_lines("ADBE Vectors Group")(
 6170:             "ADBE Vector Filter - Repeater",
 6171:           )("ADBE Vector Repeater Transform")(
 6172:             "ADBE Vector Repeater Opacity 1",
 6173:           ).expression =
 6174:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6175:           secondary_lines("ADBE Vectors Group")(
 6176:             "ADBE Vector Filter - Repeater",
 6177:           )("ADBE Vector Repeater Transform")(
 6178:             "ADBE Vector Repeater Opacity 2",
 6179:           ).expression =
 6180:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6181:           secondary_lines("ADBE Vectors Group").addProperty(
 6182:             "ADBE Vector Graphic - Fill",
 6183:           ).name = "Fill End";
 6184:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6185:             "ADBE Vector Fill Color",
 6186:           ).expression =
 6187:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 6188:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6189:             "ADBE Vector Fill Opacity",
 6190:           ).expression =
 6191:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 6192:           secondary_lines = app.project.activeItem
 6193:             .layer(
 6194:               shapeLayer.name,
 6195:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 6196:             .duplicate();
 6197:           secondary_lines.name = "Big subdivisions - Secondary Color";
 6198:           secondary_lines("ADBE Vectors Group")(
 6199:             "ADBE Vector Filter - Repeater",
 6200:           )("ADBE Vector Repeater Copies").expression =
 6201:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6202:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6203:             1 +
 6204:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6205:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6206:             1 +
 6207:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 6208:             (Number(EditTextCopies.text) - 1) +
 6209:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 6210:             divideBy +
 6211:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6212:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6213:             1 +
 6214:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 6215:             divideBy +
 6216:             "*100/" +
 6217:             (Number(EditTextCopies.text) - 1) +
 6218:             ")) } else { 0 }               }} catch(e) { value }";
 6219:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6220:             "ADBE Vector Fill Opacity",
 6221:           ).expression =
 6222:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 6223:           secondary_lines("ADBE Vector Transform Group")(
 6224:             "ADBE Vector Group Opacity",
 6225:           ).expression =
 6226:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6227:           secondary_lines("ADBE Vectors Group")(
 6228:             "ADBE Vector Graphic - Fill",
 6229:           ).name = "Fill Start";
 6230:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 6231:             "ADBE Vector Fill Color",
 6232:           ).expression =
 6233:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 6234:           secondary_lines("ADBE Vectors Group")(
 6235:             "ADBE Vector Filter - Repeater",
 6236:           )("ADBE Vector Repeater Offset").expression =
 6237:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 6238:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6239:             1 +
 6240:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 6241:             (Number(EditTextCopies.text) - 1) +
 6242:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 6243:             divideBy +
 6244:             ")} else { 0 }             }} catch(e) { value }";
 6245:           secondary_lines("ADBE Vectors Group")(
 6246:             "ADBE Vector Filter - Repeater",
 6247:           )("ADBE Vector Repeater Transform")(
 6248:             "ADBE Vector Repeater Opacity 1",
 6249:           ).expression =
 6250:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6251:           secondary_lines("ADBE Vectors Group")(
 6252:             "ADBE Vector Filter - Repeater",
 6253:           )("ADBE Vector Repeater Transform")(
 6254:             "ADBE Vector Repeater Opacity 2",
 6255:           ).expression =
 6256:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6257:           secondary_lines("ADBE Vectors Group").addProperty(
 6258:             "ADBE Vector Graphic - Fill",
 6259:           ).name = "Fill End";
 6260:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6261:             "ADBE Vector Fill Color",
 6262:           ).expression =
 6263:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 6264:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6265:             "ADBE Vector Fill Opacity",
 6266:           ).expression =
 6267:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 6268:           secondary_lines = app.project.activeItem
 6269:             .layer(
 6270:               shapeLayer.name,
 6271:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions")
 6272:             .duplicate();
 6273:           secondary_lines.name = "Fifth subdivisions - Secondary Color";
 6274:           secondary_lines("ADBE Vectors Group")(
 6275:             "ADBE Vector Filter - Repeater",
 6276:           )("ADBE Vector Repeater Copies").expression =
 6277:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6278:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
 6279:             1 +
 6280:             '-content("Ruler").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6281:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
 6282:             1 +
 6283:             '-content("Ruler Mirror").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } } else { Math.ceil(' +
 6284:             (Number(EditTextCopies.text) - 1) +
 6285:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 6286:             divideBy / 5 +
 6287:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6288:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
 6289:             1 +
 6290:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 6291:             divideBy / 5 +
 6292:             "*100/" +
 6293:             (Number(EditTextCopies.text) - 1) +
 6294:             ")) } else { 0 }              }} catch(e) { value }";
 6295:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6296:             "ADBE Vector Fill Opacity",
 6297:           ).expression =
 6298:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
 6299:           secondary_lines("ADBE Vector Transform Group")(
 6300:             "ADBE Vector Group Opacity",
 6301:           ).expression =
 6302:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6303:           secondary_lines("ADBE Vectors Group")(
 6304:             "ADBE Vector Graphic - Fill",
 6305:           ).name = "Fill Start";
 6306:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 6307:             "ADBE Vector Fill Color",
 6308:           ).expression =
 6309:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 6310:           secondary_lines("ADBE Vectors Group")(
 6311:             "ADBE Vector Filter - Repeater",
 6312:           )("ADBE Vector Repeater Offset").expression =
 6313:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 6314:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
 6315:             1 +
 6316:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 6317:             (Number(EditTextCopies.text) - 1) +
 6318:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 6319:             divideBy / 5 +
 6320:             ")} else { 0 }             }} catch(e) { value }";
 6321:           secondary_lines("ADBE Vectors Group")(
 6322:             "ADBE Vector Filter - Repeater",
 6323:           )("ADBE Vector Repeater Transform")(
 6324:             "ADBE Vector Repeater Opacity 1",
 6325:           ).expression =
 6326:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6327:           secondary_lines("ADBE Vectors Group")(
 6328:             "ADBE Vector Filter - Repeater",
 6329:           )("ADBE Vector Repeater Transform")(
 6330:             "ADBE Vector Repeater Opacity 2",
 6331:           ).expression =
 6332:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6333:           secondary_lines("ADBE Vectors Group").addProperty(
 6334:             "ADBE Vector Graphic - Fill",
 6335:           ).name = "Fill End";
 6336:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6337:             "ADBE Vector Fill Color",
 6338:           ).expression =
 6339:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 6340:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6341:             "ADBE Vector Fill Opacity",
 6342:           ).expression =
 6343:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
 6344:           app.project.activeItem
 6345:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 6346:             .duplicate().name = "Ruler Mirror";
 6347:           app.project.activeItem
 6348:             .layer(
 6349:               shapeLayer.name,
 6350:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 6351:             .setValue(60);
 6352:           app.project.activeItem
 6353:             .layer(
 6354:               shapeLayer.name,
 6355:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 6356:             .setValue(-180);
 6357:           app.project.activeItem
 6358:             .layer(
 6359:               shapeLayer.name,
 6360:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 6361:             .setValue([0, 425]);
 6362:           app.project.activeItem.layer(shapeLayer.name)(
 6363:             "ADBE Root Vectors Group",
 6364:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 6365:           if (SidesType.selection.index !== 0) {
 6366:             app.project.activeItem.layer(shapeLayer.name)(
 6367:               "ADBE Root Vectors Group",
 6368:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 6369:               "ADBE Vector Scale",
 6370:             ).expression =
 6371:               SidesType.selection.index == 2
 6372:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { value }'
 6373:                 : "[value[0] + (" + e + "), value[1] + (" + e + ")]";
 6374:             app.project.activeItem.layer(shapeLayer.name)(
 6375:               "ADBE Root Vectors Group",
 6376:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 6377:               "ADBE Vector Transform Group",
 6378:             )("ADBE Vector Anchor").expression =
 6379:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch (e) { value }';
 6380:             app.project.activeItem.layer(shapeLayer.name)(
 6381:               "ADBE Root Vectors Group",
 6382:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 6383:               "ADBE Vectors Group",
 6384:             )("ADBE Vector Shape - Ellipse")(
 6385:               "ADBE Vector Ellipse Position",
 6386:             ).expression =
 6387:               SidesType.selection.index == 2
 6388:                 ? 'try { [value[0], value[1] - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 6389:                 : "[value[0], value[1] - (" + e + ")]";
 6390:             app.project.activeItem
 6391:               .layer(
 6392:                 shapeLayer.name,
 6393:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 6394:               .setValue([0, r]);
 6395:             app.project.activeItem.layer(shapeLayer.name)(
 6396:               "ADBE Root Vectors Group",
 6397:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 6398:               "ADBE Vectors Group",
 6399:             )("ADBE Vector Shape - Ellipse")(
 6400:               "ADBE Vector Ellipse Position",
 6401:             ).expression =
 6402:               SidesType.selection.index == 2
 6403:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 6404:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - (' +
 6405:                   e +
 6406:                   ")] } catch (e) { value }";
 6407:             app.project.activeItem
 6408:               .layer(
 6409:                 shapeLayer.name,
 6410:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 6411:               .setValue([0, r]);
 6412:             app.project.activeItem.layer(shapeLayer.name)(
 6413:               "ADBE Root Vectors Group",
 6414:             )("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions")(
 6415:               "ADBE Vectors Group",
 6416:             )("ADBE Vector Shape - Ellipse")(
 6417:               "ADBE Vector Ellipse Position",
 6418:             ).expression =
 6419:               SidesType.selection.index == 2
 6420:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 6421:                 : ' try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - (' +
 6422:                   e +
 6423:                   ")] } catch (e) { value }";
 6424:             app.project.activeItem.layer(shapeLayer.name)(
 6425:               "ADBE Root Vectors Group",
 6426:             )("Ruler Mirror")("ADBE Vectors Group")("Base line")(
 6427:               "ADBE Vectors Group",
 6428:             )("ADBE Vector Filter - Offset")(
 6429:               "ADBE Vector Offset Amount",
 6430:             ).expression =
 6431:               SidesType.selection.index == 2
 6432:                 ? 'try { effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 6433:                 : "" + e + "*1.111";
 6434:             app.project.activeItem.layer(shapeLayer.name)(
 6435:               "ADBE Root Vectors Group",
 6436:             )("Ruler Mirror")("ADBE Vectors Group")(
 6437:               "Fifth subdivisions Base Line",
 6438:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 6439:               "ADBE Vector Offset Amount",
 6440:             ).expression =
 6441:               SidesType.selection.index == 2
 6442:                 ? 'try { -effect("ADBE easyRulers")("Height")*2.222 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 6443:                 : 'try { -effect("ADBE easyRulers")("Height")*2.222 + (' +
 6444:                   e +
 6445:                   ")*1.111 } catch (e) { value }";
 6446:             app.project.activeItem.layer(shapeLayer.name)(
 6447:               "ADBE Root Vectors Group",
 6448:             )("Ruler Mirror")("ADBE Vectors Group")(
 6449:               "Big subdivisions Base Line",
 6450:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 6451:               "ADBE Vector Offset Amount",
 6452:             ).expression =
 6453:               SidesType.selection.index == 2
 6454:                 ? 'try { -effect("ADBE easyRulers")("Height")*4.444 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 6455:                 : 'try { -effect("ADBE easyRulers")("Height")*4.444 + (' +
 6456:                   e +
 6457:                   ")*1.111 } catch (e) { value }";
 6458:           }
 6459:           switch (BaseLineDropdown.selection.index) {
 6460:             case 0:
 6461:               app.project.activeItem
 6462:                 .layer(
 6463:                   shapeLayer.name,
 6464:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 6465:                 .remove();
 6466:               app.project.activeItem
 6467:                 .layer(
 6468:                   shapeLayer.name,
 6469:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 6470:                 .remove();
 6471:               app.project.activeItem
 6472:                 .layer(
 6473:                   shapeLayer.name,
 6474:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 6475:                 .remove();
 6476:               app.project.activeItem
 6477:                 .layer(
 6478:                   shapeLayer.name,
 6479:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 6480:                 .remove();
 6481:               app.project.activeItem
 6482:                 .layer(
 6483:                   shapeLayer.name,
 6484:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
 6485:                 .remove();
 6486:               app.project.activeItem
 6487:                 .layer(
 6488:                   shapeLayer.name,
 6489:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
 6490:                 .remove();
 6491:               break;
 6492:             case 1:
 6493:               app.project.activeItem
 6494:                 .layer(
 6495:                   shapeLayer.name,
 6496:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 6497:                 .remove();
 6498:               app.project.activeItem
 6499:                 .layer(
 6500:                   shapeLayer.name,
 6501:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 6502:                 .remove();
 6503:               app.project.activeItem
 6504:                 .layer(
 6505:                   shapeLayer.name,
 6506:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
 6507:                 .remove();
 6508:               app.project.activeItem
 6509:                 .layer(
 6510:                   shapeLayer.name,
 6511:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
 6512:                 .remove();
 6513:           }
 6514:         };
 6515:         createBasic16_circle_DotLines = function () {
 6516:           var e = -10;
 6517:           var r = -225;
 6518:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 6519:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 6520:             "ADBE Vector Shape - Ellipse",
 6521:           )("ADBE Vector Ellipse Size").expression =
 6522:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
 6523:           shorten("Big subdivisions")("ADBE Vectors Group")(
 6524:             "ADBE Vector Shape - Ellipse",
 6525:           )("ADBE Vector Ellipse Position").expression =
 6526:             "try { [0, " +
 6527:             r +
 6528:             ' - effect("ADBE easyRulers")("Height")*6] } catch(e) { value }';
 6529:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 6530:             "ADBE Vector Graphic - Fill",
 6531:           )("ADBE Vector Fill Color").expression =
 6532:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 6533:           shorten("Big subdivisions")("ADBE Vectors Group")
 6534:             .addProperty("ADBE Vector Filter - Repeater")(
 6535:               "ADBE Vector Repeater Copies",
 6536:             )
 6537:             .setValue(
 6538:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 6539:             );
 6540:           shorten("Big subdivisions")("ADBE Vectors Group")(
 6541:             "ADBE Vector Filter - Repeater",
 6542:           )("ADBE Vector Repeater Transform")(
 6543:             "ADBE Vector Repeater Rotation",
 6544:           ).expression =
 6545:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 6546:             divideBy +
 6547:             " } catch(e) { value }";
 6548:           shorten.addProperty("ADBE Vector Group").name =
 6549:             "Big subdivisions Base Line";
 6550:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 6551:             .addProperty("ADBE Vector Shape - Group")
 6552:             .path.setValue(shape);
 6553:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 6554:             "ADBE Vector Scale",
 6555:           ).setValue([-90, -90]);
 6556:           shorten("Big subdivisions Base Line")(
 6557:             "ADBE Vectors Group",
 6558:           ).addProperty("ADBE Vector Graphic - Stroke")(
 6559:             "ADBE Vector Stroke Color",
 6560:           ).expression =
 6561:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 6562:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 6563:             "ADBE Vector Graphic - Stroke",
 6564:           )("ADBE Vector Stroke Width").setValue(2);
 6565:           shorten("Big subdivisions Base Line")(
 6566:             "ADBE Vectors Group",
 6567:           ).addProperty("ADBE Vector Filter - Offset")(
 6568:             "ADBE Vector Offset Amount",
 6569:           ).expression =
 6570:             'try { effect("ADBE easyRulers")("Height")*6.67 } catch(e) { value }';
 6571:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 6572:             "ADBE Vector Filter - Offset",
 6573:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6574:           shorten("Big subdivisions Base Line")(
 6575:             "ADBE Vectors Group",
 6576:           ).addProperty("ADBE Vector Filter - Trim")(
 6577:             "ADBE Vector Trim End",
 6578:           ).expression =
 6579:             "try { Math.abs(" +
 6580:             (EditTextCopies.text - 1) +
 6581:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6582:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 6583:             "ADBE Vector Filter - Trim",
 6584:           )("ADBE Vector Trim Start").setValue(0.001);
 6585:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 6586:             "ADBE Vector Filter - Trim",
 6587:           )("ADBE Vector Trim Offset").expression =
 6588:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 6589:             (EditTextCopies.text - 1) +
 6590:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6591:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
 6592:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 6593:             "ADBE Vector Shape - Ellipse",
 6594:           )("ADBE Vector Ellipse Size").expression =
 6595:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
 6596:           shorten("Half subdivisions")("ADBE Vectors Group")(
 6597:             "ADBE Vector Shape - Ellipse",
 6598:           )("ADBE Vector Ellipse Position").expression =
 6599:             "try { [0, " +
 6600:             r +
 6601:             ' - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
 6602:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 6603:             "ADBE Vector Graphic - Fill",
 6604:           )("ADBE Vector Fill Color").expression =
 6605:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 6606:           shorten("Half subdivisions")("ADBE Vectors Group")
 6607:             .addProperty("ADBE Vector Filter - Repeater")(
 6608:               "ADBE Vector Repeater Copies",
 6609:             )
 6610:             .setValue(
 6611:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 6612:                 1,
 6613:             );
 6614:           shorten("Half subdivisions")("ADBE Vectors Group")(
 6615:             "ADBE Vector Filter - Repeater",
 6616:           )("ADBE Vector Repeater Transform")(
 6617:             "ADBE Vector Repeater Rotation",
 6618:           ).expression =
 6619:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 6620:             divideBy / 2 +
 6621:             " } catch(e) { value }";
 6622:           shorten.addProperty("ADBE Vector Group").name =
 6623:             "Half subdivisions Base Line";
 6624:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
 6625:             .addProperty("ADBE Vector Shape - Group")
 6626:             .path.setValue(shape);
 6627:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
 6628:             "ADBE Vector Scale",
 6629:           ).setValue([-90, -90]);
 6630:           shorten("Half subdivisions Base Line")(
 6631:             "ADBE Vectors Group",
 6632:           ).addProperty("ADBE Vector Graphic - Stroke")(
 6633:             "ADBE Vector Stroke Color",
 6634:           ).expression =
 6635:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 6636:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 6637:             "ADBE Vector Graphic - Stroke",
 6638:           )("ADBE Vector Stroke Width").setValue(2);
 6639:           shorten("Half subdivisions Base Line")(
 6640:             "ADBE Vectors Group",
 6641:           ).addProperty("ADBE Vector Filter - Offset")(
 6642:             "ADBE Vector Offset Amount",
 6643:           ).expression =
 6644:             'try { effect("ADBE easyRulers")("Height")*4.444 } catch(e) { value }';
 6645:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 6646:             "ADBE Vector Filter - Offset",
 6647:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6648:           shorten("Half subdivisions Base Line")(
 6649:             "ADBE Vectors Group",
 6650:           ).addProperty("ADBE Vector Filter - Trim")(
 6651:             "ADBE Vector Trim End",
 6652:           ).expression =
 6653:             "try { Math.abs(" +
 6654:             (EditTextCopies.text - 1) +
 6655:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6656:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 6657:             "ADBE Vector Filter - Trim",
 6658:           )("ADBE Vector Trim Start").setValue(0.001);
 6659:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 6660:             "ADBE Vector Filter - Trim",
 6661:           )("ADBE Vector Trim Offset").expression =
 6662:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 6663:             (EditTextCopies.text - 1) +
 6664:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6665:           shorten.addProperty("ADBE Vector Group").name =
 6666:             "Quarter subdivisions";
 6667:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
 6668:             "ADBE Vector Shape - Ellipse",
 6669:           )("ADBE Vector Ellipse Size").expression =
 6670:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
 6671:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
 6672:             "ADBE Vector Shape - Ellipse",
 6673:           )("ADBE Vector Ellipse Position").expression =
 6674:             "try { [0, " +
 6675:             r +
 6676:             ' - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
 6677:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
 6678:             "ADBE Vector Graphic - Fill",
 6679:           )("ADBE Vector Fill Color").expression =
 6680:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
 6681:           shorten("Quarter subdivisions")("ADBE Vectors Group")
 6682:             .addProperty("ADBE Vector Filter - Repeater")(
 6683:               "ADBE Vector Repeater Copies",
 6684:             )
 6685:             .setValue(
 6686:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 6687:                 1,
 6688:             );
 6689:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
 6690:             "ADBE Vector Filter - Repeater",
 6691:           )("ADBE Vector Repeater Transform")(
 6692:             "ADBE Vector Repeater Rotation",
 6693:           ).expression =
 6694:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 6695:             divideBy / 4 +
 6696:             " } catch(e) { value }";
 6697:           shorten.addProperty("ADBE Vector Group").name =
 6698:             "Quarter subdivisions Base Line";
 6699:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")
 6700:             .addProperty("ADBE Vector Shape - Group")
 6701:             .path.setValue(shape);
 6702:           shorten("Quarter subdivisions Base Line")(
 6703:             "ADBE Vector Transform Group",
 6704:           )("ADBE Vector Scale").setValue([-90, -90]);
 6705:           shorten("Quarter subdivisions Base Line")(
 6706:             "ADBE Vectors Group",
 6707:           ).addProperty("ADBE Vector Graphic - Stroke")(
 6708:             "ADBE Vector Stroke Color",
 6709:           ).expression =
 6710:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
 6711:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 6712:             "ADBE Vector Graphic - Stroke",
 6713:           )("ADBE Vector Stroke Width").setValue(2);
 6714:           shorten("Quarter subdivisions Base Line")(
 6715:             "ADBE Vectors Group",
 6716:           ).addProperty("ADBE Vector Filter - Offset")(
 6717:             "ADBE Vector Offset Amount",
 6718:           ).expression =
 6719:             'try { effect("ADBE easyRulers")("Height")*2.22 } catch(e) { value }';
 6720:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 6721:             "ADBE Vector Filter - Offset",
 6722:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6723:           shorten("Quarter subdivisions Base Line")(
 6724:             "ADBE Vectors Group",
 6725:           ).addProperty("ADBE Vector Filter - Trim")(
 6726:             "ADBE Vector Trim End",
 6727:           ).expression =
 6728:             "try { Math.abs(" +
 6729:             (EditTextCopies.text - 1) +
 6730:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6731:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 6732:             "ADBE Vector Filter - Trim",
 6733:           )("ADBE Vector Trim Start").setValue(0.001);
 6734:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 6735:             "ADBE Vector Filter - Trim",
 6736:           )("ADBE Vector Trim Offset").expression =
 6737:             'try { if (effect("ADBE easyRulers")("Gap") < 0) {-3.6*Math.abs(' +
 6738:             (EditTextCopies.text - 1) +
 6739:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6740:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 6741:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 6742:             "ADBE Vector Shape - Ellipse",
 6743:           )("ADBE Vector Ellipse Size").expression =
 6744:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 6745:           shorten("Main lines")("ADBE Vectors Group")(
 6746:             "ADBE Vector Shape - Ellipse",
 6747:           )("ADBE Vector Ellipse Position").setValue([0, r]);
 6748:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 6749:             "ADBE Vector Graphic - Fill",
 6750:           )("ADBE Vector Fill Color").expression =
 6751:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 6752:           shorten("Main lines")("ADBE Vectors Group")
 6753:             .addProperty(
 6754:               "ADBE Vector Filter - Repeater",
 6755:             )("ADBE Vector Repeater Copies")
 6756:             .setValue(EditTextCopies.text);
 6757:           shorten("Main lines")("ADBE Vectors Group")(
 6758:             "ADBE Vector Filter - Repeater",
 6759:           )("ADBE Vector Repeater Transform")(
 6760:             "ADBE Vector Repeater Rotation",
 6761:           ).expression =
 6762:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 6763:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 6764:           shorten("Base line")("ADBE Vectors Group")
 6765:             .addProperty("ADBE Vector Shape - Group")
 6766:             .path.setValue(shape);
 6767:           shorten("Base line")("ADBE Vector Transform Group")(
 6768:             "ADBE Vector Scale",
 6769:           ).setValue([-90, -90]);
 6770:           shorten("Base line")("ADBE Vectors Group").addProperty(
 6771:             "ADBE Vector Graphic - Stroke",
 6772:           )("ADBE Vector Stroke Color").expression =
 6773:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 6774:           shorten("Base line")("ADBE Vectors Group")(
 6775:             "ADBE Vector Graphic - Stroke",
 6776:           )("ADBE Vector Stroke Width").setValue(2);
 6777:           shorten("Base line")("ADBE Vectors Group")
 6778:             .addProperty(
 6779:               "ADBE Vector Filter - Offset",
 6780:             )("ADBE Vector Offset Amount")
 6781:             .setValue(0);
 6782:           shorten("Base line")("ADBE Vectors Group")(
 6783:             "ADBE Vector Filter - Offset",
 6784:           )("ADBE Vector Offset Miter Limit").setValue(4);
 6785:           shorten("Base line")("ADBE Vectors Group").addProperty(
 6786:             "ADBE Vector Filter - Trim",
 6787:           )("ADBE Vector Trim End").expression =
 6788:             "try { Math.abs(" +
 6789:             (EditTextCopies.text - 1) +
 6790:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 6791:           shorten("Base line")("ADBE Vectors Group")(
 6792:             "ADBE Vector Filter - Trim",
 6793:           )("ADBE Vector Trim Start").setValue(0.001);
 6794:           shorten("Base line")("ADBE Vectors Group")(
 6795:             "ADBE Vector Filter - Trim",
 6796:           )("ADBE Vector Trim Offset").expression =
 6797:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 6798:             (EditTextCopies.text - 1) +
 6799:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 6800:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 6801:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 6802:           t("ADBE easyRulers")("Height").setValue(4);
 6803:           t("ADBE easyRulers")("default Height").setValue(4);
 6804:           if (SidesType.selection.index == 2) {
 6805:             t("ADBE easyRulers")("Sides Distance").setValue(e);
 6806:             t("ADBE easyRulers")("default Sides Distance").setValue(e);
 6807:           }
 6808:           if (NumbersCheckBox.value) {
 6809:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 6810:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 6811:           }
 6812:           app.project.activeItem.layer(shapeLayer.name)(
 6813:             "ADBE Root Vectors Group",
 6814:           )("Ruler")("ADBE Vector Transform Group")(
 6815:             "ADBE Vector Rotation",
 6816:           ).expression =
 6817:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 6818:           createPointerCircular();
 6819:           secondary_lines = app.project.activeItem
 6820:             .layer(
 6821:               shapeLayer.name,
 6822:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 6823:             .duplicate();
 6824:           secondary_lines.name = "Main lines - Secondary Color";
 6825:           secondary_lines("ADBE Vectors Group")(
 6826:             "ADBE Vector Filter - Repeater",
 6827:           )("ADBE Vector Repeater Copies").expression =
 6828:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6829:             EditTextCopies.text +
 6830:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6831:             (Number(EditTextCopies.text) - 1) +
 6832:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 6833:             (Number(EditTextCopies.text) - 1) +
 6834:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6835:             EditTextCopies.text +
 6836:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 6837:             (Number(EditTextCopies.text) - 1) +
 6838:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 6839:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6840:             "ADBE Vector Fill Opacity",
 6841:           ).expression =
 6842:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 6843:           secondary_lines("ADBE Vector Transform Group")(
 6844:             "ADBE Vector Group Opacity",
 6845:           ).expression =
 6846:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6847:           secondary_lines("ADBE Vectors Group")(
 6848:             "ADBE Vector Graphic - Fill",
 6849:           ).name = "Fill Start";
 6850:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 6851:             "ADBE Vector Fill Color",
 6852:           ).expression =
 6853:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 6854:           secondary_lines("ADBE Vectors Group")(
 6855:             "ADBE Vector Filter - Repeater",
 6856:           )("ADBE Vector Repeater Offset").expression =
 6857:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 6858:             (Number(EditTextCopies.text) - 1) +
 6859:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 6860:             (Number(EditTextCopies.text) - 1) +
 6861:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
 6862:           secondary_lines("ADBE Vectors Group")(
 6863:             "ADBE Vector Filter - Repeater",
 6864:           )("ADBE Vector Repeater Transform")(
 6865:             "ADBE Vector Repeater Opacity 1",
 6866:           ).expression =
 6867:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6868:           secondary_lines("ADBE Vectors Group")(
 6869:             "ADBE Vector Filter - Repeater",
 6870:           )("ADBE Vector Repeater Transform")(
 6871:             "ADBE Vector Repeater Opacity 2",
 6872:           ).expression =
 6873:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6874:           secondary_lines("ADBE Vectors Group").addProperty(
 6875:             "ADBE Vector Graphic - Fill",
 6876:           ).name = "Fill End";
 6877:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6878:             "ADBE Vector Fill Color",
 6879:           ).expression =
 6880:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 6881:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6882:             "ADBE Vector Fill Opacity",
 6883:           ).expression =
 6884:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 6885:           secondary_lines = app.project.activeItem
 6886:             .layer(
 6887:               shapeLayer.name,
 6888:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 6889:             .duplicate();
 6890:           secondary_lines.name = "Big subdivisions - Secondary Color";
 6891:           secondary_lines("ADBE Vectors Group")(
 6892:             "ADBE Vector Filter - Repeater",
 6893:           )("ADBE Vector Repeater Copies").expression =
 6894:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6895:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6896:             1 +
 6897:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6898:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6899:             1 +
 6900:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 6901:             (Number(EditTextCopies.text) - 1) +
 6902:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 6903:             divideBy +
 6904:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6905:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6906:             1 +
 6907:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 6908:             divideBy +
 6909:             "*100/" +
 6910:             (Number(EditTextCopies.text) - 1) +
 6911:             ")) } else { 0 }              }} catch(e) { value }";
 6912:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6913:             "ADBE Vector Fill Opacity",
 6914:           ).expression =
 6915:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 6916:           secondary_lines("ADBE Vector Transform Group")(
 6917:             "ADBE Vector Group Opacity",
 6918:           ).expression =
 6919:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6920:           secondary_lines("ADBE Vectors Group")(
 6921:             "ADBE Vector Graphic - Fill",
 6922:           ).name = "Fill Start";
 6923:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 6924:             "ADBE Vector Fill Color",
 6925:           ).expression =
 6926:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 6927:           secondary_lines("ADBE Vectors Group")(
 6928:             "ADBE Vector Filter - Repeater",
 6929:           )("ADBE Vector Repeater Offset").expression =
 6930:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 6931:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 6932:             1 +
 6933:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 6934:             (Number(EditTextCopies.text) - 1) +
 6935:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 6936:             divideBy +
 6937:             ")} else { 0 }             }} catch(e) { value }";
 6938:           secondary_lines("ADBE Vectors Group")(
 6939:             "ADBE Vector Filter - Repeater",
 6940:           )("ADBE Vector Repeater Transform")(
 6941:             "ADBE Vector Repeater Opacity 1",
 6942:           ).expression =
 6943:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6944:           secondary_lines("ADBE Vectors Group")(
 6945:             "ADBE Vector Filter - Repeater",
 6946:           )("ADBE Vector Repeater Transform")(
 6947:             "ADBE Vector Repeater Opacity 2",
 6948:           ).expression =
 6949:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 6950:           secondary_lines("ADBE Vectors Group").addProperty(
 6951:             "ADBE Vector Graphic - Fill",
 6952:           ).name = "Fill End";
 6953:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6954:             "ADBE Vector Fill Color",
 6955:           ).expression =
 6956:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 6957:           secondary_lines("ADBE Vectors Group")("Fill End")(
 6958:             "ADBE Vector Fill Opacity",
 6959:           ).expression =
 6960:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 6961:           secondary_lines = app.project.activeItem
 6962:             .layer(
 6963:               shapeLayer.name,
 6964:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
 6965:             .duplicate();
 6966:           secondary_lines.name = "Half subdivisions - Secondary Color";
 6967:           secondary_lines("ADBE Vectors Group")(
 6968:             "ADBE Vector Filter - Repeater",
 6969:           )("ADBE Vector Repeater Copies").expression =
 6970:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 6971:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 6972:             1 +
 6973:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 6974:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 6975:             1 +
 6976:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 6977:             (Number(EditTextCopies.text) - 1) +
 6978:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 6979:             divideBy / 2 +
 6980:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 6981:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 6982:             1 +
 6983:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 6984:             divideBy / 2 +
 6985:             "*100/" +
 6986:             (Number(EditTextCopies.text) - 1) +
 6987:             ")) } else { 0 }              }} catch(e) { value }";
 6988:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 6989:             "ADBE Vector Fill Opacity",
 6990:           ).expression =
 6991:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 6992:           secondary_lines("ADBE Vector Transform Group")(
 6993:             "ADBE Vector Group Opacity",
 6994:           ).expression =
 6995:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 6996:           secondary_lines("ADBE Vectors Group")(
 6997:             "ADBE Vector Graphic - Fill",
 6998:           ).name = "Fill Start";
 6999:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7000:             "ADBE Vector Fill Color",
 7001:           ).expression =
 7002:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7003:           secondary_lines("ADBE Vectors Group")(
 7004:             "ADBE Vector Filter - Repeater",
 7005:           )("ADBE Vector Repeater Offset").expression =
 7006:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7007:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7008:             1 +
 7009:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7010:             (Number(EditTextCopies.text) - 1) +
 7011:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 7012:             divideBy / 2 +
 7013:             ")} else { 0 }             }} catch(e) { value }";
 7014:           secondary_lines("ADBE Vectors Group")(
 7015:             "ADBE Vector Filter - Repeater",
 7016:           )("ADBE Vector Repeater Transform")(
 7017:             "ADBE Vector Repeater Opacity 1",
 7018:           ).expression =
 7019:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7020:           secondary_lines("ADBE Vectors Group")(
 7021:             "ADBE Vector Filter - Repeater",
 7022:           )("ADBE Vector Repeater Transform")(
 7023:             "ADBE Vector Repeater Opacity 2",
 7024:           ).expression =
 7025:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7026:           secondary_lines("ADBE Vectors Group").addProperty(
 7027:             "ADBE Vector Graphic - Fill",
 7028:           ).name = "Fill End";
 7029:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7030:             "ADBE Vector Fill Color",
 7031:           ).expression =
 7032:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 7033:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7034:             "ADBE Vector Fill Opacity",
 7035:           ).expression =
 7036:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 7037:           secondary_lines = app.project.activeItem
 7038:             .layer(
 7039:               shapeLayer.name,
 7040:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
 7041:             .duplicate();
 7042:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
 7043:           secondary_lines("ADBE Vectors Group")(
 7044:             "ADBE Vector Filter - Repeater",
 7045:           )("ADBE Vector Repeater Copies").expression =
 7046:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 7047:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7048:             1 +
 7049:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 7050:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7051:             1 +
 7052:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 7053:             (Number(EditTextCopies.text) - 1) +
 7054:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 7055:             divideBy / 4 +
 7056:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 7057:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7058:             1 +
 7059:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 7060:             divideBy / 4 +
 7061:             "*100/" +
 7062:             (Number(EditTextCopies.text) - 1) +
 7063:             ")) } else{ 0 }              }} catch(e) { value }";
 7064:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 7065:             "ADBE Vector Fill Opacity",
 7066:           ).expression =
 7067:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
 7068:           secondary_lines("ADBE Vector Transform Group")(
 7069:             "ADBE Vector Group Opacity",
 7070:           ).expression =
 7071:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 7072:           secondary_lines("ADBE Vectors Group")(
 7073:             "ADBE Vector Graphic - Fill",
 7074:           ).name = "Fill Start";
 7075:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7076:             "ADBE Vector Fill Color",
 7077:           ).expression =
 7078:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7079:           secondary_lines("ADBE Vectors Group")(
 7080:             "ADBE Vector Filter - Repeater",
 7081:           )("ADBE Vector Repeater Offset").expression =
 7082:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7083:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7084:             1 +
 7085:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7086:             (Number(EditTextCopies.text) - 1) +
 7087:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 7088:             divideBy / 4 +
 7089:             ")} else { 0 }              }} catch(e) { value }";
 7090:           secondary_lines("ADBE Vectors Group")(
 7091:             "ADBE Vector Filter - Repeater",
 7092:           )("ADBE Vector Repeater Transform")(
 7093:             "ADBE Vector Repeater Opacity 1",
 7094:           ).expression =
 7095:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7096:           secondary_lines("ADBE Vectors Group")(
 7097:             "ADBE Vector Filter - Repeater",
 7098:           )("ADBE Vector Repeater Transform")(
 7099:             "ADBE Vector Repeater Opacity 2",
 7100:           ).expression =
 7101:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7102:           secondary_lines("ADBE Vectors Group").addProperty(
 7103:             "ADBE Vector Graphic - Fill",
 7104:           ).name = "Fill End";
 7105:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7106:             "ADBE Vector Fill Color",
 7107:           ).expression =
 7108:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 7109:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7110:             "ADBE Vector Fill Opacity",
 7111:           ).expression =
 7112:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
 7113:           app.project.activeItem
 7114:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 7115:             .duplicate().name = "Ruler Mirror";
 7116:           app.project.activeItem
 7117:             .layer(
 7118:               shapeLayer.name,
 7119:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 7120:             .setValue(60);
 7121:           app.project.activeItem
 7122:             .layer(
 7123:               shapeLayer.name,
 7124:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 7125:             .setValue(-180);
 7126:           app.project.activeItem
 7127:             .layer(
 7128:               shapeLayer.name,
 7129:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 7130:             .setValue([0, 425]);
 7131:           app.project.activeItem.layer(shapeLayer.name)(
 7132:             "ADBE Root Vectors Group",
 7133:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 7134:           if (SidesType.selection.index !== 0) {
 7135:             app.project.activeItem.layer(shapeLayer.name)(
 7136:               "ADBE Root Vectors Group",
 7137:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 7138:               "ADBE Vector Scale",
 7139:             ).expression =
 7140:               SidesType.selection.index == 2
 7141:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { value }'
 7142:                 : "[value[0] + (" + e + "), value[1] + (" + e + ")]";
 7143:             app.project.activeItem.layer(shapeLayer.name)(
 7144:               "ADBE Root Vectors Group",
 7145:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 7146:               "ADBE Vector Transform Group",
 7147:             )("ADBE Vector Anchor").expression =
 7148:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 7149:             app.project.activeItem.layer(shapeLayer.name)(
 7150:               "ADBE Root Vectors Group",
 7151:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 7152:               "ADBE Vectors Group",
 7153:             )("ADBE Vector Shape - Ellipse")(
 7154:               "ADBE Vector Ellipse Position",
 7155:             ).expression =
 7156:               SidesType.selection.index == 2
 7157:                 ? 'try { [value[0], value[1] - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 7158:                 : "[value[0], value[1] - (" + e + ")]";
 7159:             app.project.activeItem
 7160:               .layer(
 7161:                 shapeLayer.name,
 7162:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 7163:               .setValue([0, r]);
 7164:             app.project.activeItem.layer(shapeLayer.name)(
 7165:               "ADBE Root Vectors Group",
 7166:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 7167:               "ADBE Vectors Group",
 7168:             )("ADBE Vector Shape - Ellipse")(
 7169:               "ADBE Vector Ellipse Position",
 7170:             ).expression =
 7171:               SidesType.selection.index == 2
 7172:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*6 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 7173:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*6 - (' +
 7174:                   e +
 7175:                   ")] } catch(e) { value }";
 7176:             app.project.activeItem
 7177:               .layer(
 7178:                 shapeLayer.name,
 7179:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 7180:               .setValue([0, r]);
 7181:             app.project.activeItem.layer(shapeLayer.name)(
 7182:               "ADBE Root Vectors Group",
 7183:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
 7184:               "ADBE Vectors Group",
 7185:             )("ADBE Vector Shape - Ellipse")(
 7186:               "ADBE Vector Ellipse Position",
 7187:             ).expression =
 7188:               SidesType.selection.index == 2
 7189:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 7190:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - (' +
 7191:                   e +
 7192:                   ")] } catch(e) { value }";
 7193:             app.project.activeItem
 7194:               .layer(
 7195:                 shapeLayer.name,
 7196:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 7197:               .setValue([0, r]);
 7198:             app.project.activeItem.layer(shapeLayer.name)(
 7199:               "ADBE Root Vectors Group",
 7200:             )("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")(
 7201:               "ADBE Vectors Group",
 7202:             )("ADBE Vector Shape - Ellipse")(
 7203:               "ADBE Vector Ellipse Position",
 7204:             ).expression =
 7205:               SidesType.selection.index == 2
 7206:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 7207:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - (' +
 7208:                   e +
 7209:                   ")] } catch(e) { value }";
 7210:             app.project.activeItem.layer(shapeLayer.name)(
 7211:               "ADBE Root Vectors Group",
 7212:             )("Ruler Mirror")("ADBE Vectors Group")("Base line")(
 7213:               "ADBE Vectors Group",
 7214:             )("ADBE Vector Filter - Offset")(
 7215:               "ADBE Vector Offset Amount",
 7216:             ).expression =
 7217:               SidesType.selection.index == 2
 7218:                 ? 'try { effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 7219:                 : "" + e + "*1.111";
 7220:             app.project.activeItem.layer(shapeLayer.name)(
 7221:               "ADBE Root Vectors Group",
 7222:             )("Ruler Mirror")("ADBE Vectors Group")(
 7223:               "Quarter subdivisions Base Line",
 7224:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 7225:               "ADBE Vector Offset Amount",
 7226:             ).expression =
 7227:               SidesType.selection.index == 2
 7228:                 ? 'try {-effect("ADBE easyRulers")("Height")*2.222 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 7229:                 : 'try { -effect("ADBE easyRulers")("Height")*2.222 + (' +
 7230:                   e +
 7231:                   ")*1.111 } catch(e) { value }";
 7232:             app.project.activeItem.layer(shapeLayer.name)(
 7233:               "ADBE Root Vectors Group",
 7234:             )("Ruler Mirror")("ADBE Vectors Group")(
 7235:               "Half subdivisions Base Line",
 7236:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 7237:               "ADBE Vector Offset Amount",
 7238:             ).expression =
 7239:               SidesType.selection.index == 2
 7240:                 ? 'try {-effect("ADBE easyRulers")("Height")*4.444 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 7241:                 : 'try { -effect("ADBE easyRulers")("Height")*4.444 + (' +
 7242:                   e +
 7243:                   ")*1.111 } catch(e) { value }";
 7244:             app.project.activeItem.layer(shapeLayer.name)(
 7245:               "ADBE Root Vectors Group",
 7246:             )("Ruler Mirror")("ADBE Vectors Group")(
 7247:               "Big subdivisions Base Line",
 7248:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 7249:               "ADBE Vector Offset Amount",
 7250:             ).expression =
 7251:               SidesType.selection.index == 2
 7252:                 ? 'try {-effect("ADBE easyRulers")("Height")*6.67 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 7253:                 : 'try { -effect("ADBE easyRulers")("Height")*6.67 + (' +
 7254:                   e +
 7255:                   ")*1.111 } catch(e) { value }";
 7256:           }
 7257:           switch (BaseLineDropdown.selection.index) {
 7258:             case 0:
 7259:               app.project.activeItem
 7260:                 .layer(
 7261:                   shapeLayer.name,
 7262:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 7263:                 .remove();
 7264:               app.project.activeItem
 7265:                 .layer(
 7266:                   shapeLayer.name,
 7267:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 7268:                 .remove();
 7269:               app.project.activeItem
 7270:                 .layer(
 7271:                   shapeLayer.name,
 7272:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 7273:                 .remove();
 7274:               app.project.activeItem
 7275:                 .layer(
 7276:                   shapeLayer.name,
 7277:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 7278:                 .remove();
 7279:               app.project.activeItem
 7280:                 .layer(
 7281:                   shapeLayer.name,
 7282:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 7283:                 .remove();
 7284:               app.project.activeItem
 7285:                 .layer(
 7286:                   shapeLayer.name,
 7287:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 7288:                 .remove();
 7289:               app.project.activeItem
 7290:                 .layer(
 7291:                   shapeLayer.name,
 7292:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 7293:                 .remove();
 7294:               app.project.activeItem
 7295:                 .layer(
 7296:                   shapeLayer.name,
 7297:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 7298:                 .remove();
 7299:               break;
 7300:             case 1:
 7301:               app.project.activeItem
 7302:                 .layer(
 7303:                   shapeLayer.name,
 7304:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 7305:                 .remove();
 7306:               app.project.activeItem
 7307:                 .layer(
 7308:                   shapeLayer.name,
 7309:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 7310:                 .remove();
 7311:               app.project.activeItem
 7312:                 .layer(
 7313:                   shapeLayer.name,
 7314:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 7315:                 .remove();
 7316:               app.project.activeItem
 7317:                 .layer(
 7318:                   shapeLayer.name,
 7319:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 7320:                 .remove();
 7321:               app.project.activeItem
 7322:                 .layer(
 7323:                   shapeLayer.name,
 7324:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 7325:                 .remove();
 7326:               app.project.activeItem
 7327:                 .layer(
 7328:                   shapeLayer.name,
 7329:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 7330:                 .remove();
 7331:           }
 7332:         };
 7333:         createBasic16b_circle_DotLines = function () {
 7334:           var e = -10;
 7335:           var r = -225;
 7336:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 7337:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 7338:             "ADBE Vector Shape - Ellipse",
 7339:           )("ADBE Vector Ellipse Size").expression =
 7340:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*3, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*3] } catch(e) { value }';
 7341:           shorten("Big subdivisions")("ADBE Vectors Group")(
 7342:             "ADBE Vector Shape - Ellipse",
 7343:           )("ADBE Vector Ellipse Position").expression =
 7344:             "try { [0, " +
 7345:             r +
 7346:             ' - effect("ADBE easyRulers")("Height")*8] } catch(e) { value }';
 7347:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 7348:             "ADBE Vector Graphic - Fill",
 7349:           )("ADBE Vector Fill Color").expression =
 7350:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 7351:           shorten("Big subdivisions")("ADBE Vectors Group")
 7352:             .addProperty("ADBE Vector Filter - Repeater")(
 7353:               "ADBE Vector Repeater Copies",
 7354:             )
 7355:             .setValue(
 7356:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 7357:             );
 7358:           shorten("Big subdivisions")("ADBE Vectors Group")(
 7359:             "ADBE Vector Filter - Repeater",
 7360:           )("ADBE Vector Repeater Transform")(
 7361:             "ADBE Vector Repeater Rotation",
 7362:           ).expression =
 7363:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 7364:             divideBy +
 7365:             " } catch(e) { value }";
 7366:           shorten.addProperty("ADBE Vector Group").name =
 7367:             "Big subdivisions Base Line";
 7368:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 7369:             .addProperty("ADBE Vector Shape - Group")
 7370:             .path.setValue(shape);
 7371:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 7372:             "ADBE Vector Scale",
 7373:           ).setValue([-90, -90]);
 7374:           shorten("Big subdivisions Base Line")(
 7375:             "ADBE Vectors Group",
 7376:           ).addProperty("ADBE Vector Graphic - Stroke")(
 7377:             "ADBE Vector Stroke Color",
 7378:           ).expression =
 7379:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 7380:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 7381:             "ADBE Vector Graphic - Stroke",
 7382:           )("ADBE Vector Stroke Width").setValue(2);
 7383:           shorten("Big subdivisions Base Line")(
 7384:             "ADBE Vectors Group",
 7385:           ).addProperty("ADBE Vector Filter - Offset")(
 7386:             "ADBE Vector Offset Amount",
 7387:           ).expression =
 7388:             'try { effect("ADBE easyRulers")("Height")*8.888 } catch(e) { value }';
 7389:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 7390:             "ADBE Vector Filter - Offset",
 7391:           )("ADBE Vector Offset Miter Limit").setValue(4);
 7392:           shorten("Big subdivisions Base Line")(
 7393:             "ADBE Vectors Group",
 7394:           ).addProperty("ADBE Vector Filter - Trim")(
 7395:             "ADBE Vector Trim End",
 7396:           ).expression =
 7397:             "try { Math.abs(" +
 7398:             (EditTextCopies.text - 1) +
 7399:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 7400:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 7401:             "ADBE Vector Filter - Trim",
 7402:           )("ADBE Vector Trim Start").setValue(0.001);
 7403:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 7404:             "ADBE Vector Filter - Trim",
 7405:           )("ADBE Vector Trim Offset").expression =
 7406:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 7407:             (EditTextCopies.text - 1) +
 7408:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 7409:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
 7410:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 7411:             "ADBE Vector Shape - Ellipse",
 7412:           )("ADBE Vector Ellipse Size").expression =
 7413:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
 7414:           shorten("Half subdivisions")("ADBE Vectors Group")(
 7415:             "ADBE Vector Shape - Ellipse",
 7416:           )("ADBE Vector Ellipse Position").expression =
 7417:             "try { [0, " +
 7418:             r +
 7419:             ' - effect("ADBE easyRulers")("Height")*6] } catch(e) { value }';
 7420:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 7421:             "ADBE Vector Graphic - Fill",
 7422:           )("ADBE Vector Fill Color").expression =
 7423:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 7424:           shorten("Half subdivisions")("ADBE Vectors Group")
 7425:             .addProperty("ADBE Vector Filter - Repeater")(
 7426:               "ADBE Vector Repeater Copies",
 7427:             )
 7428:             .setValue(
 7429:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7430:                 1,
 7431:             );
 7432:           shorten("Half subdivisions")("ADBE Vectors Group")(
 7433:             "ADBE Vector Filter - Repeater",
 7434:           )("ADBE Vector Repeater Transform")(
 7435:             "ADBE Vector Repeater Rotation",
 7436:           ).expression =
 7437:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 7438:             divideBy / 2 +
 7439:             " } catch(e) { value }";
 7440:           shorten.addProperty("ADBE Vector Group").name =
 7441:             "Half subdivisions Base Line";
 7442:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
 7443:             .addProperty("ADBE Vector Shape - Group")
 7444:             .path.setValue(shape);
 7445:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
 7446:             "ADBE Vector Scale",
 7447:           ).setValue([-90, -90]);
 7448:           shorten("Half subdivisions Base Line")(
 7449:             "ADBE Vectors Group",
 7450:           ).addProperty("ADBE Vector Graphic - Stroke")(
 7451:             "ADBE Vector Stroke Color",
 7452:           ).expression =
 7453:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 7454:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 7455:             "ADBE Vector Graphic - Stroke",
 7456:           )("ADBE Vector Stroke Width").setValue(2);
 7457:           shorten("Half subdivisions Base Line")(
 7458:             "ADBE Vectors Group",
 7459:           ).addProperty("ADBE Vector Filter - Offset")(
 7460:             "ADBE Vector Offset Amount",
 7461:           ).expression =
 7462:             'try { effect("ADBE easyRulers")("Height")*6.67 } catch(e) { value }';
 7463:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 7464:             "ADBE Vector Filter - Offset",
 7465:           )("ADBE Vector Offset Miter Limit").setValue(4);
 7466:           shorten("Half subdivisions Base Line")(
 7467:             "ADBE Vectors Group",
 7468:           ).addProperty("ADBE Vector Filter - Trim")(
 7469:             "ADBE Vector Trim End",
 7470:           ).expression =
 7471:             "try { Math.abs(" +
 7472:             (EditTextCopies.text - 1) +
 7473:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 7474:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 7475:             "ADBE Vector Filter - Trim",
 7476:           )("ADBE Vector Trim Start").setValue(0.001);
 7477:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 7478:             "ADBE Vector Filter - Trim",
 7479:           )("ADBE Vector Trim Offset").expression =
 7480:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 7481:             (EditTextCopies.text - 1) +
 7482:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 7483:           shorten.addProperty("ADBE Vector Group").name =
 7484:             "Quarter subdivisions";
 7485:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
 7486:             "ADBE Vector Shape - Ellipse",
 7487:           )("ADBE Vector Ellipse Size").expression =
 7488:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
 7489:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
 7490:             "ADBE Vector Shape - Ellipse",
 7491:           )("ADBE Vector Ellipse Position").expression =
 7492:             "try { [0, " +
 7493:             r +
 7494:             ' - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
 7495:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
 7496:             "ADBE Vector Graphic - Fill",
 7497:           )("ADBE Vector Fill Color").expression =
 7498:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
 7499:           shorten("Quarter subdivisions")("ADBE Vectors Group")
 7500:             .addProperty("ADBE Vector Filter - Repeater")(
 7501:               "ADBE Vector Repeater Copies",
 7502:             )
 7503:             .setValue(
 7504:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7505:                 1,
 7506:             );
 7507:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
 7508:             "ADBE Vector Filter - Repeater",
 7509:           )("ADBE Vector Repeater Transform")(
 7510:             "ADBE Vector Repeater Rotation",
 7511:           ).expression =
 7512:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 7513:             divideBy / 4 +
 7514:             " } catch(e) { value }";
 7515:           shorten.addProperty("ADBE Vector Group").name =
 7516:             "Quarter subdivisions Base Line";
 7517:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")
 7518:             .addProperty("ADBE Vector Shape - Group")
 7519:             .path.setValue(shape);
 7520:           shorten("Quarter subdivisions Base Line")(
 7521:             "ADBE Vector Transform Group",
 7522:           )("ADBE Vector Scale").setValue([-90, -90]);
 7523:           shorten("Quarter subdivisions Base Line")(
 7524:             "ADBE Vectors Group",
 7525:           ).addProperty("ADBE Vector Graphic - Stroke")(
 7526:             "ADBE Vector Stroke Color",
 7527:           ).expression =
 7528:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
 7529:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 7530:             "ADBE Vector Graphic - Stroke",
 7531:           )("ADBE Vector Stroke Width").setValue(2);
 7532:           shorten("Quarter subdivisions Base Line")(
 7533:             "ADBE Vectors Group",
 7534:           ).addProperty("ADBE Vector Filter - Offset")(
 7535:             "ADBE Vector Offset Amount",
 7536:           ).expression =
 7537:             'try { effect("ADBE easyRulers")("Height")*4.444 } catch(e) { value }';
 7538:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 7539:             "ADBE Vector Filter - Offset",
 7540:           )("ADBE Vector Offset Miter Limit").setValue(4);
 7541:           shorten("Quarter subdivisions Base Line")(
 7542:             "ADBE Vectors Group",
 7543:           ).addProperty("ADBE Vector Filter - Trim")(
 7544:             "ADBE Vector Trim End",
 7545:           ).expression =
 7546:             "try { Math.abs(" +
 7547:             (EditTextCopies.text - 1) +
 7548:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 7549:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 7550:             "ADBE Vector Filter - Trim",
 7551:           )("ADBE Vector Trim Start").setValue(0.001);
 7552:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
 7553:             "ADBE Vector Filter - Trim",
 7554:           )("ADBE Vector Trim Offset").expression =
 7555:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 7556:             (EditTextCopies.text - 1) +
 7557:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 7558:           shorten.addProperty("ADBE Vector Group").name = "Eighth subdivisions";
 7559:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
 7560:             "ADBE Vector Shape - Ellipse",
 7561:           )("ADBE Vector Ellipse Size").expression =
 7562:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
 7563:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
 7564:             "ADBE Vector Shape - Ellipse",
 7565:           )("ADBE Vector Ellipse Position").expression =
 7566:             "try { [0, " +
 7567:             r +
 7568:             ' - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
 7569:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
 7570:             "ADBE Vector Graphic - Fill",
 7571:           )("ADBE Vector Fill Color").expression =
 7572:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
 7573:           shorten("Eighth subdivisions")("ADBE Vectors Group")
 7574:             .addProperty("ADBE Vector Filter - Repeater")(
 7575:               "ADBE Vector Repeater Copies",
 7576:             )
 7577:             .setValue(
 7578:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
 7579:                 1,
 7580:             );
 7581:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
 7582:             "ADBE Vector Filter - Repeater",
 7583:           )("ADBE Vector Repeater Transform")(
 7584:             "ADBE Vector Repeater Rotation",
 7585:           ).expression =
 7586:             'try { (effect("ADBE easyRulers")("Gap")/10)*' +
 7587:             divideBy / 8 +
 7588:             " } catch(e) { value }";
 7589:           shorten.addProperty("ADBE Vector Group").name =
 7590:             "Eighth subdivisions Base Line";
 7591:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")
 7592:             .addProperty("ADBE Vector Shape - Group")
 7593:             .path.setValue(shape);
 7594:           shorten("Eighth subdivisions Base Line")(
 7595:             "ADBE Vector Transform Group",
 7596:           )("ADBE Vector Scale").setValue([-90, -90]);
 7597:           shorten("Eighth subdivisions Base Line")(
 7598:             "ADBE Vectors Group",
 7599:           ).addProperty("ADBE Vector Graphic - Stroke")(
 7600:             "ADBE Vector Stroke Color",
 7601:           ).expression =
 7602:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
 7603:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
 7604:             "ADBE Vector Graphic - Stroke",
 7605:           )("ADBE Vector Stroke Width").setValue(2);
 7606:           shorten("Eighth subdivisions Base Line")(
 7607:             "ADBE Vectors Group",
 7608:           ).addProperty("ADBE Vector Filter - Offset")(
 7609:             "ADBE Vector Offset Amount",
 7610:           ).expression =
 7611:             'try { effect("ADBE easyRulers")("Height")*2.22 } catch(e) { value }';
 7612:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
 7613:             "ADBE Vector Filter - Offset",
 7614:           )("ADBE Vector Offset Miter Limit").setValue(4);
 7615:           shorten("Eighth subdivisions Base Line")(
 7616:             "ADBE Vectors Group",
 7617:           ).addProperty("ADBE Vector Filter - Trim")(
 7618:             "ADBE Vector Trim End",
 7619:           ).expression =
 7620:             "try { Math.abs(" +
 7621:             (EditTextCopies.text - 1) +
 7622:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 7623:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
 7624:             "ADBE Vector Filter - Trim",
 7625:           )("ADBE Vector Trim Start").setValue(0.001);
 7626:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
 7627:             "ADBE Vector Filter - Trim",
 7628:           )("ADBE Vector Trim Offset").expression =
 7629:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 7630:             (EditTextCopies.text - 1) +
 7631:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 7632:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 7633:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 7634:             "ADBE Vector Shape - Ellipse",
 7635:           )("ADBE Vector Ellipse Size").expression =
 7636:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
 7637:           shorten("Main lines")("ADBE Vectors Group")(
 7638:             "ADBE Vector Shape - Ellipse",
 7639:           )("ADBE Vector Ellipse Position").setValue([0, r]);
 7640:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 7641:             "ADBE Vector Graphic - Fill",
 7642:           )("ADBE Vector Fill Color").expression =
 7643:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 7644:           shorten("Main lines")("ADBE Vectors Group")
 7645:             .addProperty(
 7646:               "ADBE Vector Filter - Repeater",
 7647:             )("ADBE Vector Repeater Copies")
 7648:             .setValue(EditTextCopies.text);
 7649:           shorten("Main lines")("ADBE Vectors Group")(
 7650:             "ADBE Vector Filter - Repeater",
 7651:           )("ADBE Vector Repeater Transform")(
 7652:             "ADBE Vector Repeater Rotation",
 7653:           ).expression =
 7654:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 7655:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 7656:           shorten("Base line")("ADBE Vectors Group")
 7657:             .addProperty("ADBE Vector Shape - Group")
 7658:             .path.setValue(shape);
 7659:           shorten("Base line")("ADBE Vector Transform Group")(
 7660:             "ADBE Vector Scale",
 7661:           ).setValue([-90, -90]);
 7662:           shorten("Base line")("ADBE Vectors Group").addProperty(
 7663:             "ADBE Vector Graphic - Stroke",
 7664:           )("ADBE Vector Stroke Color").expression =
 7665:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 7666:           shorten("Base line")("ADBE Vectors Group")(
 7667:             "ADBE Vector Graphic - Stroke",
 7668:           )("ADBE Vector Stroke Width").setValue(2);
 7669:           shorten("Base line")("ADBE Vectors Group")
 7670:             .addProperty(
 7671:               "ADBE Vector Filter - Offset",
 7672:             )("ADBE Vector Offset Amount")
 7673:             .setValue(0);
 7674:           shorten("Base line")("ADBE Vectors Group")(
 7675:             "ADBE Vector Filter - Offset",
 7676:           )("ADBE Vector Offset Miter Limit").setValue(4);
 7677:           shorten("Base line")("ADBE Vectors Group").addProperty(
 7678:             "ADBE Vector Filter - Trim",
 7679:           )("ADBE Vector Trim End").expression =
 7680:             "try { Math.abs(" +
 7681:             (EditTextCopies.text - 1) +
 7682:             '*effect("ADBE easyRulers")("Gap")/36) } catch(e) { value }';
 7683:           shorten("Base line")("ADBE Vectors Group")(
 7684:             "ADBE Vector Filter - Trim",
 7685:           )("ADBE Vector Trim Start").setValue(0.001);
 7686:           shorten("Base line")("ADBE Vectors Group")(
 7687:             "ADBE Vector Filter - Trim",
 7688:           )("ADBE Vector Trim Offset").expression =
 7689:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 7690:             (EditTextCopies.text - 1) +
 7691:             '*effect("ADBE easyRulers")("Gap")/36) } else { 0 } } catch(e) { value }';
 7692:           t("ADBE easyRulers")("Dots Scale").setValue(5);
 7693:           t("ADBE easyRulers")("default Dots Scale").setValue(5);
 7694:           t("ADBE easyRulers")("Height").setValue(4);
 7695:           t("ADBE easyRulers")("default Height").setValue(4);
 7696:           if (SidesType.selection.index == 2) {
 7697:             t("ADBE easyRulers")("Sides Distance").setValue(e);
 7698:             t("ADBE easyRulers")("default Sides Distance").setValue(e);
 7699:           }
 7700:           if (NumbersCheckBox.value) {
 7701:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(25);
 7702:             t("ADBE easyRulers")("default Text Distance").setValue(25);
 7703:           }
 7704:           app.project.activeItem.layer(shapeLayer.name)(
 7705:             "ADBE Root Vectors Group",
 7706:           )("Ruler")("ADBE Vector Transform Group")(
 7707:             "ADBE Vector Rotation",
 7708:           ).expression =
 7709:             'try { [effect("ADBE easyRulers")("Rotation Offset")] } catch(e) { value }';
 7710:           createPointerCircular();
 7711:           secondary_lines = app.project.activeItem
 7712:             .layer(
 7713:               shapeLayer.name,
 7714:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 7715:             .duplicate();
 7716:           secondary_lines.name = "Main lines - Secondary Color";
 7717:           secondary_lines("ADBE Vectors Group")(
 7718:             "ADBE Vector Filter - Repeater",
 7719:           )("ADBE Vector Repeater Copies").expression =
 7720:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                 if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 7721:             EditTextCopies.text +
 7722:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 7723:             (Number(EditTextCopies.text) - 1) +
 7724:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                 } else { Math.ceil(' +
 7725:             (Number(EditTextCopies.text) - 1) +
 7726:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 7727:             EditTextCopies.text +
 7728:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 7729:             (Number(EditTextCopies.text) - 1) +
 7730:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }             }} catch(e) { value }';
 7731:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 7732:             "ADBE Vector Fill Opacity",
 7733:           ).expression =
 7734:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 7735:           secondary_lines("ADBE Vector Transform Group")(
 7736:             "ADBE Vector Group Opacity",
 7737:           ).expression =
 7738:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 7739:           secondary_lines("ADBE Vectors Group")(
 7740:             "ADBE Vector Graphic - Fill",
 7741:           ).name = "Fill Start";
 7742:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7743:             "ADBE Vector Fill Color",
 7744:           ).expression =
 7745:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7746:           secondary_lines("ADBE Vectors Group")(
 7747:             "ADBE Vector Filter - Repeater",
 7748:           )("ADBE Vector Repeater Offset").expression =
 7749:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7750:             (Number(EditTextCopies.text) - 1) +
 7751:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7752:             (Number(EditTextCopies.text) - 1) +
 7753:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
 7754:           secondary_lines("ADBE Vectors Group")(
 7755:             "ADBE Vector Filter - Repeater",
 7756:           )("ADBE Vector Repeater Transform")(
 7757:             "ADBE Vector Repeater Opacity 1",
 7758:           ).expression =
 7759:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7760:           secondary_lines("ADBE Vectors Group")(
 7761:             "ADBE Vector Filter - Repeater",
 7762:           )("ADBE Vector Repeater Transform")(
 7763:             "ADBE Vector Repeater Opacity 2",
 7764:           ).expression =
 7765:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7766:           secondary_lines("ADBE Vectors Group").addProperty(
 7767:             "ADBE Vector Graphic - Fill",
 7768:           ).name = "Fill End";
 7769:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7770:             "ADBE Vector Fill Color",
 7771:           ).expression =
 7772:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 7773:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7774:             "ADBE Vector Fill Opacity",
 7775:           ).expression =
 7776:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 7777:           secondary_lines = app.project.activeItem
 7778:             .layer(
 7779:               shapeLayer.name,
 7780:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 7781:             .duplicate();
 7782:           secondary_lines.name = "Big subdivisions - Secondary Color";
 7783:           secondary_lines("ADBE Vectors Group")(
 7784:             "ADBE Vector Filter - Repeater",
 7785:           )("ADBE Vector Repeater Copies").expression =
 7786:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 7787:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 7788:             1 +
 7789:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 7790:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 7791:             1 +
 7792:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 7793:             (Number(EditTextCopies.text) - 1) +
 7794:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 7795:             divideBy +
 7796:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 7797:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 7798:             1 +
 7799:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 7800:             divideBy +
 7801:             "*100/" +
 7802:             (Number(EditTextCopies.text) - 1) +
 7803:             ")) } else { 0 }              }} catch(e) { value }";
 7804:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 7805:             "ADBE Vector Fill Opacity",
 7806:           ).expression =
 7807:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 7808:           secondary_lines("ADBE Vector Transform Group")(
 7809:             "ADBE Vector Group Opacity",
 7810:           ).expression =
 7811:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 7812:           secondary_lines("ADBE Vectors Group")(
 7813:             "ADBE Vector Graphic - Fill",
 7814:           ).name = "Fill Start";
 7815:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7816:             "ADBE Vector Fill Color",
 7817:           ).expression =
 7818:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7819:           secondary_lines("ADBE Vectors Group")(
 7820:             "ADBE Vector Filter - Repeater",
 7821:           )("ADBE Vector Repeater Offset").expression =
 7822:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7823:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 7824:             1 +
 7825:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7826:             (Number(EditTextCopies.text) - 1) +
 7827:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 7828:             divideBy +
 7829:             ")} else { 0 }             }} catch(e) { value }";
 7830:           secondary_lines("ADBE Vectors Group")(
 7831:             "ADBE Vector Filter - Repeater",
 7832:           )("ADBE Vector Repeater Transform")(
 7833:             "ADBE Vector Repeater Opacity 1",
 7834:           ).expression =
 7835:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7836:           secondary_lines("ADBE Vectors Group")(
 7837:             "ADBE Vector Filter - Repeater",
 7838:           )("ADBE Vector Repeater Transform")(
 7839:             "ADBE Vector Repeater Opacity 2",
 7840:           ).expression =
 7841:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7842:           secondary_lines("ADBE Vectors Group").addProperty(
 7843:             "ADBE Vector Graphic - Fill",
 7844:           ).name = "Fill End";
 7845:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7846:             "ADBE Vector Fill Color",
 7847:           ).expression =
 7848:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 7849:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7850:             "ADBE Vector Fill Opacity",
 7851:           ).expression =
 7852:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 7853:           secondary_lines = app.project.activeItem
 7854:             .layer(
 7855:               shapeLayer.name,
 7856:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
 7857:             .duplicate();
 7858:           secondary_lines.name = "Half subdivisions - Secondary Color";
 7859:           secondary_lines("ADBE Vectors Group")(
 7860:             "ADBE Vector Filter - Repeater",
 7861:           )("ADBE Vector Repeater Copies").expression =
 7862:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 7863:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7864:             1 +
 7865:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 7866:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7867:             1 +
 7868:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 7869:             (Number(EditTextCopies.text) - 1) +
 7870:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 7871:             divideBy / 2 +
 7872:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 7873:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7874:             1 +
 7875:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 7876:             divideBy / 2 +
 7877:             "*100/" +
 7878:             (Number(EditTextCopies.text) - 1) +
 7879:             ")) } else { 0 }               }} catch(e) { value }";
 7880:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 7881:             "ADBE Vector Fill Opacity",
 7882:           ).expression =
 7883:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 7884:           secondary_lines("ADBE Vector Transform Group")(
 7885:             "ADBE Vector Group Opacity",
 7886:           ).expression =
 7887:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 7888:           secondary_lines("ADBE Vectors Group")(
 7889:             "ADBE Vector Graphic - Fill",
 7890:           ).name = "Fill Start";
 7891:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7892:             "ADBE Vector Fill Color",
 7893:           ).expression =
 7894:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7895:           secondary_lines("ADBE Vectors Group")(
 7896:             "ADBE Vector Filter - Repeater",
 7897:           )("ADBE Vector Repeater Offset").expression =
 7898:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7899:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 7900:             1 +
 7901:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7902:             (Number(EditTextCopies.text) - 1) +
 7903:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 7904:             divideBy / 2 +
 7905:             ")} else { 0 }             }} catch(e) { value }";
 7906:           secondary_lines("ADBE Vectors Group")(
 7907:             "ADBE Vector Filter - Repeater",
 7908:           )("ADBE Vector Repeater Transform")(
 7909:             "ADBE Vector Repeater Opacity 1",
 7910:           ).expression =
 7911:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7912:           secondary_lines("ADBE Vectors Group")(
 7913:             "ADBE Vector Filter - Repeater",
 7914:           )("ADBE Vector Repeater Transform")(
 7915:             "ADBE Vector Repeater Opacity 2",
 7916:           ).expression =
 7917:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7918:           secondary_lines("ADBE Vectors Group").addProperty(
 7919:             "ADBE Vector Graphic - Fill",
 7920:           ).name = "Fill End";
 7921:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7922:             "ADBE Vector Fill Color",
 7923:           ).expression =
 7924:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 7925:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7926:             "ADBE Vector Fill Opacity",
 7927:           ).expression =
 7928:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 7929:           secondary_lines = app.project.activeItem
 7930:             .layer(
 7931:               shapeLayer.name,
 7932:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
 7933:             .duplicate();
 7934:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
 7935:           secondary_lines("ADBE Vectors Group")(
 7936:             "ADBE Vector Filter - Repeater",
 7937:           )("ADBE Vector Repeater Copies").expression =
 7938:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 7939:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7940:             1 +
 7941:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 7942:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7943:             1 +
 7944:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 7945:             (Number(EditTextCopies.text) - 1) +
 7946:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 7947:             divideBy / 4 +
 7948:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 7949:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7950:             1 +
 7951:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 7952:             divideBy / 4 +
 7953:             "*100/" +
 7954:             (Number(EditTextCopies.text) - 1) +
 7955:             ")) } else { 0 }              }} catch(e) { value }";
 7956:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 7957:             "ADBE Vector Fill Opacity",
 7958:           ).expression =
 7959:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
 7960:           secondary_lines("ADBE Vector Transform Group")(
 7961:             "ADBE Vector Group Opacity",
 7962:           ).expression =
 7963:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 7964:           secondary_lines("ADBE Vectors Group")(
 7965:             "ADBE Vector Graphic - Fill",
 7966:           ).name = "Fill Start";
 7967:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 7968:             "ADBE Vector Fill Color",
 7969:           ).expression =
 7970:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 7971:           secondary_lines("ADBE Vectors Group")(
 7972:             "ADBE Vector Filter - Repeater",
 7973:           )("ADBE Vector Repeater Offset").expression =
 7974:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 7975:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
 7976:             1 +
 7977:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 7978:             (Number(EditTextCopies.text) - 1) +
 7979:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 7980:             divideBy / 4 +
 7981:             ")} else { 0 }             }} catch(e) { value }";
 7982:           secondary_lines("ADBE Vectors Group")(
 7983:             "ADBE Vector Filter - Repeater",
 7984:           )("ADBE Vector Repeater Transform")(
 7985:             "ADBE Vector Repeater Opacity 1",
 7986:           ).expression =
 7987:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7988:           secondary_lines("ADBE Vectors Group")(
 7989:             "ADBE Vector Filter - Repeater",
 7990:           )("ADBE Vector Repeater Transform")(
 7991:             "ADBE Vector Repeater Opacity 2",
 7992:           ).expression =
 7993:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 7994:           secondary_lines("ADBE Vectors Group").addProperty(
 7995:             "ADBE Vector Graphic - Fill",
 7996:           ).name = "Fill End";
 7997:           secondary_lines("ADBE Vectors Group")("Fill End")(
 7998:             "ADBE Vector Fill Color",
 7999:           ).expression =
 8000:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 8001:           secondary_lines("ADBE Vectors Group")("Fill End")(
 8002:             "ADBE Vector Fill Opacity",
 8003:           ).expression =
 8004:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
 8005:           secondary_lines = app.project.activeItem
 8006:             .layer(
 8007:               shapeLayer.name,
 8008:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions")
 8009:             .duplicate();
 8010:           secondary_lines.name = "Eighth subdivisions - Secondary Color";
 8011:           secondary_lines("ADBE Vectors Group")(
 8012:             "ADBE Vector Filter - Repeater",
 8013:           )("ADBE Vector Repeater Copies").expression =
 8014:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 8015:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
 8016:             1 +
 8017:             '-content("Ruler").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 8018:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
 8019:             1 +
 8020:             '-content("Ruler Mirror").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 8021:             (Number(EditTextCopies.text) - 1) +
 8022:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 8023:             divideBy / 8 +
 8024:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 8025:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
 8026:             1 +
 8027:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 8028:             divideBy / 8 +
 8029:             "*100/" +
 8030:             (Number(EditTextCopies.text) - 1) +
 8031:             ")) } else { 0 }              }} catch(e) { value }";
 8032:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
 8033:             "ADBE Vector Fill Opacity",
 8034:           ).expression =
 8035:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
 8036:           secondary_lines("ADBE Vector Transform Group")(
 8037:             "ADBE Vector Group Opacity",
 8038:           ).expression =
 8039:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 8040:           secondary_lines("ADBE Vectors Group")(
 8041:             "ADBE Vector Graphic - Fill",
 8042:           ).name = "Fill Start";
 8043:           secondary_lines("ADBE Vectors Group")("Fill Start")(
 8044:             "ADBE Vector Fill Color",
 8045:           ).expression =
 8046:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 8047:           secondary_lines("ADBE Vectors Group")(
 8048:             "ADBE Vector Filter - Repeater",
 8049:           )("ADBE Vector Repeater Offset").expression =
 8050:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 8051:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
 8052:             1 +
 8053:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 8054:             (Number(EditTextCopies.text) - 1) +
 8055:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 8056:             divideBy / 8 +
 8057:             ")} else { 0 }              }} catch(e) { value }";
 8058:           secondary_lines("ADBE Vectors Group")(
 8059:             "ADBE Vector Filter - Repeater",
 8060:           )("ADBE Vector Repeater Transform")(
 8061:             "ADBE Vector Repeater Opacity 1",
 8062:           ).expression =
 8063:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8064:           secondary_lines("ADBE Vectors Group")(
 8065:             "ADBE Vector Filter - Repeater",
 8066:           )("ADBE Vector Repeater Transform")(
 8067:             "ADBE Vector Repeater Opacity 2",
 8068:           ).expression =
 8069:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8070:           secondary_lines("ADBE Vectors Group").addProperty(
 8071:             "ADBE Vector Graphic - Fill",
 8072:           ).name = "Fill End";
 8073:           secondary_lines("ADBE Vectors Group")("Fill End")(
 8074:             "ADBE Vector Fill Color",
 8075:           ).expression =
 8076:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 8077:           secondary_lines("ADBE Vectors Group")("Fill End")(
 8078:             "ADBE Vector Fill Opacity",
 8079:           ).expression =
 8080:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
 8081:           app.project.activeItem
 8082:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 8083:             .duplicate().name = "Ruler Mirror";
 8084:           app.project.activeItem
 8085:             .layer(
 8086:               shapeLayer.name,
 8087:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 8088:             .setValue(60);
 8089:           app.project.activeItem
 8090:             .layer(
 8091:               shapeLayer.name,
 8092:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 8093:             .setValue(-180);
 8094:           app.project.activeItem
 8095:             .layer(
 8096:               shapeLayer.name,
 8097:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 8098:             .setValue([0, 425]);
 8099:           app.project.activeItem.layer(shapeLayer.name)(
 8100:             "ADBE Root Vectors Group",
 8101:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 8102:           if (SidesType.selection.index !== 0) {
 8103:             app.project.activeItem.layer(shapeLayer.name)(
 8104:               "ADBE Root Vectors Group",
 8105:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 8106:               "ADBE Vector Scale",
 8107:             ).expression =
 8108:               SidesType.selection.index == 2
 8109:                 ? 'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { value }'
 8110:                 : "[value[0] " + e + ", value[1] " + e + "]";
 8111:             app.project.activeItem.layer(shapeLayer.name)(
 8112:               "ADBE Root Vectors Group",
 8113:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 8114:               "ADBE Vector Transform Group",
 8115:             )("ADBE Vector Anchor").expression =
 8116:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch (e) { value }';
 8117:             app.project.activeItem.layer(shapeLayer.name)(
 8118:               "ADBE Root Vectors Group",
 8119:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 8120:               "ADBE Vectors Group",
 8121:             )("ADBE Vector Shape - Ellipse")(
 8122:               "ADBE Vector Ellipse Position",
 8123:             ).expression =
 8124:               SidesType.selection.index == 2
 8125:                 ? 'try { [value[0], value[1] - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 8126:                 : "[value[0], value[1] - (" + e + ")]";
 8127:             app.project.activeItem
 8128:               .layer(
 8129:                 shapeLayer.name,
 8130:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 8131:               .setValue([0, r]);
 8132:             app.project.activeItem.layer(shapeLayer.name)(
 8133:               "ADBE Root Vectors Group",
 8134:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 8135:               "ADBE Vectors Group",
 8136:             )("ADBE Vector Shape - Ellipse")(
 8137:               "ADBE Vector Ellipse Position",
 8138:             ).expression =
 8139:               SidesType.selection.index == 2
 8140:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*8 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 8141:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*8 - (' +
 8142:                   e +
 8143:                   ")] } catch(e) { value }";
 8144:             app.project.activeItem
 8145:               .layer(
 8146:                 shapeLayer.name,
 8147:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 8148:               .setValue([0, r]);
 8149:             app.project.activeItem.layer(shapeLayer.name)(
 8150:               "ADBE Root Vectors Group",
 8151:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
 8152:               "ADBE Vectors Group",
 8153:             )("ADBE Vector Shape - Ellipse")(
 8154:               "ADBE Vector Ellipse Position",
 8155:             ).expression =
 8156:               SidesType.selection.index == 2
 8157:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*6 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 8158:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*6 - (' +
 8159:                   e +
 8160:                   ")] } catch(e) { value }";
 8161:             app.project.activeItem
 8162:               .layer(
 8163:                 shapeLayer.name,
 8164:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 8165:               .setValue([0, r]);
 8166:             app.project.activeItem.layer(shapeLayer.name)(
 8167:               "ADBE Root Vectors Group",
 8168:             )("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")(
 8169:               "ADBE Vectors Group",
 8170:             )("ADBE Vector Shape - Ellipse")(
 8171:               "ADBE Vector Ellipse Position",
 8172:             ).expression =
 8173:               SidesType.selection.index == 2
 8174:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 8175:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*4 - (' +
 8176:                   e +
 8177:                   ")] } catch(e) { value }";
 8178:             app.project.activeItem
 8179:               .layer(
 8180:                 shapeLayer.name,
 8181:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions")("ADBE Vectors Group")("ADBE Vector Shape - Ellipse")("ADBE Vector Ellipse Position")
 8182:               .setValue([0, r]);
 8183:             app.project.activeItem.layer(shapeLayer.name)(
 8184:               "ADBE Root Vectors Group",
 8185:             )("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions")(
 8186:               "ADBE Vectors Group",
 8187:             )("ADBE Vector Shape - Ellipse")(
 8188:               "ADBE Vector Ellipse Position",
 8189:             ).expression =
 8190:               SidesType.selection.index == 2
 8191:                 ? 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }'
 8192:                 : 'try { [value[0], value[1] + effect("ADBE easyRulers")("Height")*2 - (' +
 8193:                   e +
 8194:                   ")] } catch(e) { value }";
 8195:             app.project.activeItem.layer(shapeLayer.name)(
 8196:               "ADBE Root Vectors Group",
 8197:             )("Ruler Mirror")("ADBE Vectors Group")("Base line")(
 8198:               "ADBE Vectors Group",
 8199:             )("ADBE Vector Filter - Offset")(
 8200:               "ADBE Vector Offset Amount",
 8201:             ).expression =
 8202:               SidesType.selection.index == 2
 8203:                 ? 'try { effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 8204:                 : "" + e + "*1.111";
 8205:             app.project.activeItem.layer(shapeLayer.name)(
 8206:               "ADBE Root Vectors Group",
 8207:             )("Ruler Mirror")("ADBE Vectors Group")(
 8208:               "Eighth subdivisions Base Line",
 8209:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 8210:               "ADBE Vector Offset Amount",
 8211:             ).expression =
 8212:               SidesType.selection.index == 2
 8213:                 ? 'try { -effect("ADBE easyRulers")("Height")*2.222 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 8214:                 : ' try { -effect("ADBE easyRulers")("Height")*2.222 + (' +
 8215:                   e +
 8216:                   ")*1.111 } catch(e) { value }";
 8217:             app.project.activeItem.layer(shapeLayer.name)(
 8218:               "ADBE Root Vectors Group",
 8219:             )("Ruler Mirror")("ADBE Vectors Group")(
 8220:               "Quarter subdivisions Base Line",
 8221:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 8222:               "ADBE Vector Offset Amount",
 8223:             ).expression =
 8224:               SidesType.selection.index == 2
 8225:                 ? 'try { -effect("ADBE easyRulers")("Height")*4.444 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 8226:                 : 'try { -effect("ADBE easyRulers")("Height")*4.444 + (' +
 8227:                   e +
 8228:                   ")*1.111 } catch(e) { value }";
 8229:             app.project.activeItem.layer(shapeLayer.name)(
 8230:               "ADBE Root Vectors Group",
 8231:             )("Ruler Mirror")("ADBE Vectors Group")(
 8232:               "Half subdivisions Base Line",
 8233:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 8234:               "ADBE Vector Offset Amount",
 8235:             ).expression =
 8236:               SidesType.selection.index == 2
 8237:                 ? 'try { -effect("ADBE easyRulers")("Height")*6.67 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 8238:                 : 'try { -effect("ADBE easyRulers")("Height")*6.67 + (' +
 8239:                   e +
 8240:                   ")*1.111 } catch(e) { value }";
 8241:             app.project.activeItem.layer(shapeLayer.name)(
 8242:               "ADBE Root Vectors Group",
 8243:             )("Ruler Mirror")("ADBE Vectors Group")(
 8244:               "Big subdivisions Base Line",
 8245:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 8246:               "ADBE Vector Offset Amount",
 8247:             ).expression =
 8248:               SidesType.selection.index == 2
 8249:                 ? 'try { -effect("ADBE easyRulers")("Height")*8.888 + effect("ADBE easyRulers")("Sides Distance")*1.111 } catch(e) { value }'
 8250:                 : 'try { -effect("ADBE easyRulers")("Height")*8.888 + (' +
 8251:                   e +
 8252:                   ")*1.111 } catch(e) { value }";
 8253:           }
 8254:           switch (BaseLineDropdown.selection.index) {
 8255:             case 0:
 8256:               app.project.activeItem
 8257:                 .layer(
 8258:                   shapeLayer.name,
 8259:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 8260:                 .remove();
 8261:               app.project.activeItem
 8262:                 .layer(
 8263:                   shapeLayer.name,
 8264:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 8265:                 .remove();
 8266:               app.project.activeItem
 8267:                 .layer(
 8268:                   shapeLayer.name,
 8269:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 8270:                 .remove();
 8271:               app.project.activeItem
 8272:                 .layer(
 8273:                   shapeLayer.name,
 8274:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 8275:                 .remove();
 8276:               app.project.activeItem
 8277:                 .layer(
 8278:                   shapeLayer.name,
 8279:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 8280:                 .remove();
 8281:               app.project.activeItem
 8282:                 .layer(
 8283:                   shapeLayer.name,
 8284:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 8285:                 .remove();
 8286:               app.project.activeItem
 8287:                 .layer(
 8288:                   shapeLayer.name,
 8289:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 8290:                 .remove();
 8291:               app.project.activeItem
 8292:                 .layer(
 8293:                   shapeLayer.name,
 8294:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 8295:                 .remove();
 8296:               app.project.activeItem
 8297:                 .layer(
 8298:                   shapeLayer.name,
 8299:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
 8300:                 .remove();
 8301:               app.project.activeItem
 8302:                 .layer(
 8303:                   shapeLayer.name,
 8304:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
 8305:                 .remove();
 8306:               break;
 8307:             case 1:
 8308:               app.project.activeItem
 8309:                 .layer(
 8310:                   shapeLayer.name,
 8311:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 8312:                 .remove();
 8313:               app.project.activeItem
 8314:                 .layer(
 8315:                   shapeLayer.name,
 8316:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 8317:                 .remove();
 8318:               app.project.activeItem
 8319:                 .layer(
 8320:                   shapeLayer.name,
 8321:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 8322:                 .remove();
 8323:               app.project.activeItem
 8324:                 .layer(
 8325:                   shapeLayer.name,
 8326:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 8327:                 .remove();
 8328:               app.project.activeItem
 8329:                 .layer(
 8330:                   shapeLayer.name,
 8331:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 8332:                 .remove();
 8333:               app.project.activeItem
 8334:                 .layer(
 8335:                   shapeLayer.name,
 8336:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
 8337:                 .remove();
 8338:               app.project.activeItem
 8339:                 .layer(
 8340:                   shapeLayer.name,
 8341:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
 8342:                 .remove();
 8343:               app.project.activeItem
 8344:                 .layer(
 8345:                   shapeLayer.name,
 8346:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
 8347:                 .remove();
 8348:           }
 8349:         };
 8350:         createBasicNoDivs_circle = function () {
 8351:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 8352:           shorten("Base line")("ADBE Vectors Group")
 8353:             .addProperty("ADBE Vector Shape - Group")
 8354:             .path.setValue(shape);
 8355:           shorten("Base line")("ADBE Vector Transform Group")(
 8356:             "ADBE Vector Scale",
 8357:           ).setValue([-90, -90]);
 8358:           shorten("Base line")("ADBE Vectors Group").addProperty(
 8359:             "ADBE Vector Graphic - Stroke",
 8360:           )("ADBE Vector Stroke Color").expression =
 8361:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 8362:           shorten("Base line")("ADBE Vectors Group")(
 8363:             "ADBE Vector Graphic - Stroke",
 8364:           )("ADBE Vector Stroke Width").expression =
 8365:             'try { effect("ADBE easyRulers")("Width") } catch(e) { value }';
 8366:           shorten("Base line")("ADBE Vectors Group").addProperty(
 8367:             "ADBE Vector Filter - Trim",
 8368:           )("ADBE Vector Trim End").expression =
 8369:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 8370:             (EditTextCopies.text - 1) +
 8371:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 8372:             (EditTextCopies.text - 1) +
 8373:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 8374:           shorten("Base line")("ADBE Vectors Group")(
 8375:             "ADBE Vector Filter - Trim",
 8376:           )("ADBE Vector Trim Offset").expression =
 8377:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 8378:             (EditTextCopies.text - 1) +
 8379:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 8380:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 8381:           shorten("Main lines")("ADBE Vectors Group")
 8382:             .addProperty("ADBE Vector Shape - Group")
 8383:             .path.setValue(shape);
 8384:           shorten("Main lines")("ADBE Vector Transform Group")(
 8385:             "ADBE Vector Scale",
 8386:           ).setValue([-90, -90]);
 8387:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8388:             "ADBE Vector Graphic - Stroke",
 8389:           )("ADBE Vector Stroke Color").expression =
 8390:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 8391:           shorten("Main lines")("ADBE Vectors Group")(
 8392:             "ADBE Vector Graphic - Stroke",
 8393:           )("ADBE Vector Stroke Width").expression =
 8394:             'try { effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8395:           shorten("Main lines")("ADBE Vectors Group")
 8396:             .addProperty(
 8397:               "ADBE Vector Filter - Repeater",
 8398:             )("ADBE Vector Repeater Copies")
 8399:             .setValue(EditTextCopies.text);
 8400:           shorten("Main lines")("ADBE Vectors Group")(
 8401:             "ADBE Vector Filter - Repeater",
 8402:           )("ADBE Vector Repeater Transform")(
 8403:             "ADBE Vector Repeater Rotation",
 8404:           ).expression =
 8405:             'try { [effect("ADBE easyRulers")("Gap")/10] } catch(e) { value }';
 8406:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8407:             "ADBE Vector Filter - Offset",
 8408:           )("ADBE Vector Offset Amount").expression =
 8409:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 8410:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8411:             "ADBE Vector Filter - Trim",
 8412:           )("ADBE Vector Trim End").expression =
 8413:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 8414:           shorten("Main lines")("ADBE Vectors Group")(
 8415:             "ADBE Vector Filter - Trim",
 8416:           )("ADBE Vector Trim Offset").expression =
 8417:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 8418:           t("ADBE easyRulers")("Width").setValue(2);
 8419:           t("ADBE easyRulers")("default Width").setValue(2);
 8420:           t("ADBE easyRulers")("Height").setValue(10);
 8421:           t("ADBE easyRulers")("default Height").setValue(10);
 8422:           if (SidesType.selection.index == 2) {
 8423:             t("ADBE easyRulers")("Sides Distance").setValue(-10);
 8424:             t("ADBE easyRulers")("default Sides Distance").setValue(-10);
 8425:           }
 8426:           app.project.activeItem.layer(shapeLayer.name)(
 8427:             "ADBE Root Vectors Group",
 8428:           )("Ruler")("ADBE Vector Transform Group")(
 8429:             "ADBE Vector Rotation",
 8430:           ).expression =
 8431:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
 8432:           createPointerCircular();
 8433:           secondary_lines = app.project.activeItem
 8434:             .layer(
 8435:               shapeLayer.name,
 8436:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
 8437:             .duplicate();
 8438:           secondary_lines.name = "Main lines - Secondary Color";
 8439:           secondary_lines("ADBE Vectors Group")(
 8440:             "ADBE Vector Filter - Repeater",
 8441:           )("ADBE Vector Repeater Copies").expression =
 8442:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 8443:             EditTextCopies.text +
 8444:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 8445:             (Number(EditTextCopies.text) - 1) +
 8446:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 8447:             (Number(EditTextCopies.text) - 1) +
 8448:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 8449:             EditTextCopies.text +
 8450:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 8451:             (Number(EditTextCopies.text) - 1) +
 8452:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }               }} catch(e) { value }';
 8453:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
 8454:             "ADBE Vector Stroke Opacity",
 8455:           ).expression =
 8456:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 8457:           secondary_lines("ADBE Vector Transform Group")(
 8458:             "ADBE Vector Group Opacity",
 8459:           ).expression =
 8460:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 8461:           secondary_lines("ADBE Vectors Group")(
 8462:             "ADBE Vector Graphic - Stroke",
 8463:           ).name = "Stroke Start";
 8464:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
 8465:             "ADBE Vector Stroke Color",
 8466:           ).expression =
 8467:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 8468:           secondary_lines("ADBE Vectors Group")(
 8469:             "ADBE Vector Filter - Repeater",
 8470:           )("ADBE Vector Repeater Offset").expression =
 8471:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 8472:             (Number(EditTextCopies.text) - 1) +
 8473:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 8474:             (Number(EditTextCopies.text) - 1) +
 8475:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
 8476:           secondary_lines("ADBE Vectors Group")(
 8477:             "ADBE Vector Filter - Repeater",
 8478:           )("ADBE Vector Repeater Transform")(
 8479:             "ADBE Vector Repeater Opacity 1",
 8480:           ).expression =
 8481:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8482:           secondary_lines("ADBE Vectors Group")(
 8483:             "ADBE Vector Filter - Repeater",
 8484:           )("ADBE Vector Repeater Transform")(
 8485:             "ADBE Vector Repeater Opacity 2",
 8486:           ).expression =
 8487:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8488:           secondary_lines("ADBE Vectors Group").addProperty(
 8489:             "ADBE Vector Graphic - Stroke",
 8490:           ).name = "Stroke End";
 8491:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8492:             "ADBE Vector Stroke Width",
 8493:           ).expression =
 8494:             'try { effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8495:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8496:             "ADBE Vector Stroke Color",
 8497:           ).expression =
 8498:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 8499:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8500:             "ADBE Vector Stroke Opacity",
 8501:           ).expression =
 8502:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 8503:           app.project.activeItem
 8504:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 8505:             .duplicate().name = "Ruler Mirror";
 8506:           app.project.activeItem
 8507:             .layer(
 8508:               shapeLayer.name,
 8509:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 8510:             .setValue(60);
 8511:           app.project.activeItem
 8512:             .layer(
 8513:               shapeLayer.name,
 8514:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 8515:             .setValue(-180);
 8516:           app.project.activeItem
 8517:             .layer(
 8518:               shapeLayer.name,
 8519:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 8520:             .setValue([0, 425]);
 8521:           app.project.activeItem.layer(shapeLayer.name)(
 8522:             "ADBE Root Vectors Group",
 8523:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 8524:           if (SidesType.selection.index !== 0) {
 8525:             app.project.activeItem.layer(shapeLayer.name)(
 8526:               "ADBE Root Vectors Group",
 8527:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 8528:               "ADBE Vector Scale",
 8529:             ).expression =
 8530:               'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] }';
 8531:             app.project.activeItem.layer(shapeLayer.name)(
 8532:               "ADBE Root Vectors Group",
 8533:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 8534:               "ADBE Vectors Group",
 8535:             )("ADBE Vector Filter - Offset")(
 8536:               "ADBE Vector Offset Amount",
 8537:             ).expression =
 8538:               'try { -effect("ADBE easyRulers")("Height") } catch(e) { value }';
 8539:             app.project.activeItem.layer(shapeLayer.name)(
 8540:               "ADBE Root Vectors Group",
 8541:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 8542:               "ADBE Vector Transform Group",
 8543:             )("ADBE Vector Anchor").expression =
 8544:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 8545:           }
 8546:           if (BaseLineDropdown.selection.index == 0) {
 8547:             app.project.activeItem
 8548:               .layer(
 8549:                 shapeLayer.name,
 8550:               )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 8551:               .remove();
 8552:             app.project.activeItem
 8553:               .layer(
 8554:                 shapeLayer.name,
 8555:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 8556:               .remove();
 8557:           }
 8558:           switch (SidesType.selection.index) {
 8559:             case 0:
 8560:               app.project.activeItem
 8561:                 .layer(
 8562:                   shapeLayer.name,
 8563:                 )("ADBE Root Vectors Group")("Ruler Mirror")
 8564:                 .remove();
 8565:               break;
 8566:             case 1:
 8567:               app.project.activeItem
 8568:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 8569:                 .remove();
 8570:               app.project.activeItem.layer(shapeLayer.name)(
 8571:                 "ADBE Root Vectors Group",
 8572:               )("Ruler Mirror")("ADBE Vector Transform Group")(
 8573:                 "ADBE Vector Scale",
 8574:               ).expression = "";
 8575:               app.project.activeItem
 8576:                 .layer(
 8577:                   shapeLayer.name,
 8578:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
 8579:                 .setValue([90, 90]);
 8580:               app.project.activeItem.layer(shapeLayer.name)(
 8581:                 "ADBE Root Vectors Group",
 8582:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
 8583:           }
 8584:         };
 8585:         createBasic_circle = function () {
 8586:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 8587:           shorten("Base line")("ADBE Vectors Group")
 8588:             .addProperty("ADBE Vector Shape - Group")
 8589:             .path.setValue(shape);
 8590:           shorten("Base line")("ADBE Vector Transform Group")(
 8591:             "ADBE Vector Scale",
 8592:           ).setValue([-90, -90]);
 8593:           shorten("Base line")("ADBE Vectors Group").addProperty(
 8594:             "ADBE Vector Graphic - Stroke",
 8595:           )("ADBE Vector Stroke Color").expression =
 8596:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 8597:           shorten("Base line")("ADBE Vectors Group")(
 8598:             "ADBE Vector Graphic - Stroke",
 8599:           )("ADBE Vector Stroke Width").expression =
 8600:             'try { value - 2 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
 8601:           shorten("Base line")("ADBE Vectors Group").addProperty(
 8602:             "ADBE Vector Filter - Trim",
 8603:           )("ADBE Vector Trim End").expression =
 8604:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 8605:             (EditTextCopies.text - 1) +
 8606:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 8607:             (EditTextCopies.text - 1) +
 8608:             '*effect("ADBE easyRulers")("Gap")/36 + effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 8609:           shorten("Base line")("ADBE Vectors Group")(
 8610:             "ADBE Vector Filter - Trim",
 8611:           )("ADBE Vector Trim Offset").expression =
 8612:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 8613:             (EditTextCopies.text - 1) +
 8614:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 8615:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 8616:           shorten("Big subdivisions")("ADBE Vectors Group")
 8617:             .addProperty("ADBE Vector Shape - Group")
 8618:             .path.setValue(shape);
 8619:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
 8620:             "ADBE Vector Scale",
 8621:           ).setValue([-90, -90]);
 8622:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 8623:             "ADBE Vector Graphic - Stroke",
 8624:           )("ADBE Vector Stroke Color").expression =
 8625:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 8626:           shorten("Big subdivisions")("ADBE Vectors Group")
 8627:             .addProperty("ADBE Vector Filter - Repeater")(
 8628:               "ADBE Vector Repeater Copies",
 8629:             )
 8630:             .setValue(
 8631:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 8632:             );
 8633:           shorten("Big subdivisions")("ADBE Vectors Group")(
 8634:             "ADBE Vector Filter - Repeater",
 8635:           )("ADBE Vector Repeater Transform")(
 8636:             "ADBE Vector Repeater Rotation",
 8637:           ).expression =
 8638:             'try { effect("ADBE easyRulers")("Gap")/10*' +
 8639:             divideBy +
 8640:             " } catch(e) { value }";
 8641:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 8642:             "ADBE Vector Filter - Offset",
 8643:           )("ADBE Vector Offset Amount").expression =
 8644:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2 - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 8645:           shorten("Big subdivisions")("ADBE Vectors Group")(
 8646:             "ADBE Vector Graphic - Stroke",
 8647:           )("ADBE Vector Stroke Width").expression =
 8648:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8649:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 8650:             "ADBE Vector Filter - Trim",
 8651:           )("ADBE Vector Trim End").expression =
 8652:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 8653:           shorten("Big subdivisions")("ADBE Vectors Group")(
 8654:             "ADBE Vector Filter - Trim",
 8655:           )("ADBE Vector Trim Offset").expression =
 8656:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 8657:           shorten.addProperty("ADBE Vector Group").name =
 8658:             "Big subdivisions Base Line";
 8659:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 8660:             .addProperty("ADBE Vector Shape - Group")
 8661:             .path.setValue(shape);
 8662:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 8663:             "ADBE Vector Scale",
 8664:           ).setValue([-90, -90]);
 8665:           shorten("Big subdivisions Base Line")(
 8666:             "ADBE Vectors Group",
 8667:           ).addProperty("ADBE Vector Graphic - Stroke")(
 8668:             "ADBE Vector Stroke Color",
 8669:           ).expression =
 8670:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 8671:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 8672:             "ADBE Vector Graphic - Stroke",
 8673:           )("ADBE Vector Stroke Width").expression =
 8674:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
 8675:           shorten("Big subdivisions Base Line")(
 8676:             "ADBE Vectors Group",
 8677:           ).addProperty("ADBE Vector Filter - Offset")(
 8678:             "ADBE Vector Offset Amount",
 8679:           ).expression =
 8680:             'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2; } else { 0 } } catch(e) { value }';
 8681:           shorten("Big subdivisions Base Line")(
 8682:             "ADBE Vectors Group",
 8683:           ).addProperty("ADBE Vector Filter - Trim")(
 8684:             "ADBE Vector Trim End",
 8685:           ).expression =
 8686:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 8687:             (EditTextCopies.text - 1) +
 8688:             '*effect("ADBE easyRulers")("Gap")/36 - effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 8689:             (EditTextCopies.text - 1) +
 8690:             '*effect("ADBE easyRulers")("Gap")/36 + effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 8691:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 8692:             "ADBE Vector Filter - Trim",
 8693:           )("ADBE Vector Trim Offset").expression =
 8694:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 8695:             (EditTextCopies.text - 1) +
 8696:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 8697:           shorten.addProperty("ADBE Vector Group").name =
 8698:             "Main lines - Secondary Color";
 8699:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 8700:           shorten("Main lines")("ADBE Vectors Group")
 8701:             .addProperty("ADBE Vector Shape - Group")
 8702:             .path.setValue(shape);
 8703:           shorten("Main lines")("ADBE Vector Transform Group")(
 8704:             "ADBE Vector Scale",
 8705:           ).setValue([-90, -90]);
 8706:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8707:             "ADBE Vector Filter - Offset",
 8708:           )("ADBE Vector Offset Amount").expression =
 8709:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 8710:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8711:             "ADBE Vector Filter - Trim",
 8712:           )("ADBE Vector Trim End").expression =
 8713:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 8714:           shorten("Main lines")("ADBE Vectors Group")(
 8715:             "ADBE Vector Filter - Trim",
 8716:           )("ADBE Vector Trim Offset").expression =
 8717:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 8718:           shorten("Main lines")("ADBE Vectors Group")
 8719:             .addProperty("ADBE Vector Filter - Repeater")(
 8720:               "ADBE Vector Repeater Copies",
 8721:             )
 8722:             .setValue(divideBy - 1);
 8723:           shorten("Main lines")("ADBE Vectors Group")(
 8724:             "ADBE Vector Filter - Repeater",
 8725:           )("ADBE Vector Repeater Transform")(
 8726:             "ADBE Vector Repeater Rotation",
 8727:           ).expression =
 8728:             'try { effect("ADBE easyRulers")("Gap")/10 } catch(e) { value }';
 8729:           shorten("Main lines")("ADBE Vectors Group")(
 8730:             "ADBE Vector Filter - Repeater",
 8731:           )("ADBE Vector Repeater Offset").setValue(1);
 8732:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8733:             "ADBE Vector Filter - Repeater",
 8734:           ).name = "Repeater Group";
 8735:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
 8736:             "ADBE Vector Repeater Copies",
 8737:           ).setValue(Math.ceil((EditTextCopies.text - 1) / divideBy));
 8738:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
 8739:             "ADBE Vector Repeater Transform",
 8740:           )("ADBE Vector Repeater Rotation").expression =
 8741:             'try { effect("ADBE easyRulers")("Gap")/10*' +
 8742:             divideBy +
 8743:             " } catch(e) { value }";
 8744:           if (
 8745:             (EditTextCopies.text - 1) % divideBy > 0 &&
 8746:             (EditTextCopies.text - 1) % divideBy < divideBy - 1
 8747:           ) {
 8748:             shorten("Main lines")("ADBE Vectors Group").addProperty(
 8749:               "ADBE Vector Filter - Trim",
 8750:             ).name = "Trim Last";
 8751:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
 8752:               "ADBE Vector Trim End",
 8753:             ).expression =
 8754:               "try { " +
 8755:               (100 -
 8756:                 (divideBy - 1 - ((EditTextCopies.text - 1) % divideBy)) *
 8757:                   (100 /
 8758:                     ((divideBy - 1) *
 8759:                       Math.ceil((EditTextCopies.text - 1) / divideBy)))) +
 8760:               " } catch(e) { value }";
 8761:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
 8762:               "ADBE Vector Trim Type",
 8763:             ).setValue(2);
 8764:           }
 8765:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 8766:             "ADBE Vector Graphic - Stroke",
 8767:           )("ADBE Vector Stroke Color").expression =
 8768:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 8769:           shorten("Main lines")("ADBE Vectors Group")(
 8770:             "ADBE Vector Graphic - Stroke",
 8771:           )("ADBE Vector Stroke Width").expression =
 8772:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8773:           t("ADBE easyRulers")("Width").setValue(2);
 8774:           t("ADBE easyRulers")("default Width").setValue(2);
 8775:           t("ADBE easyRulers")("Height").setValue(2);
 8776:           t("ADBE easyRulers")("default Height").setValue(2);
 8777:           t("ADBE easyRulers")("Height Bias").setValue(5);
 8778:           t("ADBE easyRulers")("default Height Bias").setValue(5);
 8779:           if (SidesType.selection.index == 2) {
 8780:             t("ADBE easyRulers")("Sides Distance").setValue(-10);
 8781:             t("ADBE easyRulers")("default Sides Distance").setValue(-10);
 8782:           }
 8783:           if (NumbersCheckBox.value) {
 8784:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 8785:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 8786:           }
 8787:           app.project.activeItem.layer(shapeLayer.name)(
 8788:             "ADBE Root Vectors Group",
 8789:           )("Ruler")("ADBE Vector Transform Group")(
 8790:             "ADBE Vector Rotation",
 8791:           ).expression =
 8792:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
 8793:           createPointerCircular();
 8794:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
 8795:             .addProperty("ADBE Vector Shape - Group")
 8796:             .path.setValue(shape);
 8797:           shorten("Main lines - Secondary Color")(
 8798:             "ADBE Vector Transform Group",
 8799:           )("ADBE Vector Scale").setValue([-90, -90]);
 8800:           shorten("Main lines - Secondary Color")(
 8801:             "ADBE Vectors Group",
 8802:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
 8803:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8804:             "Stroke Start",
 8805:           )("ADBE Vector Stroke Color").expression =
 8806:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 8807:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8808:             "Stroke Start",
 8809:           )("ADBE Vector Stroke Width").expression =
 8810:             'try { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2+1 } catch(e) { value }';
 8811:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8812:             "Stroke Start",
 8813:           )("ADBE Vector Stroke Opacity").expression =
 8814:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 8815:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
 8816:             .addProperty(
 8817:               "ADBE Vector Filter - Repeater",
 8818:             )("ADBE Vector Repeater Copies")
 8819:             .setValue(EditTextCopies.text);
 8820:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8821:             "ADBE Vector Filter - Repeater",
 8822:           )("ADBE Vector Repeater Transform")(
 8823:             "ADBE Vector Repeater Rotation",
 8824:           ).expression =
 8825:             'try { effect("ADBE easyRulers")("Gap")/10 } catch (err) { value }';
 8826:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8827:             "ADBE Vector Filter - Repeater",
 8828:           )("ADBE Vector Repeater Copies").expression =
 8829:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 8830:             EditTextCopies.text +
 8831:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 8832:             (Number(EditTextCopies.text) - 1) +
 8833:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 8834:             (Number(EditTextCopies.text) - 1) +
 8835:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 8836:             EditTextCopies.text +
 8837:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 8838:             (Number(EditTextCopies.text) - 1) +
 8839:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 8840:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8841:             "ADBE Vector Filter - Repeater",
 8842:           )("ADBE Vector Repeater Transform")(
 8843:             "ADBE Vector Repeater Opacity 1",
 8844:           ).expression =
 8845:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8846:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8847:             "ADBE Vector Filter - Repeater",
 8848:           )("ADBE Vector Repeater Transform")(
 8849:             "ADBE Vector Repeater Opacity 2",
 8850:           ).expression =
 8851:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8852:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8853:             "ADBE Vector Filter - Repeater",
 8854:           )("ADBE Vector Repeater Offset").expression =
 8855:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 8856:             (Number(EditTextCopies.text) - 1) +
 8857:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 8858:             (Number(EditTextCopies.text) - 1) +
 8859:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
 8860:           shorten("Main lines - Secondary Color")(
 8861:             "ADBE Vectors Group",
 8862:           ).addProperty("ADBE Vector Filter - Offset")(
 8863:             "ADBE Vector Offset Amount",
 8864:           ).expression =
 8865:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch (err) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch (err) { value }';
 8866:           shorten("Main lines - Secondary Color")(
 8867:             "ADBE Vectors Group",
 8868:           ).addProperty("ADBE Vector Filter - Trim")(
 8869:             "ADBE Vector Trim End",
 8870:           ).expression =
 8871:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
 8872:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8873:             "ADBE Vector Filter - Trim",
 8874:           )("ADBE Vector Trim Offset").expression =
 8875:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
 8876:           shorten("Main lines - Secondary Color")(
 8877:             "ADBE Vectors Group",
 8878:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
 8879:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8880:             "Stroke End",
 8881:           )("ADBE Vector Stroke Width").expression =
 8882:             'try { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8883:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8884:             "Stroke End",
 8885:           )("ADBE Vector Stroke Color").expression =
 8886:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 8887:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 8888:             "Stroke End",
 8889:           )("ADBE Vector Stroke Opacity").expression =
 8890:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 8891:           shorten("Main lines - Secondary Color")(
 8892:             "ADBE Vector Transform Group",
 8893:           )("ADBE Vector Group Opacity").expression =
 8894:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 8895:           secondary_lines = app.project.activeItem
 8896:             .layer(
 8897:               shapeLayer.name,
 8898:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 8899:             .duplicate();
 8900:           secondary_lines.name = "Big subdivisions - Secondary Color";
 8901:           secondary_lines("ADBE Vectors Group")(
 8902:             "ADBE Vector Filter - Repeater",
 8903:           )("ADBE Vector Repeater Copies").expression =
 8904:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                 if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 8905:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 8906:             1 +
 8907:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 8908:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 8909:             1 +
 8910:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                 } else { Math.ceil(' +
 8911:             (Number(EditTextCopies.text) - 1) +
 8912:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 8913:             divideBy +
 8914:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 8915:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 8916:             1 +
 8917:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 8918:             divideBy +
 8919:             "*100/" +
 8920:             (Number(EditTextCopies.text) - 1) +
 8921:             ")) } else { 0 }             }} catch(e) { value }";
 8922:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
 8923:             "ADBE Vector Stroke Opacity",
 8924:           ).expression =
 8925:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 8926:           secondary_lines("ADBE Vector Transform Group")(
 8927:             "ADBE Vector Group Opacity",
 8928:           ).expression =
 8929:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 8930:           secondary_lines("ADBE Vectors Group")(
 8931:             "ADBE Vector Graphic - Stroke",
 8932:           ).name = "Stroke Start";
 8933:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
 8934:             "ADBE Vector Stroke Color",
 8935:           ).expression =
 8936:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 8937:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
 8938:             "ADBE Vector Stroke Width",
 8939:           ).expression =
 8940:             'try { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2+1 } catch(e) { value }';
 8941:           secondary_lines("ADBE Vectors Group")(
 8942:             "ADBE Vector Filter - Repeater",
 8943:           )("ADBE Vector Repeater Offset").expression =
 8944:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 8945:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 8946:             1 +
 8947:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 8948:             (Number(EditTextCopies.text) - 1) +
 8949:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 8950:             divideBy +
 8951:             ")} else { 0 }             }} catch(e) { value }";
 8952:           secondary_lines("ADBE Vectors Group")(
 8953:             "ADBE Vector Filter - Repeater",
 8954:           )("ADBE Vector Repeater Transform")(
 8955:             "ADBE Vector Repeater Opacity 1",
 8956:           ).expression =
 8957:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8958:           secondary_lines("ADBE Vectors Group")(
 8959:             "ADBE Vector Filter - Repeater",
 8960:           )("ADBE Vector Repeater Transform")(
 8961:             "ADBE Vector Repeater Opacity 2",
 8962:           ).expression =
 8963:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 8964:           secondary_lines("ADBE Vectors Group").addProperty(
 8965:             "ADBE Vector Graphic - Stroke",
 8966:           ).name = "Stroke End";
 8967:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8968:             "ADBE Vector Stroke Width",
 8969:           ).expression =
 8970:             'try { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 8971:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8972:             "ADBE Vector Stroke Color",
 8973:           ).expression =
 8974:             'try {effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 8975:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 8976:             "ADBE Vector Stroke Opacity",
 8977:           ).expression =
 8978:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 8979:           app.project.activeItem
 8980:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 8981:             .duplicate().name = "Ruler Mirror";
 8982:           app.project.activeItem
 8983:             .layer(
 8984:               shapeLayer.name,
 8985:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 8986:             .setValue(60);
 8987:           app.project.activeItem
 8988:             .layer(
 8989:               shapeLayer.name,
 8990:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 8991:             .setValue(-180);
 8992:           app.project.activeItem
 8993:             .layer(
 8994:               shapeLayer.name,
 8995:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 8996:             .setValue([0, 425]);
 8997:           app.project.activeItem.layer(shapeLayer.name)(
 8998:             "ADBE Root Vectors Group",
 8999:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 9000:           if (SidesType.selection.index !== 0) {
 9001:             app.project.activeItem.layer(shapeLayer.name)(
 9002:               "ADBE Root Vectors Group",
 9003:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 9004:               "ADBE Vector Scale",
 9005:             ).expression =
 9006:               'try { try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] } } catch(e) { value }';
 9007:             app.project.activeItem.layer(shapeLayer.name)(
 9008:               "ADBE Root Vectors Group",
 9009:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 9010:               "ADBE Vector Rotation",
 9011:             ).expression =
 9012:               'try { -effect("ADBE easyRulers")("Width")/5.75 } catch(e) { value }';
 9013:             app.project.activeItem.layer(shapeLayer.name)(
 9014:               "ADBE Root Vectors Group",
 9015:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 9016:               "ADBE Vector Transform Group",
 9017:             )("ADBE Vector Anchor").expression =
 9018:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 9019:             app.project.activeItem.layer(shapeLayer.name)(
 9020:               "ADBE Root Vectors Group",
 9021:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 9022:               "ADBE Vectors Group",
 9023:             )("ADBE Vector Filter - Offset")(
 9024:               "ADBE Vector Offset Amount",
 9025:             ).expression =
 9026:               'try { -effect("ADBE easyRulers")("Height Bias")-effect("ADBE easyRulers")("Height") } catch(e) { value }';
 9027:             app.project.activeItem.layer(shapeLayer.name)(
 9028:               "ADBE Root Vectors Group",
 9029:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 9030:               "ADBE Vectors Group",
 9031:             )("ADBE Vector Filter - Offset")(
 9032:               "ADBE Vector Offset Amount",
 9033:             ).expression =
 9034:               'try { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height") } catch(e) { value }';
 9035:             app.project.activeItem.layer(shapeLayer.name)(
 9036:               "ADBE Root Vectors Group",
 9037:             )("Ruler Mirror")("ADBE Vectors Group")(
 9038:               "Big subdivisions Base Line",
 9039:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 9040:               "ADBE Vector Offset Amount",
 9041:             ).expression =
 9042:               'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")*2; } else { 0 } } catch(e) { value }';
 9043:           }
 9044:           switch (BaseLineDropdown.selection.index) {
 9045:             case 0:
 9046:               app.project.activeItem
 9047:                 .layer(
 9048:                   shapeLayer.name,
 9049:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 9050:                 .remove();
 9051:               app.project.activeItem
 9052:                 .layer(
 9053:                   shapeLayer.name,
 9054:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 9055:                 .remove();
 9056:               app.project.activeItem
 9057:                 .layer(
 9058:                   shapeLayer.name,
 9059:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 9060:                 .remove();
 9061:               app.project.activeItem
 9062:                 .layer(
 9063:                   shapeLayer.name,
 9064:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 9065:                 .remove();
 9066:               break;
 9067:             case 1:
 9068:               app.project.activeItem
 9069:                 .layer(
 9070:                   shapeLayer.name,
 9071:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 9072:                 .remove();
 9073:               app.project.activeItem
 9074:                 .layer(
 9075:                   shapeLayer.name,
 9076:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 9077:                 .remove();
 9078:           }
 9079:           switch (SidesType.selection.index) {
 9080:             case 0:
 9081:               app.project.activeItem
 9082:                 .layer(
 9083:                   shapeLayer.name,
 9084:                 )("ADBE Root Vectors Group")("Ruler Mirror")
 9085:                 .remove();
 9086:               break;
 9087:             case 1:
 9088:               app.project.activeItem
 9089:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 9090:                 .remove();
 9091:               app.project.activeItem.layer(shapeLayer.name)(
 9092:                 "ADBE Root Vectors Group",
 9093:               )("Ruler Mirror")("ADBE Vector Transform Group")(
 9094:                 "ADBE Vector Scale",
 9095:               ).expression = "";
 9096:               app.project.activeItem
 9097:                 .layer(
 9098:                   shapeLayer.name,
 9099:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
 9100:                 .setValue([95, 95]);
 9101:               app.project.activeItem.layer(shapeLayer.name)(
 9102:                 "ADBE Root Vectors Group",
 9103:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
 9104:           }
 9105:         };
 9106:         createBasic10_circle = function () {
 9107:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 9108:           shorten("Base line")("ADBE Vectors Group")
 9109:             .addProperty("ADBE Vector Shape - Group")
 9110:             .path.setValue(shape);
 9111:           shorten("Base line")("ADBE Vector Transform Group")(
 9112:             "ADBE Vector Scale",
 9113:           ).setValue([-85, -85]);
 9114:           shorten("Base line")("ADBE Vectors Group").addProperty(
 9115:             "ADBE Vector Graphic - Stroke",
 9116:           )("ADBE Vector Stroke Color").expression =
 9117:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 9118:           shorten("Base line")("ADBE Vectors Group")(
 9119:             "ADBE Vector Graphic - Stroke",
 9120:           )("ADBE Vector Stroke Width").expression =
 9121:             'try { effect("ADBE easyRulers")("Width") } catch(e) { value }';
 9122:           shorten("Base line")("ADBE Vectors Group").addProperty(
 9123:             "ADBE Vector Filter - Trim",
 9124:           )("ADBE Vector Trim End").expression =
 9125:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 9126:             (EditTextCopies.text - 1) +
 9127:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 9128:             (EditTextCopies.text - 1) +
 9129:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 9130:           shorten("Base line")("ADBE Vectors Group")(
 9131:             "ADBE Vector Filter - Trim",
 9132:           )("ADBE Vector Trim Offset").expression =
 9133:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 9134:             (EditTextCopies.text - 1) +
 9135:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 9136:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 9137:           shorten("Big subdivisions")("ADBE Vectors Group")
 9138:             .addProperty("ADBE Vector Shape - Group")
 9139:             .path.setValue(shape);
 9140:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
 9141:             "ADBE Vector Scale",
 9142:           ).setValue([-85, -85]);
 9143:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9144:             "ADBE Vector Graphic - Stroke",
 9145:           )("ADBE Vector Stroke Color").expression =
 9146:             'try {effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 9147:           shorten("Big subdivisions")("ADBE Vectors Group")
 9148:             .addProperty("ADBE Vector Filter - Repeater")(
 9149:               "ADBE Vector Repeater Copies",
 9150:             )
 9151:             .setValue(
 9152:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 9153:             );
 9154:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9155:             "ADBE Vector Filter - Repeater",
 9156:           )("ADBE Vector Repeater Transform")(
 9157:             "ADBE Vector Repeater Rotation",
 9158:           ).expression =
 9159:             'try { effect("ADBE easyRulers")("Gap")/10*' +
 9160:             divideBy +
 9161:             " } catch(e) { value }";
 9162:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9163:             "ADBE Vector Filter - Offset",
 9164:           )("ADBE Vector Offset Amount").expression =
 9165:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*4 - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9166:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9167:             "ADBE Vector Graphic - Stroke",
 9168:           )("ADBE Vector Stroke Width").expression =
 9169:             'try { effect("ADBE easyRulers")("Height Bias")*8 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9170:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9171:             "ADBE Vector Filter - Trim",
 9172:           )("ADBE Vector Trim End").expression =
 9173:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 9174:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9175:             "ADBE Vector Filter - Trim",
 9176:           )("ADBE Vector Trim Offset").expression =
 9177:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 9178:           shorten.addProperty("ADBE Vector Group").name =
 9179:             "Big subdivisions Base Line";
 9180:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 9181:             .addProperty("ADBE Vector Shape - Group")
 9182:             .path.setValue(shape);
 9183:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 9184:             "ADBE Vector Scale",
 9185:           ).setValue([-85, -85]);
 9186:           shorten("Big subdivisions Base Line")(
 9187:             "ADBE Vectors Group",
 9188:           ).addProperty("ADBE Vector Graphic - Stroke")(
 9189:             "ADBE Vector Stroke Color",
 9190:           ).expression =
 9191:             'try {effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 9192:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 9193:             "ADBE Vector Graphic - Stroke",
 9194:           )("ADBE Vector Stroke Width").expression =
 9195:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
 9196:           shorten("Big subdivisions Base Line")(
 9197:             "ADBE Vectors Group",
 9198:           ).addProperty("ADBE Vector Filter - Offset")(
 9199:             "ADBE Vector Offset Amount",
 9200:           ).expression =
 9201:             'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2; } else { 0 } } catch(e) { value }';
 9202:           shorten("Big subdivisions Base Line")(
 9203:             "ADBE Vectors Group",
 9204:           ).addProperty("ADBE Vector Filter - Trim")(
 9205:             "ADBE Vector Trim End",
 9206:           ).expression =
 9207:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 9208:             (EditTextCopies.text - 1) +
 9209:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 9210:             (EditTextCopies.text - 1) +
 9211:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 9212:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 9213:             "ADBE Vector Filter - Trim",
 9214:           )("ADBE Vector Trim Offset").expression =
 9215:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 9216:             (EditTextCopies.text - 1) +
 9217:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 9218:           shorten.addProperty("ADBE Vector Group").name =
 9219:             "Half subdivisions - Secondary Color";
 9220:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
 9221:           shorten("Half subdivisions")("ADBE Vectors Group")
 9222:             .addProperty("ADBE Vector Shape - Group")
 9223:             .path.setValue(shape);
 9224:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
 9225:             "ADBE Vector Scale",
 9226:           ).setValue([-85, -85]);
 9227:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 9228:             "ADBE Vector Graphic - Stroke",
 9229:           )("ADBE Vector Stroke Color").expression =
 9230:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 9231:           shorten("Half subdivisions")("ADBE Vectors Group")
 9232:             .addProperty("ADBE Vector Filter - Repeater")(
 9233:               "ADBE Vector Repeater Copies",
 9234:             )
 9235:             .setValue(Math.floor((Number(EditTextCopies.text) + 4) / 10));
 9236:           shorten("Half subdivisions")("ADBE Vectors Group")(
 9237:             "ADBE Vector Filter - Repeater",
 9238:           )("ADBE Vector Repeater Offset").setValue(0.5);
 9239:           shorten("Half subdivisions")("ADBE Vectors Group")(
 9240:             "ADBE Vector Filter - Repeater",
 9241:           )("ADBE Vector Repeater Transform")(
 9242:             "ADBE Vector Repeater Rotation",
 9243:           ).expression =
 9244:             'try { effect("ADBE easyRulers")("Gap") } catch(e) { value }';
 9245:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 9246:             "ADBE Vector Filter - Offset",
 9247:           )("ADBE Vector Offset Amount").expression =
 9248:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9249:           shorten("Half subdivisions")("ADBE Vectors Group")(
 9250:             "ADBE Vector Graphic - Stroke",
 9251:           )("ADBE Vector Stroke Width").expression =
 9252:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9253:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
 9254:             "ADBE Vector Filter - Trim",
 9255:           )("ADBE Vector Trim End").expression =
 9256:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 9257:           shorten("Half subdivisions")("ADBE Vectors Group")(
 9258:             "ADBE Vector Filter - Trim",
 9259:           )("ADBE Vector Trim Offset").expression =
 9260:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 9261:           shorten.addProperty("ADBE Vector Group").name =
 9262:             "Half subdivisions Base Line";
 9263:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
 9264:             .addProperty("ADBE Vector Shape - Group")
 9265:             .path.setValue(shape);
 9266:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
 9267:             "ADBE Vector Scale",
 9268:           ).setValue([-85, -85]);
 9269:           shorten("Half subdivisions Base Line")(
 9270:             "ADBE Vectors Group",
 9271:           ).addProperty("ADBE Vector Graphic - Stroke")(
 9272:             "ADBE Vector Stroke Color",
 9273:           ).expression =
 9274:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
 9275:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 9276:             "ADBE Vector Graphic - Stroke",
 9277:           )("ADBE Vector Stroke Width").expression =
 9278:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
 9279:           shorten("Half subdivisions Base Line")(
 9280:             "ADBE Vectors Group",
 9281:           ).addProperty("ADBE Vector Filter - Offset")(
 9282:             "ADBE Vector Offset Amount",
 9283:           ).expression =
 9284:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2)>0) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value }';
 9285:           shorten("Half subdivisions Base Line")(
 9286:             "ADBE Vectors Group",
 9287:           ).addProperty("ADBE Vector Filter - Trim")(
 9288:             "ADBE Vector Trim End",
 9289:           ).expression =
 9290:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 9291:             (EditTextCopies.text - 1) +
 9292:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 9293:             (EditTextCopies.text - 1) +
 9294:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 9295:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
 9296:             "ADBE Vector Filter - Trim",
 9297:           )("ADBE Vector Trim Offset").expression =
 9298:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 9299:             (EditTextCopies.text - 1) +
 9300:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 9301:           shorten.addProperty("ADBE Vector Group").name =
 9302:             "Main lines - Secondary Color";
 9303:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
 9304:           shorten("Main lines")("ADBE Vectors Group")
 9305:             .addProperty("ADBE Vector Shape - Group")
 9306:             .path.setValue(shape);
 9307:           shorten("Main lines")("ADBE Vector Transform Group")(
 9308:             "ADBE Vector Scale",
 9309:           ).setValue([-85, -85]);
 9310:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 9311:             "ADBE Vector Filter - Offset",
 9312:           )("ADBE Vector Offset Amount").expression =
 9313:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9314:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 9315:             "ADBE Vector Filter - Trim",
 9316:           )("ADBE Vector Trim End").expression =
 9317:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 9318:           shorten("Main lines")("ADBE Vectors Group")(
 9319:             "ADBE Vector Filter - Trim",
 9320:           )("ADBE Vector Trim Offset").expression =
 9321:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 9322:           shorten("Main lines")("ADBE Vectors Group")
 9323:             .addProperty(
 9324:               "ADBE Vector Filter - Repeater",
 9325:             )("ADBE Vector Repeater Copies")
 9326:             .setValue(4);
 9327:           shorten("Main lines")("ADBE Vectors Group")(
 9328:             "ADBE Vector Filter - Repeater",
 9329:           )("ADBE Vector Repeater Transform")(
 9330:             "ADBE Vector Repeater Rotation",
 9331:           ).expression =
 9332:             'try { effect("ADBE easyRulers")("Gap")/10 } catch(e) { value }';
 9333:           shorten("Main lines")("ADBE Vectors Group")(
 9334:             "ADBE Vector Filter - Repeater",
 9335:           )("ADBE Vector Repeater Offset").setValue(1);
 9336:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 9337:             "ADBE Vector Filter - Repeater",
 9338:           ).name = "Repeater Group";
 9339:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
 9340:             "ADBE Vector Repeater Copies",
 9341:           ).setValue(Math.ceil((Number(EditTextCopies.text) - 1) / 5));
 9342:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
 9343:             "ADBE Vector Repeater Transform",
 9344:           )("ADBE Vector Repeater Rotation").expression =
 9345:             'try { effect("ADBE easyRulers")("Gap")/2 } catch(e) { value }';
 9346:           if (
 9347:             (EditTextCopies.text - 1) % 5 > 0 &&
 9348:             (EditTextCopies.text - 1) % 5 < 4
 9349:           ) {
 9350:             shorten("Main lines")("ADBE Vectors Group").addProperty(
 9351:               "ADBE Vector Filter - Trim",
 9352:             ).name = "Trim Last";
 9353:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
 9354:               "ADBE Vector Trim End",
 9355:             ).expression =
 9356:               "try { " +
 9357:               (100 -
 9358:                 (4 - ((EditTextCopies.text - 1) % 5)) *
 9359:                   (100 / (4 * Math.ceil((EditTextCopies.text - 1) / 5)))) +
 9360:               " } catch(e) { value }";
 9361:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
 9362:               "ADBE Vector Trim Type",
 9363:             ).setValue(2);
 9364:           }
 9365:           shorten("Main lines")("ADBE Vectors Group").addProperty(
 9366:             "ADBE Vector Graphic - Stroke",
 9367:           )("ADBE Vector Stroke Color").expression =
 9368:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 9369:           shorten("Main lines")("ADBE Vectors Group")(
 9370:             "ADBE Vector Graphic - Stroke",
 9371:           )("ADBE Vector Stroke Width").expression =
 9372:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9373:           t("ADBE easyRulers")("Width").setValue(2);
 9374:           t("ADBE easyRulers")("default Width").setValue(2);
 9375:           t("ADBE easyRulers")("Height").setValue(2);
 9376:           t("ADBE easyRulers")("default Height").setValue(2);
 9377:           t("ADBE easyRulers")("Height Bias").setValue(4);
 9378:           t("ADBE easyRulers")("default Height Bias").setValue(4);
 9379:           if (SidesType.selection.index == 2) {
 9380:             t("ADBE easyRulers")("Sides Distance").setValue(-10);
 9381:             t("ADBE easyRulers")("default Sides Distance").setValue(-10);
 9382:           }
 9383:           if (NumbersCheckBox.value) {
 9384:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
 9385:             t("ADBE easyRulers")("default Text Distance").setValue(10);
 9386:           }
 9387:           app.project.activeItem.layer(shapeLayer.name)(
 9388:             "ADBE Root Vectors Group",
 9389:           )("Ruler")("ADBE Vector Transform Group")(
 9390:             "ADBE Vector Rotation",
 9391:           ).expression =
 9392:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
 9393:           createPointerCircular();
 9394:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
 9395:             .addProperty("ADBE Vector Shape - Group")
 9396:             .path.setValue(shape);
 9397:           shorten("Main lines - Secondary Color")(
 9398:             "ADBE Vector Transform Group",
 9399:           )("ADBE Vector Scale").setValue([-85, -85]);
 9400:           shorten("Main lines - Secondary Color")(
 9401:             "ADBE Vectors Group",
 9402:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
 9403:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9404:             "Stroke Start",
 9405:           )("ADBE Vector Stroke Color").expression =
 9406:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 9407:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9408:             "Stroke Start",
 9409:           )("ADBE Vector Stroke Width").expression =
 9410:             'try { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2+1 } catch(e) { value }';
 9411:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9412:             "Stroke Start",
 9413:           )("ADBE Vector Stroke Opacity").expression =
 9414:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 9415:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
 9416:             .addProperty(
 9417:               "ADBE Vector Filter - Repeater",
 9418:             )("ADBE Vector Repeater Copies")
 9419:             .setValue(EditTextCopies.text);
 9420:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9421:             "ADBE Vector Filter - Repeater",
 9422:           )("ADBE Vector Repeater Transform")(
 9423:             "ADBE Vector Repeater Rotation",
 9424:           ).expression =
 9425:             'try { effect("ADBE easyRulers")("Gap")/10 } catch (err) { value }';
 9426:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9427:             "ADBE Vector Filter - Repeater",
 9428:           )("ADBE Vector Repeater Copies").expression =
 9429:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 9430:             EditTextCopies.text +
 9431:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 9432:             (Number(EditTextCopies.text) - 1) +
 9433:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 9434:             (Number(EditTextCopies.text) - 1) +
 9435:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 9436:             EditTextCopies.text +
 9437:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
 9438:             (Number(EditTextCopies.text) - 1) +
 9439:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
 9440:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9441:             "ADBE Vector Filter - Repeater",
 9442:           )("ADBE Vector Repeater Transform")(
 9443:             "ADBE Vector Repeater Opacity 1",
 9444:           ).expression =
 9445:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9446:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9447:             "ADBE Vector Filter - Repeater",
 9448:           )("ADBE Vector Repeater Transform")(
 9449:             "ADBE Vector Repeater Opacity 2",
 9450:           ).expression =
 9451:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9452:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9453:             "ADBE Vector Filter - Repeater",
 9454:           )("ADBE Vector Repeater Offset").expression =
 9455:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 9456:             (Number(EditTextCopies.text) - 1) +
 9457:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 9458:             (Number(EditTextCopies.text) - 1) +
 9459:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
 9460:           shorten("Main lines - Secondary Color")(
 9461:             "ADBE Vectors Group",
 9462:           ).addProperty("ADBE Vector Filter - Offset")(
 9463:             "ADBE Vector Offset Amount",
 9464:           ).expression =
 9465:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch (err) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch (err) { value }';
 9466:           shorten("Main lines - Secondary Color")(
 9467:             "ADBE Vectors Group",
 9468:           ).addProperty("ADBE Vector Filter - Trim")(
 9469:             "ADBE Vector Trim End",
 9470:           ).expression =
 9471:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
 9472:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9473:             "ADBE Vector Filter - Trim",
 9474:           )("ADBE Vector Trim Offset").expression =
 9475:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
 9476:           shorten("Main lines - Secondary Color")(
 9477:             "ADBE Vectors Group",
 9478:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
 9479:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9480:             "Stroke End",
 9481:           )("ADBE Vector Stroke Width").expression =
 9482:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9483:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9484:             "Stroke End",
 9485:           )("ADBE Vector Stroke Color").expression =
 9486:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 9487:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
 9488:             "Stroke End",
 9489:           )("ADBE Vector Stroke Opacity").expression =
 9490:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
 9491:           shorten("Main lines - Secondary Color")(
 9492:             "ADBE Vector Transform Group",
 9493:           )("ADBE Vector Group Opacity").expression =
 9494:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 9495:           secondary_lines = app.project.activeItem
 9496:             .layer(
 9497:               shapeLayer.name,
 9498:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
 9499:             .duplicate();
 9500:           secondary_lines.name = "Big subdivisions - Secondary Color";
 9501:           secondary_lines("ADBE Vectors Group")(
 9502:             "ADBE Vector Filter - Repeater",
 9503:           )("ADBE Vector Repeater Copies").expression =
 9504:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 9505:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 9506:             1 +
 9507:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 9508:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 9509:             1 +
 9510:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 9511:             (Number(EditTextCopies.text) - 1) +
 9512:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 9513:             divideBy +
 9514:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 9515:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 9516:             1 +
 9517:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 9518:             divideBy +
 9519:             "*100/" +
 9520:             (Number(EditTextCopies.text) - 1) +
 9521:             ")) } else { 0 }              }} catch(e) { value }";
 9522:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
 9523:             "ADBE Vector Stroke Opacity",
 9524:           ).expression =
 9525:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 9526:           secondary_lines("ADBE Vector Transform Group")(
 9527:             "ADBE Vector Group Opacity",
 9528:           ).expression =
 9529:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 9530:           secondary_lines("ADBE Vectors Group")(
 9531:             "ADBE Vector Graphic - Stroke",
 9532:           ).name = "Stroke Start";
 9533:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
 9534:             "ADBE Vector Stroke Color",
 9535:           ).expression =
 9536:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 9537:           secondary_lines("ADBE Vectors Group")(
 9538:             "ADBE Vector Filter - Repeater",
 9539:           )("ADBE Vector Repeater Offset").expression =
 9540:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
 9541:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
 9542:             1 +
 9543:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 9544:             (Number(EditTextCopies.text) - 1) +
 9545:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 9546:             divideBy +
 9547:             ")} else { 0 }             }} catch(e) { value }";
 9548:           secondary_lines("ADBE Vectors Group")(
 9549:             "ADBE Vector Filter - Repeater",
 9550:           )("ADBE Vector Repeater Transform")(
 9551:             "ADBE Vector Repeater Opacity 1",
 9552:           ).expression =
 9553:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9554:           secondary_lines("ADBE Vectors Group")(
 9555:             "ADBE Vector Filter - Repeater",
 9556:           )("ADBE Vector Repeater Transform")(
 9557:             "ADBE Vector Repeater Opacity 2",
 9558:           ).expression =
 9559:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9560:           secondary_lines("ADBE Vectors Group").addProperty(
 9561:             "ADBE Vector Graphic - Stroke",
 9562:           ).name = "Stroke End";
 9563:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 9564:             "ADBE Vector Stroke Width",
 9565:           ).expression =
 9566:             'try { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9567:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 9568:             "ADBE Vector Stroke Color",
 9569:           ).expression =
 9570:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 9571:           secondary_lines("ADBE Vectors Group")("Stroke End")(
 9572:             "ADBE Vector Stroke Opacity",
 9573:           ).expression =
 9574:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
 9575:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")
 9576:             .addProperty("ADBE Vector Shape - Group")
 9577:             .path.setValue(shape);
 9578:           shorten("Half subdivisions - Secondary Color")(
 9579:             "ADBE Vector Transform Group",
 9580:           )("ADBE Vector Scale").setValue([-85, -85]);
 9581:           shorten("Half subdivisions - Secondary Color")(
 9582:             "ADBE Vectors Group",
 9583:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
 9584:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9585:             "Stroke Start",
 9586:           )("ADBE Vector Stroke Color").expression =
 9587:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
 9588:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9589:             "Stroke Start",
 9590:           )("ADBE Vector Stroke Width").expression =
 9591:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9592:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9593:             "Stroke Start",
 9594:           )("ADBE Vector Stroke Opacity").expression =
 9595:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 9596:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")
 9597:             .addProperty("ADBE Vector Filter - Repeater")(
 9598:               "ADBE Vector Repeater Copies",
 9599:             )
 9600:             .setValue(Math.floor((Number(EditTextCopies.text) + 4) / 10));
 9601:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9602:             "ADBE Vector Filter - Repeater",
 9603:           )("ADBE Vector Repeater Offset").setValue(0.5);
 9604:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9605:             "ADBE Vector Filter - Repeater",
 9606:           )("ADBE Vector Repeater Transform")(
 9607:             "ADBE Vector Repeater Rotation",
 9608:           ).expression =
 9609:             'try { effect("ADBE easyRulers")("Gap")/2 } catch (err) { value }';
 9610:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9611:             "ADBE Vector Filter - Repeater",
 9612:           )("ADBE Vector Repeater Copies").expression =
 9613:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
 9614:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 9615:             1 +
 9616:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
 9617:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 9618:             1 +
 9619:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
 9620:             (Number(EditTextCopies.text) - 1) +
 9621:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
 9622:             divideBy / 2 +
 9623:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
 9624:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 9625:             1 +
 9626:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
 9627:             divideBy / 2 +
 9628:             "*100/" +
 9629:             (Number(EditTextCopies.text) - 1) +
 9630:             ")) } else { 0 }              }} catch(e) { value }";
 9631:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9632:             "ADBE Vector Filter - Repeater",
 9633:           )("ADBE Vector Repeater Transform")(
 9634:             "ADBE Vector Repeater Opacity 1",
 9635:           ).expression =
 9636:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9637:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9638:             "ADBE Vector Filter - Repeater",
 9639:           )("ADBE Vector Repeater Transform")(
 9640:             "ADBE Vector Repeater Opacity 2",
 9641:           ).expression =
 9642:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
 9643:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9644:             "ADBE Vector Filter - Repeater",
 9645:           )("ADBE Vector Repeater Offset").expression =
 9646:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) { ' +
 9647:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
 9648:             1 +
 9649:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
 9650:             (Number(EditTextCopies.text) - 1) +
 9651:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
 9652:             divideBy / 2 +
 9653:             ")} else { 0 }             }} catch(e) { value }";
 9654:           shorten("Half subdivisions - Secondary Color")(
 9655:             "ADBE Vectors Group",
 9656:           ).addProperty("ADBE Vector Filter - Offset")(
 9657:             "ADBE Vector Offset Amount",
 9658:           ).expression =
 9659:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9660:           shorten("Half subdivisions - Secondary Color")(
 9661:             "ADBE Vectors Group",
 9662:           ).addProperty("ADBE Vector Filter - Trim")(
 9663:             "ADBE Vector Trim End",
 9664:           ).expression =
 9665:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
 9666:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9667:             "ADBE Vector Filter - Trim",
 9668:           )("ADBE Vector Trim Offset").expression =
 9669:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
 9670:           shorten("Half subdivisions - Secondary Color")(
 9671:             "ADBE Vectors Group",
 9672:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
 9673:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9674:             "Stroke End",
 9675:           )("ADBE Vector Stroke Width").expression =
 9676:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9677:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9678:             "Stroke End",
 9679:           )("ADBE Vector Stroke Color").expression =
 9680:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
 9681:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
 9682:             "Stroke End",
 9683:           )("ADBE Vector Stroke Opacity").expression =
 9684:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
 9685:           shorten("Half subdivisions - Secondary Color")(
 9686:             "ADBE Vector Transform Group",
 9687:           )("ADBE Vector Group Opacity").expression =
 9688:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
 9689:           app.project.activeItem
 9690:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 9691:             .duplicate().name = "Ruler Mirror";
 9692:           app.project.activeItem
 9693:             .layer(
 9694:               shapeLayer.name,
 9695:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
 9696:             .setValue(60);
 9697:           app.project.activeItem
 9698:             .layer(
 9699:               shapeLayer.name,
 9700:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
 9701:             .setValue(-180);
 9702:           app.project.activeItem
 9703:             .layer(
 9704:               shapeLayer.name,
 9705:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
 9706:             .setValue([0, 425]);
 9707:           app.project.activeItem.layer(shapeLayer.name)(
 9708:             "ADBE Root Vectors Group",
 9709:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
 9710:           if (SidesType.selection.index !== 0) {
 9711:             app.project.activeItem.layer(shapeLayer.name)(
 9712:               "ADBE Root Vectors Group",
 9713:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 9714:               "ADBE Vector Scale",
 9715:             ).expression =
 9716:               'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] }';
 9717:             app.project.activeItem.layer(shapeLayer.name)(
 9718:               "ADBE Root Vectors Group",
 9719:             )("Ruler Mirror")("ADBE Vector Transform Group")(
 9720:               "ADBE Vector Rotation",
 9721:             ).expression =
 9722:               'try { -effect("ADBE easyRulers")("Width")/5.75 } catch(e) { value }';
 9723:             app.project.activeItem.layer(shapeLayer.name)(
 9724:               "ADBE Root Vectors Group",
 9725:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
 9726:               "ADBE Vector Transform Group",
 9727:             )("ADBE Vector Anchor").expression =
 9728:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
 9729:             app.project.activeItem.layer(shapeLayer.name)(
 9730:               "ADBE Root Vectors Group",
 9731:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
 9732:               "ADBE Vectors Group",
 9733:             )("ADBE Vector Filter - Offset")(
 9734:               "ADBE Vector Offset Amount",
 9735:             ).expression =
 9736:               'try { -effect("ADBE easyRulers")("Height Bias")-effect("ADBE easyRulers")("Height") } catch(e) { value }';
 9737:             app.project.activeItem.layer(shapeLayer.name)(
 9738:               "ADBE Root Vectors Group",
 9739:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
 9740:               "ADBE Vectors Group",
 9741:             )("ADBE Vector Filter - Offset")(
 9742:               "ADBE Vector Offset Amount",
 9743:             ).expression =
 9744:               'try { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height") } catch(e) { value }';
 9745:             app.project.activeItem.layer(shapeLayer.name)(
 9746:               "ADBE Root Vectors Group",
 9747:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
 9748:               "ADBE Vectors Group",
 9749:             )("ADBE Vector Filter - Offset")(
 9750:               "ADBE Vector Offset Amount",
 9751:             ).expression =
 9752:               'try { -effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height") } catch(e) { value }';
 9753:             app.project.activeItem.layer(shapeLayer.name)(
 9754:               "ADBE Root Vectors Group",
 9755:             )("Ruler Mirror")("ADBE Vectors Group")(
 9756:               "Big subdivisions Base Line",
 9757:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 9758:               "ADBE Vector Offset Amount",
 9759:             ).expression =
 9760:               'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")*2 } else { 0 } } catch(e) { value }';
 9761:             app.project.activeItem.layer(shapeLayer.name)(
 9762:               "ADBE Root Vectors Group",
 9763:             )("Ruler Mirror")("ADBE Vectors Group")(
 9764:               "Half subdivisions Base Line",
 9765:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
 9766:               "ADBE Vector Offset Amount",
 9767:             ).expression =
 9768:               'try { if (effect("ADBE easyRulers")("Height Bias") > 0) { if ( effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2 > 0) {-effect("ADBE easyRulers")("Height Bias")*4- effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
 9769:           }
 9770:           switch (BaseLineDropdown.selection.index) {
 9771:             case 0:
 9772:               app.project.activeItem
 9773:                 .layer(
 9774:                   shapeLayer.name,
 9775:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
 9776:                 .remove();
 9777:               app.project.activeItem
 9778:                 .layer(
 9779:                   shapeLayer.name,
 9780:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
 9781:                 .remove();
 9782:               app.project.activeItem
 9783:                 .layer(
 9784:                   shapeLayer.name,
 9785:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 9786:                 .remove();
 9787:               app.project.activeItem
 9788:                 .layer(
 9789:                   shapeLayer.name,
 9790:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 9791:                 .remove();
 9792:               app.project.activeItem
 9793:                 .layer(
 9794:                   shapeLayer.name,
 9795:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 9796:                 .remove();
 9797:               app.project.activeItem
 9798:                 .layer(
 9799:                   shapeLayer.name,
 9800:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 9801:                 .remove();
 9802:               break;
 9803:             case 1:
 9804:               app.project.activeItem
 9805:                 .layer(
 9806:                   shapeLayer.name,
 9807:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
 9808:                 .remove();
 9809:               app.project.activeItem
 9810:                 .layer(
 9811:                   shapeLayer.name,
 9812:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
 9813:                 .remove();
 9814:               app.project.activeItem
 9815:                 .layer(
 9816:                   shapeLayer.name,
 9817:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
 9818:                 .remove();
 9819:               app.project.activeItem
 9820:                 .layer(
 9821:                   shapeLayer.name,
 9822:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
 9823:                 .remove();
 9824:           }
 9825:           switch (SidesType.selection.index) {
 9826:             case 0:
 9827:               app.project.activeItem
 9828:                 .layer(
 9829:                   shapeLayer.name,
 9830:                 )("ADBE Root Vectors Group")("Ruler Mirror")
 9831:                 .remove();
 9832:               break;
 9833:             case 1:
 9834:               app.project.activeItem
 9835:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
 9836:                 .remove();
 9837:               app.project.activeItem.layer(shapeLayer.name)(
 9838:                 "ADBE Root Vectors Group",
 9839:               )("Ruler Mirror")("ADBE Vector Transform Group")(
 9840:                 "ADBE Vector Scale",
 9841:               ).expression = "";
 9842:               app.project.activeItem
 9843:                 .layer(
 9844:                   shapeLayer.name,
 9845:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
 9846:                 .setValue([90, 90]);
 9847:               app.project.activeItem.layer(shapeLayer.name)(
 9848:                 "ADBE Root Vectors Group",
 9849:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
 9850:               break;
 9851:             case 2:
 9852:               app.project.activeItem.layer(shapeLayer.name)(
 9853:                 "ADBE Root Vectors Group",
 9854:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled =
 9855:                 false;
 9856:           }
 9857:         };
 9858:         createBasic10b_circle = function () {
 9859:           shorten.addProperty("ADBE Vector Group").name = "Base line";
 9860:           shorten("Base line")("ADBE Vectors Group")
 9861:             .addProperty("ADBE Vector Shape - Group")
 9862:             .path.setValue(shape);
 9863:           shorten("Base line")("ADBE Vector Transform Group")(
 9864:             "ADBE Vector Scale",
 9865:           ).setValue([-85, -85]);
 9866:           shorten("Base line")("ADBE Vectors Group").addProperty(
 9867:             "ADBE Vector Graphic - Stroke",
 9868:           )("ADBE Vector Stroke Color").expression =
 9869:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
 9870:           shorten("Base line")("ADBE Vectors Group")(
 9871:             "ADBE Vector Graphic - Stroke",
 9872:           )("ADBE Vector Stroke Width").expression =
 9873:             'try { effect("ADBE easyRulers")("Width") } catch(e) { value }';
 9874:           shorten("Base line")("ADBE Vectors Group").addProperty(
 9875:             "ADBE Vector Filter - Trim",
 9876:           )("ADBE Vector Trim End").expression =
 9877:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 9878:             (EditTextCopies.text - 1) +
 9879:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 9880:             (EditTextCopies.text - 1) +
 9881:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 9882:           shorten("Base line")("ADBE Vectors Group")(
 9883:             "ADBE Vector Filter - Trim",
 9884:           )("ADBE Vector Trim Offset").expression =
 9885:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 9886:             (EditTextCopies.text - 1) +
 9887:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 9888:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
 9889:           shorten("Big subdivisions")("ADBE Vectors Group")
 9890:             .addProperty("ADBE Vector Shape - Group")
 9891:             .path.setValue(shape);
 9892:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
 9893:             "ADBE Vector Scale",
 9894:           ).setValue([-85, -85]);
 9895:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9896:             "ADBE Vector Graphic - Stroke",
 9897:           )("ADBE Vector Stroke Color").expression =
 9898:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 9899:           shorten("Big subdivisions")("ADBE Vectors Group")
 9900:             .addProperty("ADBE Vector Filter - Repeater")(
 9901:               "ADBE Vector Repeater Copies",
 9902:             )
 9903:             .setValue(
 9904:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
 9905:             );
 9906:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9907:             "ADBE Vector Filter - Repeater",
 9908:           )("ADBE Vector Repeater Transform")(
 9909:             "ADBE Vector Repeater Rotation",
 9910:           ).expression =
 9911:             'try { effect("ADBE easyRulers")("Gap")/10*' +
 9912:             divideBy +
 9913:             " } catch(e) { value }";
 9914:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9915:             "ADBE Vector Filter - Offset",
 9916:           )("ADBE Vector Offset Amount").expression =
 9917:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*4 - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9918:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9919:             "ADBE Vector Graphic - Stroke",
 9920:           )("ADBE Vector Stroke Width").expression =
 9921:             'try { effect("ADBE easyRulers")("Height Bias")*8 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
 9922:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
 9923:             "ADBE Vector Filter - Trim",
 9924:           )("ADBE Vector Trim End").expression =
 9925:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 9926:           shorten("Big subdivisions")("ADBE Vectors Group")(
 9927:             "ADBE Vector Filter - Trim",
 9928:           )("ADBE Vector Trim Offset").expression =
 9929:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 9930:           shorten.addProperty("ADBE Vector Group").name =
 9931:             "Big subdivisions Base Line";
 9932:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
 9933:             .addProperty("ADBE Vector Shape - Group")
 9934:             .path.setValue(shape);
 9935:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
 9936:             "ADBE Vector Scale",
 9937:           ).setValue([-85, -85]);
 9938:           shorten("Big subdivisions Base Line")(
 9939:             "ADBE Vectors Group",
 9940:           ).addProperty("ADBE Vector Graphic - Stroke")(
 9941:             "ADBE Vector Stroke Color",
 9942:           ).expression =
 9943:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
 9944:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 9945:             "ADBE Vector Graphic - Stroke",
 9946:           )("ADBE Vector Stroke Width").expression =
 9947:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
 9948:           shorten("Big subdivisions Base Line")(
 9949:             "ADBE Vectors Group",
 9950:           ).addProperty("ADBE Vector Filter - Offset")(
 9951:             "ADBE Vector Offset Amount",
 9952:           ).expression =
 9953:             'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2; } else { 0 } } catch(e) { value }';
 9954:           shorten("Big subdivisions Base Line")(
 9955:             "ADBE Vectors Group",
 9956:           ).addProperty("ADBE Vector Filter - Trim")(
 9957:             "ADBE Vector Trim End",
 9958:           ).expression =
 9959:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
 9960:             (EditTextCopies.text - 1) +
 9961:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
 9962:             (EditTextCopies.text - 1) +
 9963:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
 9964:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
 9965:             "ADBE Vector Filter - Trim",
 9966:           )("ADBE Vector Trim Offset").expression =
 9967:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
 9968:             (EditTextCopies.text - 1) +
 9969:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
 9970:           shorten.addProperty("ADBE Vector Group").name =
 9971:             "Fifth subdivisions - Secondary Color";
 9972:           shorten.addProperty("ADBE Vector Group").name = "Fifth subdivisions";
 9973:           shorten("Fifth subdivisions")("ADBE Vectors Group")
 9974:             .addProperty("ADBE Vector Shape - Group")
 9975:             .path.setValue(shape);
 9976:           shorten("Fifth subdivisions")("ADBE Vector Transform Group")(
 9977:             "ADBE Vector Scale",
 9978:           ).setValue([-85, -85]);
 9979:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
 9980:             "ADBE Vector Filter - Offset",
 9981:           )("ADBE Vector Offset Amount").expression =
 9982:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2 - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
 9983:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
 9984:             "ADBE Vector Filter - Trim",
 9985:           )("ADBE Vector Trim End").expression =
 9986:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
 9987:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
 9988:             "ADBE Vector Filter - Trim",
 9989:           )("ADBE Vector Trim Offset").expression =
 9990:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
 9991:           shorten("Fifth subdivisions")("ADBE Vectors Group")
 9992:             .addProperty(
 9993:               "ADBE Vector Filter - Repeater",
 9994:             )("ADBE Vector Repeater Copies")
 9995:             .setValue(4);
 9996:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
 9997:             "ADBE Vector Filter - Repeater",
 9998:           )("ADBE Vector Repeater Transform")(
 9999:             "ADBE Vector Repeater Rotation",
10000:           ).expression =
10001:             'try { effect("ADBE easyRulers")("Gap")/5 } catch(e) { value }';
10002:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
10003:             "ADBE Vector Filter - Repeater",
10004:           )("ADBE Vector Repeater Offset").setValue(1);
10005:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
10006:             "ADBE Vector Filter - Repeater",
10007:           ).name = "Repeater Group";
10008:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Repeater Group")(
10009:             "ADBE Vector Repeater Copies",
10010:           ).setValue(Math.ceil((EditTextCopies.text - 1) / 10));
10011:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Repeater Group")(
10012:             "ADBE Vector Repeater Transform",
10013:           )("ADBE Vector Repeater Rotation").expression =
10014:             'try { effect("ADBE easyRulers")("Gap") } catch(e) { value }';
10015:           if (
10016:             (EditTextCopies.text - 1) % 10 > 0 &&
10017:             (EditTextCopies.text - 1) % 10 < 8
10018:           ) {
10019:             shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
10020:               "ADBE Vector Filter - Trim",
10021:             ).name = "Trim Last";
10022:             shorten("Fifth subdivisions")("ADBE Vectors Group")("Trim Last")(
10023:               "ADBE Vector Trim End",
10024:             ).expression =
10025:               "try { " +
10026:               (100 -
10027:                 Math.ceil((8 - ((EditTextCopies.text - 1) % 10)) / 2) *
10028:                   (100 / (4 * Math.ceil((EditTextCopies.text - 1) / 10)))) +
10029:               " } catch(e) { value }";
10030:             shorten("Fifth subdivisions")("ADBE Vectors Group")("Trim Last")(
10031:               "ADBE Vector Trim Type",
10032:             ).setValue(2);
10033:           }
10034:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
10035:             "ADBE Vector Graphic - Stroke",
10036:           )("ADBE Vector Stroke Color").expression =
10037:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
10038:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
10039:             "ADBE Vector Graphic - Stroke",
10040:           )("ADBE Vector Stroke Width").expression =
10041:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10042:           shorten.addProperty("ADBE Vector Group").name =
10043:             "Fifth subdivisions Base Line";
10044:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")
10045:             .addProperty("ADBE Vector Shape - Group")
10046:             .path.setValue(shape);
10047:           shorten("Fifth subdivisions Base Line")(
10048:             "ADBE Vector Transform Group",
10049:           )("ADBE Vector Scale").setValue([-85, -85]);
10050:           shorten("Fifth subdivisions Base Line")(
10051:             "ADBE Vectors Group",
10052:           ).addProperty("ADBE Vector Graphic - Stroke")(
10053:             "ADBE Vector Stroke Color",
10054:           ).expression =
10055:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
10056:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
10057:             "ADBE Vector Graphic - Stroke",
10058:           )("ADBE Vector Stroke Width").expression =
10059:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
10060:           shorten("Fifth subdivisions Base Line")(
10061:             "ADBE Vectors Group",
10062:           ).addProperty("ADBE Vector Filter - Offset")(
10063:             "ADBE Vector Offset Amount",
10064:           ).expression =
10065:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2)>0) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
10066:           shorten("Fifth subdivisions Base Line")(
10067:             "ADBE Vectors Group",
10068:           ).addProperty("ADBE Vector Filter - Trim")(
10069:             "ADBE Vector Trim End",
10070:           ).expression =
10071:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
10072:             (EditTextCopies.text - 1) +
10073:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
10074:             (EditTextCopies.text - 1) +
10075:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
10076:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
10077:             "ADBE Vector Filter - Trim",
10078:           )("ADBE Vector Trim Offset").expression =
10079:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
10080:             (EditTextCopies.text - 1) +
10081:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
10082:           shorten.addProperty("ADBE Vector Group").name =
10083:             "Main lines - Secondary Color";
10084:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
10085:           shorten("Main lines")("ADBE Vectors Group")
10086:             .addProperty("ADBE Vector Shape - Group")
10087:             .path.setValue(shape);
10088:           shorten("Main lines")("ADBE Vector Transform Group")(
10089:             "ADBE Vector Scale",
10090:           ).setValue([-85, -85]);
10091:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10092:             "ADBE Vector Filter - Offset",
10093:           )("ADBE Vector Offset Amount").expression =
10094:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10095:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10096:             "ADBE Vector Filter - Trim",
10097:           )("ADBE Vector Trim End").expression =
10098:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
10099:           shorten("Main lines")("ADBE Vectors Group")(
10100:             "ADBE Vector Filter - Trim",
10101:           )("ADBE Vector Trim Offset").expression =
10102:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
10103:           shorten("Main lines")("ADBE Vectors Group")
10104:             .addProperty("ADBE Vector Filter - Repeater")(
10105:               "ADBE Vector Repeater Copies",
10106:             )
10107:             .setValue(Math.ceil((EditTextCopies.text - 1) / 2));
10108:           shorten("Main lines")("ADBE Vectors Group")(
10109:             "ADBE Vector Filter - Repeater",
10110:           )("ADBE Vector Repeater Transform")(
10111:             "ADBE Vector Repeater Rotation",
10112:           ).expression =
10113:             'try { effect("ADBE easyRulers")("Gap")/5 } catch(e) { value }';
10114:           shorten("Main lines")("ADBE Vectors Group")(
10115:             "ADBE Vector Filter - Repeater",
10116:           )("ADBE Vector Repeater Offset").setValue(0.5);
10117:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10118:             "ADBE Vector Graphic - Stroke",
10119:           )("ADBE Vector Stroke Color").expression =
10120:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
10121:           shorten("Main lines")("ADBE Vectors Group")(
10122:             "ADBE Vector Graphic - Stroke",
10123:           )("ADBE Vector Stroke Width").expression =
10124:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10125:           t("ADBE easyRulers")("Width").setValue(2);
10126:           t("ADBE easyRulers")("default Width").setValue(2);
10127:           t("ADBE easyRulers")("Height").setValue(2);
10128:           t("ADBE easyRulers")("default Height").setValue(2);
10129:           t("ADBE easyRulers")("Height Bias").setValue(4);
10130:           t("ADBE easyRulers")("default Height Bias").setValue(4);
10131:           if (NumbersCheckBox.value) {
10132:             t("ADBE easyRulers")("ADBE easyRulers-0015").setValue(10);
10133:             t("ADBE easyRulers")("default Text Distance").setValue(10);
10134:           }
10135:           if (SidesType.selection.index == 2) {
10136:             t("ADBE easyRulers")("Sides Distance").setValue(-10);
10137:             t("ADBE easyRulers")("default Sides Distance").setValue(-10);
10138:           }
10139:           t("ADBE easyRulers")("ADBE easyRulers-0051").setValue([
10140:             PointerColorRGB.red / 255,
10141:             PointerColorRGB.green / 255,
10142:             PointerColorRGB.blue / 255,
10143:             1,
10144:           ]);
10145:           app.project.activeItem.layer(shapeLayer.name)(
10146:             "ADBE Root Vectors Group",
10147:           )("Ruler")("ADBE Vector Transform Group")(
10148:             "ADBE Vector Rotation",
10149:           ).expression =
10150:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
10151:           createPointerCircular();
10152:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
10153:             .addProperty("ADBE Vector Shape - Group")
10154:             .path.setValue(shape);
10155:           shorten("Main lines - Secondary Color")(
10156:             "ADBE Vector Transform Group",
10157:           )("ADBE Vector Scale").setValue([-85, -85]);
10158:           shorten("Main lines - Secondary Color")(
10159:             "ADBE Vectors Group",
10160:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
10161:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10162:             "Stroke Start",
10163:           )("ADBE Vector Stroke Color").expression =
10164:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
10165:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10166:             "Stroke Start",
10167:           )("ADBE Vector Stroke Width").expression =
10168:             'try { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2+1 } catch(e) { value }';
10169:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10170:             "Stroke Start",
10171:           )("ADBE Vector Stroke Opacity").expression =
10172:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
10173:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
10174:             .addProperty(
10175:               "ADBE Vector Filter - Repeater",
10176:             )("ADBE Vector Repeater Copies")
10177:             .setValue(EditTextCopies.text);
10178:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10179:             "ADBE Vector Filter - Repeater",
10180:           )("ADBE Vector Repeater Transform")(
10181:             "ADBE Vector Repeater Rotation",
10182:           ).expression =
10183:             'try { effect("ADBE easyRulers")("Gap")/10 } catch (err) { value }';
10184:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10185:             "ADBE Vector Filter - Repeater",
10186:           )("ADBE Vector Repeater Copies").expression =
10187:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
10188:             EditTextCopies.text +
10189:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
10190:             (Number(EditTextCopies.text) - 1) +
10191:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
10192:             (Number(EditTextCopies.text) - 1) +
10193:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
10194:             EditTextCopies.text +
10195:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
10196:             (Number(EditTextCopies.text) - 1) +
10197:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
10198:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10199:             "ADBE Vector Filter - Repeater",
10200:           )("ADBE Vector Repeater Transform")(
10201:             "ADBE Vector Repeater Opacity 1",
10202:           ).expression =
10203:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10204:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10205:             "ADBE Vector Filter - Repeater",
10206:           )("ADBE Vector Repeater Transform")(
10207:             "ADBE Vector Repeater Opacity 2",
10208:           ).expression =
10209:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10210:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10211:             "ADBE Vector Filter - Repeater",
10212:           )("ADBE Vector Repeater Offset").expression =
10213:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
10214:             (Number(EditTextCopies.text) - 1) +
10215:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
10216:             (Number(EditTextCopies.text) - 1) +
10217:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
10218:           shorten("Main lines - Secondary Color")(
10219:             "ADBE Vectors Group",
10220:           ).addProperty("ADBE Vector Filter - Offset")(
10221:             "ADBE Vector Offset Amount",
10222:           ).expression =
10223:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch (err) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch (err) { value }';
10224:           shorten("Main lines - Secondary Color")(
10225:             "ADBE Vectors Group",
10226:           ).addProperty("ADBE Vector Filter - Trim")(
10227:             "ADBE Vector Trim End",
10228:           ).expression =
10229:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
10230:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10231:             "ADBE Vector Filter - Trim",
10232:           )("ADBE Vector Trim Offset").expression =
10233:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
10234:           shorten("Main lines - Secondary Color")(
10235:             "ADBE Vectors Group",
10236:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
10237:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10238:             "Stroke End",
10239:           )("ADBE Vector Stroke Width").expression =
10240:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10241:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10242:             "Stroke End",
10243:           )("ADBE Vector Stroke Color").expression =
10244:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
10245:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10246:             "Stroke End",
10247:           )("ADBE Vector Stroke Opacity").expression =
10248:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
10249:           shorten("Main lines - Secondary Color")(
10250:             "ADBE Vector Transform Group",
10251:           )("ADBE Vector Group Opacity").expression =
10252:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
10253:           secondary_lines = app.project.activeItem
10254:             .layer(
10255:               shapeLayer.name,
10256:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
10257:             .duplicate();
10258:           secondary_lines.name = "Big subdivisions - Secondary Color";
10259:           secondary_lines("ADBE Vectors Group")(
10260:             "ADBE Vector Filter - Repeater",
10261:           )("ADBE Vector Repeater Copies").expression =
10262:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
10263:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
10264:             1 +
10265:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
10266:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
10267:             1 +
10268:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
10269:             (Number(EditTextCopies.text) - 1) +
10270:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
10271:             divideBy +
10272:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
10273:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
10274:             1 +
10275:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
10276:             divideBy +
10277:             "*100/" +
10278:             (Number(EditTextCopies.text) - 1) +
10279:             ")) } else { 0 }              }} catch(e) { value }";
10280:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
10281:             "ADBE Vector Stroke Opacity",
10282:           ).expression =
10283:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
10284:           secondary_lines("ADBE Vector Transform Group")(
10285:             "ADBE Vector Group Opacity",
10286:           ).expression =
10287:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
10288:           secondary_lines("ADBE Vectors Group")(
10289:             "ADBE Vector Graphic - Stroke",
10290:           ).name = "Stroke Start";
10291:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
10292:             "ADBE Vector Stroke Color",
10293:           ).expression =
10294:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
10295:           secondary_lines("ADBE Vectors Group")(
10296:             "ADBE Vector Filter - Repeater",
10297:           )("ADBE Vector Repeater Offset").expression =
10298:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
10299:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
10300:             1 +
10301:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
10302:             (Number(EditTextCopies.text) - 1) +
10303:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
10304:             divideBy +
10305:             ")} else { 0 }             }} catch(e) { value }";
10306:           secondary_lines("ADBE Vectors Group")(
10307:             "ADBE Vector Filter - Repeater",
10308:           )("ADBE Vector Repeater Transform")(
10309:             "ADBE Vector Repeater Opacity 1",
10310:           ).expression =
10311:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10312:           secondary_lines("ADBE Vectors Group")(
10313:             "ADBE Vector Filter - Repeater",
10314:           )("ADBE Vector Repeater Transform")(
10315:             "ADBE Vector Repeater Opacity 2",
10316:           ).expression =
10317:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10318:           secondary_lines("ADBE Vectors Group").addProperty(
10319:             "ADBE Vector Graphic - Stroke",
10320:           ).name = "Stroke End";
10321:           secondary_lines("ADBE Vectors Group")("Stroke End")(
10322:             "ADBE Vector Stroke Width",
10323:           ).expression =
10324:             'try { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10325:           secondary_lines("ADBE Vectors Group")("Stroke End")(
10326:             "ADBE Vector Stroke Color",
10327:           ).expression =
10328:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
10329:           secondary_lines("ADBE Vectors Group")("Stroke End")(
10330:             "ADBE Vector Stroke Opacity",
10331:           ).expression =
10332:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
10333:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")
10334:             .addProperty("ADBE Vector Shape - Group")
10335:             .path.setValue(shape);
10336:           shorten("Fifth subdivisions - Secondary Color")(
10337:             "ADBE Vector Transform Group",
10338:           )("ADBE Vector Scale").setValue([-85, -85]);
10339:           shorten("Fifth subdivisions - Secondary Color")(
10340:             "ADBE Vectors Group",
10341:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
10342:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10343:             "Stroke Start",
10344:           )("ADBE Vector Stroke Color").expression =
10345:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
10346:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10347:             "Stroke Start",
10348:           )("ADBE Vector Stroke Width").expression =
10349:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10350:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10351:             "Stroke Start",
10352:           )("ADBE Vector Stroke Opacity").expression =
10353:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
10354:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")
10355:             .addProperty("ADBE Vector Filter - Repeater")(
10356:               "ADBE Vector Repeater Copies",
10357:             )
10358:             .setValue(
10359:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
10360:                 1,
10361:             );
10362:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10363:             "ADBE Vector Filter - Repeater",
10364:           )("ADBE Vector Repeater Offset").setValue(0.5);
10365:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10366:             "ADBE Vector Filter - Repeater",
10367:           )("ADBE Vector Repeater Transform")(
10368:             "ADBE Vector Repeater Rotation",
10369:           ).expression =
10370:             'try { effect("ADBE easyRulers")("Gap")/5 } catch (err) { value }';
10371:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10372:             "ADBE Vector Filter - Repeater",
10373:           )("ADBE Vector Repeater Copies").expression =
10374:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
10375:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
10376:             1 +
10377:             '-content("Ruler").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
10378:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
10379:             1 +
10380:             '-content("Ruler Mirror").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } } else { Math.ceil(' +
10381:             (Number(EditTextCopies.text) - 1) +
10382:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
10383:             divideBy / 5 +
10384:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
10385:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
10386:             1 +
10387:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
10388:             divideBy / 5 +
10389:             "*100/" +
10390:             (Number(EditTextCopies.text) - 1) +
10391:             ")) } else { 0 }              }} catch(e) { value }";
10392:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10393:             "ADBE Vector Filter - Repeater",
10394:           )("ADBE Vector Repeater Transform")(
10395:             "ADBE Vector Repeater Opacity 1",
10396:           ).expression =
10397:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10398:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10399:             "ADBE Vector Filter - Repeater",
10400:           )("ADBE Vector Repeater Transform")(
10401:             "ADBE Vector Repeater Opacity 2",
10402:           ).expression =
10403:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
10404:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10405:             "ADBE Vector Filter - Repeater",
10406:           )("ADBE Vector Repeater Offset").expression =
10407:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) { ' +
10408:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
10409:             1 +
10410:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
10411:             (Number(EditTextCopies.text) - 1) +
10412:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
10413:             divideBy / 5 +
10414:             ")} else { 0 }             }} catch(e) { value }";
10415:           shorten("Fifth subdivisions - Secondary Color")(
10416:             "ADBE Vectors Group",
10417:           ).addProperty("ADBE Vector Filter - Offset")(
10418:             "ADBE Vector Offset Amount",
10419:           ).expression =
10420:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10421:           shorten("Fifth subdivisions - Secondary Color")(
10422:             "ADBE Vectors Group",
10423:           ).addProperty("ADBE Vector Filter - Trim")(
10424:             "ADBE Vector Trim End",
10425:           ).expression =
10426:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
10427:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10428:             "ADBE Vector Filter - Trim",
10429:           )("ADBE Vector Trim Offset").expression =
10430:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
10431:           shorten("Fifth subdivisions - Secondary Color")(
10432:             "ADBE Vectors Group",
10433:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
10434:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10435:             "Stroke End",
10436:           )("ADBE Vector Stroke Width").expression =
10437:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10438:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10439:             "Stroke End",
10440:           )("ADBE Vector Stroke Color").expression =
10441:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
10442:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
10443:             "Stroke End",
10444:           )("ADBE Vector Stroke Opacity").expression =
10445:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
10446:           shorten("Fifth subdivisions - Secondary Color")(
10447:             "ADBE Vector Transform Group",
10448:           )("ADBE Vector Group Opacity").expression =
10449:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
10450:           app.project.activeItem
10451:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
10452:             .duplicate().name = "Ruler Mirror";
10453:           app.project.activeItem
10454:             .layer(
10455:               shapeLayer.name,
10456:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
10457:             .setValue(60);
10458:           app.project.activeItem
10459:             .layer(
10460:               shapeLayer.name,
10461:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
10462:             .setValue(-180);
10463:           app.project.activeItem
10464:             .layer(
10465:               shapeLayer.name,
10466:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
10467:             .setValue([0, 425]);
10468:           app.project.activeItem.layer(shapeLayer.name)(
10469:             "ADBE Root Vectors Group",
10470:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
10471:           if (SidesType.selection.index !== 0) {
10472:             app.project.activeItem.layer(shapeLayer.name)(
10473:               "ADBE Root Vectors Group",
10474:             )("Ruler Mirror")("ADBE Vector Transform Group")(
10475:               "ADBE Vector Scale",
10476:             ).expression =
10477:               'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] }';
10478:             app.project.activeItem.layer(shapeLayer.name)(
10479:               "ADBE Root Vectors Group",
10480:             )("Ruler Mirror")("ADBE Vector Transform Group")(
10481:               "ADBE Vector Rotation",
10482:             ).expression =
10483:               'try { -effect("ADBE easyRulers")("Width")/5.75 } catch(e) { value }';
10484:             app.project.activeItem.layer(shapeLayer.name)(
10485:               "ADBE Root Vectors Group",
10486:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
10487:               "ADBE Vector Transform Group",
10488:             )("ADBE Vector Anchor").expression =
10489:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
10490:             app.project.activeItem.layer(shapeLayer.name)(
10491:               "ADBE Root Vectors Group",
10492:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
10493:               "ADBE Vectors Group",
10494:             )("ADBE Vector Filter - Offset")(
10495:               "ADBE Vector Offset Amount",
10496:             ).expression =
10497:               'try { -effect("ADBE easyRulers")("Height Bias")-effect("ADBE easyRulers")("Height") } catch(e) { value }';
10498:             app.project.activeItem.layer(shapeLayer.name)(
10499:               "ADBE Root Vectors Group",
10500:             )("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions")(
10501:               "ADBE Vectors Group",
10502:             )("ADBE Vector Filter - Offset")(
10503:               "ADBE Vector Offset Amount",
10504:             ).expression =
10505:               'try { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height") } catch(e) { value }';
10506:             app.project.activeItem.layer(shapeLayer.name)(
10507:               "ADBE Root Vectors Group",
10508:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
10509:               "ADBE Vectors Group",
10510:             )("ADBE Vector Filter - Offset")(
10511:               "ADBE Vector Offset Amount",
10512:             ).expression =
10513:               'try { -effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height") } catch(e) { value }';
10514:             app.project.activeItem.layer(shapeLayer.name)(
10515:               "ADBE Root Vectors Group",
10516:             )("Ruler Mirror")("ADBE Vectors Group")(
10517:               "Big subdivisions Base Line",
10518:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
10519:               "ADBE Vector Offset Amount",
10520:             ).expression =
10521:               'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")*2 } else { 0 } } catch(e) { value }';
10522:             app.project.activeItem.layer(shapeLayer.name)(
10523:               "ADBE Root Vectors Group",
10524:             )("Ruler Mirror")("ADBE Vectors Group")(
10525:               "Fifth subdivisions Base Line",
10526:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
10527:               "ADBE Vector Offset Amount",
10528:             ).expression =
10529:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2 > 0) { -effect("ADBE easyRulers")("Height Bias")*4 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
10530:           }
10531:           switch (BaseLineDropdown.selection.index) {
10532:             case 0:
10533:               app.project.activeItem
10534:                 .layer(
10535:                   shapeLayer.name,
10536:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
10537:                 .remove();
10538:               app.project.activeItem
10539:                 .layer(
10540:                   shapeLayer.name,
10541:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
10542:                 .remove();
10543:               app.project.activeItem
10544:                 .layer(
10545:                   shapeLayer.name,
10546:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
10547:                 .remove();
10548:               app.project.activeItem
10549:                 .layer(
10550:                   shapeLayer.name,
10551:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
10552:                 .remove();
10553:               app.project.activeItem
10554:                 .layer(
10555:                   shapeLayer.name,
10556:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
10557:                 .remove();
10558:               app.project.activeItem
10559:                 .layer(
10560:                   shapeLayer.name,
10561:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
10562:                 .remove();
10563:               break;
10564:             case 1:
10565:               app.project.activeItem
10566:                 .layer(
10567:                   shapeLayer.name,
10568:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
10569:                 .remove();
10570:               app.project.activeItem
10571:                 .layer(
10572:                   shapeLayer.name,
10573:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
10574:                 .remove();
10575:               app.project.activeItem
10576:                 .layer(
10577:                   shapeLayer.name,
10578:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
10579:                 .remove();
10580:               app.project.activeItem
10581:                 .layer(
10582:                   shapeLayer.name,
10583:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
10584:                 .remove();
10585:           }
10586:           switch (SidesType.selection.index) {
10587:             case 0:
10588:               app.project.activeItem
10589:                 .layer(
10590:                   shapeLayer.name,
10591:                 )("ADBE Root Vectors Group")("Ruler Mirror")
10592:                 .remove();
10593:               break;
10594:             case 1:
10595:               app.project.activeItem
10596:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
10597:                 .remove();
10598:               app.project.activeItem.layer(shapeLayer.name)(
10599:                 "ADBE Root Vectors Group",
10600:               )("Ruler Mirror")("ADBE Vector Transform Group")(
10601:                 "ADBE Vector Scale",
10602:               ).expression = "";
10603:               app.project.activeItem
10604:                 .layer(
10605:                   shapeLayer.name,
10606:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
10607:                 .setValue([90, 90]);
10608:               app.project.activeItem.layer(shapeLayer.name)(
10609:                 "ADBE Root Vectors Group",
10610:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
10611:           }
10612:         };
10613:         createBasic16_circle = function () {
10614:           shorten.addProperty("ADBE Vector Group").name = "Base line";
10615:           shorten("Base line")("ADBE Vectors Group")
10616:             .addProperty("ADBE Vector Shape - Group")
10617:             .path.setValue(shape);
10618:           shorten("Base line")("ADBE Vector Transform Group")(
10619:             "ADBE Vector Scale",
10620:           ).setValue([-80, -80]);
10621:           shorten("Base line")("ADBE Vectors Group").addProperty(
10622:             "ADBE Vector Graphic - Stroke",
10623:           )("ADBE Vector Stroke Color").expression =
10624:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
10625:           shorten("Base line")("ADBE Vectors Group")(
10626:             "ADBE Vector Graphic - Stroke",
10627:           )("ADBE Vector Stroke Width").expression =
10628:             'try { effect("ADBE easyRulers")("Width") } catch(e) { value }';
10629:           shorten("Base line")("ADBE Vectors Group").addProperty(
10630:             "ADBE Vector Filter - Trim",
10631:           )("ADBE Vector Trim End").expression =
10632:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
10633:             (EditTextCopies.text - 1) +
10634:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
10635:             (EditTextCopies.text - 1) +
10636:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
10637:           shorten("Base line")("ADBE Vectors Group")(
10638:             "ADBE Vector Filter - Trim",
10639:           )("ADBE Vector Trim Offset").expression =
10640:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
10641:             (EditTextCopies.text - 1) +
10642:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
10643:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
10644:           shorten("Big subdivisions")("ADBE Vectors Group")
10645:             .addProperty("ADBE Vector Shape - Group")
10646:             .path.setValue(shape);
10647:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
10648:             "ADBE Vector Scale",
10649:           ).setValue([-80, -80]);
10650:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
10651:             "ADBE Vector Graphic - Stroke",
10652:           )("ADBE Vector Stroke Color").expression =
10653:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
10654:           shorten("Big subdivisions")("ADBE Vectors Group")
10655:             .addProperty("ADBE Vector Filter - Repeater")(
10656:               "ADBE Vector Repeater Copies",
10657:             )
10658:             .setValue(
10659:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
10660:             );
10661:           shorten("Big subdivisions")("ADBE Vectors Group")(
10662:             "ADBE Vector Filter - Repeater",
10663:           )("ADBE Vector Repeater Transform")(
10664:             "ADBE Vector Repeater Rotation",
10665:           ).expression =
10666:             'try { effect("ADBE easyRulers")("Gap")/10*' +
10667:             divideBy +
10668:             " } catch(e) { value }";
10669:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
10670:             "ADBE Vector Filter - Offset",
10671:           )("ADBE Vector Offset Amount").expression =
10672:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*8-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10673:           shorten("Big subdivisions")("ADBE Vectors Group")(
10674:             "ADBE Vector Graphic - Stroke",
10675:           )("ADBE Vector Stroke Width").expression =
10676:             'try { effect("ADBE easyRulers")("Height Bias")*16 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10677:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
10678:             "ADBE Vector Filter - Trim",
10679:           )("ADBE Vector Trim End").expression =
10680:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
10681:           shorten("Big subdivisions")("ADBE Vectors Group")(
10682:             "ADBE Vector Filter - Trim",
10683:           )("ADBE Vector Trim Offset").expression =
10684:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
10685:           shorten.addProperty("ADBE Vector Group").name =
10686:             "Big subdivisions Base Line";
10687:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
10688:             .addProperty("ADBE Vector Shape - Group")
10689:             .path.setValue(shape);
10690:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
10691:             "ADBE Vector Scale",
10692:           ).setValue([-80, -80]);
10693:           shorten("Big subdivisions Base Line")(
10694:             "ADBE Vectors Group",
10695:           ).addProperty("ADBE Vector Graphic - Stroke")(
10696:             "ADBE Vector Stroke Color",
10697:           ).expression =
10698:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
10699:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
10700:             "ADBE Vector Graphic - Stroke",
10701:           )("ADBE Vector Stroke Width").expression =
10702:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
10703:           shorten("Big subdivisions Base Line")(
10704:             "ADBE Vectors Group",
10705:           ).addProperty("ADBE Vector Filter - Offset")(
10706:             "ADBE Vector Offset Amount",
10707:           ).expression =
10708:             'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2; } else { 0 } } catch(e) { value };';
10709:           shorten("Big subdivisions Base Line")(
10710:             "ADBE Vectors Group",
10711:           ).addProperty("ADBE Vector Filter - Trim")(
10712:             "ADBE Vector Trim End",
10713:           ).expression =
10714:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
10715:             (EditTextCopies.text - 1) +
10716:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
10717:             (EditTextCopies.text - 1) +
10718:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
10719:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
10720:             "ADBE Vector Filter - Trim",
10721:           )("ADBE Vector Trim Offset").expression =
10722:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
10723:             (EditTextCopies.text - 1) +
10724:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
10725:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
10726:           shorten("Half subdivisions")("ADBE Vectors Group")
10727:             .addProperty("ADBE Vector Shape - Group")
10728:             .path.setValue(shape);
10729:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
10730:             "ADBE Vector Scale",
10731:           ).setValue([-80, -80]);
10732:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
10733:             "ADBE Vector Graphic - Stroke",
10734:           )("ADBE Vector Stroke Color").expression =
10735:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
10736:           shorten("Half subdivisions")("ADBE Vectors Group")
10737:             .addProperty("ADBE Vector Filter - Repeater")(
10738:               "ADBE Vector Repeater Copies",
10739:             )
10740:             .setValue(Math.floor((Number(EditTextCopies.text - 1) + 8) / 16));
10741:           shorten("Half subdivisions")("ADBE Vectors Group")(
10742:             "ADBE Vector Filter - Repeater",
10743:           )("ADBE Vector Repeater Offset").setValue(0.5);
10744:           shorten("Half subdivisions")("ADBE Vectors Group")(
10745:             "ADBE Vector Filter - Repeater",
10746:           )("ADBE Vector Repeater Transform")(
10747:             "ADBE Vector Repeater Rotation",
10748:           ).expression =
10749:             'try { effect("ADBE easyRulers")("Gap")*1.6 } catch(e) { value }';
10750:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
10751:             "ADBE Vector Filter - Offset",
10752:           )("ADBE Vector Offset Amount").expression =
10753:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10754:           shorten("Half subdivisions")("ADBE Vectors Group")(
10755:             "ADBE Vector Graphic - Stroke",
10756:           )("ADBE Vector Stroke Width").expression =
10757:             'try { effect("ADBE easyRulers")("Height Bias")*8 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10758:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
10759:             "ADBE Vector Filter - Trim",
10760:           )("ADBE Vector Trim End").expression =
10761:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
10762:           shorten("Half subdivisions")("ADBE Vectors Group")(
10763:             "ADBE Vector Filter - Trim",
10764:           )("ADBE Vector Trim Offset").expression =
10765:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
10766:           shorten.addProperty("ADBE Vector Group").name =
10767:             "Half subdivisions Base Line";
10768:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
10769:             .addProperty("ADBE Vector Shape - Group")
10770:             .path.setValue(shape);
10771:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
10772:             "ADBE Vector Scale",
10773:           ).setValue([-80, -80]);
10774:           shorten("Half subdivisions Base Line")(
10775:             "ADBE Vectors Group",
10776:           ).addProperty("ADBE Vector Graphic - Stroke")(
10777:             "ADBE Vector Stroke Color",
10778:           ).expression =
10779:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
10780:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
10781:             "ADBE Vector Graphic - Stroke",
10782:           )("ADBE Vector Stroke Width").expression =
10783:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
10784:           shorten("Half subdivisions Base Line")(
10785:             "ADBE Vectors Group",
10786:           ).addProperty("ADBE Vector Filter - Offset")(
10787:             "ADBE Vector Offset Amount",
10788:           ).expression =
10789:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2)>0) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
10790:           shorten("Half subdivisions Base Line")(
10791:             "ADBE Vectors Group",
10792:           ).addProperty("ADBE Vector Filter - Trim")(
10793:             "ADBE Vector Trim End",
10794:           ).expression =
10795:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
10796:             (EditTextCopies.text - 1) +
10797:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
10798:             (EditTextCopies.text - 1) +
10799:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
10800:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
10801:             "ADBE Vector Filter - Trim",
10802:           )("ADBE Vector Trim Offset").expression =
10803:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
10804:             (EditTextCopies.text - 1) +
10805:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
10806:           shorten.addProperty("ADBE Vector Group").name =
10807:             "Quarter subdivisions";
10808:           shorten("Quarter subdivisions")("ADBE Vectors Group")
10809:             .addProperty("ADBE Vector Shape - Group")
10810:             .path.setValue(shape);
10811:           shorten("Quarter subdivisions")("ADBE Vector Transform Group")(
10812:             "ADBE Vector Scale",
10813:           ).setValue([-80, -80]);
10814:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
10815:             "ADBE Vector Graphic - Stroke",
10816:           )("ADBE Vector Stroke Color").expression =
10817:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
10818:           shorten("Quarter subdivisions")("ADBE Vectors Group")
10819:             .addProperty("ADBE Vector Filter - Repeater")(
10820:               "ADBE Vector Repeater Copies",
10821:             )
10822:             .setValue(Math.floor((Number(EditTextCopies.text - 1) + 4) / 8));
10823:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
10824:             "ADBE Vector Filter - Repeater",
10825:           )("ADBE Vector Repeater Offset").setValue(0.5);
10826:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
10827:             "ADBE Vector Filter - Repeater",
10828:           )("ADBE Vector Repeater Transform")(
10829:             "ADBE Vector Repeater Rotation",
10830:           ).expression =
10831:             'try { effect("ADBE easyRulers")("Gap")/1.25 } catch(e) { value }';
10832:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
10833:             "ADBE Vector Filter - Offset",
10834:           )("ADBE Vector Offset Amount").expression =
10835:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10836:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
10837:             "ADBE Vector Graphic - Stroke",
10838:           )("ADBE Vector Stroke Width").expression =
10839:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10840:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
10841:             "ADBE Vector Filter - Trim",
10842:           )("ADBE Vector Trim End").expression =
10843:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
10844:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
10845:             "ADBE Vector Filter - Trim",
10846:           )("ADBE Vector Trim Offset").expression =
10847:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
10848:           shorten.addProperty("ADBE Vector Group").name =
10849:             "Quarter subdivisions Base Line";
10850:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")
10851:             .addProperty("ADBE Vector Shape - Group")
10852:             .path.setValue(shape);
10853:           shorten("Quarter subdivisions Base Line")(
10854:             "ADBE Vector Transform Group",
10855:           )("ADBE Vector Scale").setValue([-80, -80]);
10856:           shorten("Quarter subdivisions Base Line")(
10857:             "ADBE Vectors Group",
10858:           ).addProperty("ADBE Vector Graphic - Stroke")(
10859:             "ADBE Vector Stroke Color",
10860:           ).expression =
10861:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
10862:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
10863:             "ADBE Vector Graphic - Stroke",
10864:           )("ADBE Vector Stroke Width").expression =
10865:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
10866:           shorten("Quarter subdivisions Base Line")(
10867:             "ADBE Vectors Group",
10868:           ).addProperty("ADBE Vector Filter - Offset")(
10869:             "ADBE Vector Offset Amount",
10870:           ).expression =
10871:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/4)>0) { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
10872:           shorten("Quarter subdivisions Base Line")(
10873:             "ADBE Vectors Group",
10874:           ).addProperty("ADBE Vector Filter - Trim")(
10875:             "ADBE Vector Trim End",
10876:           ).expression =
10877:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
10878:             (EditTextCopies.text - 1) +
10879:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
10880:             (EditTextCopies.text - 1) +
10881:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
10882:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
10883:             "ADBE Vector Filter - Trim",
10884:           )("ADBE Vector Trim Offset").expression =
10885:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
10886:             (EditTextCopies.text - 1) +
10887:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
10888:           shorten.addProperty("ADBE Vector Group").name =
10889:             "Main lines - Secondary Color";
10890:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
10891:           shorten("Main lines")("ADBE Vectors Group")
10892:             .addProperty("ADBE Vector Shape - Group")
10893:             .path.setValue(shape);
10894:           shorten("Main lines")("ADBE Vector Transform Group")(
10895:             "ADBE Vector Scale",
10896:           ).setValue([-80, -80]);
10897:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10898:             "ADBE Vector Filter - Offset",
10899:           )("ADBE Vector Offset Amount").expression =
10900:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch(e) { value }';
10901:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10902:             "ADBE Vector Filter - Trim",
10903:           )("ADBE Vector Trim End").expression =
10904:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
10905:           shorten("Main lines")("ADBE Vectors Group")(
10906:             "ADBE Vector Filter - Trim",
10907:           )("ADBE Vector Trim Offset").expression =
10908:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
10909:           shorten("Main lines")("ADBE Vectors Group")
10910:             .addProperty(
10911:               "ADBE Vector Filter - Repeater",
10912:             )("ADBE Vector Repeater Copies")
10913:             .setValue(3);
10914:           shorten("Main lines")("ADBE Vectors Group")(
10915:             "ADBE Vector Filter - Repeater",
10916:           )("ADBE Vector Repeater Transform")(
10917:             "ADBE Vector Repeater Rotation",
10918:           ).expression =
10919:             'try { effect("ADBE easyRulers")("Gap")/10 } catch(e) { value }';
10920:           shorten("Main lines")("ADBE Vectors Group")(
10921:             "ADBE Vector Filter - Repeater",
10922:           )("ADBE Vector Repeater Offset").setValue(1);
10923:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10924:             "ADBE Vector Filter - Repeater",
10925:           ).name = "Repeater Group";
10926:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
10927:             "ADBE Vector Repeater Copies",
10928:           ).setValue(Math.ceil((Number(EditTextCopies.text) - 1) / 4));
10929:           shorten("Main lines")("ADBE Vectors Group")("Repeater Group")(
10930:             "ADBE Vector Repeater Transform",
10931:           )("ADBE Vector Repeater Rotation").expression =
10932:             'try { effect("ADBE easyRulers")("Gap")/2.5 } catch(e) { value }';
10933:           if (
10934:             (EditTextCopies.text - 1) % 4 > 0 &&
10935:             (EditTextCopies.text - 1) % 4 < 3
10936:           ) {
10937:             shorten("Main lines")("ADBE Vectors Group").addProperty(
10938:               "ADBE Vector Filter - Trim",
10939:             ).name = "Trim Last";
10940:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
10941:               "ADBE Vector Trim End",
10942:             ).expression =
10943:               "try { " +
10944:               (100 -
10945:                 (3 - ((EditTextCopies.text - 1) % 4)) *
10946:                   (100 / (3 * Math.ceil((EditTextCopies.text - 1) / 4)))) +
10947:               " } catch(e) { value }";
10948:             shorten("Main lines")("ADBE Vectors Group")("Trim Last")(
10949:               "ADBE Vector Trim Type",
10950:             ).setValue(2);
10951:           }
10952:           shorten("Main lines")("ADBE Vectors Group").addProperty(
10953:             "ADBE Vector Graphic - Stroke",
10954:           )("ADBE Vector Stroke Color").expression =
10955:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
10956:           shorten("Main lines")("ADBE Vectors Group")(
10957:             "ADBE Vector Graphic - Stroke",
10958:           )("ADBE Vector Stroke Width").expression =
10959:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
10960:           app.project.activeItem.layer(shapeLayer.name)(
10961:             "ADBE Root Vectors Group",
10962:           )("Ruler")("ADBE Vector Transform Group")(
10963:             "ADBE Vector Rotation",
10964:           ).expression =
10965:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
10966:           createPointerCircular();
10967:           t("ADBE easyRulers")("Width").setValue(2);
10968:           t("ADBE easyRulers")("default Width").setValue(2);
10969:           t("ADBE easyRulers")("Height").setValue(2);
10970:           t("ADBE easyRulers")("default Height").setValue(2);
10971:           t("ADBE easyRulers")("Height Bias").setValue(3);
10972:           t("ADBE easyRulers")("default Height Bias").setValue(3);
10973:           switch (SidesType.selection.index) {
10974:             case 0:
10975:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(160);
10976:               t("ADBE easyRulers")("default Pointer Distance").setValue(160);
10977:               break;
10978:             case 1:
10979:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(200);
10980:               t("ADBE easyRulers")("default Pointer Distance").setValue(200);
10981:               break;
10982:             case 2:
10983:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(100);
10984:               t("ADBE easyRulers")("default Pointer Distance").setValue(100);
10985:               t("ADBE easyRulers")("Sides Distance").setValue(-10);
10986:               t("ADBE easyRulers")("default Sides Distance").setValue(-10);
10987:           }
10988:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
10989:             .addProperty("ADBE Vector Shape - Group")
10990:             .path.setValue(shape);
10991:           shorten("Main lines - Secondary Color")(
10992:             "ADBE Vector Transform Group",
10993:           )("ADBE Vector Scale").setValue([-80, -80]);
10994:           shorten("Main lines - Secondary Color")(
10995:             "ADBE Vectors Group",
10996:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke Start";
10997:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
10998:             "Stroke Start",
10999:           )("ADBE Vector Stroke Color").expression =
11000:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
11001:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11002:             "Stroke Start",
11003:           )("ADBE Vector Stroke Width").expression =
11004:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11005:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11006:             "Stroke Start",
11007:           )("ADBE Vector Stroke Opacity").expression =
11008:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
11009:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")
11010:             .addProperty(
11011:               "ADBE Vector Filter - Repeater",
11012:             )("ADBE Vector Repeater Copies")
11013:             .setValue(EditTextCopies.text);
11014:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11015:             "ADBE Vector Filter - Repeater",
11016:           )("ADBE Vector Repeater Transform")(
11017:             "ADBE Vector Repeater Rotation",
11018:           ).expression =
11019:             'try { effect("ADBE easyRulers")("Gap")/10 } catch (err) { value }';
11020:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11021:             "ADBE Vector Filter - Repeater",
11022:           )("ADBE Vector Repeater Copies").expression =
11023:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
11024:             EditTextCopies.text +
11025:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
11026:             (Number(EditTextCopies.text) - 1) +
11027:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
11028:             (Number(EditTextCopies.text) - 1) +
11029:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
11030:             EditTextCopies.text +
11031:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
11032:             (Number(EditTextCopies.text) - 1) +
11033:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
11034:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11035:             "ADBE Vector Filter - Repeater",
11036:           )("ADBE Vector Repeater Transform")(
11037:             "ADBE Vector Repeater Opacity 1",
11038:           ).expression =
11039:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11040:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11041:             "ADBE Vector Filter - Repeater",
11042:           )("ADBE Vector Repeater Transform")(
11043:             "ADBE Vector Repeater Opacity 2",
11044:           ).expression =
11045:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11046:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11047:             "ADBE Vector Filter - Repeater",
11048:           )("ADBE Vector Repeater Offset").expression =
11049:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
11050:             (Number(EditTextCopies.text) - 1) +
11051:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
11052:             (Number(EditTextCopies.text) - 1) +
11053:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }             }} catch(e) { value }';
11054:           shorten("Main lines - Secondary Color")(
11055:             "ADBE Vectors Group",
11056:           ).addProperty("ADBE Vector Filter - Offset")(
11057:             "ADBE Vector Offset Amount",
11058:           ).expression =
11059:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch (err) { effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height") } } catch (err) { value }';
11060:           shorten("Main lines - Secondary Color")(
11061:             "ADBE Vectors Group",
11062:           ).addProperty("ADBE Vector Filter - Trim")(
11063:             "ADBE Vector Trim End",
11064:           ).expression =
11065:             'try { effect("ADBE easyRulers")("Width")/10 } catch (err) { value }';
11066:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11067:             "ADBE Vector Filter - Trim",
11068:           )("ADBE Vector Trim Offset").expression =
11069:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch (err) { value }';
11070:           shorten("Main lines - Secondary Color")(
11071:             "ADBE Vectors Group",
11072:           ).addProperty("ADBE Vector Graphic - Stroke").name = "Stroke End";
11073:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11074:             "Stroke End",
11075:           )("ADBE Vector Stroke Width").expression =
11076:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11077:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11078:             "Stroke End",
11079:           )("ADBE Vector Stroke Color").expression =
11080:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
11081:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
11082:             "Stroke End",
11083:           )("ADBE Vector Stroke Opacity").expression =
11084:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
11085:           shorten("Main lines - Secondary Color")(
11086:             "ADBE Vector Transform Group",
11087:           )("ADBE Vector Group Opacity").expression =
11088:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
11089:           secondary_lines = app.project.activeItem
11090:             .layer(
11091:               shapeLayer.name,
11092:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
11093:             .duplicate();
11094:           secondary_lines.name = "Big subdivisions - Secondary Color";
11095:           secondary_lines("ADBE Vectors Group")(
11096:             "ADBE Vector Filter - Repeater",
11097:           )("ADBE Vector Repeater Copies").expression =
11098:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
11099:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
11100:             1 +
11101:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
11102:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
11103:             1 +
11104:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
11105:             (Number(EditTextCopies.text) - 1) +
11106:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
11107:             divideBy +
11108:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
11109:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
11110:             1 +
11111:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion") / ((value-1)*' +
11112:             divideBy +
11113:             "*100/" +
11114:             (Number(EditTextCopies.text) - 1) +
11115:             ")) } else { 0 }              }} catch(e) { value }";
11116:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
11117:             "ADBE Vector Stroke Opacity",
11118:           ).expression =
11119:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0;  } catch(e) { value }';
11120:           secondary_lines("ADBE Vector Transform Group")(
11121:             "ADBE Vector Group Opacity",
11122:           ).expression =
11123:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
11124:           secondary_lines("ADBE Vectors Group")(
11125:             "ADBE Vector Graphic - Stroke",
11126:           ).name = "Stroke Start";
11127:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
11128:             "ADBE Vector Stroke Color",
11129:           ).expression =
11130:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
11131:           secondary_lines("ADBE Vectors Group")(
11132:             "ADBE Vector Filter - Repeater",
11133:           )("ADBE Vector Repeater Offset").expression =
11134:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
11135:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
11136:             1 +
11137:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
11138:             (Number(EditTextCopies.text) - 1) +
11139:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
11140:             divideBy +
11141:             ")} else { 0 }              }} catch(e) { value }";
11142:           secondary_lines("ADBE Vectors Group")(
11143:             "ADBE Vector Filter - Repeater",
11144:           )("ADBE Vector Repeater Transform")(
11145:             "ADBE Vector Repeater Opacity 1",
11146:           ).expression =
11147:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11148:           secondary_lines("ADBE Vectors Group")(
11149:             "ADBE Vector Filter - Repeater",
11150:           )("ADBE Vector Repeater Transform")(
11151:             "ADBE Vector Repeater Opacity 2",
11152:           ).expression =
11153:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11154:           secondary_lines("ADBE Vectors Group").addProperty(
11155:             "ADBE Vector Graphic - Stroke",
11156:           ).name = "Stroke End";
11157:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11158:             "ADBE Vector Stroke Width",
11159:           ).expression =
11160:             'try { effect("ADBE easyRulers")("Height Bias")*16+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11161:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11162:             "ADBE Vector Stroke Color",
11163:           ).expression =
11164:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
11165:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11166:             "ADBE Vector Stroke Opacity",
11167:           ).expression =
11168:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
11169:           secondary_lines = app.project.activeItem
11170:             .layer(
11171:               shapeLayer.name,
11172:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
11173:             .duplicate();
11174:           secondary_lines.name = "Half subdivisions - Secondary Color";
11175:           secondary_lines("ADBE Vectors Group")(
11176:             "ADBE Vector Filter - Repeater",
11177:           )("ADBE Vector Repeater Copies").expression =
11178:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
11179:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
11180:             1 +
11181:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
11182:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
11183:             1 +
11184:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
11185:             (Number(EditTextCopies.text) - 1) +
11186:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
11187:             divideBy / 2 +
11188:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
11189:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
11190:             1 +
11191:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
11192:             divideBy / 2 +
11193:             "*100/" +
11194:             (Number(EditTextCopies.text) - 1) +
11195:             ")) } else { 0 }              }} catch(e) { value }";
11196:           secondary_lines("ADBE Vectors Group")(
11197:             "ADBE Vector Filter - Repeater",
11198:           )("ADBE Vector Repeater Transform")(
11199:             "ADBE Vector Repeater Rotation",
11200:           ).expression =
11201:             'try { effect("ADBE easyRulers")("Gap")/1.25 } catch (err) { value }';
11202:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
11203:             "ADBE Vector Stroke Opacity",
11204:           ).expression =
11205:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
11206:           secondary_lines("ADBE Vector Transform Group")(
11207:             "ADBE Vector Group Opacity",
11208:           ).expression =
11209:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
11210:           secondary_lines("ADBE Vectors Group")(
11211:             "ADBE Vector Graphic - Stroke",
11212:           ).name = "Stroke Start";
11213:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
11214:             "ADBE Vector Stroke Color",
11215:           ).expression =
11216:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
11217:           secondary_lines("ADBE Vectors Group")(
11218:             "ADBE Vector Filter - Repeater",
11219:           )("ADBE Vector Repeater Offset").expression =
11220:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
11221:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
11222:             1 +
11223:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
11224:             (Number(EditTextCopies.text) - 1) +
11225:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
11226:             divideBy / 2 +
11227:             ")} else { 0 }              }} catch(e) { value }";
11228:           secondary_lines("ADBE Vectors Group")(
11229:             "ADBE Vector Filter - Repeater",
11230:           )("ADBE Vector Repeater Transform")(
11231:             "ADBE Vector Repeater Opacity 1",
11232:           ).expression =
11233:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11234:           secondary_lines("ADBE Vectors Group")(
11235:             "ADBE Vector Filter - Repeater",
11236:           )("ADBE Vector Repeater Transform")(
11237:             "ADBE Vector Repeater Opacity 2",
11238:           ).expression =
11239:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11240:           secondary_lines("ADBE Vectors Group").addProperty(
11241:             "ADBE Vector Graphic - Stroke",
11242:           ).name = "Stroke End";
11243:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11244:             "ADBE Vector Stroke Width",
11245:           ).expression =
11246:             'try { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11247:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11248:             "ADBE Vector Stroke Color",
11249:           ).expression =
11250:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
11251:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11252:             "ADBE Vector Stroke Opacity",
11253:           ).expression =
11254:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
11255:           secondary_lines = app.project.activeItem
11256:             .layer(
11257:               shapeLayer.name,
11258:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
11259:             .duplicate();
11260:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
11261:           secondary_lines("ADBE Vectors Group")(
11262:             "ADBE Vector Filter - Repeater",
11263:           )("ADBE Vector Repeater Copies").expression =
11264:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
11265:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
11266:             1 +
11267:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
11268:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
11269:             1 +
11270:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
11271:             (Number(EditTextCopies.text) - 1) +
11272:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
11273:             divideBy / 4 +
11274:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
11275:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
11276:             1 +
11277:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
11278:             divideBy / 4 +
11279:             "*100/" +
11280:             (Number(EditTextCopies.text) - 1) +
11281:             ")) } else { 0 }              }} catch(e) { value }";
11282:           secondary_lines("ADBE Vectors Group")(
11283:             "ADBE Vector Filter - Repeater",
11284:           )("ADBE Vector Repeater Transform")(
11285:             "ADBE Vector Repeater Rotation",
11286:           ).expression =
11287:             'try { effect("ADBE easyRulers")("Gap")/2.5 } catch (err) { value }';
11288:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
11289:             "ADBE Vector Stroke Opacity",
11290:           ).expression =
11291:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
11292:           secondary_lines("ADBE Vector Transform Group")(
11293:             "ADBE Vector Group Opacity",
11294:           ).expression =
11295:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
11296:           secondary_lines("ADBE Vectors Group")(
11297:             "ADBE Vector Graphic - Stroke",
11298:           ).name = "Stroke Start";
11299:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
11300:             "ADBE Vector Stroke Color",
11301:           ).expression =
11302:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
11303:           secondary_lines("ADBE Vectors Group")(
11304:             "ADBE Vector Filter - Repeater",
11305:           )("ADBE Vector Repeater Offset").expression =
11306:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
11307:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
11308:             1 +
11309:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
11310:             (Number(EditTextCopies.text) - 1) +
11311:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
11312:             divideBy / 4 +
11313:             ")} else { 0 }              }} catch(e) { value }";
11314:           secondary_lines("ADBE Vectors Group")(
11315:             "ADBE Vector Filter - Repeater",
11316:           )("ADBE Vector Repeater Transform")(
11317:             "ADBE Vector Repeater Opacity 1",
11318:           ).expression =
11319:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11320:           secondary_lines("ADBE Vectors Group")(
11321:             "ADBE Vector Filter - Repeater",
11322:           )("ADBE Vector Repeater Transform")(
11323:             "ADBE Vector Repeater Opacity 2",
11324:           ).expression =
11325:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
11326:           secondary_lines("ADBE Vectors Group").addProperty(
11327:             "ADBE Vector Graphic - Stroke",
11328:           ).name = "Stroke End";
11329:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11330:             "ADBE Vector Stroke Width",
11331:           ).expression =
11332:             'try { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11333:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11334:             "ADBE Vector Stroke Color",
11335:           ).expression =
11336:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
11337:           secondary_lines("ADBE Vectors Group")("Stroke End")(
11338:             "ADBE Vector Stroke Opacity",
11339:           ).expression =
11340:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
11341:           app.project.activeItem
11342:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
11343:             .duplicate().name = "Ruler Mirror";
11344:           app.project.activeItem
11345:             .layer(
11346:               shapeLayer.name,
11347:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
11348:             .setValue(60);
11349:           app.project.activeItem
11350:             .layer(
11351:               shapeLayer.name,
11352:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
11353:             .setValue(-180);
11354:           app.project.activeItem
11355:             .layer(
11356:               shapeLayer.name,
11357:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
11358:             .setValue([0, 425]);
11359:           app.project.activeItem.layer(shapeLayer.name)(
11360:             "ADBE Root Vectors Group",
11361:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
11362:           if (SidesType.selection.index !== 0) {
11363:             app.project.activeItem.layer(shapeLayer.name)(
11364:               "ADBE Root Vectors Group",
11365:             )("Ruler Mirror")("ADBE Vector Transform Group")(
11366:               "ADBE Vector Scale",
11367:             ).expression =
11368:               'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] }';
11369:             app.project.activeItem.layer(shapeLayer.name)(
11370:               "ADBE Root Vectors Group",
11371:             )("Ruler Mirror")("ADBE Vector Transform Group")(
11372:               "ADBE Vector Rotation",
11373:             ).expression =
11374:               'try { -effect("ADBE easyRulers")("Width")/5.75 } catch(e) { value }';
11375:             app.project.activeItem.layer(shapeLayer.name)(
11376:               "ADBE Root Vectors Group",
11377:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
11378:               "ADBE Vector Transform Group",
11379:             )("ADBE Vector Anchor").expression =
11380:               'try { [value[0], value[1]-effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
11381:             app.project.activeItem.layer(shapeLayer.name)(
11382:               "ADBE Root Vectors Group",
11383:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
11384:               "ADBE Vectors Group",
11385:             )("ADBE Vector Filter - Offset")(
11386:               "ADBE Vector Offset Amount",
11387:             ).expression =
11388:               'try { -effect("ADBE easyRulers")("Height Bias")-effect("ADBE easyRulers")("Height") } catch(e) { value }';
11389:             app.project.activeItem.layer(shapeLayer.name)(
11390:               "ADBE Root Vectors Group",
11391:             )("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")(
11392:               "ADBE Vectors Group",
11393:             )("ADBE Vector Filter - Offset")(
11394:               "ADBE Vector Offset Amount",
11395:             ).expression =
11396:               'try { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height") } catch(e) { value }';
11397:             app.project.activeItem.layer(shapeLayer.name)(
11398:               "ADBE Root Vectors Group",
11399:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
11400:               "ADBE Vectors Group",
11401:             )("ADBE Vector Filter - Offset")(
11402:               "ADBE Vector Offset Amount",
11403:             ).expression =
11404:               'try { -effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height") } catch(e) { value }';
11405:             app.project.activeItem.layer(shapeLayer.name)(
11406:               "ADBE Root Vectors Group",
11407:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
11408:               "ADBE Vectors Group",
11409:             )("ADBE Vector Filter - Offset")(
11410:               "ADBE Vector Offset Amount",
11411:             ).expression =
11412:               'try { -effect("ADBE easyRulers")("Height Bias")*8-effect("ADBE easyRulers")("Height") } catch(e) { value }';
11413:             app.project.activeItem.layer(shapeLayer.name)(
11414:               "ADBE Root Vectors Group",
11415:             )("Ruler Mirror")("ADBE Vectors Group")(
11416:               "Big subdivisions Base Line",
11417:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
11418:               "ADBE Vector Offset Amount",
11419:             ).expression =
11420:               'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")*2 } else { 0 } } catch(e) { value }';
11421:             app.project.activeItem.layer(shapeLayer.name)(
11422:               "ADBE Root Vectors Group",
11423:             )("Ruler Mirror")("ADBE Vectors Group")(
11424:               "Half subdivisions Base Line",
11425:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
11426:               "ADBE Vector Offset Amount",
11427:             ).expression =
11428:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2 > 0) { -effect("ADBE easyRulers")("Height Bias")*4 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
11429:             app.project.activeItem.layer(shapeLayer.name)(
11430:               "ADBE Root Vectors Group",
11431:             )("Ruler Mirror")("ADBE Vectors Group")(
11432:               "Quarter subdivisions Base Line",
11433:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
11434:               "ADBE Vector Offset Amount",
11435:             ).expression =
11436:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/4 > 0) { -effect("ADBE easyRulers")("Height Bias")*8 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
11437:           }
11438:           switch (BaseLineDropdown.selection.index) {
11439:             case 0:
11440:               app.project.activeItem
11441:                 .layer(
11442:                   shapeLayer.name,
11443:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
11444:                 .remove();
11445:               app.project.activeItem
11446:                 .layer(
11447:                   shapeLayer.name,
11448:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
11449:                 .remove();
11450:               app.project.activeItem
11451:                 .layer(
11452:                   shapeLayer.name,
11453:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
11454:                 .remove();
11455:               app.project.activeItem
11456:                 .layer(
11457:                   shapeLayer.name,
11458:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
11459:                 .remove();
11460:               app.project.activeItem
11461:                 .layer(
11462:                   shapeLayer.name,
11463:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
11464:                 .remove();
11465:               app.project.activeItem
11466:                 .layer(
11467:                   shapeLayer.name,
11468:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
11469:                 .remove();
11470:               app.project.activeItem
11471:                 .layer(
11472:                   shapeLayer.name,
11473:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
11474:                 .remove();
11475:               app.project.activeItem
11476:                 .layer(
11477:                   shapeLayer.name,
11478:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
11479:                 .remove();
11480:               break;
11481:             case 1:
11482:               app.project.activeItem
11483:                 .layer(
11484:                   shapeLayer.name,
11485:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
11486:                 .remove();
11487:               app.project.activeItem
11488:                 .layer(
11489:                   shapeLayer.name,
11490:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
11491:                 .remove();
11492:               app.project.activeItem
11493:                 .layer(
11494:                   shapeLayer.name,
11495:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
11496:                 .remove();
11497:               app.project.activeItem
11498:                 .layer(
11499:                   shapeLayer.name,
11500:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
11501:                 .remove();
11502:               app.project.activeItem
11503:                 .layer(
11504:                   shapeLayer.name,
11505:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
11506:                 .remove();
11507:               app.project.activeItem
11508:                 .layer(
11509:                   shapeLayer.name,
11510:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
11511:                 .remove();
11512:           }
11513:           switch (SidesType.selection.index) {
11514:             case 0:
11515:               app.project.activeItem
11516:                 .layer(
11517:                   shapeLayer.name,
11518:                 )("ADBE Root Vectors Group")("Ruler Mirror")
11519:                 .remove();
11520:               break;
11521:             case 1:
11522:               app.project.activeItem
11523:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
11524:                 .remove();
11525:               app.project.activeItem.layer(shapeLayer.name)(
11526:                 "ADBE Root Vectors Group",
11527:               )("Ruler Mirror")("ADBE Vector Transform Group")(
11528:                 "ADBE Vector Scale",
11529:               ).expression = "";
11530:               app.project.activeItem
11531:                 .layer(
11532:                   shapeLayer.name,
11533:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
11534:                 .setValue([90, 90]);
11535:               app.project.activeItem.layer(shapeLayer.name)(
11536:                 "ADBE Root Vectors Group",
11537:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
11538:           }
11539:         };
11540:         createBasic16b_circle = function () {
11541:           shorten.addProperty("ADBE Vector Group").name = "Base line";
11542:           shorten("Base line")("ADBE Vectors Group")
11543:             .addProperty("ADBE Vector Shape - Group")
11544:             .path.setValue(shape);
11545:           shorten("Base line")("ADBE Vector Transform Group")(
11546:             "ADBE Vector Scale",
11547:           ).setValue([-75, -75]);
11548:           shorten("Base line")("ADBE Vectors Group").addProperty(
11549:             "ADBE Vector Graphic - Stroke",
11550:           )("ADBE Vector Stroke Color").expression =
11551:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
11552:           shorten("Base line")("ADBE Vectors Group")(
11553:             "ADBE Vector Graphic - Stroke",
11554:           )("ADBE Vector Stroke Width").expression =
11555:             'try { effect("ADBE easyRulers")("Width") } catch(e) { value }';
11556:           shorten("Base line")("ADBE Vectors Group").addProperty(
11557:             "ADBE Vector Filter - Trim",
11558:           )("ADBE Vector Trim End").expression =
11559:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
11560:             (EditTextCopies.text - 1) +
11561:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
11562:             (EditTextCopies.text - 1) +
11563:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
11564:           shorten("Base line")("ADBE Vectors Group")(
11565:             "ADBE Vector Filter - Trim",
11566:           )("ADBE Vector Trim Offset").expression =
11567:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
11568:             (EditTextCopies.text - 1) +
11569:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
11570:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
11571:           shorten("Big subdivisions")("ADBE Vectors Group")
11572:             .addProperty("ADBE Vector Shape - Group")
11573:             .path.setValue(shape);
11574:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
11575:             "ADBE Vector Scale",
11576:           ).setValue([-75, -75]);
11577:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
11578:             "ADBE Vector Graphic - Stroke",
11579:           )("ADBE Vector Stroke Color").expression =
11580:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
11581:           shorten("Big subdivisions")("ADBE Vectors Group")
11582:             .addProperty("ADBE Vector Filter - Repeater")(
11583:               "ADBE Vector Repeater Copies",
11584:             )
11585:             .setValue(
11586:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
11587:             );
11588:           shorten("Big subdivisions")("ADBE Vectors Group")(
11589:             "ADBE Vector Filter - Repeater",
11590:           )("ADBE Vector Repeater Transform")(
11591:             "ADBE Vector Repeater Rotation",
11592:           ).expression =
11593:             'try { effect("ADBE easyRulers")("Gap")/10*' +
11594:             divideBy +
11595:             " } catch(e) { value }";
11596:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
11597:             "ADBE Vector Filter - Offset",
11598:           )("ADBE Vector Offset Amount").expression =
11599:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*16-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*16+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*16+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
11600:           shorten("Big subdivisions")("ADBE Vectors Group")(
11601:             "ADBE Vector Graphic - Stroke",
11602:           )("ADBE Vector Stroke Width").expression =
11603:             'try { effect("ADBE easyRulers")("Height Bias")*32 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11604:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
11605:             "ADBE Vector Filter - Trim",
11606:           )("ADBE Vector Trim End").expression =
11607:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
11608:           shorten("Big subdivisions")("ADBE Vectors Group")(
11609:             "ADBE Vector Filter - Trim",
11610:           )("ADBE Vector Trim Offset").expression =
11611:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
11612:           shorten.addProperty("ADBE Vector Group").name =
11613:             "Big subdivisions Base Line";
11614:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")
11615:             .addProperty("ADBE Vector Shape - Group")
11616:             .path.setValue(shape);
11617:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
11618:             "ADBE Vector Scale",
11619:           ).setValue([-75, -75]);
11620:           shorten("Big subdivisions Base Line")(
11621:             "ADBE Vectors Group",
11622:           ).addProperty("ADBE Vector Graphic - Stroke")(
11623:             "ADBE Vector Stroke Color",
11624:           ).expression =
11625:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
11626:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
11627:             "ADBE Vector Graphic - Stroke",
11628:           )("ADBE Vector Stroke Width").expression =
11629:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
11630:           shorten("Big subdivisions Base Line")(
11631:             "ADBE Vectors Group",
11632:           ).addProperty("ADBE Vector Filter - Offset")(
11633:             "ADBE Vector Offset Amount",
11634:           ).expression =
11635:             'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")*2; } else { 0 }; } catch(e) { value }';
11636:           shorten("Big subdivisions Base Line")(
11637:             "ADBE Vectors Group",
11638:           ).addProperty("ADBE Vector Filter - Trim")(
11639:             "ADBE Vector Trim End",
11640:           ).expression =
11641:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
11642:             (EditTextCopies.text - 1) +
11643:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
11644:             (EditTextCopies.text - 1) +
11645:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
11646:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
11647:             "ADBE Vector Filter - Trim",
11648:           )("ADBE Vector Trim Offset").expression =
11649:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
11650:             (EditTextCopies.text - 1) +
11651:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
11652:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
11653:           shorten("Half subdivisions")("ADBE Vectors Group")
11654:             .addProperty("ADBE Vector Shape - Group")
11655:             .path.setValue(shape);
11656:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
11657:             "ADBE Vector Scale",
11658:           ).setValue([-75, -75]);
11659:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
11660:             "ADBE Vector Graphic - Stroke",
11661:           )("ADBE Vector Stroke Color").expression =
11662:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
11663:           shorten("Half subdivisions")("ADBE Vectors Group")
11664:             .addProperty("ADBE Vector Filter - Repeater")(
11665:               "ADBE Vector Repeater Copies",
11666:             )
11667:             .setValue(Math.floor((Number(EditTextCopies.text - 1) + 8) / 16));
11668:           shorten("Half subdivisions")("ADBE Vectors Group")(
11669:             "ADBE Vector Filter - Repeater",
11670:           )("ADBE Vector Repeater Offset").setValue(0.5);
11671:           shorten("Half subdivisions")("ADBE Vectors Group")(
11672:             "ADBE Vector Filter - Repeater",
11673:           )("ADBE Vector Repeater Transform")(
11674:             "ADBE Vector Repeater Rotation",
11675:           ).expression =
11676:             'try { effect("ADBE easyRulers")("Gap")/0.625 } catch(e) { value }';
11677:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
11678:             "ADBE Vector Filter - Offset",
11679:           )("ADBE Vector Offset Amount").expression =
11680:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*8-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
11681:           shorten("Half subdivisions")("ADBE Vectors Group")(
11682:             "ADBE Vector Graphic - Stroke",
11683:           )("ADBE Vector Stroke Width").expression =
11684:             'try { effect("ADBE easyRulers")("Height Bias")*16 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11685:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
11686:             "ADBE Vector Filter - Trim",
11687:           )("ADBE Vector Trim End").expression =
11688:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
11689:           shorten("Half subdivisions")("ADBE Vectors Group")(
11690:             "ADBE Vector Filter - Trim",
11691:           )("ADBE Vector Trim Offset").expression =
11692:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
11693:           shorten.addProperty("ADBE Vector Group").name =
11694:             "Half subdivisions Base Line";
11695:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")
11696:             .addProperty("ADBE Vector Shape - Group")
11697:             .path.setValue(shape);
11698:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
11699:             "ADBE Vector Scale",
11700:           ).setValue([-75, -75]);
11701:           shorten("Half subdivisions Base Line")(
11702:             "ADBE Vectors Group",
11703:           ).addProperty("ADBE Vector Graphic - Stroke")(
11704:             "ADBE Vector Stroke Color",
11705:           ).expression =
11706:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
11707:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
11708:             "ADBE Vector Graphic - Stroke",
11709:           )("ADBE Vector Stroke Width").expression =
11710:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
11711:           shorten("Half subdivisions Base Line")(
11712:             "ADBE Vectors Group",
11713:           ).addProperty("ADBE Vector Filter - Offset")(
11714:             "ADBE Vector Offset Amount",
11715:           ).expression =
11716:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2)>0) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
11717:           shorten("Half subdivisions Base Line")(
11718:             "ADBE Vectors Group",
11719:           ).addProperty("ADBE Vector Filter - Trim")(
11720:             "ADBE Vector Trim End",
11721:           ).expression =
11722:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
11723:             (EditTextCopies.text - 1) +
11724:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
11725:             (EditTextCopies.text - 1) +
11726:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
11727:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
11728:             "ADBE Vector Filter - Trim",
11729:           )("ADBE Vector Trim Offset").expression =
11730:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
11731:             (EditTextCopies.text - 1) +
11732:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
11733:           shorten.addProperty("ADBE Vector Group").name =
11734:             "Quarter subdivisions";
11735:           shorten("Quarter subdivisions")("ADBE Vectors Group")
11736:             .addProperty("ADBE Vector Shape - Group")
11737:             .path.setValue(shape);
11738:           shorten("Quarter subdivisions")("ADBE Vector Transform Group")(
11739:             "ADBE Vector Scale",
11740:           ).setValue([-75, -75]);
11741:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
11742:             "ADBE Vector Graphic - Stroke",
11743:           )("ADBE Vector Stroke Color").expression =
11744:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
11745:           shorten("Quarter subdivisions")("ADBE Vectors Group")
11746:             .addProperty("ADBE Vector Filter - Repeater")(
11747:               "ADBE Vector Repeater Copies",
11748:             )
11749:             .setValue(Math.floor((Number(EditTextCopies.text - 1) + 4) / 8));
11750:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
11751:             "ADBE Vector Filter - Repeater",
11752:           )("ADBE Vector Repeater Offset").setValue(0.5);
11753:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
11754:             "ADBE Vector Filter - Repeater",
11755:           )("ADBE Vector Repeater Transform")(
11756:             "ADBE Vector Repeater Rotation",
11757:           ).expression =
11758:             'try { effect("ADBE easyRulers")("Gap")*0.8 } catch(e) { value }';
11759:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
11760:             "ADBE Vector Filter - Offset",
11761:           )("ADBE Vector Offset Amount").expression =
11762:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*4+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
11763:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
11764:             "ADBE Vector Graphic - Stroke",
11765:           )("ADBE Vector Stroke Width").expression =
11766:             'try { effect("ADBE easyRulers")("Height Bias")*8 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11767:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
11768:             "ADBE Vector Filter - Trim",
11769:           )("ADBE Vector Trim End").expression =
11770:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
11771:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
11772:             "ADBE Vector Filter - Trim",
11773:           )("ADBE Vector Trim Offset").expression =
11774:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
11775:           shorten.addProperty("ADBE Vector Group").name =
11776:             "Quarter subdivisions Base Line";
11777:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")
11778:             .addProperty("ADBE Vector Shape - Group")
11779:             .path.setValue(shape);
11780:           shorten("Quarter subdivisions Base Line")(
11781:             "ADBE Vector Transform Group",
11782:           )("ADBE Vector Scale").setValue([-75, -75]);
11783:           shorten("Quarter subdivisions Base Line")(
11784:             "ADBE Vectors Group",
11785:           ).addProperty("ADBE Vector Graphic - Stroke")(
11786:             "ADBE Vector Stroke Color",
11787:           ).expression =
11788:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
11789:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
11790:             "ADBE Vector Graphic - Stroke",
11791:           )("ADBE Vector Stroke Width").expression =
11792:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
11793:           shorten("Quarter subdivisions Base Line")(
11794:             "ADBE Vectors Group",
11795:           ).addProperty("ADBE Vector Filter - Offset")(
11796:             "ADBE Vector Offset Amount",
11797:           ).expression =
11798:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/4)>0) { effect("ADBE easyRulers")("Height Bias")*8+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
11799:           shorten("Quarter subdivisions Base Line")(
11800:             "ADBE Vectors Group",
11801:           ).addProperty("ADBE Vector Filter - Trim")(
11802:             "ADBE Vector Trim End",
11803:           ).expression =
11804:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
11805:             (EditTextCopies.text - 1) +
11806:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
11807:             (EditTextCopies.text - 1) +
11808:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
11809:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
11810:             "ADBE Vector Filter - Trim",
11811:           )("ADBE Vector Trim Offset").expression =
11812:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
11813:             (EditTextCopies.text - 1) +
11814:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
11815:           shorten.addProperty("ADBE Vector Group").name = "Eighth subdivisions";
11816:           shorten("Eighth subdivisions")("ADBE Vectors Group")
11817:             .addProperty("ADBE Vector Shape - Group")
11818:             .path.setValue(shape);
11819:           shorten("Eighth subdivisions")("ADBE Vector Transform Group")(
11820:             "ADBE Vector Scale",
11821:           ).setValue([-75, -75]);
11822:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
11823:             "ADBE Vector Graphic - Stroke",
11824:           )("ADBE Vector Stroke Color").expression =
11825:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
11826:           shorten("Eighth subdivisions")("ADBE Vectors Group")
11827:             .addProperty("ADBE Vector Filter - Repeater")(
11828:               "ADBE Vector Repeater Copies",
11829:             )
11830:             .setValue(Math.floor((Number(EditTextCopies.text - 1) + 2) / 4));
11831:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
11832:             "ADBE Vector Filter - Repeater",
11833:           )("ADBE Vector Repeater Offset").setValue(0.5);
11834:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
11835:             "ADBE Vector Filter - Repeater",
11836:           )("ADBE Vector Repeater Transform")(
11837:             "ADBE Vector Repeater Rotation",
11838:           ).expression =
11839:             'try { effect("ADBE easyRulers")("Gap")*0.4 } catch(e) { value }';
11840:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
11841:             "ADBE Vector Filter - Offset",
11842:           )("ADBE Vector Offset Amount").expression =
11843:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")*2+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
11844:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
11845:             "ADBE Vector Graphic - Stroke",
11846:           )("ADBE Vector Stroke Width").expression =
11847:             'try { effect("ADBE easyRulers")("Height Bias")*4 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11848:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
11849:             "ADBE Vector Filter - Trim",
11850:           )("ADBE Vector Trim End").expression =
11851:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
11852:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
11853:             "ADBE Vector Filter - Trim",
11854:           )("ADBE Vector Trim Offset").expression =
11855:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
11856:           shorten.addProperty("ADBE Vector Group").name =
11857:             "Eighth subdivisions Base Line";
11858:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")
11859:             .addProperty("ADBE Vector Shape - Group")
11860:             .path.setValue(shape);
11861:           shorten("Eighth subdivisions Base Line")(
11862:             "ADBE Vector Transform Group",
11863:           )("ADBE Vector Scale").setValue([-75, -75]);
11864:           shorten("Eighth subdivisions Base Line")(
11865:             "ADBE Vectors Group",
11866:           ).addProperty("ADBE Vector Graphic - Stroke")(
11867:             "ADBE Vector Stroke Color",
11868:           ).expression =
11869:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
11870:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
11871:             "ADBE Vector Graphic - Stroke",
11872:           )("ADBE Vector Stroke Width").expression =
11873:             'try { -0.5 + effect("ADBE easyRulers")("Width") } catch(e) { value }';
11874:           shorten("Eighth subdivisions Base Line")(
11875:             "ADBE Vectors Group",
11876:           ).addProperty("ADBE Vector Filter - Offset")(
11877:             "ADBE Vector Offset Amount",
11878:           ).expression =
11879:             'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/8)>0) { effect("ADBE easyRulers")("Height Bias")*16+effect("ADBE easyRulers")("Height")*2 } else { 0 }; } else { 0 } } catch(e) { value };';
11880:           shorten("Eighth subdivisions Base Line")(
11881:             "ADBE Vectors Group",
11882:           ).addProperty("ADBE Vector Filter - Trim")(
11883:             "ADBE Vector Trim End",
11884:           ).expression =
11885:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { Math.abs(' +
11886:             (EditTextCopies.text - 1) +
11887:             '*effect("ADBE easyRulers")("Gap")/36-effect("ADBE easyRulers")("Width")/18) } else { Math.abs(' +
11888:             (EditTextCopies.text - 1) +
11889:             '*effect("ADBE easyRulers")("Gap")/36+effect("ADBE easyRulers")("Width")/18) } } catch(e) { value }';
11890:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
11891:             "ADBE Vector Filter - Trim",
11892:           )("ADBE Vector Trim Offset").expression =
11893:             'try { if (effect("ADBE easyRulers")("Gap") < 0) { -3.6*Math.abs(' +
11894:             (EditTextCopies.text - 1) +
11895:             '*effect("ADBE easyRulers")("Gap")/36) + effect("ADBE easyRulers")("Rotation Offset") } else { effect("ADBE easyRulers")("Rotation Offset") } } catch(e) { value }';
11896:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
11897:           shorten("Main lines")("ADBE Vectors Group")
11898:             .addProperty("ADBE Vector Shape - Group")
11899:             .path.setValue(shape);
11900:           shorten("Main lines")("ADBE Vector Transform Group")(
11901:             "ADBE Vector Scale",
11902:           ).setValue([-75, -75]);
11903:           shorten("Main lines")("ADBE Vectors Group").addProperty(
11904:             "ADBE Vector Graphic - Stroke",
11905:           )("ADBE Vector Stroke Color").expression =
11906:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
11907:           shorten("Main lines")("ADBE Vectors Group")
11908:             .addProperty("ADBE Vector Filter - Repeater")(
11909:               "ADBE Vector Repeater Copies",
11910:             )
11911:             .setValue(Math.floor(EditTextCopies.text / 2));
11912:           shorten("Main lines")("ADBE Vectors Group")(
11913:             "ADBE Vector Filter - Repeater",
11914:           )("ADBE Vector Repeater Offset").setValue(0.5);
11915:           shorten("Main lines")("ADBE Vectors Group")(
11916:             "ADBE Vector Filter - Repeater",
11917:           )("ADBE Vector Repeater Transform")(
11918:             "ADBE Vector Repeater Rotation",
11919:           ).expression =
11920:             'try { effect("ADBE easyRulers")("Gap")/5 } catch(e) { value }';
11921:           shorten("Main lines")("ADBE Vectors Group").addProperty(
11922:             "ADBE Vector Filter - Offset",
11923:           )("ADBE Vector Offset Amount").expression =
11924:             'try { try { if (thisProperty.propertyGroup(5).name == "Ruler Mirror") {-effect("ADBE easyRulers")("Height Bias")-effect("ADBE easyRulers")("Height")} else {effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")} } catch(e) { effect("ADBE easyRulers")("Height Bias")+effect("ADBE easyRulers")("Height") } } catch(e) { value }';
11925:           shorten("Main lines")("ADBE Vectors Group")(
11926:             "ADBE Vector Graphic - Stroke",
11927:           )("ADBE Vector Stroke Width").expression =
11928:             'try { effect("ADBE easyRulers")("Height Bias")*2 + effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
11929:           shorten("Main lines")("ADBE Vectors Group").addProperty(
11930:             "ADBE Vector Filter - Trim",
11931:           )("ADBE Vector Trim End").expression =
11932:             'try { effect("ADBE easyRulers")("Width")/10 } catch(e) { value }';
11933:           shorten("Main lines")("ADBE Vectors Group")(
11934:             "ADBE Vector Filter - Trim",
11935:           )("ADBE Vector Trim Offset").expression =
11936:             'try { value + effect("ADBE easyRulers")("Rotation Offset") } catch(e) { value }';
11937:           app.project.activeItem.layer(shapeLayer.name)(
11938:             "ADBE Root Vectors Group",
11939:           )("Ruler")("ADBE Vector Transform Group")(
11940:             "ADBE Vector Rotation",
11941:           ).expression =
11942:             'try { (-effect("ADBE easyRulers")("Width")/5.75) } catch(e) { value }';
11943:           createPointerCircular();
11944:           t("ADBE easyRulers")("Width").setValue(2);
11945:           t("ADBE easyRulers")("default Width").setValue(2);
11946:           t("ADBE easyRulers")("Height").setValue(2);
11947:           t("ADBE easyRulers")("default Height").setValue(2);
11948:           t("ADBE easyRulers")("Height Bias").setValue(2);
11949:           t("ADBE easyRulers")("default Height Bias").setValue(2);
11950:           switch (SidesType.selection.index) {
11951:             case 0:
11952:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(160);
11953:               t("ADBE easyRulers")("default Pointer Distance").setValue(160);
11954:               break;
11955:             case 1:
11956:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(200);
11957:               t("ADBE easyRulers")("default Pointer Distance").setValue(200);
11958:               break;
11959:             case 2:
11960:               t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(100);
11961:               t("ADBE easyRulers")("default Pointer Distance").setValue(100);
11962:               t("ADBE easyRulers")("Sides Distance").setValue(-10);
11963:               t("ADBE easyRulers")("default Sides Distance").setValue(-10);
11964:           }
11965:           secondary_lines = app.project.activeItem
11966:             .layer(
11967:               shapeLayer.name,
11968:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
11969:             .duplicate();
11970:           secondary_lines.name = "Main lines - Secondary Color";
11971:           secondary_lines("ADBE Vectors Group")(
11972:             "ADBE Vector Filter - Repeater",
11973:           )("ADBE Vector Repeater Copies").expression =
11974:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
11975:             EditTextCopies.text +
11976:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
11977:             (Number(EditTextCopies.text) - 1) +
11978:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
11979:             (Number(EditTextCopies.text) - 1) +
11980:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
11981:             EditTextCopies.text +
11982:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { ' +
11983:             (Number(EditTextCopies.text) - 1) +
11984:             ' * (effect("ADBE easyRulers")("Completion")/100) } else { 0 }              }} catch(e) { value }';
11985:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
11986:             "ADBE Vector Stroke Opacity",
11987:           ).expression =
11988:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
11989:           secondary_lines("ADBE Vector Transform Group")(
11990:             "ADBE Vector Group Opacity",
11991:           ).expression =
11992:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
11993:           secondary_lines("ADBE Vectors Group")(
11994:             "ADBE Vector Graphic - Stroke",
11995:           ).name = "Stroke Start";
11996:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
11997:             "ADBE Vector Stroke Color",
11998:           ).expression =
11999:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12000:           secondary_lines("ADBE Vectors Group")(
12001:             "ADBE Vector Filter - Repeater",
12002:           )("ADBE Vector Repeater Offset").expression =
12003:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
12004:             (Number(EditTextCopies.text) - 1) +
12005:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12006:             (Number(EditTextCopies.text) - 1) +
12007:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
12008:           secondary_lines("ADBE Vectors Group")(
12009:             "ADBE Vector Filter - Repeater",
12010:           )("ADBE Vector Repeater Transform")(
12011:             "ADBE Vector Repeater Opacity 1",
12012:           ).expression =
12013:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12014:           secondary_lines("ADBE Vectors Group")(
12015:             "ADBE Vector Filter - Repeater",
12016:           )("ADBE Vector Repeater Transform")(
12017:             "ADBE Vector Repeater Opacity 2",
12018:           ).expression =
12019:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12020:           secondary_lines("ADBE Vectors Group")(
12021:             "ADBE Vector Filter - Repeater",
12022:           )("ADBE Vector Repeater Transform")(
12023:             "ADBE Vector Repeater Rotation",
12024:           ).expression =
12025:             'try { effect("ADBE easyRulers")("Gap")/10 } catch(e) { value }';
12026:           secondary_lines("ADBE Vectors Group").addProperty(
12027:             "ADBE Vector Graphic - Stroke",
12028:           ).name = "Stroke End";
12029:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12030:             "ADBE Vector Stroke Width",
12031:           ).expression =
12032:             'try { effect("ADBE easyRulers")("Height Bias")*2 +effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
12033:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12034:             "ADBE Vector Stroke Color",
12035:           ).expression =
12036:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12037:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12038:             "ADBE Vector Stroke Opacity",
12039:           ).expression =
12040:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
12041:           secondary_lines = app.project.activeItem
12042:             .layer(
12043:               shapeLayer.name,
12044:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
12045:             .duplicate();
12046:           secondary_lines.name = "Big subdivisions - Secondary Color";
12047:           secondary_lines("ADBE Vectors Group")(
12048:             "ADBE Vector Filter - Repeater",
12049:           )("ADBE Vector Repeater Copies").expression =
12050:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12051:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12052:             1 +
12053:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12054:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12055:             1 +
12056:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12057:             (Number(EditTextCopies.text) - 1) +
12058:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
12059:             divideBy +
12060:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12061:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12062:             1 +
12063:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
12064:             divideBy +
12065:             "*100/" +
12066:             (Number(EditTextCopies.text) - 1) +
12067:             ")) } else { 0 }              }} catch(e) { value }";
12068:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
12069:             "ADBE Vector Stroke Opacity",
12070:           ).expression =
12071:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
12072:           secondary_lines("ADBE Vector Transform Group")(
12073:             "ADBE Vector Group Opacity",
12074:           ).expression =
12075:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12076:           secondary_lines("ADBE Vectors Group")(
12077:             "ADBE Vector Graphic - Stroke",
12078:           ).name = "Stroke Start";
12079:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
12080:             "ADBE Vector Stroke Color",
12081:           ).expression =
12082:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12083:           secondary_lines("ADBE Vectors Group")(
12084:             "ADBE Vector Filter - Repeater",
12085:           )("ADBE Vector Repeater Offset").expression =
12086:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
12087:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12088:             1 +
12089:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12090:             (Number(EditTextCopies.text) - 1) +
12091:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
12092:             divideBy +
12093:             ")} else { 0 }              }} catch(e) { value }";
12094:           secondary_lines("ADBE Vectors Group")(
12095:             "ADBE Vector Filter - Repeater",
12096:           )("ADBE Vector Repeater Transform")(
12097:             "ADBE Vector Repeater Opacity 1",
12098:           ).expression =
12099:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12100:           secondary_lines("ADBE Vectors Group")(
12101:             "ADBE Vector Filter - Repeater",
12102:           )("ADBE Vector Repeater Transform")(
12103:             "ADBE Vector Repeater Opacity 2",
12104:           ).expression =
12105:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12106:           secondary_lines("ADBE Vectors Group").addProperty(
12107:             "ADBE Vector Graphic - Stroke",
12108:           ).name = "Stroke End";
12109:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12110:             "ADBE Vector Stroke Width",
12111:           ).expression =
12112:             'try { effect("ADBE easyRulers")("Height Bias")*32+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
12113:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12114:             "ADBE Vector Stroke Color",
12115:           ).expression =
12116:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12117:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12118:             "ADBE Vector Stroke Opacity",
12119:           ).expression =
12120:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
12121:           secondary_lines = app.project.activeItem
12122:             .layer(
12123:               shapeLayer.name,
12124:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
12125:             .duplicate();
12126:           secondary_lines.name = "Half subdivisions - Secondary Color";
12127:           secondary_lines("ADBE Vectors Group")(
12128:             "ADBE Vector Filter - Repeater",
12129:           )("ADBE Vector Repeater Copies").expression =
12130:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12131:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
12132:             1 +
12133:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12134:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
12135:             1 +
12136:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12137:             (Number(EditTextCopies.text) - 1) +
12138:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
12139:             divideBy / 2 +
12140:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12141:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
12142:             1 +
12143:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
12144:             divideBy / 2 +
12145:             "*100/" +
12146:             (Number(EditTextCopies.text) - 1) +
12147:             ")) } else { 0 }              }} catch(e) { value }";
12148:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
12149:             "ADBE Vector Stroke Opacity",
12150:           ).expression =
12151:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
12152:           secondary_lines("ADBE Vector Transform Group")(
12153:             "ADBE Vector Group Opacity",
12154:           ).expression =
12155:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12156:           secondary_lines("ADBE Vectors Group")(
12157:             "ADBE Vector Graphic - Stroke",
12158:           ).name = "Stroke Start";
12159:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
12160:             "ADBE Vector Stroke Color",
12161:           ).expression =
12162:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12163:           secondary_lines("ADBE Vectors Group")(
12164:             "ADBE Vector Filter - Repeater",
12165:           )("ADBE Vector Repeater Offset").expression =
12166:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
12167:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
12168:             1 +
12169:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12170:             (Number(EditTextCopies.text) - 1) +
12171:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
12172:             divideBy / 2 +
12173:             ")} else { 0 }              }} catch(e) { value }";
12174:           secondary_lines("ADBE Vectors Group")(
12175:             "ADBE Vector Filter - Repeater",
12176:           )("ADBE Vector Repeater Transform")(
12177:             "ADBE Vector Repeater Opacity 1",
12178:           ).expression =
12179:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12180:           secondary_lines("ADBE Vectors Group")(
12181:             "ADBE Vector Filter - Repeater",
12182:           )("ADBE Vector Repeater Transform")(
12183:             "ADBE Vector Repeater Opacity 2",
12184:           ).expression =
12185:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12186:           secondary_lines("ADBE Vectors Group")(
12187:             "ADBE Vector Filter - Repeater",
12188:           )("ADBE Vector Repeater Transform")(
12189:             "ADBE Vector Repeater Rotation",
12190:           ).expression =
12191:             'try { effect("ADBE easyRulers")("Gap")*0.8 } catch(e) { value }';
12192:           secondary_lines("ADBE Vectors Group").addProperty(
12193:             "ADBE Vector Graphic - Stroke",
12194:           ).name = "Stroke End";
12195:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12196:             "ADBE Vector Stroke Width",
12197:           ).expression =
12198:             'try { effect("ADBE easyRulers")("Height Bias")*16+effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
12199:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12200:             "ADBE Vector Stroke Color",
12201:           ).expression =
12202:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12203:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12204:             "ADBE Vector Stroke Opacity",
12205:           ).expression =
12206:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
12207:           secondary_lines = app.project.activeItem
12208:             .layer(
12209:               shapeLayer.name,
12210:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
12211:             .duplicate();
12212:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
12213:           secondary_lines("ADBE Vectors Group")(
12214:             "ADBE Vector Filter - Repeater",
12215:           )("ADBE Vector Repeater Copies").expression =
12216:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12217:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
12218:             1 +
12219:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12220:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
12221:             1 +
12222:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12223:             (Number(EditTextCopies.text) - 1) +
12224:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
12225:             divideBy / 4 +
12226:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12227:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
12228:             1 +
12229:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
12230:             divideBy / 4 +
12231:             "*100/" +
12232:             (Number(EditTextCopies.text) - 1) +
12233:             ")) } else { 0 }              }} catch(e) { value }";
12234:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
12235:             "ADBE Vector Stroke Opacity",
12236:           ).expression =
12237:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
12238:           secondary_lines("ADBE Vector Transform Group")(
12239:             "ADBE Vector Group Opacity",
12240:           ).expression =
12241:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12242:           secondary_lines("ADBE Vectors Group")(
12243:             "ADBE Vector Graphic - Stroke",
12244:           ).name = "Stroke Start";
12245:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
12246:             "ADBE Vector Stroke Color",
12247:           ).expression =
12248:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12249:           secondary_lines("ADBE Vectors Group")(
12250:             "ADBE Vector Filter - Repeater",
12251:           )("ADBE Vector Repeater Offset").expression =
12252:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
12253:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
12254:             1 +
12255:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12256:             (Number(EditTextCopies.text) - 1) +
12257:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
12258:             divideBy / 4 +
12259:             ")} else { 0 }              }} catch(e) { value }";
12260:           secondary_lines("ADBE Vectors Group")(
12261:             "ADBE Vector Filter - Repeater",
12262:           )("ADBE Vector Repeater Transform")(
12263:             "ADBE Vector Repeater Opacity 1",
12264:           ).expression =
12265:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12266:           secondary_lines("ADBE Vectors Group")(
12267:             "ADBE Vector Filter - Repeater",
12268:           )("ADBE Vector Repeater Transform")(
12269:             "ADBE Vector Repeater Opacity 2",
12270:           ).expression =
12271:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12272:           secondary_lines("ADBE Vectors Group")(
12273:             "ADBE Vector Filter - Repeater",
12274:           )("ADBE Vector Repeater Transform")(
12275:             "ADBE Vector Repeater Rotation",
12276:           ).expression =
12277:             'try { effect("ADBE easyRulers")("Gap")*0.4 } catch(e) { value }';
12278:           secondary_lines("ADBE Vectors Group").addProperty(
12279:             "ADBE Vector Graphic - Stroke",
12280:           ).name = "Stroke End";
12281:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12282:             "ADBE Vector Stroke Width",
12283:           ).expression =
12284:             'try { effect("ADBE easyRulers")("Height Bias")*8 +effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
12285:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12286:             "ADBE Vector Stroke Color",
12287:           ).expression =
12288:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12289:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12290:             "ADBE Vector Stroke Opacity",
12291:           ).expression =
12292:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
12293:           secondary_lines = app.project.activeItem
12294:             .layer(
12295:               shapeLayer.name,
12296:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions")
12297:             .duplicate();
12298:           secondary_lines.name = "Eighth subdivisions - Secondary Color";
12299:           secondary_lines("ADBE Vectors Group")(
12300:             "ADBE Vector Filter - Repeater",
12301:           )("ADBE Vector Repeater Copies").expression =
12302:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12303:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
12304:             1 +
12305:             '-content("Ruler").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12306:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
12307:             1 +
12308:             '-content("Ruler Mirror").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12309:             (Number(EditTextCopies.text) - 1) +
12310:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
12311:             divideBy / 8 +
12312:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12313:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
12314:             1 +
12315:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil((value-1)*effect("ADBE easyRulers")("Completion")/ ((value-1)*' +
12316:             divideBy / 8 +
12317:             "*100/" +
12318:             (Number(EditTextCopies.text) - 1) +
12319:             ")) } else { 0 }              }} catch(e) { value }";
12320:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Stroke")(
12321:             "ADBE Vector Stroke Opacity",
12322:           ).expression =
12323:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
12324:           secondary_lines("ADBE Vector Transform Group")(
12325:             "ADBE Vector Group Opacity",
12326:           ).expression =
12327:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12328:           secondary_lines("ADBE Vectors Group")(
12329:             "ADBE Vector Graphic - Stroke",
12330:           ).name = "Stroke Start";
12331:           secondary_lines("ADBE Vectors Group")("Stroke Start")(
12332:             "ADBE Vector Stroke Color",
12333:           ).expression =
12334:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12335:           secondary_lines("ADBE Vectors Group")(
12336:             "ADBE Vector Filter - Repeater",
12337:           )("ADBE Vector Repeater Offset").expression =
12338:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
12339:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
12340:             1 +
12341:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12342:             (Number(EditTextCopies.text) - 1) +
12343:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
12344:             divideBy / 8 +
12345:             ")} else { 0 }              }} catch(e) { value }";
12346:           secondary_lines("ADBE Vectors Group")(
12347:             "ADBE Vector Filter - Repeater",
12348:           )("ADBE Vector Repeater Transform")(
12349:             "ADBE Vector Repeater Opacity 1",
12350:           ).expression =
12351:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12352:           secondary_lines("ADBE Vectors Group")(
12353:             "ADBE Vector Filter - Repeater",
12354:           )("ADBE Vector Repeater Transform")(
12355:             "ADBE Vector Repeater Opacity 2",
12356:           ).expression =
12357:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12358:           secondary_lines("ADBE Vectors Group")(
12359:             "ADBE Vector Filter - Repeater",
12360:           )("ADBE Vector Repeater Transform")(
12361:             "ADBE Vector Repeater Rotation",
12362:           ).expression =
12363:             'try { effect("ADBE easyRulers")("Gap")*0.2 } catch(e) { value }';
12364:           secondary_lines("ADBE Vectors Group").addProperty(
12365:             "ADBE Vector Graphic - Stroke",
12366:           ).name = "Stroke End";
12367:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12368:             "ADBE Vector Stroke Width",
12369:           ).expression =
12370:             'try { effect("ADBE easyRulers")("Height Bias")*4 +effect("ADBE easyRulers")("Height")*2 } catch(e) { value }';
12371:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12372:             "ADBE Vector Stroke Color",
12373:           ).expression =
12374:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12375:           secondary_lines("ADBE Vectors Group")("Stroke End")(
12376:             "ADBE Vector Stroke Opacity",
12377:           ).expression =
12378:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
12379:           app.project.activeItem
12380:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
12381:             .duplicate().name = "Ruler Mirror";
12382:           app.project.activeItem
12383:             .layer(
12384:               shapeLayer.name,
12385:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("triangle")("ADBE Vector Star Rotation")
12386:             .setValue(60);
12387:           app.project.activeItem
12388:             .layer(
12389:               shapeLayer.name,
12390:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vectors Group")("squared triangle")("ADBE Vector Transform Group")("ADBE Vector Rotation")
12391:             .setValue(-180);
12392:           app.project.activeItem
12393:             .layer(
12394:               shapeLayer.name,
12395:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("pointer")("ADBE Vector Transform Group")("ADBE Vector Anchor")
12396:             .setValue([0, 425]);
12397:           app.project.activeItem.layer(shapeLayer.name)(
12398:             "ADBE Root Vectors Group",
12399:           )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = false;
12400:           if (SidesType.selection.index !== 0) {
12401:             app.project.activeItem.layer(shapeLayer.name)(
12402:               "ADBE Root Vectors Group",
12403:             )("Ruler Mirror")("ADBE Vector Transform Group")(
12404:               "ADBE Vector Scale",
12405:             ).expression =
12406:               'try { [value[0] + effect("ADBE easyRulers")("Sides Distance").value, value[1] + effect("ADBE easyRulers")("Sides Distance").value] } catch(e) { [value[0] -10, value[1] -10] }';
12407:             app.project.activeItem.layer(shapeLayer.name)(
12408:               "ADBE Root Vectors Group",
12409:             )("Ruler Mirror")("ADBE Vector Transform Group")(
12410:               "ADBE Vector Rotation",
12411:             ).expression =
12412:               'try { -effect("ADBE easyRulers")("Width")/5.75 } catch(e) { value }';
12413:             app.project.activeItem.layer(shapeLayer.name)(
12414:               "ADBE Root Vectors Group",
12415:             )("Ruler Mirror")("ADBE Vectors Group")("pointer")(
12416:               "ADBE Vector Transform Group",
12417:             )("ADBE Vector Anchor").expression =
12418:               'try { [value[0], value[1] - effect("ADBE easyRulers")("ADBE easyRulers-0049")] } catch(e) { value }';
12419:             app.project.activeItem.layer(shapeLayer.name)(
12420:               "ADBE Root Vectors Group",
12421:             )("Ruler Mirror")("ADBE Vectors Group")("Main lines")(
12422:               "ADBE Vectors Group",
12423:             )("ADBE Vector Filter - Offset")(
12424:               "ADBE Vector Offset Amount",
12425:             ).expression =
12426:               'try { -effect("ADBE easyRulers")("Height Bias") - effect("ADBE easyRulers")("Height") } catch(e) { value }';
12427:             app.project.activeItem.layer(shapeLayer.name)(
12428:               "ADBE Root Vectors Group",
12429:             )("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions")(
12430:               "ADBE Vectors Group",
12431:             )("ADBE Vector Filter - Offset")(
12432:               "ADBE Vector Offset Amount",
12433:             ).expression =
12434:               'try { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height") } catch(e) { value }';
12435:             app.project.activeItem.layer(shapeLayer.name)(
12436:               "ADBE Root Vectors Group",
12437:             )("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions")(
12438:               "ADBE Vectors Group",
12439:             )("ADBE Vector Filter - Offset")(
12440:               "ADBE Vector Offset Amount",
12441:             ).expression =
12442:               'try { -effect("ADBE easyRulers")("Height Bias")*4-effect("ADBE easyRulers")("Height") } catch(e) { value }';
12443:             app.project.activeItem.layer(shapeLayer.name)(
12444:               "ADBE Root Vectors Group",
12445:             )("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions")(
12446:               "ADBE Vectors Group",
12447:             )("ADBE Vector Filter - Offset")(
12448:               "ADBE Vector Offset Amount",
12449:             ).expression =
12450:               'try { -effect("ADBE easyRulers")("Height Bias")*8-effect("ADBE easyRulers")("Height") } catch(e) { value }';
12451:             app.project.activeItem.layer(shapeLayer.name)(
12452:               "ADBE Root Vectors Group",
12453:             )("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions")(
12454:               "ADBE Vectors Group",
12455:             )("ADBE Vector Filter - Offset")(
12456:               "ADBE Vector Offset Amount",
12457:             ).expression =
12458:               'try { -effect("ADBE easyRulers")("Height Bias")*16-effect("ADBE easyRulers")("Height") } catch(e) { value }';
12459:             app.project.activeItem.layer(shapeLayer.name)(
12460:               "ADBE Root Vectors Group",
12461:             )("Ruler Mirror")("ADBE Vectors Group")(
12462:               "Big subdivisions Base Line",
12463:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
12464:               "ADBE Vector Offset Amount",
12465:             ).expression =
12466:               'try { if ((effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height"))>0) { -effect("ADBE easyRulers")("Height Bias")*2-effect("ADBE easyRulers")("Height")*2 } else { 0 }  } catch(e) { value }';
12467:             app.project.activeItem.layer(shapeLayer.name)(
12468:               "ADBE Root Vectors Group",
12469:             )("Ruler Mirror")("ADBE Vectors Group")(
12470:               "Half subdivisions Base Line",
12471:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
12472:               "ADBE Vector Offset Amount",
12473:             ).expression =
12474:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/2 > 0) { -effect("ADBE easyRulers")("Height Bias")*4 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
12475:             app.project.activeItem.layer(shapeLayer.name)(
12476:               "ADBE Root Vectors Group",
12477:             )("Ruler Mirror")("ADBE Vectors Group")(
12478:               "Quarter subdivisions Base Line",
12479:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
12480:               "ADBE Vector Offset Amount",
12481:             ).expression =
12482:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/4 > 0) { -effect("ADBE easyRulers")("Height Bias")*8 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
12483:             app.project.activeItem.layer(shapeLayer.name)(
12484:               "ADBE Root Vectors Group",
12485:             )("Ruler Mirror")("ADBE Vectors Group")(
12486:               "Eighth subdivisions Base Line",
12487:             )("ADBE Vectors Group")("ADBE Vector Filter - Offset")(
12488:               "ADBE Vector Offset Amount",
12489:             ).expression =
12490:               'try { if (effect("ADBE easyRulers")("Height Bias")>0) { if (effect("ADBE easyRulers")("Height Bias") + effect("ADBE easyRulers")("Height")/8 > 0) { -effect("ADBE easyRulers")("Height Bias")*16 - effect("ADBE easyRulers")("Height")*2; } else { 0 } } else { 0 } } catch(e) { value }';
12491:           }
12492:           switch (BaseLineDropdown.selection.index) {
12493:             case 0:
12494:               app.project.activeItem
12495:                 .layer(
12496:                   shapeLayer.name,
12497:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base line")
12498:                 .remove();
12499:               app.project.activeItem
12500:                 .layer(
12501:                   shapeLayer.name,
12502:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base line")
12503:                 .remove();
12504:               app.project.activeItem
12505:                 .layer(
12506:                   shapeLayer.name,
12507:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
12508:                 .remove();
12509:               app.project.activeItem
12510:                 .layer(
12511:                   shapeLayer.name,
12512:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
12513:                 .remove();
12514:               app.project.activeItem
12515:                 .layer(
12516:                   shapeLayer.name,
12517:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
12518:                 .remove();
12519:               app.project.activeItem
12520:                 .layer(
12521:                   shapeLayer.name,
12522:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
12523:                 .remove();
12524:               app.project.activeItem
12525:                 .layer(
12526:                   shapeLayer.name,
12527:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
12528:                 .remove();
12529:               app.project.activeItem
12530:                 .layer(
12531:                   shapeLayer.name,
12532:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
12533:                 .remove();
12534:               app.project.activeItem
12535:                 .layer(
12536:                   shapeLayer.name,
12537:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
12538:                 .remove();
12539:               app.project.activeItem
12540:                 .layer(
12541:                   shapeLayer.name,
12542:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
12543:                 .remove();
12544:               break;
12545:             case 1:
12546:               app.project.activeItem
12547:                 .layer(
12548:                   shapeLayer.name,
12549:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
12550:                 .remove();
12551:               app.project.activeItem
12552:                 .layer(
12553:                   shapeLayer.name,
12554:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
12555:                 .remove();
12556:               app.project.activeItem
12557:                 .layer(
12558:                   shapeLayer.name,
12559:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
12560:                 .remove();
12561:               app.project.activeItem
12562:                 .layer(
12563:                   shapeLayer.name,
12564:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
12565:                 .remove();
12566:               app.project.activeItem
12567:                 .layer(
12568:                   shapeLayer.name,
12569:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
12570:                 .remove();
12571:               app.project.activeItem
12572:                 .layer(
12573:                   shapeLayer.name,
12574:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
12575:                 .remove();
12576:               app.project.activeItem
12577:                 .layer(
12578:                   shapeLayer.name,
12579:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
12580:                 .remove();
12581:               app.project.activeItem
12582:                 .layer(
12583:                   shapeLayer.name,
12584:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
12585:                 .remove();
12586:           }
12587:           switch (SidesType.selection.index) {
12588:             case 0:
12589:               app.project.activeItem
12590:                 .layer(
12591:                   shapeLayer.name,
12592:                 )("ADBE Root Vectors Group")("Ruler Mirror")
12593:                 .remove();
12594:               break;
12595:             case 1:
12596:               app.project.activeItem
12597:                 .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
12598:                 .remove();
12599:               app.project.activeItem.layer(shapeLayer.name)(
12600:                 "ADBE Root Vectors Group",
12601:               )("Ruler Mirror")("ADBE Vector Transform Group")(
12602:                 "ADBE Vector Scale",
12603:               ).expression = "";
12604:               app.project.activeItem
12605:                 .layer(
12606:                   shapeLayer.name,
12607:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
12608:                 .setValue([90, 90]);
12609:               app.project.activeItem.layer(shapeLayer.name)(
12610:                 "ADBE Root Vectors Group",
12611:               )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled = true;
12612:           }
12613:         };
12614:         createBasicNoDivs_DotLines = function () {
12615:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
12616:           shorten("Main lines")("ADBE Vectors Group").addProperty(
12617:             "ADBE Vector Shape - Ellipse",
12618:           )("ADBE Vector Ellipse Size").expression =
12619:             'try { [effect("ADBE easyRulers")("Dots Scale"), effect("ADBE easyRulers")("Dots Scale")] } catch(e) { value }';
12620:           shorten("Main lines")("ADBE Vectors Group").addProperty(
12621:             "ADBE Vector Graphic - Fill",
12622:           )("ADBE Vector Fill Color").expression =
12623:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
12624:           shorten("Main lines")("ADBE Vectors Group")
12625:             .addProperty(
12626:               "ADBE Vector Filter - Repeater",
12627:             )("ADBE Vector Repeater Copies")
12628:             .setValue(EditTextCopies.text);
12629:           shorten("Main lines")("ADBE Vectors Group")(
12630:             "ADBE Vector Filter - Repeater",
12631:           )("ADBE Vector Repeater Transform")(
12632:             "ADBE Vector Repeater Position",
12633:           ).expression =
12634:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
12635:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
12636:           shorten("Base Line")("ADBE Vectors Group").addProperty(
12637:             "ADBE Vector Shape - Rect",
12638:           )("ADBE Vector Rect Size").expression =
12639:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
12640:             (EditTextCopies.text - 1) +
12641:             "), 2.5] } catch(e) { value }";
12642:           shorten("Base Line")("ADBE Vectors Group")(
12643:             "ADBE Vector Shape - Rect",
12644:           )("ADBE Vector Rect Position").expression =
12645:             'try { [(effect("ADBE easyRulers")("Gap")*' +
12646:             (EditTextCopies.text - 1) +
12647:             ")/2, value[1]-45] } catch(e) { value }";
12648:           shorten("Base Line")("ADBE Vector Transform Group")(
12649:             "ADBE Vector Position",
12650:           ).setValue([0, 45]);
12651:           shorten("Base Line")("ADBE Vectors Group").addProperty(
12652:             "ADBE Vector Graphic - Fill",
12653:           )("ADBE Vector Fill Color").expression =
12654:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
12655:           t("ADBE easyRulers")("Dots Scale").setValue(10);
12656:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
12657:           if (SidesType.selection.index == 2) {
12658:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
12659:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
12660:           }
12661:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
12662:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
12663:           createPointerLinear();
12664:           secondary_lines = app.project.activeItem
12665:             .layer(
12666:               shapeLayer.name,
12667:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
12668:             .duplicate();
12669:           secondary_lines.name = "Main lines - Secondary Color";
12670:           secondary_lines("ADBE Vectors Group")(
12671:             "ADBE Vector Filter - Repeater",
12672:           )("ADBE Vector Repeater Copies").expression =
12673:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12674:             EditTextCopies.text +
12675:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12676:             EditTextCopies.text +
12677:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12678:             (Number(EditTextCopies.text) - 1) +
12679:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12680:             EditTextCopies.text +
12681:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
12682:             (Number(EditTextCopies.text) - 1) +
12683:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
12684:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
12685:             "ADBE Vector Fill Opacity",
12686:           ).expression =
12687:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
12688:           secondary_lines("ADBE Vector Transform Group")(
12689:             "ADBE Vector Group Opacity",
12690:           ).expression =
12691:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12692:           secondary_lines("ADBE Vectors Group")(
12693:             "ADBE Vector Graphic - Fill",
12694:           ).name = "Fill Start";
12695:           secondary_lines("ADBE Vectors Group")("Fill Start")(
12696:             "ADBE Vector Fill Color",
12697:           ).expression =
12698:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12699:           secondary_lines("ADBE Vectors Group")(
12700:             "ADBE Vector Filter - Repeater",
12701:           )("ADBE Vector Repeater Offset").expression =
12702:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12703:             (Number(EditTextCopies.text) - 1) +
12704:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }} } catch(e) { value }';
12705:           secondary_lines("ADBE Vectors Group")(
12706:             "ADBE Vector Filter - Repeater",
12707:           )("ADBE Vector Repeater Transform")(
12708:             "ADBE Vector Repeater Opacity 1",
12709:           ).expression =
12710:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12711:           secondary_lines("ADBE Vectors Group")(
12712:             "ADBE Vector Filter - Repeater",
12713:           )("ADBE Vector Repeater Transform")(
12714:             "ADBE Vector Repeater Opacity 2",
12715:           ).expression =
12716:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12717:           secondary_lines("ADBE Vectors Group").addProperty(
12718:             "ADBE Vector Graphic - Fill",
12719:           ).name = "Fill End";
12720:           secondary_lines("ADBE Vectors Group")("Fill End")(
12721:             "ADBE Vector Fill Color",
12722:           ).expression =
12723:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12724:           secondary_lines("ADBE Vectors Group")("Fill End")(
12725:             "ADBE Vector Fill Opacity",
12726:           ).expression =
12727:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
12728:           app.project.activeItem
12729:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
12730:             .duplicate().name = "Ruler Mirror";
12731:           app.project.activeItem
12732:             .layer(
12733:               shapeLayer.name,
12734:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
12735:             .setValue([100, -100]);
12736:           if (BaseLineDropdown.selection.index == 0) {
12737:             app.project.activeItem
12738:               .layer(
12739:                 shapeLayer.name,
12740:               )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
12741:               .remove();
12742:             app.project.activeItem
12743:               .layer(
12744:                 shapeLayer.name,
12745:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
12746:               .remove();
12747:           }
12748:         };
12749:         createBasic_DotLines = function () {
12750:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
12751:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
12752:             "ADBE Vector Shape - Ellipse",
12753:           )("ADBE Vector Ellipse Size").expression =
12754:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
12755:           shorten("Big subdivisions")("ADBE Vectors Group")(
12756:             "ADBE Vector Shape - Ellipse",
12757:           )("ADBE Vector Ellipse Position").expression =
12758:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
12759:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
12760:             "ADBE Vector Graphic - Fill",
12761:           )("ADBE Vector Fill Color").expression =
12762:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
12763:           shorten("Big subdivisions")("ADBE Vectors Group")
12764:             .addProperty("ADBE Vector Filter - Repeater")(
12765:               "ADBE Vector Repeater Copies",
12766:             )
12767:             .setValue(
12768:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
12769:             );
12770:           shorten("Big subdivisions")("ADBE Vectors Group")(
12771:             "ADBE Vector Filter - Repeater",
12772:           )("ADBE Vector Repeater Transform")(
12773:             "ADBE Vector Repeater Position",
12774:           ).expression =
12775:             'try { [effect("ADBE easyRulers")("Gap")*' +
12776:             divideBy +
12777:             ", value[1]] } catch(e) { value }";
12778:           shorten.addProperty("ADBE Vector Group").name =
12779:             "Big subdivisions Base Line";
12780:           shorten("Big subdivisions Base Line")(
12781:             "ADBE Vectors Group",
12782:           ).addProperty("ADBE Vector Shape - Rect")(
12783:             "ADBE Vector Rect Size",
12784:           ).expression =
12785:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
12786:             (EditTextCopies.text - 1) +
12787:             "), 2.5] } catch(e) { value }";
12788:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
12789:             "ADBE Vector Shape - Rect",
12790:           )("ADBE Vector Rect Position").expression =
12791:             'try { [(effect("ADBE easyRulers")("Gap")*' +
12792:             (EditTextCopies.text - 1) +
12793:             ')/2, -20 -effect("ADBE easyRulers")("Height")] } catch(e) { value }';
12794:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
12795:             "ADBE Vector Position",
12796:           ).setValue([0, 45]);
12797:           shorten("Big subdivisions Base Line")(
12798:             "ADBE Vectors Group",
12799:           ).addProperty("ADBE Vector Graphic - Fill")(
12800:             "ADBE Vector Fill Color",
12801:           ).expression =
12802:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
12803:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
12804:           shorten("Main lines")("ADBE Vectors Group").addProperty(
12805:             "ADBE Vector Shape - Ellipse",
12806:           )("ADBE Vector Ellipse Size").expression =
12807:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
12808:           shorten("Main lines")("ADBE Vectors Group")(
12809:             "ADBE Vector Shape - Ellipse",
12810:           )("ADBE Vector Ellipse Position").setValue([0, 25]);
12811:           shorten("Main lines")("ADBE Vectors Group").addProperty(
12812:             "ADBE Vector Graphic - Fill",
12813:           )("ADBE Vector Fill Color").expression =
12814:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
12815:           shorten("Main lines")("ADBE Vectors Group")
12816:             .addProperty(
12817:               "ADBE Vector Filter - Repeater",
12818:             )("ADBE Vector Repeater Copies")
12819:             .setValue(EditTextCopies.text);
12820:           shorten("Main lines")("ADBE Vectors Group")(
12821:             "ADBE Vector Filter - Repeater",
12822:           )("ADBE Vector Repeater Transform")(
12823:             "ADBE Vector Repeater Position",
12824:           ).expression =
12825:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
12826:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
12827:           shorten("Base Line")("ADBE Vectors Group").addProperty(
12828:             "ADBE Vector Shape - Rect",
12829:           )("ADBE Vector Rect Size").expression =
12830:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
12831:             (EditTextCopies.text - 1) +
12832:             "), 2.5] } catch(e) { value }";
12833:           shorten("Base Line")("ADBE Vectors Group")(
12834:             "ADBE Vector Shape - Rect",
12835:           )("ADBE Vector Rect Position").expression =
12836:             'try { [(effect("ADBE easyRulers")("Gap")*' +
12837:             (EditTextCopies.text - 1) +
12838:             ")/2, -20] } catch(e) { value }";
12839:           shorten("Base Line")("ADBE Vector Transform Group")(
12840:             "ADBE Vector Position",
12841:           ).setValue([0, 45]);
12842:           shorten("Base Line")("ADBE Vectors Group").addProperty(
12843:             "ADBE Vector Graphic - Fill",
12844:           )("ADBE Vector Fill Color").expression =
12845:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
12846:           t("ADBE easyRulers")("Dots Scale").setValue(10);
12847:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
12848:           t("ADBE easyRulers")("Height").setValue(15);
12849:           t("ADBE easyRulers")("default Height").setValue(15);
12850:           if (SidesType.selection.index == 2) {
12851:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
12852:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
12853:           }
12854:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
12855:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
12856:           createPointerLinear();
12857:           secondary_lines = app.project.activeItem
12858:             .layer(
12859:               shapeLayer.name,
12860:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
12861:             .duplicate();
12862:           secondary_lines.name = "Main lines - Secondary Color";
12863:           secondary_lines("ADBE Vectors Group")(
12864:             "ADBE Vector Filter - Repeater",
12865:           )("ADBE Vector Repeater Copies").expression =
12866:             'try { if(effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12867:             EditTextCopies.text +
12868:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12869:             EditTextCopies.text +
12870:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12871:             (Number(EditTextCopies.text) - 1) +
12872:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12873:             EditTextCopies.text +
12874:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
12875:             (Number(EditTextCopies.text) - 1) +
12876:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
12877:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
12878:             "ADBE Vector Fill Opacity",
12879:           ).expression =
12880:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
12881:           secondary_lines("ADBE Vector Transform Group")(
12882:             "ADBE Vector Group Opacity",
12883:           ).expression =
12884:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12885:           secondary_lines("ADBE Vectors Group")(
12886:             "ADBE Vector Graphic - Fill",
12887:           ).name = "Fill Start";
12888:           secondary_lines("ADBE Vectors Group")("Fill Start")(
12889:             "ADBE Vector Fill Color",
12890:           ).expression =
12891:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12892:           secondary_lines("ADBE Vectors Group")(
12893:             "ADBE Vector Filter - Repeater",
12894:           )("ADBE Vector Repeater Offset").expression =
12895:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12896:             (Number(EditTextCopies.text) - 1) +
12897:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 } } } catch(e) { value }';
12898:           secondary_lines("ADBE Vectors Group")(
12899:             "ADBE Vector Filter - Repeater",
12900:           )("ADBE Vector Repeater Transform")(
12901:             "ADBE Vector Repeater Opacity 1",
12902:           ).expression =
12903:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12904:           secondary_lines("ADBE Vectors Group")(
12905:             "ADBE Vector Filter - Repeater",
12906:           )("ADBE Vector Repeater Transform")(
12907:             "ADBE Vector Repeater Opacity 2",
12908:           ).expression =
12909:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12910:           secondary_lines("ADBE Vectors Group").addProperty(
12911:             "ADBE Vector Graphic - Fill",
12912:           ).name = "Fill End";
12913:           secondary_lines("ADBE Vectors Group")("Fill End")(
12914:             "ADBE Vector Fill Color",
12915:           ).expression =
12916:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12917:           secondary_lines("ADBE Vectors Group")("Fill End")(
12918:             "ADBE Vector Fill Opacity",
12919:           ).expression =
12920:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
12921:           secondary_lines = app.project.activeItem
12922:             .layer(
12923:               shapeLayer.name,
12924:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
12925:             .duplicate();
12926:           secondary_lines.name = "Big subdivisions - Secondary Color";
12927:           secondary_lines("ADBE Vectors Group")(
12928:             "ADBE Vector Filter - Repeater",
12929:           )("ADBE Vector Repeater Copies").expression =
12930:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
12931:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12932:             1 +
12933:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
12934:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12935:             1 +
12936:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
12937:             (Number(EditTextCopies.text) - 1) +
12938:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
12939:             divideBy +
12940:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
12941:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
12942:             1 +
12943:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
12944:             (Number(EditTextCopies.text) - 1) +
12945:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
12946:             divideBy +
12947:             ") } else { 0 }              }} catch(e) { value }";
12948:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
12949:             "ADBE Vector Fill Opacity",
12950:           ).expression =
12951:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
12952:           secondary_lines("ADBE Vector Transform Group")(
12953:             "ADBE Vector Group Opacity",
12954:           ).expression =
12955:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
12956:           secondary_lines("ADBE Vectors Group")(
12957:             "ADBE Vector Graphic - Fill",
12958:           ).name = "Fill Start";
12959:           secondary_lines("ADBE Vectors Group")("Fill Start")(
12960:             "ADBE Vector Fill Color",
12961:           ).expression =
12962:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
12963:           secondary_lines("ADBE Vectors Group")(
12964:             "ADBE Vector Filter - Repeater",
12965:           )("ADBE Vector Repeater Offset").expression =
12966:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
12967:             (Number(EditTextCopies.text) - 1) +
12968:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
12969:             divideBy +
12970:             ") } else { 0 } } } catch(e) { value }";
12971:           secondary_lines("ADBE Vectors Group")(
12972:             "ADBE Vector Filter - Repeater",
12973:           )("ADBE Vector Repeater Transform")(
12974:             "ADBE Vector Repeater Opacity 1",
12975:           ).expression =
12976:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12977:           secondary_lines("ADBE Vectors Group")(
12978:             "ADBE Vector Filter - Repeater",
12979:           )("ADBE Vector Repeater Transform")(
12980:             "ADBE Vector Repeater Opacity 2",
12981:           ).expression =
12982:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
12983:           secondary_lines("ADBE Vectors Group").addProperty(
12984:             "ADBE Vector Graphic - Fill",
12985:           ).name = "Fill End";
12986:           secondary_lines("ADBE Vectors Group")("Fill End")(
12987:             "ADBE Vector Fill Color",
12988:           ).expression =
12989:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
12990:           secondary_lines("ADBE Vectors Group")("Fill End")(
12991:             "ADBE Vector Fill Opacity",
12992:           ).expression =
12993:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
12994:           app.project.activeItem
12995:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
12996:             .duplicate().name = "Ruler Mirror";
12997:           app.project.activeItem
12998:             .layer(
12999:               shapeLayer.name,
13000:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
13001:             .setValue([100, -100]);
13002:           switch (BaseLineDropdown.selection.index) {
13003:             case 0:
13004:               app.project.activeItem
13005:                 .layer(
13006:                   shapeLayer.name,
13007:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
13008:                 .remove();
13009:               app.project.activeItem
13010:                 .layer(
13011:                   shapeLayer.name,
13012:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
13013:                 .remove();
13014:               app.project.activeItem
13015:                 .layer(
13016:                   shapeLayer.name,
13017:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13018:                 .remove();
13019:               app.project.activeItem
13020:                 .layer(
13021:                   shapeLayer.name,
13022:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13023:                 .remove();
13024:               break;
13025:             case 1:
13026:               app.project.activeItem
13027:                 .layer(
13028:                   shapeLayer.name,
13029:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13030:                 .remove();
13031:               app.project.activeItem
13032:                 .layer(
13033:                   shapeLayer.name,
13034:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13035:                 .remove();
13036:           }
13037:         };
13038:         createBasic10_DotLines = function () {
13039:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
13040:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13041:             "ADBE Vector Shape - Ellipse",
13042:           )("ADBE Vector Ellipse Size").expression =
13043:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
13044:           shorten("Big subdivisions")("ADBE Vectors Group")(
13045:             "ADBE Vector Shape - Ellipse",
13046:           )("ADBE Vector Ellipse Position").expression =
13047:             'try { [value[0], 40 - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
13048:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13049:             "ADBE Vector Graphic - Fill",
13050:           )("ADBE Vector Fill Color").expression =
13051:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13052:           shorten("Big subdivisions")("ADBE Vectors Group")
13053:             .addProperty("ADBE Vector Filter - Repeater")(
13054:               "ADBE Vector Repeater Copies",
13055:             )
13056:             .setValue(
13057:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
13058:             );
13059:           shorten("Big subdivisions")("ADBE Vectors Group")(
13060:             "ADBE Vector Filter - Repeater",
13061:           )("ADBE Vector Repeater Transform")(
13062:             "ADBE Vector Repeater Position",
13063:           ).expression =
13064:             'try { [effect("ADBE easyRulers")("Gap")*' +
13065:             divideBy +
13066:             ", value[1]] } catch(e) { value }";
13067:           shorten.addProperty("ADBE Vector Group").name =
13068:             "Big subdivisions Base Line";
13069:           shorten("Big subdivisions Base Line")(
13070:             "ADBE Vectors Group",
13071:           ).addProperty("ADBE Vector Shape - Rect")(
13072:             "ADBE Vector Rect Size",
13073:           ).expression =
13074:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13075:             (EditTextCopies.text - 1) +
13076:             "), 2.5] } catch(e) { value }";
13077:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
13078:             "ADBE Vector Shape - Rect",
13079:           )("ADBE Vector Rect Position").expression =
13080:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13081:             (EditTextCopies.text - 1) +
13082:             ')/2, -5-effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
13083:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
13084:             "ADBE Vector Position",
13085:           ).setValue([0, 45]);
13086:           shorten("Big subdivisions Base Line")(
13087:             "ADBE Vectors Group",
13088:           ).addProperty("ADBE Vector Graphic - Fill")(
13089:             "ADBE Vector Fill Color",
13090:           ).expression =
13091:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13092:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
13093:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
13094:             "ADBE Vector Shape - Ellipse",
13095:           )("ADBE Vector Ellipse Size").expression =
13096:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
13097:           shorten("Half subdivisions")("ADBE Vectors Group")(
13098:             "ADBE Vector Shape - Ellipse",
13099:           )("ADBE Vector Ellipse Position").expression =
13100:             'try { [value[0], 40 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
13101:           shorten("Half subdivisions")("ADBE Vectors Group")
13102:             .addProperty("ADBE Vector Filter - Repeater")(
13103:               "ADBE Vector Repeater Copies",
13104:             )
13105:             .setValue(
13106:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
13107:                 1,
13108:             );
13109:           shorten("Half subdivisions")("ADBE Vectors Group")(
13110:             "ADBE Vector Filter - Repeater",
13111:           )("ADBE Vector Repeater Transform")(
13112:             "ADBE Vector Repeater Position",
13113:           ).expression =
13114:             'try { [effect("ADBE easyRulers")("Gap")*' +
13115:             divideBy / 2 +
13116:             ", value[1]] } catch(e) { value }";
13117:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
13118:             "ADBE Vector Graphic - Fill",
13119:           )("ADBE Vector Fill Color").expression =
13120:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
13121:           shorten.addProperty("ADBE Vector Group").name =
13122:             "Half subdivisions Base Line";
13123:           shorten("Half subdivisions Base Line")(
13124:             "ADBE Vectors Group",
13125:           ).addProperty("ADBE Vector Shape - Rect")(
13126:             "ADBE Vector Rect Size",
13127:           ).expression =
13128:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13129:             (EditTextCopies.text - 1) +
13130:             "), 2.5] } catch(e) { value }";
13131:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
13132:             "ADBE Vector Shape - Rect",
13133:           )("ADBE Vector Rect Position").expression =
13134:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13135:             (EditTextCopies.text - 1) +
13136:             ')/2, -5-effect("ADBE easyRulers")("Height")] } catch(e) { value }';
13137:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
13138:             "ADBE Vector Position",
13139:           ).setValue([0, 45]);
13140:           shorten("Half subdivisions Base Line")(
13141:             "ADBE Vectors Group",
13142:           ).addProperty("ADBE Vector Graphic - Fill")(
13143:             "ADBE Vector Fill Color",
13144:           ).expression =
13145:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
13146:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
13147:           shorten("Main lines")("ADBE Vectors Group").addProperty(
13148:             "ADBE Vector Shape - Ellipse",
13149:           )("ADBE Vector Ellipse Size").expression =
13150:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
13151:           shorten("Main lines")("ADBE Vectors Group")(
13152:             "ADBE Vector Shape - Ellipse",
13153:           )("ADBE Vector Ellipse Position").setValue([0, 40]);
13154:           shorten("Main lines")("ADBE Vectors Group").addProperty(
13155:             "ADBE Vector Graphic - Fill",
13156:           )("ADBE Vector Fill Color").expression =
13157:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
13158:           shorten("Main lines")("ADBE Vectors Group")
13159:             .addProperty(
13160:               "ADBE Vector Filter - Repeater",
13161:             )("ADBE Vector Repeater Copies")
13162:             .setValue(EditTextCopies.text);
13163:           shorten("Main lines")("ADBE Vectors Group")(
13164:             "ADBE Vector Filter - Repeater",
13165:           )("ADBE Vector Repeater Transform")(
13166:             "ADBE Vector Repeater Position",
13167:           ).expression =
13168:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
13169:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
13170:           shorten("Base Line")("ADBE Vectors Group").addProperty(
13171:             "ADBE Vector Shape - Rect",
13172:           )("ADBE Vector Rect Size").expression =
13173:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13174:             (EditTextCopies.text - 1) +
13175:             "), 2.5] } catch(e) { value }";
13176:           shorten("Base Line")("ADBE Vectors Group")(
13177:             "ADBE Vector Shape - Rect",
13178:           )("ADBE Vector Rect Position").expression =
13179:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13180:             (EditTextCopies.text - 1) +
13181:             ")/2, -5] } catch(e) { value }";
13182:           shorten("Base Line")("ADBE Vector Transform Group")(
13183:             "ADBE Vector Position",
13184:           ).setValue([0, 45]);
13185:           shorten("Base Line")("ADBE Vectors Group").addProperty(
13186:             "ADBE Vector Graphic - Fill",
13187:           )("ADBE Vector Fill Color").expression =
13188:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
13189:           t("ADBE easyRulers")("Dots Scale").setValue(10);
13190:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
13191:           t("ADBE easyRulers")("Height").setValue(15);
13192:           t("ADBE easyRulers")("default Height").setValue(15);
13193:           if (SidesType.selection.index == 2) {
13194:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
13195:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
13196:           }
13197:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(80);
13198:           t("ADBE easyRulers")("default Pointer Distance").setValue(80);
13199:           createPointerLinear();
13200:           secondary_lines = app.project.activeItem
13201:             .layer(
13202:               shapeLayer.name,
13203:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
13204:             .duplicate();
13205:           secondary_lines.name = "Main lines - Secondary Color";
13206:           secondary_lines("ADBE Vectors Group")(
13207:             "ADBE Vector Filter - Repeater",
13208:           )("ADBE Vector Repeater Copies").expression =
13209:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13210:             EditTextCopies.text +
13211:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13212:             EditTextCopies.text +
13213:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
13214:             (Number(EditTextCopies.text) - 1) +
13215:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13216:             EditTextCopies.text +
13217:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13218:             (Number(EditTextCopies.text) - 1) +
13219:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
13220:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13221:             "ADBE Vector Fill Opacity",
13222:           ).expression =
13223:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
13224:           secondary_lines("ADBE Vector Transform Group")(
13225:             "ADBE Vector Group Opacity",
13226:           ).expression =
13227:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13228:           secondary_lines("ADBE Vectors Group")(
13229:             "ADBE Vector Graphic - Fill",
13230:           ).name = "Fill Start";
13231:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13232:             "ADBE Vector Fill Color",
13233:           ).expression =
13234:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13235:           secondary_lines("ADBE Vectors Group")(
13236:             "ADBE Vector Filter - Repeater",
13237:           )("ADBE Vector Repeater Offset").expression =
13238:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13239:             (Number(EditTextCopies.text) - 1) +
13240:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 } } } catch(e) { value }';
13241:           secondary_lines("ADBE Vectors Group")(
13242:             "ADBE Vector Filter - Repeater",
13243:           )("ADBE Vector Repeater Transform")(
13244:             "ADBE Vector Repeater Opacity 1",
13245:           ).expression =
13246:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13247:           secondary_lines("ADBE Vectors Group")(
13248:             "ADBE Vector Filter - Repeater",
13249:           )("ADBE Vector Repeater Transform")(
13250:             "ADBE Vector Repeater Opacity 2",
13251:           ).expression =
13252:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13253:           secondary_lines("ADBE Vectors Group").addProperty(
13254:             "ADBE Vector Graphic - Fill",
13255:           ).name = "Fill End";
13256:           secondary_lines("ADBE Vectors Group")("Fill End")(
13257:             "ADBE Vector Fill Color",
13258:           ).expression =
13259:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13260:           secondary_lines("ADBE Vectors Group")("Fill End")(
13261:             "ADBE Vector Fill Opacity",
13262:           ).expression =
13263:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
13264:           secondary_lines = app.project.activeItem
13265:             .layer(
13266:               shapeLayer.name,
13267:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
13268:             .duplicate();
13269:           secondary_lines.name = "Big subdivisions - Secondary Color";
13270:           secondary_lines("ADBE Vectors Group")(
13271:             "ADBE Vector Filter - Repeater",
13272:           )("ADBE Vector Repeater Copies").expression =
13273:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13274:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13275:             1 +
13276:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13277:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13278:             1 +
13279:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
13280:             (Number(EditTextCopies.text) - 1) +
13281:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
13282:             divideBy +
13283:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13284:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13285:             1 +
13286:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13287:             (Number(EditTextCopies.text) - 1) +
13288:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
13289:             divideBy +
13290:             ") } else { 0 }              }} catch(e) { value }";
13291:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13292:             "ADBE Vector Fill Opacity",
13293:           ).expression =
13294:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
13295:           secondary_lines("ADBE Vector Transform Group")(
13296:             "ADBE Vector Group Opacity",
13297:           ).expression =
13298:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13299:           secondary_lines("ADBE Vectors Group")(
13300:             "ADBE Vector Graphic - Fill",
13301:           ).name = "Fill Start";
13302:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13303:             "ADBE Vector Fill Color",
13304:           ).expression =
13305:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13306:           secondary_lines("ADBE Vectors Group")(
13307:             "ADBE Vector Filter - Repeater",
13308:           )("ADBE Vector Repeater Offset").expression =
13309:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13310:             (Number(EditTextCopies.text) - 1) +
13311:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
13312:             divideBy +
13313:             ") } else { 0 } } } catch(e) { value }";
13314:           secondary_lines("ADBE Vectors Group")(
13315:             "ADBE Vector Filter - Repeater",
13316:           )("ADBE Vector Repeater Transform")(
13317:             "ADBE Vector Repeater Opacity 1",
13318:           ).expression =
13319:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13320:           secondary_lines("ADBE Vectors Group")(
13321:             "ADBE Vector Filter - Repeater",
13322:           )("ADBE Vector Repeater Transform")(
13323:             "ADBE Vector Repeater Opacity 2",
13324:           ).expression =
13325:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13326:           secondary_lines("ADBE Vectors Group").addProperty(
13327:             "ADBE Vector Graphic - Fill",
13328:           ).name = "Fill End";
13329:           secondary_lines("ADBE Vectors Group")("Fill End")(
13330:             "ADBE Vector Fill Color",
13331:           ).expression =
13332:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13333:           secondary_lines("ADBE Vectors Group")("Fill End")(
13334:             "ADBE Vector Fill Opacity",
13335:           ).expression =
13336:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
13337:           secondary_lines = app.project.activeItem
13338:             .layer(
13339:               shapeLayer.name,
13340:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
13341:             .duplicate();
13342:           secondary_lines.name = "Half subdivisions - Secondary Color";
13343:           secondary_lines("ADBE Vectors Group")(
13344:             "ADBE Vector Filter - Repeater",
13345:           )("ADBE Vector Repeater Copies").expression =
13346:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13347:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
13348:             1 +
13349:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13350:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
13351:             1 +
13352:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
13353:             (Number(EditTextCopies.text) - 1) +
13354:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
13355:             divideBy / 2 +
13356:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13357:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
13358:             1 +
13359:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13360:             (Number(EditTextCopies.text) - 1) +
13361:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
13362:             divideBy / 2 +
13363:             ") } else { 0 }              }} catch(e) { value }";
13364:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13365:             "ADBE Vector Fill Opacity",
13366:           ).expression =
13367:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
13368:           secondary_lines("ADBE Vector Transform Group")(
13369:             "ADBE Vector Group Opacity",
13370:           ).expression =
13371:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13372:           secondary_lines("ADBE Vectors Group")(
13373:             "ADBE Vector Graphic - Fill",
13374:           ).name = "Fill Start";
13375:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13376:             "ADBE Vector Fill Color",
13377:           ).expression =
13378:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13379:           secondary_lines("ADBE Vectors Group")(
13380:             "ADBE Vector Filter - Repeater",
13381:           )("ADBE Vector Repeater Offset").expression =
13382:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13383:             (Number(EditTextCopies.text) - 1) +
13384:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
13385:             divideBy / 2 +
13386:             ") } else { 0 } } } catch(e) { value }";
13387:           secondary_lines("ADBE Vectors Group")(
13388:             "ADBE Vector Filter - Repeater",
13389:           )("ADBE Vector Repeater Transform")(
13390:             "ADBE Vector Repeater Opacity 1",
13391:           ).expression =
13392:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13393:           secondary_lines("ADBE Vectors Group")(
13394:             "ADBE Vector Filter - Repeater",
13395:           )("ADBE Vector Repeater Transform")(
13396:             "ADBE Vector Repeater Opacity 2",
13397:           ).expression =
13398:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13399:           secondary_lines("ADBE Vectors Group").addProperty(
13400:             "ADBE Vector Graphic - Fill",
13401:           ).name = "Fill End";
13402:           secondary_lines("ADBE Vectors Group")("Fill End")(
13403:             "ADBE Vector Fill Color",
13404:           ).expression =
13405:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13406:           secondary_lines("ADBE Vectors Group")("Fill End")(
13407:             "ADBE Vector Fill Opacity",
13408:           ).expression =
13409:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
13410:           app.project.activeItem
13411:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
13412:             .duplicate().name = "Ruler Mirror";
13413:           app.project.activeItem
13414:             .layer(
13415:               shapeLayer.name,
13416:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
13417:             .setValue([100, -100]);
13418:           switch (BaseLineDropdown.selection.index) {
13419:             case 0:
13420:               app.project.activeItem
13421:                 .layer(
13422:                   shapeLayer.name,
13423:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
13424:                 .remove();
13425:               app.project.activeItem
13426:                 .layer(
13427:                   shapeLayer.name,
13428:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
13429:                 .remove();
13430:               app.project.activeItem
13431:                 .layer(
13432:                   shapeLayer.name,
13433:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13434:                 .remove();
13435:               app.project.activeItem
13436:                 .layer(
13437:                   shapeLayer.name,
13438:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13439:                 .remove();
13440:               app.project.activeItem
13441:                 .layer(
13442:                   shapeLayer.name,
13443:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
13444:                 .remove();
13445:               app.project.activeItem
13446:                 .layer(
13447:                   shapeLayer.name,
13448:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
13449:                 .remove();
13450:               break;
13451:             case 1:
13452:               app.project.activeItem
13453:                 .layer(
13454:                   shapeLayer.name,
13455:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13456:                 .remove();
13457:               app.project.activeItem
13458:                 .layer(
13459:                   shapeLayer.name,
13460:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13461:                 .remove();
13462:               app.project.activeItem
13463:                 .layer(
13464:                   shapeLayer.name,
13465:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
13466:                 .remove();
13467:               app.project.activeItem
13468:                 .layer(
13469:                   shapeLayer.name,
13470:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
13471:                 .remove();
13472:           }
13473:         };
13474:         createBasic10b_DotLines = function () {
13475:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
13476:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13477:             "ADBE Vector Shape - Ellipse",
13478:           )("ADBE Vector Ellipse Size").expression =
13479:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
13480:           shorten("Big subdivisions")("ADBE Vectors Group")(
13481:             "ADBE Vector Shape - Ellipse",
13482:           )("ADBE Vector Ellipse Position").expression =
13483:             'try { [value[0], 40 - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
13484:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13485:             "ADBE Vector Graphic - Fill",
13486:           )("ADBE Vector Fill Color").expression =
13487:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13488:           shorten("Big subdivisions")("ADBE Vectors Group")
13489:             .addProperty("ADBE Vector Filter - Repeater")(
13490:               "ADBE Vector Repeater Copies",
13491:             )
13492:             .setValue(
13493:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
13494:             );
13495:           shorten("Big subdivisions")("ADBE Vectors Group")(
13496:             "ADBE Vector Filter - Repeater",
13497:           )("ADBE Vector Repeater Transform")(
13498:             "ADBE Vector Repeater Position",
13499:           ).expression =
13500:             'try { [effect("ADBE easyRulers")("Gap")*' +
13501:             divideBy +
13502:             ", value[1]] } catch(e) { value }";
13503:           shorten.addProperty("ADBE Vector Group").name =
13504:             "Big subdivisions Base Line";
13505:           shorten("Big subdivisions Base Line")(
13506:             "ADBE Vectors Group",
13507:           ).addProperty("ADBE Vector Shape - Rect")(
13508:             "ADBE Vector Rect Size",
13509:           ).expression =
13510:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13511:             (EditTextCopies.text - 1) +
13512:             "), 2.5] } catch(e) { value }";
13513:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
13514:             "ADBE Vector Shape - Rect",
13515:           )("ADBE Vector Rect Position").expression =
13516:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13517:             (EditTextCopies.text - 1) +
13518:             ')/2, -5-effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
13519:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
13520:             "ADBE Vector Position",
13521:           ).setValue([0, 45]);
13522:           shorten("Big subdivisions Base Line")(
13523:             "ADBE Vectors Group",
13524:           ).addProperty("ADBE Vector Graphic - Fill")(
13525:             "ADBE Vector Fill Color",
13526:           ).expression =
13527:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13528:           shorten.addProperty("ADBE Vector Group").name = "Fifth subdivisions";
13529:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
13530:             "ADBE Vector Shape - Ellipse",
13531:           )("ADBE Vector Ellipse Size").expression =
13532:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
13533:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
13534:             "ADBE Vector Shape - Ellipse",
13535:           )("ADBE Vector Ellipse Position").expression =
13536:             'try { [value[0], 40 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
13537:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
13538:             "ADBE Vector Graphic - Fill",
13539:           )("ADBE Vector Fill Color").expression =
13540:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
13541:           shorten("Fifth subdivisions")("ADBE Vectors Group")
13542:             .addProperty("ADBE Vector Filter - Repeater")(
13543:               "ADBE Vector Repeater Copies",
13544:             )
13545:             .setValue(
13546:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
13547:                 1,
13548:             );
13549:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
13550:             "ADBE Vector Filter - Repeater",
13551:           )("ADBE Vector Repeater Transform")(
13552:             "ADBE Vector Repeater Position",
13553:           ).expression =
13554:             'try { [effect("ADBE easyRulers")("Gap")*' +
13555:             divideBy / 5 +
13556:             ", value[1]] } catch(e) { value }";
13557:           shorten.addProperty("ADBE Vector Group").name =
13558:             "Fifth subdivisions Base Line";
13559:           shorten("Fifth subdivisions Base Line")(
13560:             "ADBE Vectors Group",
13561:           ).addProperty("ADBE Vector Shape - Rect")(
13562:             "ADBE Vector Rect Size",
13563:           ).expression =
13564:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13565:             (EditTextCopies.text - 1) +
13566:             "), 2.5] } catch(e) { value }";
13567:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
13568:             "ADBE Vector Shape - Rect",
13569:           )("ADBE Vector Rect Position").expression =
13570:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13571:             (EditTextCopies.text - 1) +
13572:             ')/2, -5-effect("ADBE easyRulers")("Height")] } catch(e) { value }';
13573:           shorten("Fifth subdivisions Base Line")(
13574:             "ADBE Vector Transform Group",
13575:           )("ADBE Vector Position").setValue([0, 45]);
13576:           shorten("Fifth subdivisions Base Line")(
13577:             "ADBE Vectors Group",
13578:           ).addProperty("ADBE Vector Graphic - Fill")(
13579:             "ADBE Vector Fill Color",
13580:           ).expression =
13581:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
13582:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
13583:           shorten("Main lines")("ADBE Vectors Group").addProperty(
13584:             "ADBE Vector Shape - Ellipse",
13585:           )("ADBE Vector Ellipse Size").expression =
13586:             'try { [effect("ADBE easyRulers")("Dots Scale") + effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
13587:           shorten("Main lines")("ADBE Vectors Group")(
13588:             "ADBE Vector Shape - Ellipse",
13589:           )("ADBE Vector Ellipse Position").setValue([0, 40]);
13590:           shorten("Main lines")("ADBE Vectors Group").addProperty(
13591:             "ADBE Vector Graphic - Fill",
13592:           )("ADBE Vector Fill Color").expression =
13593:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
13594:           shorten("Main lines")("ADBE Vectors Group")
13595:             .addProperty(
13596:               "ADBE Vector Filter - Repeater",
13597:             )("ADBE Vector Repeater Copies")
13598:             .setValue(EditTextCopies.text);
13599:           shorten("Main lines")("ADBE Vectors Group")(
13600:             "ADBE Vector Filter - Repeater",
13601:           )("ADBE Vector Repeater Transform")(
13602:             "ADBE Vector Repeater Position",
13603:           ).expression =
13604:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
13605:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
13606:           shorten("Base Line")("ADBE Vectors Group").addProperty(
13607:             "ADBE Vector Shape - Rect",
13608:           )("ADBE Vector Rect Size").expression =
13609:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13610:             (EditTextCopies.text - 1) +
13611:             "), 2.5] } catch(e) { value }";
13612:           shorten("Base Line")("ADBE Vectors Group")(
13613:             "ADBE Vector Shape - Rect",
13614:           )("ADBE Vector Rect Position").expression =
13615:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13616:             (EditTextCopies.text - 1) +
13617:             ")/2, -5] } catch(e) { value }";
13618:           shorten("Base Line")("ADBE Vector Transform Group")(
13619:             "ADBE Vector Position",
13620:           ).setValue([0, 45]);
13621:           shorten("Base Line")("ADBE Vectors Group").addProperty(
13622:             "ADBE Vector Graphic - Fill",
13623:           )("ADBE Vector Fill Color").expression =
13624:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
13625:           t("ADBE easyRulers")("Dots Scale").setValue(10);
13626:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
13627:           t("ADBE easyRulers")("Height").setValue(15);
13628:           t("ADBE easyRulers")("default Height").setValue(15);
13629:           if (SidesType.selection.index == 2) {
13630:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
13631:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
13632:           }
13633:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(85);
13634:           t("ADBE easyRulers")("default Pointer Distance").setValue(85);
13635:           createPointerLinear();
13636:           secondary_lines = app.project.activeItem
13637:             .layer(
13638:               shapeLayer.name,
13639:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
13640:             .duplicate();
13641:           secondary_lines.name = "Main lines - Secondary Color";
13642:           secondary_lines("ADBE Vectors Group")(
13643:             "ADBE Vector Filter - Repeater",
13644:           )("ADBE Vector Repeater Copies").expression =
13645:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13646:             EditTextCopies.text +
13647:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13648:             EditTextCopies.text +
13649:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
13650:             (Number(EditTextCopies.text) - 1) +
13651:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }                } else {                     if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13652:             EditTextCopies.text +
13653:             ' } else                     if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13654:             (Number(EditTextCopies.text) - 1) +
13655:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
13656:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13657:             "ADBE Vector Fill Opacity",
13658:           ).expression =
13659:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
13660:           secondary_lines("ADBE Vector Transform Group")(
13661:             "ADBE Vector Group Opacity",
13662:           ).expression =
13663:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13664:           secondary_lines("ADBE Vectors Group")(
13665:             "ADBE Vector Graphic - Fill",
13666:           ).name = "Fill Start";
13667:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13668:             "ADBE Vector Fill Color",
13669:           ).expression =
13670:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13671:           secondary_lines("ADBE Vectors Group")(
13672:             "ADBE Vector Filter - Repeater",
13673:           )("ADBE Vector Repeater Offset").expression =
13674:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13675:             (Number(EditTextCopies.text) - 1) +
13676:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 } } } catch(e) { value }';
13677:           secondary_lines("ADBE Vectors Group")(
13678:             "ADBE Vector Filter - Repeater",
13679:           )("ADBE Vector Repeater Transform")(
13680:             "ADBE Vector Repeater Opacity 1",
13681:           ).expression =
13682:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13683:           secondary_lines("ADBE Vectors Group")(
13684:             "ADBE Vector Filter - Repeater",
13685:           )("ADBE Vector Repeater Transform")(
13686:             "ADBE Vector Repeater Opacity 2",
13687:           ).expression =
13688:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13689:           secondary_lines("ADBE Vectors Group").addProperty(
13690:             "ADBE Vector Graphic - Fill",
13691:           ).name = "Fill End";
13692:           secondary_lines("ADBE Vectors Group")("Fill End")(
13693:             "ADBE Vector Fill Color",
13694:           ).expression =
13695:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13696:           secondary_lines("ADBE Vectors Group")("Fill End")(
13697:             "ADBE Vector Fill Opacity",
13698:           ).expression =
13699:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
13700:           secondary_lines = app.project.activeItem
13701:             .layer(
13702:               shapeLayer.name,
13703:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
13704:             .duplicate();
13705:           secondary_lines.name = "Big subdivisions - Secondary Color";
13706:           secondary_lines("ADBE Vectors Group")(
13707:             "ADBE Vector Filter - Repeater",
13708:           )("ADBE Vector Repeater Copies").expression =
13709:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13710:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13711:             1 +
13712:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13713:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13714:             1 +
13715:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
13716:             (Number(EditTextCopies.text) - 1) +
13717:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
13718:             divideBy +
13719:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13720:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
13721:             1 +
13722:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13723:             (Number(EditTextCopies.text) - 1) +
13724:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
13725:             divideBy +
13726:             ") } else { 0 }              }} catch(e) { value }";
13727:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13728:             "ADBE Vector Fill Opacity",
13729:           ).expression =
13730:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
13731:           secondary_lines("ADBE Vector Transform Group")(
13732:             "ADBE Vector Group Opacity",
13733:           ).expression =
13734:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13735:           secondary_lines("ADBE Vectors Group")(
13736:             "ADBE Vector Graphic - Fill",
13737:           ).name = "Fill Start";
13738:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13739:             "ADBE Vector Fill Color",
13740:           ).expression =
13741:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13742:           secondary_lines("ADBE Vectors Group")(
13743:             "ADBE Vector Filter - Repeater",
13744:           )("ADBE Vector Repeater Offset").expression =
13745:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13746:             (Number(EditTextCopies.text) - 1) +
13747:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
13748:             divideBy +
13749:             ") } else { 0 } } } catch(e) { value }";
13750:           secondary_lines("ADBE Vectors Group")(
13751:             "ADBE Vector Filter - Repeater",
13752:           )("ADBE Vector Repeater Transform")(
13753:             "ADBE Vector Repeater Opacity 1",
13754:           ).expression =
13755:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13756:           secondary_lines("ADBE Vectors Group")(
13757:             "ADBE Vector Filter - Repeater",
13758:           )("ADBE Vector Repeater Transform")(
13759:             "ADBE Vector Repeater Opacity 2",
13760:           ).expression =
13761:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13762:           secondary_lines("ADBE Vectors Group").addProperty(
13763:             "ADBE Vector Graphic - Fill",
13764:           ).name = "Fill End";
13765:           secondary_lines("ADBE Vectors Group")("Fill End")(
13766:             "ADBE Vector Fill Color",
13767:           ).expression =
13768:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13769:           secondary_lines("ADBE Vectors Group")("Fill End")(
13770:             "ADBE Vector Fill Opacity",
13771:           ).expression =
13772:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
13773:           secondary_lines = app.project.activeItem
13774:             .layer(
13775:               shapeLayer.name,
13776:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions")
13777:             .duplicate();
13778:           secondary_lines.name = "Fifth subdivisions - Secondary Color";
13779:           secondary_lines("ADBE Vectors Group")(
13780:             "ADBE Vector Filter - Repeater",
13781:           )("ADBE Vector Repeater Copies").expression =
13782:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
13783:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
13784:             1 +
13785:             '-content("Ruler").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
13786:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
13787:             1 +
13788:             '-content("Ruler Mirror").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
13789:             (Number(EditTextCopies.text) - 1) +
13790:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
13791:             divideBy / 5 +
13792:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
13793:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
13794:             1 +
13795:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
13796:             (Number(EditTextCopies.text) - 1) +
13797:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
13798:             divideBy / 5 +
13799:             ") } else { 0 }              }} catch(e) { value }";
13800:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
13801:             "ADBE Vector Fill Opacity",
13802:           ).expression =
13803:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
13804:           secondary_lines("ADBE Vector Transform Group")(
13805:             "ADBE Vector Group Opacity",
13806:           ).expression =
13807:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
13808:           secondary_lines("ADBE Vectors Group")(
13809:             "ADBE Vector Graphic - Fill",
13810:           ).name = "Fill Start";
13811:           secondary_lines("ADBE Vectors Group")("Fill Start")(
13812:             "ADBE Vector Fill Color",
13813:           ).expression =
13814:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
13815:           secondary_lines("ADBE Vectors Group")(
13816:             "ADBE Vector Filter - Repeater",
13817:           )("ADBE Vector Repeater Offset").expression =
13818:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
13819:             (Number(EditTextCopies.text) - 1) +
13820:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
13821:             divideBy / 5 +
13822:             ") } else { 0 } } } catch(e) { value }";
13823:           secondary_lines("ADBE Vectors Group")(
13824:             "ADBE Vector Filter - Repeater",
13825:           )("ADBE Vector Repeater Transform")(
13826:             "ADBE Vector Repeater Opacity 1",
13827:           ).expression =
13828:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13829:           secondary_lines("ADBE Vectors Group")(
13830:             "ADBE Vector Filter - Repeater",
13831:           )("ADBE Vector Repeater Transform")(
13832:             "ADBE Vector Repeater Opacity 2",
13833:           ).expression =
13834:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
13835:           secondary_lines("ADBE Vectors Group").addProperty(
13836:             "ADBE Vector Graphic - Fill",
13837:           ).name = "Fill End";
13838:           secondary_lines("ADBE Vectors Group")("Fill End")(
13839:             "ADBE Vector Fill Color",
13840:           ).expression =
13841:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
13842:           secondary_lines("ADBE Vectors Group")("Fill End")(
13843:             "ADBE Vector Fill Opacity",
13844:           ).expression =
13845:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
13846:           app.project.activeItem
13847:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
13848:             .duplicate().name = "Ruler Mirror";
13849:           app.project.activeItem
13850:             .layer(
13851:               shapeLayer.name,
13852:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
13853:             .setValue([100, -100]);
13854:           switch (BaseLineDropdown.selection.index) {
13855:             case 0:
13856:               app.project.activeItem
13857:                 .layer(
13858:                   shapeLayer.name,
13859:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
13860:                 .remove();
13861:               app.project.activeItem
13862:                 .layer(
13863:                   shapeLayer.name,
13864:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
13865:                 .remove();
13866:               app.project.activeItem
13867:                 .layer(
13868:                   shapeLayer.name,
13869:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13870:                 .remove();
13871:               app.project.activeItem
13872:                 .layer(
13873:                   shapeLayer.name,
13874:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13875:                 .remove();
13876:               app.project.activeItem
13877:                 .layer(
13878:                   shapeLayer.name,
13879:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
13880:                 .remove();
13881:               app.project.activeItem
13882:                 .layer(
13883:                   shapeLayer.name,
13884:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
13885:                 .remove();
13886:               break;
13887:             case 1:
13888:               app.project.activeItem
13889:                 .layer(
13890:                   shapeLayer.name,
13891:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
13892:                 .remove();
13893:               app.project.activeItem
13894:                 .layer(
13895:                   shapeLayer.name,
13896:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
13897:                 .remove();
13898:               app.project.activeItem
13899:                 .layer(
13900:                   shapeLayer.name,
13901:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
13902:                 .remove();
13903:               app.project.activeItem
13904:                 .layer(
13905:                   shapeLayer.name,
13906:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
13907:                 .remove();
13908:           }
13909:         };
13910:         createBasic16_DotLines = function () {
13911:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
13912:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13913:             "ADBE Vector Shape - Ellipse",
13914:           )("ADBE Vector Ellipse Size").expression =
13915:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2.5] } catch(e) { value }';
13916:           shorten("Big subdivisions")("ADBE Vectors Group")(
13917:             "ADBE Vector Shape - Ellipse",
13918:           )("ADBE Vector Ellipse Position").expression =
13919:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")*3] } catch(e) { value }';
13920:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
13921:             "ADBE Vector Graphic - Fill",
13922:           )("ADBE Vector Fill Color").expression =
13923:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13924:           shorten("Big subdivisions")("ADBE Vectors Group")
13925:             .addProperty("ADBE Vector Filter - Repeater")(
13926:               "ADBE Vector Repeater Copies",
13927:             )
13928:             .setValue(
13929:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
13930:             );
13931:           shorten("Big subdivisions")("ADBE Vectors Group")(
13932:             "ADBE Vector Filter - Repeater",
13933:           )("ADBE Vector Repeater Transform")(
13934:             "ADBE Vector Repeater Position",
13935:           ).expression =
13936:             'try { [effect("ADBE easyRulers")("Gap")*' +
13937:             divideBy +
13938:             ", value[1]] } catch(e) { value }";
13939:           shorten.addProperty("ADBE Vector Group").name =
13940:             "Big subdivisions Base Line";
13941:           shorten("Big subdivisions Base Line")(
13942:             "ADBE Vectors Group",
13943:           ).addProperty("ADBE Vector Shape - Rect")(
13944:             "ADBE Vector Rect Size",
13945:           ).expression =
13946:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
13947:             (EditTextCopies.text - 1) +
13948:             "), 2.5] } catch(e) { value }";
13949:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
13950:             "ADBE Vector Shape - Rect",
13951:           )("ADBE Vector Rect Position").expression =
13952:             'try { [(effect("ADBE easyRulers")("Gap")*' +
13953:             (EditTextCopies.text - 1) +
13954:             ')/2, 10-effect("ADBE easyRulers")("Height")*3] } catch(e) { value }';
13955:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
13956:             "ADBE Vector Position",
13957:           ).setValue([0, 45]);
13958:           shorten("Big subdivisions Base Line")(
13959:             "ADBE Vectors Group",
13960:           ).addProperty("ADBE Vector Graphic - Fill")(
13961:             "ADBE Vector Fill Color",
13962:           ).expression =
13963:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
13964:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
13965:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
13966:             "ADBE Vector Shape - Ellipse",
13967:           )("ADBE Vector Ellipse Size").expression =
13968:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
13969:           shorten("Half subdivisions")("ADBE Vectors Group")(
13970:             "ADBE Vector Shape - Ellipse",
13971:           )("ADBE Vector Ellipse Position").expression =
13972:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
13973:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
13974:             "ADBE Vector Graphic - Fill",
13975:           )("ADBE Vector Fill Color").expression =
13976:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
13977:           shorten("Half subdivisions")("ADBE Vectors Group")
13978:             .addProperty("ADBE Vector Filter - Repeater")(
13979:               "ADBE Vector Repeater Copies",
13980:             )
13981:             .setValue(
13982:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
13983:                 1,
13984:             );
13985:           shorten("Half subdivisions")("ADBE Vectors Group")(
13986:             "ADBE Vector Filter - Repeater",
13987:           )("ADBE Vector Repeater Transform")(
13988:             "ADBE Vector Repeater Position",
13989:           ).expression =
13990:             'try { [effect("ADBE easyRulers")("Gap")*' +
13991:             divideBy / 2 +
13992:             ", value[1]] } catch(e) { value }";
13993:           shorten.addProperty("ADBE Vector Group").name =
13994:             "Half subdivisions Base Line";
13995:           shorten("Half subdivisions Base Line")(
13996:             "ADBE Vectors Group",
13997:           ).addProperty("ADBE Vector Shape - Rect")(
13998:             "ADBE Vector Rect Size",
13999:           ).expression =
14000:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14001:             (EditTextCopies.text - 1) +
14002:             "), 2.5] } catch(e) { value }";
14003:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
14004:             "ADBE Vector Shape - Rect",
14005:           )("ADBE Vector Rect Position").expression =
14006:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14007:             (EditTextCopies.text - 1) +
14008:             ')/2, 10-effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
14009:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
14010:             "ADBE Vector Position",
14011:           ).setValue([0, 45]);
14012:           shorten("Half subdivisions Base Line")(
14013:             "ADBE Vectors Group",
14014:           ).addProperty("ADBE Vector Graphic - Fill")(
14015:             "ADBE Vector Fill Color",
14016:           ).expression =
14017:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
14018:           shorten.addProperty("ADBE Vector Group").name =
14019:             "Quarter subdivisions";
14020:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
14021:             "ADBE Vector Shape - Ellipse",
14022:           )("ADBE Vector Ellipse Size").expression =
14023:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
14024:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
14025:             "ADBE Vector Shape - Ellipse",
14026:           )("ADBE Vector Ellipse Position").expression =
14027:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
14028:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
14029:             "ADBE Vector Graphic - Fill",
14030:           )("ADBE Vector Fill Color").expression =
14031:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
14032:           shorten("Quarter subdivisions")("ADBE Vectors Group")
14033:             .addProperty("ADBE Vector Filter - Repeater")(
14034:               "ADBE Vector Repeater Copies",
14035:             )
14036:             .setValue(
14037:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14038:                 1,
14039:             );
14040:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
14041:             "ADBE Vector Filter - Repeater",
14042:           )("ADBE Vector Repeater Transform")(
14043:             "ADBE Vector Repeater Position",
14044:           ).expression =
14045:             'try { [effect("ADBE easyRulers")("Gap")*' +
14046:             divideBy / 4 +
14047:             ", value[1]] } catch(e) { value }";
14048:           shorten.addProperty("ADBE Vector Group").name =
14049:             "Quarter subdivisions Base Line";
14050:           shorten("Quarter subdivisions Base Line")(
14051:             "ADBE Vectors Group",
14052:           ).addProperty("ADBE Vector Shape - Rect")(
14053:             "ADBE Vector Rect Size",
14054:           ).expression =
14055:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14056:             (EditTextCopies.text - 1) +
14057:             "), 2.5] } catch(e) { value }";
14058:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
14059:             "ADBE Vector Shape - Rect",
14060:           )("ADBE Vector Rect Position").expression =
14061:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14062:             (EditTextCopies.text - 1) +
14063:             ')/2, 10-effect("ADBE easyRulers")("Height")] } catch(e) { value }';
14064:           shorten("Quarter subdivisions Base Line")(
14065:             "ADBE Vector Transform Group",
14066:           )("ADBE Vector Position").setValue([0, 45]);
14067:           shorten("Quarter subdivisions Base Line")(
14068:             "ADBE Vectors Group",
14069:           ).addProperty("ADBE Vector Graphic - Fill")(
14070:             "ADBE Vector Fill Color",
14071:           ).expression =
14072:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
14073:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
14074:           shorten("Main lines")("ADBE Vectors Group").addProperty(
14075:             "ADBE Vector Shape - Ellipse",
14076:           )("ADBE Vector Ellipse Size").expression =
14077:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
14078:           shorten("Main lines")("ADBE Vectors Group")(
14079:             "ADBE Vector Shape - Ellipse",
14080:           )("ADBE Vector Ellipse Position").setValue([0, 55]);
14081:           shorten("Main lines")("ADBE Vectors Group").addProperty(
14082:             "ADBE Vector Graphic - Fill",
14083:           )("ADBE Vector Fill Color").expression =
14084:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
14085:           shorten("Main lines")("ADBE Vectors Group")
14086:             .addProperty(
14087:               "ADBE Vector Filter - Repeater",
14088:             )("ADBE Vector Repeater Copies")
14089:             .setValue(EditTextCopies.text);
14090:           shorten("Main lines")("ADBE Vectors Group")(
14091:             "ADBE Vector Filter - Repeater",
14092:           )("ADBE Vector Repeater Transform")(
14093:             "ADBE Vector Repeater Position",
14094:           ).expression =
14095:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
14096:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
14097:           shorten("Base Line")("ADBE Vectors Group").addProperty(
14098:             "ADBE Vector Shape - Rect",
14099:           )("ADBE Vector Rect Size").expression =
14100:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14101:             (EditTextCopies.text - 1) +
14102:             "), 2.5] } catch(e) { value }";
14103:           shorten("Base Line")("ADBE Vectors Group")(
14104:             "ADBE Vector Shape - Rect",
14105:           )("ADBE Vector Rect Position").expression =
14106:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14107:             (EditTextCopies.text - 1) +
14108:             ")/2, value[1]+10] } catch(e) { value }";
14109:           shorten("Base Line")("ADBE Vector Transform Group")(
14110:             "ADBE Vector Position",
14111:           ).setValue([0, 45]);
14112:           shorten("Base Line")("ADBE Vectors Group").addProperty(
14113:             "ADBE Vector Graphic - Fill",
14114:           )("ADBE Vector Fill Color").expression =
14115:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
14116:           t("ADBE easyRulers")("Dots Scale").setValue(10);
14117:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
14118:           t("ADBE easyRulers")("Height").setValue(15);
14119:           t("ADBE easyRulers")("default Height").setValue(15);
14120:           if (SidesType.selection.index == 2) {
14121:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
14122:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
14123:           }
14124:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(85);
14125:           t("ADBE easyRulers")("default Pointer Distance").setValue(85);
14126:           createPointerLinear();
14127:           secondary_lines = app.project.activeItem
14128:             .layer(
14129:               shapeLayer.name,
14130:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
14131:             .duplicate();
14132:           secondary_lines.name = "Main lines - Secondary Color";
14133:           secondary_lines("ADBE Vectors Group")(
14134:             "ADBE Vector Filter - Repeater",
14135:           )("ADBE Vector Repeater Copies").expression =
14136:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14137:             EditTextCopies.text +
14138:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14139:             EditTextCopies.text +
14140:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14141:             (Number(EditTextCopies.text) - 1) +
14142:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14143:             EditTextCopies.text +
14144:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14145:             (Number(EditTextCopies.text) - 1) +
14146:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
14147:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14148:             "ADBE Vector Fill Opacity",
14149:           ).expression =
14150:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
14151:           secondary_lines("ADBE Vector Transform Group")(
14152:             "ADBE Vector Group Opacity",
14153:           ).expression =
14154:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14155:           secondary_lines("ADBE Vectors Group")(
14156:             "ADBE Vector Graphic - Fill",
14157:           ).name = "Fill Start";
14158:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14159:             "ADBE Vector Fill Color",
14160:           ).expression =
14161:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14162:           secondary_lines("ADBE Vectors Group")(
14163:             "ADBE Vector Filter - Repeater",
14164:           )("ADBE Vector Repeater Offset").expression =
14165:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14166:             (Number(EditTextCopies.text) - 1) +
14167:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 } } } catch(e) { value }';
14168:           secondary_lines("ADBE Vectors Group")(
14169:             "ADBE Vector Filter - Repeater",
14170:           )("ADBE Vector Repeater Transform")(
14171:             "ADBE Vector Repeater Opacity 1",
14172:           ).expression =
14173:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14174:           secondary_lines("ADBE Vectors Group")(
14175:             "ADBE Vector Filter - Repeater",
14176:           )("ADBE Vector Repeater Transform")(
14177:             "ADBE Vector Repeater Opacity 2",
14178:           ).expression =
14179:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14180:           secondary_lines("ADBE Vectors Group").addProperty(
14181:             "ADBE Vector Graphic - Fill",
14182:           ).name = "Fill End";
14183:           secondary_lines("ADBE Vectors Group")("Fill End")(
14184:             "ADBE Vector Fill Color",
14185:           ).expression =
14186:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14187:           secondary_lines("ADBE Vectors Group")("Fill End")(
14188:             "ADBE Vector Fill Opacity",
14189:           ).expression =
14190:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
14191:           secondary_lines = app.project.activeItem
14192:             .layer(
14193:               shapeLayer.name,
14194:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
14195:             .duplicate();
14196:           secondary_lines.name = "Big subdivisions - Secondary Color";
14197:           secondary_lines("ADBE Vectors Group")(
14198:             "ADBE Vector Filter - Repeater",
14199:           )("ADBE Vector Repeater Copies").expression =
14200:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14201:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14202:             1 +
14203:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14204:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14205:             1 +
14206:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14207:             (Number(EditTextCopies.text) - 1) +
14208:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14209:             divideBy +
14210:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14211:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14212:             1 +
14213:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14214:             (Number(EditTextCopies.text) - 1) +
14215:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
14216:             divideBy +
14217:             ") } else { 0 }              }} catch(e) { value }";
14218:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14219:             "ADBE Vector Fill Opacity",
14220:           ).expression =
14221:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
14222:           secondary_lines("ADBE Vector Transform Group")(
14223:             "ADBE Vector Group Opacity",
14224:           ).expression =
14225:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14226:           secondary_lines("ADBE Vectors Group")(
14227:             "ADBE Vector Graphic - Fill",
14228:           ).name = "Fill Start";
14229:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14230:             "ADBE Vector Fill Color",
14231:           ).expression =
14232:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14233:           secondary_lines("ADBE Vectors Group")(
14234:             "ADBE Vector Filter - Repeater",
14235:           )("ADBE Vector Repeater Offset").expression =
14236:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14237:             (Number(EditTextCopies.text) - 1) +
14238:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
14239:             divideBy +
14240:             ") } else { 0 } } } catch(e) { value }";
14241:           secondary_lines("ADBE Vectors Group")(
14242:             "ADBE Vector Filter - Repeater",
14243:           )("ADBE Vector Repeater Transform")(
14244:             "ADBE Vector Repeater Opacity 1",
14245:           ).expression =
14246:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14247:           secondary_lines("ADBE Vectors Group")(
14248:             "ADBE Vector Filter - Repeater",
14249:           )("ADBE Vector Repeater Transform")(
14250:             "ADBE Vector Repeater Opacity 2",
14251:           ).expression =
14252:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14253:           secondary_lines("ADBE Vectors Group").addProperty(
14254:             "ADBE Vector Graphic - Fill",
14255:           ).name = "Fill End";
14256:           secondary_lines("ADBE Vectors Group")("Fill End")(
14257:             "ADBE Vector Fill Color",
14258:           ).expression =
14259:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14260:           secondary_lines("ADBE Vectors Group")("Fill End")(
14261:             "ADBE Vector Fill Opacity",
14262:           ).expression =
14263:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
14264:           secondary_lines = app.project.activeItem
14265:             .layer(
14266:               shapeLayer.name,
14267:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
14268:             .duplicate();
14269:           secondary_lines.name = "Half subdivisions - Secondary Color";
14270:           secondary_lines("ADBE Vectors Group")(
14271:             "ADBE Vector Filter - Repeater",
14272:           )("ADBE Vector Repeater Copies").expression =
14273:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14274:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14275:             1 +
14276:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14277:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14278:             1 +
14279:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
14280:             (Number(EditTextCopies.text) - 1) +
14281:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14282:             divideBy / 2 +
14283:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14284:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14285:             1 +
14286:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14287:             (Number(EditTextCopies.text) - 1) +
14288:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
14289:             divideBy / 2 +
14290:             ") } else { 0 }              }} catch(e) { value }";
14291:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14292:             "ADBE Vector Fill Opacity",
14293:           ).expression =
14294:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
14295:           secondary_lines("ADBE Vector Transform Group")(
14296:             "ADBE Vector Group Opacity",
14297:           ).expression =
14298:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14299:           secondary_lines("ADBE Vectors Group")(
14300:             "ADBE Vector Graphic - Fill",
14301:           ).name = "Fill Start";
14302:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14303:             "ADBE Vector Fill Color",
14304:           ).expression =
14305:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14306:           secondary_lines("ADBE Vectors Group")(
14307:             "ADBE Vector Filter - Repeater",
14308:           )("ADBE Vector Repeater Offset").expression =
14309:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14310:             (Number(EditTextCopies.text) - 1) +
14311:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
14312:             divideBy / 2 +
14313:             ") } else { 0 } } } catch(e) { value }";
14314:           secondary_lines("ADBE Vectors Group")(
14315:             "ADBE Vector Filter - Repeater",
14316:           )("ADBE Vector Repeater Transform")(
14317:             "ADBE Vector Repeater Opacity 1",
14318:           ).expression =
14319:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14320:           secondary_lines("ADBE Vectors Group")(
14321:             "ADBE Vector Filter - Repeater",
14322:           )("ADBE Vector Repeater Transform")(
14323:             "ADBE Vector Repeater Opacity 2",
14324:           ).expression =
14325:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14326:           secondary_lines("ADBE Vectors Group").addProperty(
14327:             "ADBE Vector Graphic - Fill",
14328:           ).name = "Fill End";
14329:           secondary_lines("ADBE Vectors Group")("Fill End")(
14330:             "ADBE Vector Fill Color",
14331:           ).expression =
14332:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14333:           secondary_lines("ADBE Vectors Group")("Fill End")(
14334:             "ADBE Vector Fill Opacity",
14335:           ).expression =
14336:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
14337:           secondary_lines = app.project.activeItem
14338:             .layer(
14339:               shapeLayer.name,
14340:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
14341:             .duplicate();
14342:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
14343:           secondary_lines("ADBE Vectors Group")(
14344:             "ADBE Vector Filter - Repeater",
14345:           )("ADBE Vector Repeater Copies").expression =
14346:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14347:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14348:             1 +
14349:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14350:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14351:             1 +
14352:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14353:             (Number(EditTextCopies.text) - 1) +
14354:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14355:             divideBy / 4 +
14356:             ') }              } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14357:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14358:             1 +
14359:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14360:             (Number(EditTextCopies.text) - 1) +
14361:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
14362:             divideBy / 4 +
14363:             ") } else { 0 }              }} catch(e) { value }";
14364:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14365:             "ADBE Vector Fill Opacity",
14366:           ).expression =
14367:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
14368:           secondary_lines("ADBE Vector Transform Group")(
14369:             "ADBE Vector Group Opacity",
14370:           ).expression =
14371:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14372:           secondary_lines("ADBE Vectors Group")(
14373:             "ADBE Vector Graphic - Fill",
14374:           ).name = "Fill Start";
14375:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14376:             "ADBE Vector Fill Color",
14377:           ).expression =
14378:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14379:           secondary_lines("ADBE Vectors Group")(
14380:             "ADBE Vector Filter - Repeater",
14381:           )("ADBE Vector Repeater Offset").expression =
14382:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14383:             (Number(EditTextCopies.text) - 1) +
14384:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
14385:             divideBy / 4 +
14386:             ") } else { 0 } } } catch(e) { value }";
14387:           secondary_lines("ADBE Vectors Group")(
14388:             "ADBE Vector Filter - Repeater",
14389:           )("ADBE Vector Repeater Transform")(
14390:             "ADBE Vector Repeater Opacity 1",
14391:           ).expression =
14392:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14393:           secondary_lines("ADBE Vectors Group")(
14394:             "ADBE Vector Filter - Repeater",
14395:           )("ADBE Vector Repeater Transform")(
14396:             "ADBE Vector Repeater Opacity 2",
14397:           ).expression =
14398:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14399:           secondary_lines("ADBE Vectors Group").addProperty(
14400:             "ADBE Vector Graphic - Fill",
14401:           ).name = "Fill End";
14402:           secondary_lines("ADBE Vectors Group")("Fill End")(
14403:             "ADBE Vector Fill Color",
14404:           ).expression =
14405:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14406:           secondary_lines("ADBE Vectors Group")("Fill End")(
14407:             "ADBE Vector Fill Opacity",
14408:           ).expression =
14409:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
14410:           app.project.activeItem
14411:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
14412:             .duplicate().name = "Ruler Mirror";
14413:           app.project.activeItem
14414:             .layer(
14415:               shapeLayer.name,
14416:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
14417:             .setValue([100, -100]);
14418:           switch (BaseLineDropdown.selection.index) {
14419:             case 0:
14420:               app.project.activeItem
14421:                 .layer(
14422:                   shapeLayer.name,
14423:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
14424:                 .remove();
14425:               app.project.activeItem
14426:                 .layer(
14427:                   shapeLayer.name,
14428:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
14429:                 .remove();
14430:               app.project.activeItem
14431:                 .layer(
14432:                   shapeLayer.name,
14433:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
14434:                 .remove();
14435:               app.project.activeItem
14436:                 .layer(
14437:                   shapeLayer.name,
14438:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
14439:                 .remove();
14440:               app.project.activeItem
14441:                 .layer(
14442:                   shapeLayer.name,
14443:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
14444:                 .remove();
14445:               app.project.activeItem
14446:                 .layer(
14447:                   shapeLayer.name,
14448:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
14449:                 .remove();
14450:               app.project.activeItem
14451:                 .layer(
14452:                   shapeLayer.name,
14453:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
14454:                 .remove();
14455:               app.project.activeItem
14456:                 .layer(
14457:                   shapeLayer.name,
14458:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
14459:                 .remove();
14460:               break;
14461:             case 1:
14462:               app.project.activeItem
14463:                 .layer(
14464:                   shapeLayer.name,
14465:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
14466:                 .remove();
14467:               app.project.activeItem
14468:                 .layer(
14469:                   shapeLayer.name,
14470:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
14471:                 .remove();
14472:               app.project.activeItem
14473:                 .layer(
14474:                   shapeLayer.name,
14475:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
14476:                 .remove();
14477:               app.project.activeItem
14478:                 .layer(
14479:                   shapeLayer.name,
14480:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
14481:                 .remove();
14482:               app.project.activeItem
14483:                 .layer(
14484:                   shapeLayer.name,
14485:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
14486:                 .remove();
14487:               app.project.activeItem
14488:                 .layer(
14489:                   shapeLayer.name,
14490:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
14491:                 .remove();
14492:           }
14493:         };
14494:         createBasic16b_DotLines = function () {
14495:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
14496:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
14497:             "ADBE Vector Shape - Ellipse",
14498:           )("ADBE Vector Ellipse Size").expression =
14499:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*3, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*3] } catch(e) { value }';
14500:           shorten("Big subdivisions")("ADBE Vectors Group")(
14501:             "ADBE Vector Shape - Ellipse",
14502:           )("ADBE Vector Ellipse Position").expression =
14503:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
14504:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
14505:             "ADBE Vector Graphic - Fill",
14506:           )("ADBE Vector Fill Color").expression =
14507:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
14508:           shorten("Big subdivisions")("ADBE Vectors Group")
14509:             .addProperty("ADBE Vector Filter - Repeater")(
14510:               "ADBE Vector Repeater Copies",
14511:             )
14512:             .setValue(
14513:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
14514:             );
14515:           shorten("Big subdivisions")("ADBE Vectors Group")(
14516:             "ADBE Vector Filter - Repeater",
14517:           )("ADBE Vector Repeater Transform")(
14518:             "ADBE Vector Repeater Position",
14519:           ).expression =
14520:             'try { [effect("ADBE easyRulers")("Gap")*' +
14521:             divideBy +
14522:             ", value[1]] } catch(e) { value }";
14523:           shorten.addProperty("ADBE Vector Group").name =
14524:             "Big subdivisions Base Line";
14525:           shorten("Big subdivisions Base Line")(
14526:             "ADBE Vectors Group",
14527:           ).addProperty("ADBE Vector Shape - Rect")(
14528:             "ADBE Vector Rect Size",
14529:           ).expression =
14530:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14531:             (EditTextCopies.text - 1) +
14532:             "), 2.5] } catch(e) { value }";
14533:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
14534:             "ADBE Vector Shape - Rect",
14535:           )("ADBE Vector Rect Position").expression =
14536:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14537:             (EditTextCopies.text - 1) +
14538:             ')/2, 10 - effect("ADBE easyRulers")("Height")*4] } catch(e) { value }';
14539:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
14540:             "ADBE Vector Position",
14541:           ).setValue([0, 45]);
14542:           shorten("Big subdivisions Base Line")(
14543:             "ADBE Vectors Group",
14544:           ).addProperty("ADBE Vector Graphic - Fill")(
14545:             "ADBE Vector Fill Color",
14546:           ).expression =
14547:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
14548:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
14549:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
14550:             "ADBE Vector Shape - Ellipse",
14551:           )("ADBE Vector Ellipse Size").expression =
14552:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2.5] } catch(e) { value }';
14553:           shorten("Half subdivisions")("ADBE Vectors Group")(
14554:             "ADBE Vector Shape - Ellipse",
14555:           )("ADBE Vector Ellipse Position").expression =
14556:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")*3] } catch(e) { value }';
14557:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
14558:             "ADBE Vector Graphic - Fill",
14559:           )("ADBE Vector Fill Color").expression =
14560:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
14561:           shorten("Half subdivisions")("ADBE Vectors Group")
14562:             .addProperty("ADBE Vector Filter - Repeater")(
14563:               "ADBE Vector Repeater Copies",
14564:             )
14565:             .setValue(
14566:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14567:                 1,
14568:             );
14569:           shorten("Half subdivisions")("ADBE Vectors Group")(
14570:             "ADBE Vector Filter - Repeater",
14571:           )("ADBE Vector Repeater Transform")(
14572:             "ADBE Vector Repeater Position",
14573:           ).expression =
14574:             'try { [effect("ADBE easyRulers")("Gap")*' +
14575:             divideBy / 2 +
14576:             ", value[1]] } catch(e) { value }";
14577:           shorten.addProperty("ADBE Vector Group").name =
14578:             "Half subdivisions Base Line";
14579:           shorten("Half subdivisions Base Line")(
14580:             "ADBE Vectors Group",
14581:           ).addProperty("ADBE Vector Shape - Rect")(
14582:             "ADBE Vector Rect Size",
14583:           ).expression =
14584:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14585:             (EditTextCopies.text - 1) +
14586:             "), 2.5] } catch(e) { value }";
14587:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
14588:             "ADBE Vector Shape - Rect",
14589:           )("ADBE Vector Rect Position").expression =
14590:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14591:             (EditTextCopies.text - 1) +
14592:             ')/2, 10 - effect("ADBE easyRulers")("Height")*3] } catch(e) { value }';
14593:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
14594:             "ADBE Vector Position",
14595:           ).setValue([0, 45]);
14596:           shorten("Half subdivisions Base Line")(
14597:             "ADBE Vectors Group",
14598:           ).addProperty("ADBE Vector Graphic - Fill")(
14599:             "ADBE Vector Fill Color",
14600:           ).expression =
14601:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
14602:           shorten.addProperty("ADBE Vector Group").name =
14603:             "Quarter subdivisions";
14604:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
14605:             "ADBE Vector Shape - Ellipse",
14606:           )("ADBE Vector Ellipse Size").expression =
14607:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*2] } catch(e) { value }';
14608:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
14609:             "ADBE Vector Shape - Ellipse",
14610:           )("ADBE Vector Ellipse Position").expression =
14611:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
14612:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
14613:             "ADBE Vector Graphic - Fill",
14614:           )("ADBE Vector Fill Color").expression =
14615:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
14616:           shorten("Quarter subdivisions")("ADBE Vectors Group")
14617:             .addProperty("ADBE Vector Filter - Repeater")(
14618:               "ADBE Vector Repeater Copies",
14619:             )
14620:             .setValue(
14621:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14622:                 1,
14623:             );
14624:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
14625:             "ADBE Vector Filter - Repeater",
14626:           )("ADBE Vector Repeater Transform")(
14627:             "ADBE Vector Repeater Position",
14628:           ).expression =
14629:             'try { [effect("ADBE easyRulers")("Gap")*' +
14630:             divideBy / 4 +
14631:             ", value[1]] } catch(e) { value }";
14632:           shorten.addProperty("ADBE Vector Group").name =
14633:             "Quarter subdivisions Base Line";
14634:           shorten("Quarter subdivisions Base Line")(
14635:             "ADBE Vectors Group",
14636:           ).addProperty("ADBE Vector Shape - Rect")(
14637:             "ADBE Vector Rect Size",
14638:           ).expression =
14639:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14640:             (EditTextCopies.text - 1) +
14641:             "), 2.5] } catch(e) { value }";
14642:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
14643:             "ADBE Vector Shape - Rect",
14644:           )("ADBE Vector Rect Position").expression =
14645:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14646:             (EditTextCopies.text - 1) +
14647:             ')/2, 10 - effect("ADBE easyRulers")("Height")*2] } catch(e) { value }';
14648:           shorten("Quarter subdivisions Base Line")(
14649:             "ADBE Vector Transform Group",
14650:           )("ADBE Vector Position").setValue([0, 45]);
14651:           shorten("Quarter subdivisions Base Line")(
14652:             "ADBE Vectors Group",
14653:           ).addProperty("ADBE Vector Graphic - Fill")(
14654:             "ADBE Vector Fill Color",
14655:           ).expression =
14656:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
14657:           shorten.addProperty("ADBE Vector Group").name = "Eighth subdivisions";
14658:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
14659:             "ADBE Vector Shape - Ellipse",
14660:           )("ADBE Vector Ellipse Size").expression =
14661:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5, effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")*1.5] } catch(e) { value }';
14662:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
14663:             "ADBE Vector Shape - Ellipse",
14664:           )("ADBE Vector Ellipse Position").expression =
14665:             'try { [value[0], 55 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
14666:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
14667:             "ADBE Vector Graphic - Fill",
14668:           )("ADBE Vector Fill Color").expression =
14669:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
14670:           shorten("Eighth subdivisions")("ADBE Vectors Group")
14671:             .addProperty("ADBE Vector Filter - Repeater")(
14672:               "ADBE Vector Repeater Copies",
14673:             )
14674:             .setValue(
14675:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
14676:                 1,
14677:             );
14678:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
14679:             "ADBE Vector Filter - Repeater",
14680:           )("ADBE Vector Repeater Transform")(
14681:             "ADBE Vector Repeater Position",
14682:           ).expression =
14683:             'try { [effect("ADBE easyRulers")("Gap")*' +
14684:             divideBy / 8 +
14685:             ", value[1]] } catch(e) { value }";
14686:           shorten.addProperty("ADBE Vector Group").name =
14687:             "Eighth subdivisions Base Line";
14688:           shorten("Eighth subdivisions Base Line")(
14689:             "ADBE Vectors Group",
14690:           ).addProperty("ADBE Vector Shape - Rect")(
14691:             "ADBE Vector Rect Size",
14692:           ).expression =
14693:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14694:             (EditTextCopies.text - 1) +
14695:             "), 2.5] } catch(e) { value }";
14696:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
14697:             "ADBE Vector Shape - Rect",
14698:           )("ADBE Vector Rect Position").expression =
14699:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14700:             (EditTextCopies.text - 1) +
14701:             ')/2, 10 - effect("ADBE easyRulers")("Height")] } catch(e) { value }';
14702:           shorten("Eighth subdivisions Base Line")(
14703:             "ADBE Vector Transform Group",
14704:           )("ADBE Vector Position").setValue([0, 45]);
14705:           shorten("Eighth subdivisions Base Line")(
14706:             "ADBE Vectors Group",
14707:           ).addProperty("ADBE Vector Graphic - Fill")(
14708:             "ADBE Vector Fill Color",
14709:           ).expression =
14710:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
14711:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
14712:           shorten("Main lines")("ADBE Vectors Group").addProperty(
14713:             "ADBE Vector Shape - Ellipse",
14714:           )("ADBE Vector Ellipse Size").expression =
14715:             'try { [effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias"), effect("ADBE easyRulers")("Dots Scale")+effect("ADBE easyRulers")("Dots Scale Bias")] } catch(e) { value }';
14716:           shorten("Main lines")("ADBE Vectors Group")(
14717:             "ADBE Vector Shape - Ellipse",
14718:           )("ADBE Vector Ellipse Position").setValue([0, 55]);
14719:           shorten("Main lines")("ADBE Vectors Group").addProperty(
14720:             "ADBE Vector Graphic - Fill",
14721:           )("ADBE Vector Fill Color").expression =
14722:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
14723:           shorten("Main lines")("ADBE Vectors Group")
14724:             .addProperty(
14725:               "ADBE Vector Filter - Repeater",
14726:             )("ADBE Vector Repeater Copies")
14727:             .setValue(EditTextCopies.text);
14728:           shorten("Main lines")("ADBE Vectors Group")(
14729:             "ADBE Vector Filter - Repeater",
14730:           )("ADBE Vector Repeater Transform")(
14731:             "ADBE Vector Repeater Position",
14732:           ).expression =
14733:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
14734:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
14735:           shorten("Base Line")("ADBE Vectors Group").addProperty(
14736:             "ADBE Vector Shape - Rect",
14737:           )("ADBE Vector Rect Size").expression =
14738:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
14739:             (EditTextCopies.text - 1) +
14740:             "), 2.5] } catch(e) { value }";
14741:           shorten("Base Line")("ADBE Vectors Group")(
14742:             "ADBE Vector Shape - Rect",
14743:           )("ADBE Vector Rect Position").expression =
14744:             'try { [(effect("ADBE easyRulers")("Gap")*' +
14745:             (EditTextCopies.text - 1) +
14746:             ")/2, value[1]+10] } catch(e) { value }";
14747:           shorten("Base Line")("ADBE Vector Transform Group")(
14748:             "ADBE Vector Position",
14749:           ).setValue([0, 45]);
14750:           shorten("Base Line")("ADBE Vectors Group").addProperty(
14751:             "ADBE Vector Graphic - Fill",
14752:           )("ADBE Vector Fill Color").expression =
14753:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
14754:           t("ADBE easyRulers")("Dots Scale").setValue(10);
14755:           t("ADBE easyRulers")("default Dots Scale").setValue(10);
14756:           t("ADBE easyRulers")("Height").setValue(15);
14757:           t("ADBE easyRulers")("default Height").setValue(15);
14758:           if (SidesType.selection.index == 2) {
14759:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
14760:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
14761:           }
14762:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(85);
14763:           t("ADBE easyRulers")("default Pointer Distance").setValue(85);
14764:           createPointerLinear();
14765:           secondary_lines = app.project.activeItem
14766:             .layer(
14767:               shapeLayer.name,
14768:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
14769:             .duplicate();
14770:           secondary_lines.name = "Main lines - Secondary Color";
14771:           secondary_lines("ADBE Vectors Group")(
14772:             "ADBE Vector Filter - Repeater",
14773:           )("ADBE Vector Repeater Copies").expression =
14774:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14775:             EditTextCopies.text +
14776:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14777:             EditTextCopies.text +
14778:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14779:             (Number(EditTextCopies.text) - 1) +
14780:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14781:             EditTextCopies.text +
14782:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14783:             (Number(EditTextCopies.text) - 1) +
14784:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
14785:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14786:             "ADBE Vector Fill Opacity",
14787:           ).expression =
14788:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
14789:           secondary_lines("ADBE Vector Transform Group")(
14790:             "ADBE Vector Group Opacity",
14791:           ).expression =
14792:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14793:           secondary_lines("ADBE Vectors Group")(
14794:             "ADBE Vector Graphic - Fill",
14795:           ).name = "Fill Start";
14796:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14797:             "ADBE Vector Fill Color",
14798:           ).expression =
14799:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14800:           secondary_lines("ADBE Vectors Group")(
14801:             "ADBE Vector Filter - Repeater",
14802:           )("ADBE Vector Repeater Offset").expression =
14803:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14804:             (Number(EditTextCopies.text) - 1) +
14805:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 } } } catch(e) { value }';
14806:           secondary_lines("ADBE Vectors Group")(
14807:             "ADBE Vector Filter - Repeater",
14808:           )("ADBE Vector Repeater Transform")(
14809:             "ADBE Vector Repeater Opacity 1",
14810:           ).expression =
14811:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14812:           secondary_lines("ADBE Vectors Group")(
14813:             "ADBE Vector Filter - Repeater",
14814:           )("ADBE Vector Repeater Transform")(
14815:             "ADBE Vector Repeater Opacity 2",
14816:           ).expression =
14817:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14818:           secondary_lines("ADBE Vectors Group").addProperty(
14819:             "ADBE Vector Graphic - Fill",
14820:           ).name = "Fill End";
14821:           secondary_lines("ADBE Vectors Group")("Fill End")(
14822:             "ADBE Vector Fill Color",
14823:           ).expression =
14824:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14825:           secondary_lines("ADBE Vectors Group")("Fill End")(
14826:             "ADBE Vector Fill Opacity",
14827:           ).expression =
14828:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
14829:           secondary_lines = app.project.activeItem
14830:             .layer(
14831:               shapeLayer.name,
14832:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
14833:             .duplicate();
14834:           secondary_lines.name = "Big subdivisions - Secondary Color";
14835:           secondary_lines("ADBE Vectors Group")(
14836:             "ADBE Vector Filter - Repeater",
14837:           )("ADBE Vector Repeater Copies").expression =
14838:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14839:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14840:             1 +
14841:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14842:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14843:             1 +
14844:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14845:             (Number(EditTextCopies.text) - 1) +
14846:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14847:             divideBy +
14848:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14849:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
14850:             1 +
14851:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14852:             (Number(EditTextCopies.text) - 1) +
14853:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
14854:             divideBy +
14855:             ") } else { 0 }              }} catch(e) { value }";
14856:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14857:             "ADBE Vector Fill Opacity",
14858:           ).expression =
14859:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
14860:           secondary_lines("ADBE Vector Transform Group")(
14861:             "ADBE Vector Group Opacity",
14862:           ).expression =
14863:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14864:           secondary_lines("ADBE Vectors Group")(
14865:             "ADBE Vector Graphic - Fill",
14866:           ).name = "Fill Start";
14867:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14868:             "ADBE Vector Fill Color",
14869:           ).expression =
14870:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14871:           secondary_lines("ADBE Vectors Group")(
14872:             "ADBE Vector Filter - Repeater",
14873:           )("ADBE Vector Repeater Offset").expression =
14874:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14875:             (Number(EditTextCopies.text) - 1) +
14876:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
14877:             divideBy +
14878:             ") } else { 0 } } } catch(e) { value }";
14879:           secondary_lines("ADBE Vectors Group")(
14880:             "ADBE Vector Filter - Repeater",
14881:           )("ADBE Vector Repeater Transform")(
14882:             "ADBE Vector Repeater Opacity 1",
14883:           ).expression =
14884:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14885:           secondary_lines("ADBE Vectors Group")(
14886:             "ADBE Vector Filter - Repeater",
14887:           )("ADBE Vector Repeater Transform")(
14888:             "ADBE Vector Repeater Opacity 2",
14889:           ).expression =
14890:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14891:           secondary_lines("ADBE Vectors Group").addProperty(
14892:             "ADBE Vector Graphic - Fill",
14893:           ).name = "Fill End";
14894:           secondary_lines("ADBE Vectors Group")("Fill End")(
14895:             "ADBE Vector Fill Color",
14896:           ).expression =
14897:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14898:           secondary_lines("ADBE Vectors Group")("Fill End")(
14899:             "ADBE Vector Fill Opacity",
14900:           ).expression =
14901:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
14902:           secondary_lines = app.project.activeItem
14903:             .layer(
14904:               shapeLayer.name,
14905:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions")
14906:             .duplicate();
14907:           secondary_lines.name = "Half subdivisions - Secondary Color";
14908:           secondary_lines("ADBE Vectors Group")(
14909:             "ADBE Vector Filter - Repeater",
14910:           )("ADBE Vector Repeater Copies").expression =
14911:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14912:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14913:             1 +
14914:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14915:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14916:             1 +
14917:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14918:             (Number(EditTextCopies.text) - 1) +
14919:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14920:             divideBy / 2 +
14921:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14922:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
14923:             1 +
14924:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14925:             (Number(EditTextCopies.text) - 1) +
14926:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
14927:             divideBy / 2 +
14928:             ") } else { 0 }              }} catch(e) { value }";
14929:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
14930:             "ADBE Vector Fill Opacity",
14931:           ).expression =
14932:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
14933:           secondary_lines("ADBE Vector Transform Group")(
14934:             "ADBE Vector Group Opacity",
14935:           ).expression =
14936:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
14937:           secondary_lines("ADBE Vectors Group")(
14938:             "ADBE Vector Graphic - Fill",
14939:           ).name = "Fill Start";
14940:           secondary_lines("ADBE Vectors Group")("Fill Start")(
14941:             "ADBE Vector Fill Color",
14942:           ).expression =
14943:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
14944:           secondary_lines("ADBE Vectors Group")(
14945:             "ADBE Vector Filter - Repeater",
14946:           )("ADBE Vector Repeater Offset").expression =
14947:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
14948:             (Number(EditTextCopies.text) - 1) +
14949:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
14950:             divideBy / 2 +
14951:             ") } else { 0 } } } catch(e) { value }";
14952:           secondary_lines("ADBE Vectors Group")(
14953:             "ADBE Vector Filter - Repeater",
14954:           )("ADBE Vector Repeater Transform")(
14955:             "ADBE Vector Repeater Opacity 1",
14956:           ).expression =
14957:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14958:           secondary_lines("ADBE Vectors Group")(
14959:             "ADBE Vector Filter - Repeater",
14960:           )("ADBE Vector Repeater Transform")(
14961:             "ADBE Vector Repeater Opacity 2",
14962:           ).expression =
14963:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
14964:           secondary_lines("ADBE Vectors Group").addProperty(
14965:             "ADBE Vector Graphic - Fill",
14966:           ).name = "Fill End";
14967:           secondary_lines("ADBE Vectors Group")("Fill End")(
14968:             "ADBE Vector Fill Color",
14969:           ).expression =
14970:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
14971:           secondary_lines("ADBE Vectors Group")("Fill End")(
14972:             "ADBE Vector Fill Opacity",
14973:           ).expression =
14974:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
14975:           secondary_lines = app.project.activeItem
14976:             .layer(
14977:               shapeLayer.name,
14978:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions")
14979:             .duplicate();
14980:           secondary_lines.name = "Quarter subdivisions - Secondary Color";
14981:           secondary_lines("ADBE Vectors Group")(
14982:             "ADBE Vector Filter - Repeater",
14983:           )("ADBE Vector Repeater Copies").expression =
14984:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
14985:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14986:             1 +
14987:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
14988:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14989:             1 +
14990:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
14991:             (Number(EditTextCopies.text) - 1) +
14992:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
14993:             divideBy / 4 +
14994:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
14995:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
14996:             1 +
14997:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
14998:             (Number(EditTextCopies.text) - 1) +
14999:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
15000:             divideBy / 4 +
15001:             ") } else { 0 }              }} catch(e) { value }";
15002:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
15003:             "ADBE Vector Fill Opacity",
15004:           ).expression =
15005:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
15006:           secondary_lines("ADBE Vector Transform Group")(
15007:             "ADBE Vector Group Opacity",
15008:           ).expression =
15009:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
15010:           secondary_lines("ADBE Vectors Group")(
15011:             "ADBE Vector Graphic - Fill",
15012:           ).name = "Fill Start";
15013:           secondary_lines("ADBE Vectors Group")("Fill Start")(
15014:             "ADBE Vector Fill Color",
15015:           ).expression =
15016:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
15017:           secondary_lines("ADBE Vectors Group")(
15018:             "ADBE Vector Filter - Repeater",
15019:           )("ADBE Vector Repeater Offset").expression =
15020:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
15021:             (Number(EditTextCopies.text) - 1) +
15022:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
15023:             divideBy / 4 +
15024:             ") } else { 0 } } } catch(e) { value }";
15025:           secondary_lines("ADBE Vectors Group")(
15026:             "ADBE Vector Filter - Repeater",
15027:           )("ADBE Vector Repeater Transform")(
15028:             "ADBE Vector Repeater Opacity 1",
15029:           ).expression =
15030:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15031:           secondary_lines("ADBE Vectors Group")(
15032:             "ADBE Vector Filter - Repeater",
15033:           )("ADBE Vector Repeater Transform")(
15034:             "ADBE Vector Repeater Opacity 2",
15035:           ).expression =
15036:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15037:           secondary_lines("ADBE Vectors Group").addProperty(
15038:             "ADBE Vector Graphic - Fill",
15039:           ).name = "Fill End";
15040:           secondary_lines("ADBE Vectors Group")("Fill End")(
15041:             "ADBE Vector Fill Color",
15042:           ).expression =
15043:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
15044:           secondary_lines("ADBE Vectors Group")("Fill End")(
15045:             "ADBE Vector Fill Opacity",
15046:           ).expression =
15047:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
15048:           secondary_lines = app.project.activeItem
15049:             .layer(
15050:               shapeLayer.name,
15051:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions")
15052:             .duplicate();
15053:           secondary_lines.name = "Eighth subdivisions - Secondary Color";
15054:           secondary_lines("ADBE Vectors Group")(
15055:             "ADBE Vector Filter - Repeater",
15056:           )("ADBE Vector Repeater Copies").expression =
15057:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
15058:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
15059:             1 +
15060:             '-content("Ruler").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
15061:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
15062:             1 +
15063:             '-content("Ruler Mirror").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
15064:             (Number(EditTextCopies.text) - 1) +
15065:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
15066:             divideBy / 8 +
15067:             ') }              } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
15068:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
15069:             1 +
15070:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
15071:             (Number(EditTextCopies.text) - 1) +
15072:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
15073:             divideBy / 8 +
15074:             ") } else { 0 }              }} catch(e) { value }";
15075:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
15076:             "ADBE Vector Fill Opacity",
15077:           ).expression =
15078:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
15079:           secondary_lines("ADBE Vector Transform Group")(
15080:             "ADBE Vector Group Opacity",
15081:           ).expression =
15082:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
15083:           secondary_lines("ADBE Vectors Group")(
15084:             "ADBE Vector Graphic - Fill",
15085:           ).name = "Fill Start";
15086:           secondary_lines("ADBE Vectors Group")("Fill Start")(
15087:             "ADBE Vector Fill Color",
15088:           ).expression =
15089:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
15090:           secondary_lines("ADBE Vectors Group")(
15091:             "ADBE Vector Filter - Repeater",
15092:           )("ADBE Vector Repeater Offset").expression =
15093:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else { if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
15094:             (Number(EditTextCopies.text) - 1) +
15095:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
15096:             divideBy / 8 +
15097:             ") } else { 0 } } } catch(e) { value }";
15098:           secondary_lines("ADBE Vectors Group")(
15099:             "ADBE Vector Filter - Repeater",
15100:           )("ADBE Vector Repeater Transform")(
15101:             "ADBE Vector Repeater Opacity 1",
15102:           ).expression =
15103:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15104:           secondary_lines("ADBE Vectors Group")(
15105:             "ADBE Vector Filter - Repeater",
15106:           )("ADBE Vector Repeater Transform")(
15107:             "ADBE Vector Repeater Opacity 2",
15108:           ).expression =
15109:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15110:           secondary_lines("ADBE Vectors Group").addProperty(
15111:             "ADBE Vector Graphic - Fill",
15112:           ).name = "Fill End";
15113:           secondary_lines("ADBE Vectors Group")("Fill End")(
15114:             "ADBE Vector Fill Color",
15115:           ).expression =
15116:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
15117:           secondary_lines("ADBE Vectors Group")("Fill End")(
15118:             "ADBE Vector Fill Opacity",
15119:           ).expression =
15120:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
15121:           app.project.activeItem
15122:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
15123:             .duplicate().name = "Ruler Mirror";
15124:           app.project.activeItem
15125:             .layer(
15126:               shapeLayer.name,
15127:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
15128:             .setValue([100, -100]);
15129:           switch (BaseLineDropdown.selection.index) {
15130:             case 0:
15131:               app.project.activeItem
15132:                 .layer(
15133:                   shapeLayer.name,
15134:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
15135:                 .remove();
15136:               app.project.activeItem
15137:                 .layer(
15138:                   shapeLayer.name,
15139:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
15140:                 .remove();
15141:               app.project.activeItem
15142:                 .layer(
15143:                   shapeLayer.name,
15144:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
15145:                 .remove();
15146:               app.project.activeItem
15147:                 .layer(
15148:                   shapeLayer.name,
15149:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
15150:                 .remove();
15151:               app.project.activeItem
15152:                 .layer(
15153:                   shapeLayer.name,
15154:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
15155:                 .remove();
15156:               app.project.activeItem
15157:                 .layer(
15158:                   shapeLayer.name,
15159:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
15160:                 .remove();
15161:               app.project.activeItem
15162:                 .layer(
15163:                   shapeLayer.name,
15164:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
15165:                 .remove();
15166:               app.project.activeItem
15167:                 .layer(
15168:                   shapeLayer.name,
15169:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
15170:                 .remove();
15171:               app.project.activeItem
15172:                 .layer(
15173:                   shapeLayer.name,
15174:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
15175:                 .remove();
15176:               app.project.activeItem
15177:                 .layer(
15178:                   shapeLayer.name,
15179:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
15180:                 .remove();
15181:               break;
15182:             case 1:
15183:               app.project.activeItem
15184:                 .layer(
15185:                   shapeLayer.name,
15186:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
15187:                 .remove();
15188:               app.project.activeItem
15189:                 .layer(
15190:                   shapeLayer.name,
15191:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
15192:                 .remove();
15193:               app.project.activeItem
15194:                 .layer(
15195:                   shapeLayer.name,
15196:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
15197:                 .remove();
15198:               app.project.activeItem
15199:                 .layer(
15200:                   shapeLayer.name,
15201:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
15202:                 .remove();
15203:               app.project.activeItem
15204:                 .layer(
15205:                   shapeLayer.name,
15206:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
15207:                 .remove();
15208:               app.project.activeItem
15209:                 .layer(
15210:                   shapeLayer.name,
15211:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
15212:                 .remove();
15213:               app.project.activeItem
15214:                 .layer(
15215:                   shapeLayer.name,
15216:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
15217:                 .remove();
15218:               app.project.activeItem
15219:                 .layer(
15220:                   shapeLayer.name,
15221:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
15222:                 .remove();
15223:           }
15224:         };
15225:         createBasicNoDivs = function () {
15226:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
15227:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15228:             "ADBE Vector Shape - Rect",
15229:           )("ADBE Vector Rect Size").expression =
15230:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15231:             (EditTextCopies.text - 1) +
15232:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
15233:           shorten("Base Line")("ADBE Vectors Group")(
15234:             "ADBE Vector Shape - Rect",
15235:           )("ADBE Vector Rect Position").expression =
15236:             'try { [(effect("ADBE easyRulers")("Gap")*' +
15237:             (EditTextCopies.text - 1) +
15238:             ')/2, -30 + effect("ADBE easyRulers")("Height")/2] } catch(e) { value }';
15239:           shorten("Base Line")("ADBE Vector Transform Group")(
15240:             "ADBE Vector Position",
15241:           ).setValue([0, 45]);
15242:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15243:             "ADBE Vector Graphic - Fill",
15244:           )("ADBE Vector Fill Color").expression =
15245:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
15246:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
15247:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15248:             "ADBE Vector Shape - Rect",
15249:           )("ADBE Vector Rect Size").expression =
15250:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")] } catch(e) { value }';
15251:           shorten("Main lines")("ADBE Vectors Group")(
15252:             "ADBE Vector Shape - Rect",
15253:           )("ADBE Vector Rect Position").setValue([0, 15]);
15254:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15255:             "ADBE Vector Graphic - Fill",
15256:           )("ADBE Vector Fill Color").expression =
15257:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
15258:           shorten("Main lines")("ADBE Vectors Group")
15259:             .addProperty(
15260:               "ADBE Vector Filter - Repeater",
15261:             )("ADBE Vector Repeater Copies")
15262:             .setValue(EditTextCopies.text);
15263:           shorten("Main lines")("ADBE Vectors Group")(
15264:             "ADBE Vector Filter - Repeater",
15265:           )("ADBE Vector Repeater Transform")(
15266:             "ADBE Vector Repeater Position",
15267:           ).expression =
15268:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
15269:           shorten("Main lines")("ADBE Vector Transform Group")(
15270:             "ADBE Vector Group Opacity",
15271:           ).expression =
15272:             'if (content(1).content("Main lines").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
15273:           t("ADBE easyRulers")("Width").setValue(4);
15274:           t("ADBE easyRulers")("default Width").setValue(4);
15275:           t("ADBE easyRulers")("Height").setValue(40);
15276:           t("ADBE easyRulers")("default Height").setValue(40);
15277:           if (SidesType.selection.index == 2) {
15278:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
15279:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
15280:           }
15281:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
15282:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
15283:           createPointerLinear();
15284:           secondary_lines = app.project.activeItem
15285:             .layer(
15286:               shapeLayer.name,
15287:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Main lines")
15288:             .duplicate();
15289:           secondary_lines.name = "Main lines - Secondary Color";
15290:           secondary_lines("ADBE Vectors Group")(
15291:             "ADBE Vector Filter - Repeater",
15292:           )("ADBE Vector Repeater Copies").expression =
15293:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                 if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
15294:             EditTextCopies.text +
15295:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
15296:             EditTextCopies.text +
15297:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                 } else { Math.ceil(' +
15298:             (Number(EditTextCopies.text) - 1) +
15299:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }             } else {                  if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
15300:             EditTextCopies.text +
15301:             ' } else                  if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
15302:             (Number(EditTextCopies.text) - 1) +
15303:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }             }} catch(e) { value }';
15304:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
15305:             "ADBE Vector Fill Opacity",
15306:           ).expression =
15307:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
15308:           secondary_lines("ADBE Vectors Group")(
15309:             "ADBE Vector Graphic - Fill",
15310:           ).name = "Fill Start";
15311:           secondary_lines("ADBE Vectors Group")("Fill Start")(
15312:             "ADBE Vector Fill Color",
15313:           ).expression =
15314:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
15315:           secondary_lines("ADBE Vectors Group")(
15316:             "ADBE Vector Filter - Repeater",
15317:           )("ADBE Vector Repeater Offset").expression =
15318:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
15319:             EditTextCopies.text +
15320:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
15321:             (Number(EditTextCopies.text) - 1) +
15322:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
15323:           secondary_lines("ADBE Vectors Group")(
15324:             "ADBE Vector Filter - Repeater",
15325:           )("ADBE Vector Repeater Transform")(
15326:             "ADBE Vector Repeater Opacity 1",
15327:           ).expression =
15328:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15329:           secondary_lines("ADBE Vectors Group")(
15330:             "ADBE Vector Filter - Repeater",
15331:           )("ADBE Vector Repeater Transform")(
15332:             "ADBE Vector Repeater Opacity 2",
15333:           ).expression =
15334:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15335:           secondary_lines("ADBE Vectors Group").addProperty(
15336:             "ADBE Vector Graphic - Fill",
15337:           ).name = "Fill End";
15338:           secondary_lines("ADBE Vectors Group")("Fill End")(
15339:             "ADBE Vector Fill Color",
15340:           ).expression =
15341:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
15342:           secondary_lines("ADBE Vectors Group")("Fill End")(
15343:             "ADBE Vector Fill Opacity",
15344:           ).expression =
15345:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
15346:           secondary_lines("ADBE Vector Transform Group")(
15347:             "ADBE Vector Group Opacity",
15348:           ).expression =
15349:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
15350:           secondary_lines("ADBE Vector Transform Group")(
15351:             "ADBE Vector Scale",
15352:           ).expression =
15353:             'if (content(1).content("Main lines").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
15354:           app.project.activeItem
15355:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
15356:             .duplicate().name = "Ruler Mirror";
15357:           app.project.activeItem
15358:             .layer(
15359:               shapeLayer.name,
15360:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
15361:             .setValue([100, -100]);
15362:           if (BaseLineDropdown.selection.index == 0) {
15363:             app.project.activeItem
15364:               .layer(
15365:                 shapeLayer.name,
15366:               )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
15367:               .remove();
15368:             app.project.activeItem
15369:               .layer(
15370:                 shapeLayer.name,
15371:               )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
15372:               .remove();
15373:           }
15374:         };
15375:         createBasic = function () {
15376:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
15377:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15378:             "ADBE Vector Shape - Rect",
15379:           )("ADBE Vector Rect Size").expression =
15380:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15381:             (EditTextCopies.text - 1) +
15382:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
15383:           shorten("Base Line")("ADBE Vectors Group")(
15384:             "ADBE Vector Shape - Rect",
15385:           )("ADBE Vector Rect Position").expression =
15386:             'try { [(effect("ADBE easyRulers")("Gap")*' +
15387:             (EditTextCopies.text - 1) +
15388:             ')/2, -20 + effect("ADBE easyRulers")("Height")/2] } catch(e) { value }';
15389:           shorten("Base Line")("ADBE Vector Transform Group")(
15390:             "ADBE Vector Position",
15391:           ).setValue([0, 45]);
15392:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15393:             "ADBE Vector Graphic - Fill",
15394:           )("ADBE Vector Fill Color").expression =
15395:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
15396:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
15397:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
15398:             "ADBE Vector Shape - Rect",
15399:           )("ADBE Vector Rect Size").expression =
15400:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
15401:           shorten("Big subdivisions")("ADBE Vectors Group")(
15402:             "ADBE Vector Shape - Rect",
15403:           )("ADBE Vector Rect Position").expression =
15404:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15405:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
15406:             "ADBE Vector Graphic - Fill",
15407:           )("ADBE Vector Fill Color").expression =
15408:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
15409:           shorten("Big subdivisions")("ADBE Vectors Group")
15410:             .addProperty("ADBE Vector Filter - Repeater")(
15411:               "ADBE Vector Repeater Copies",
15412:             )
15413:             .setValue(
15414:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
15415:             );
15416:           shorten("Big subdivisions")("ADBE Vectors Group")(
15417:             "ADBE Vector Filter - Repeater",
15418:           )("ADBE Vector Repeater Transform")(
15419:             "ADBE Vector Repeater Position",
15420:           ).expression =
15421:             'try { [effect("ADBE easyRulers")("Gap")*' +
15422:             divideBy +
15423:             ", value[1]] } catch(e) { value }";
15424:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
15425:             "ADBE Vector Group Opacity",
15426:           ).expression =
15427:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
15428:           shorten.addProperty("ADBE Vector Group").name =
15429:             "Big subdivisions Base Line";
15430:           shorten("Big subdivisions Base Line")(
15431:             "ADBE Vectors Group",
15432:           ).addProperty("ADBE Vector Shape - Rect")(
15433:             "ADBE Vector Rect Size",
15434:           ).expression =
15435:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15436:             (EditTextCopies.text - 1) +
15437:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
15438:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
15439:             "ADBE Vector Position",
15440:           ).setValue([0, 45]);
15441:           shorten("Big subdivisions Base Line")(
15442:             "ADBE Vectors Group",
15443:           ).addProperty("ADBE Vector Graphic - Fill")(
15444:             "ADBE Vector Fill Color",
15445:           ).expression =
15446:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
15447:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
15448:             "ADBE Vector Shape - Rect",
15449:           )("ADBE Vector Rect Position").expression =
15450:             'try { if ((effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")) > 0) {                 if (effect("ADBE easyRulers")("Height") > 0 && effect("ADBE easyRulers")("Height Bias") > 0) {                    [(effect("ADBE easyRulers")("Gap")*' +
15451:             (EditTextCopies.text - 1) +
15452:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                 } else {                     if (effect("ADBE easyRulers")("Height") <= 0 && effect("ADBE easyRulers")("Height Bias") > 0) {                          [(effect("ADBE easyRulers")("Gap")*' +
15453:             (EditTextCopies.text - 1) +
15454:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                     } else {                         if (effect("ADBE easyRulers")("Height") > 0 && effect("ADBE easyRulers")("Height Bias") <= 0) {                               [(effect("ADBE easyRulers")("Gap")*' +
15455:             (EditTextCopies.text - 1) +
15456:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                         } else { [(effect("ADBE easyRulers")("Gap")*' +
15457:             (EditTextCopies.text - 1) +
15458:             ')/2, -20]                     }}}             } else { [(effect("ADBE easyRulers")("Gap")*' +
15459:             (EditTextCopies.text - 1) +
15460:             ')/2, -20 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
15461:           shorten.addProperty("ADBE Vector Group").name =
15462:             "Main lines - Secondary Color";
15463:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
15464:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15465:             "ADBE Vector Group",
15466:           ).name = "Stripes";
15467:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15468:             "ADBE Vectors Group",
15469:           ).addProperty("ADBE Vector Shape - Rect")(
15470:             "ADBE Vector Rect Size",
15471:           ).expression =
15472:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15473:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15474:             "ADBE Vectors Group",
15475:           )("ADBE Vector Shape - Rect")(
15476:             "ADBE Vector Rect Position",
15477:           ).expression =
15478:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
15479:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15480:             "ADBE Vectors Group",
15481:           )
15482:             .addProperty("ADBE Vector Filter - Repeater")(
15483:               "ADBE Vector Repeater Copies",
15484:             )
15485:             .setValue(EditTextCopies.text);
15486:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15487:             "ADBE Vectors Group",
15488:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
15489:             "ADBE Vector Repeater Position",
15490:           ).expression =
15491:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
15492:           shorten("Main lines")("ADBE Vectors Group")
15493:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
15494:             .setValue(2);
15495:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15496:             "ADBE Vector Group",
15497:           ).name = "Stripes Mask";
15498:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask")(
15499:             "ADBE Vectors Group",
15500:           ).addProperty("ADBE Vector Shape - Rect")(
15501:             "ADBE Vector Rect Size",
15502:           ).expression =
15503:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
15504:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask")(
15505:             "ADBE Vectors Group",
15506:           )("ADBE Vector Shape - Rect")(
15507:             "ADBE Vector Rect Position",
15508:           ).expression =
15509:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15510:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask")(
15511:             "ADBE Vectors Group",
15512:           )
15513:             .addProperty("ADBE Vector Filter - Repeater")(
15514:               "ADBE Vector Repeater Copies",
15515:             )
15516:             .setValue(
15517:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
15518:             );
15519:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask")(
15520:             "ADBE Vectors Group",
15521:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
15522:             "ADBE Vector Repeater Position",
15523:           ).expression =
15524:             'try { [effect("ADBE easyRulers")("Gap")*' +
15525:             divideBy +
15526:             ", value[1]] } catch(e) { value }";
15527:           shorten("Main lines")("ADBE Vectors Group")
15528:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
15529:             .setValue(3);
15530:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15531:             "ADBE Vector Graphic - Fill",
15532:           )("ADBE Vector Fill Color").expression =
15533:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
15534:           shorten("Main lines")("ADBE Vector Transform Group")(
15535:             "ADBE Vector Group Opacity",
15536:           ).expression =
15537:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
15538:           t("ADBE easyRulers")("Width").setValue(4);
15539:           t("ADBE easyRulers")("default Width").setValue(4);
15540:           t("ADBE easyRulers")("Height").setValue(10);
15541:           t("ADBE easyRulers")("default Height").setValue(10);
15542:           t("ADBE easyRulers")("Height Bias").setValue(15);
15543:           t("ADBE easyRulers")("default Height Bias").setValue(15);
15544:           if (SidesType.selection.index == 2) {
15545:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
15546:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
15547:           }
15548:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
15549:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
15550:           createPointerLinear();
15551:           shorten("Main lines - Secondary Color")(
15552:             "ADBE Vectors Group",
15553:           ).addProperty("ADBE Vector Shape - Rect")(
15554:             "ADBE Vector Rect Size",
15555:           ).expression =
15556:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15557:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15558:             "ADBE Vector Shape - Rect",
15559:           )("ADBE Vector Rect Position").expression =
15560:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
15561:           shorten("Main lines - Secondary Color")(
15562:             "ADBE Vectors Group",
15563:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
15564:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15565:             "ADBE Vector Graphic - Fill",
15566:           )("ADBE Vector Fill Color").expression =
15567:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
15568:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15569:             "ADBE Vector Graphic - Fill",
15570:           )("ADBE Vector Fill Opacity").expression =
15571:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
15572:           shorten("Main lines - Secondary Color")(
15573:             "ADBE Vectors Group",
15574:           ).addProperty("ADBE Vector Filter - Repeater")(
15575:             "ADBE Vector Repeater Copies",
15576:           ).expression =
15577:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
15578:             EditTextCopies.text +
15579:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
15580:             EditTextCopies.text +
15581:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
15582:             (Number(EditTextCopies.text) - 1) +
15583:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
15584:             EditTextCopies.text +
15585:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
15586:             (Number(EditTextCopies.text) - 1) +
15587:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
15588:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15589:             "ADBE Vector Filter - Repeater",
15590:           )("ADBE Vector Repeater Transform")(
15591:             "ADBE Vector Repeater Opacity 1",
15592:           ).expression =
15593:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15594:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15595:             "ADBE Vector Filter - Repeater",
15596:           )("ADBE Vector Repeater Transform")(
15597:             "ADBE Vector Repeater Opacity 2",
15598:           ).expression =
15599:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15600:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15601:             "ADBE Vector Filter - Repeater",
15602:           )("ADBE Vector Repeater Transform")(
15603:             "ADBE Vector Repeater Position",
15604:           ).expression =
15605:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
15606:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15607:             "ADBE Vector Filter - Repeater",
15608:           )("ADBE Vector Repeater Offset").expression =
15609:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
15610:             EditTextCopies.text +
15611:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
15612:             (Number(EditTextCopies.text) - 1) +
15613:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
15614:           shorten("Main lines - Secondary Color")(
15615:             "ADBE Vectors Group",
15616:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
15617:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15618:             "Fill End",
15619:           )("ADBE Vector Fill Color").expression =
15620:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
15621:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
15622:             "Fill End",
15623:           )("ADBE Vector Fill Opacity").expression =
15624:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
15625:           shorten("Main lines - Secondary Color")(
15626:             "ADBE Vector Transform Group",
15627:           )("ADBE Vector Group Opacity").expression =
15628:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
15629:           shorten("Main lines - Secondary Color")(
15630:             "ADBE Vector Transform Group",
15631:           )("ADBE Vector Scale").expression =
15632:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
15633:           secondary_lines = app.project.activeItem
15634:             .layer(
15635:               shapeLayer.name,
15636:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
15637:             .duplicate();
15638:           secondary_lines.name = "Big subdivisions - Secondary Color";
15639:           secondary_lines("ADBE Vectors Group")(
15640:             "ADBE Vector Filter - Repeater",
15641:           )("ADBE Vector Repeater Copies").expression =
15642:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
15643:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
15644:             1 +
15645:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
15646:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
15647:             1 +
15648:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
15649:             (Number(EditTextCopies.text) - 1) +
15650:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
15651:             divideBy +
15652:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
15653:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
15654:             1 +
15655:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
15656:             (Number(EditTextCopies.text) - 1) +
15657:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
15658:             divideBy +
15659:             ") } else { 0 }              }} catch(e) { value }";
15660:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
15661:             "ADBE Vector Fill Opacity",
15662:           ).expression =
15663:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
15664:           secondary_lines("ADBE Vectors Group")(
15665:             "ADBE Vector Graphic - Fill",
15666:           ).name = "Fill Start";
15667:           secondary_lines("ADBE Vectors Group")("Fill Start")(
15668:             "ADBE Vector Fill Color",
15669:           ).expression =
15670:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
15671:           secondary_lines("ADBE Vectors Group")(
15672:             "ADBE Vector Filter - Repeater",
15673:           )("ADBE Vector Repeater Offset").expression =
15674:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
15675:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
15676:             1 +
15677:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
15678:             (Number(EditTextCopies.text) - 1) +
15679:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
15680:             divideBy +
15681:             ")} else { 0 }              }} catch(e) { value }";
15682:           secondary_lines("ADBE Vectors Group")(
15683:             "ADBE Vector Filter - Repeater",
15684:           )("ADBE Vector Repeater Transform")(
15685:             "ADBE Vector Repeater Opacity 1",
15686:           ).expression =
15687:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15688:           secondary_lines("ADBE Vectors Group")(
15689:             "ADBE Vector Filter - Repeater",
15690:           )("ADBE Vector Repeater Transform")(
15691:             "ADBE Vector Repeater Opacity 2",
15692:           ).expression =
15693:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
15694:           secondary_lines("ADBE Vectors Group").addProperty(
15695:             "ADBE Vector Graphic - Fill",
15696:           ).name = "Fill End";
15697:           secondary_lines("ADBE Vectors Group")("Fill End")(
15698:             "ADBE Vector Fill Color",
15699:           ).expression =
15700:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
15701:           secondary_lines("ADBE Vectors Group")("Fill End")(
15702:             "ADBE Vector Fill Opacity",
15703:           ).expression =
15704:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
15705:           secondary_lines("ADBE Vector Transform Group")(
15706:             "ADBE Vector Group Opacity",
15707:           ).expression =
15708:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
15709:           secondary_lines("ADBE Vector Transform Group")(
15710:             "ADBE Vector Scale",
15711:           ).expression =
15712:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
15713:           app.project.activeItem
15714:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
15715:             .duplicate().name = "Ruler Mirror";
15716:           app.project.activeItem
15717:             .layer(
15718:               shapeLayer.name,
15719:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
15720:             .setValue([100, -100]);
15721:           switch (BaseLineDropdown.selection.index) {
15722:             case 0:
15723:               app.project.activeItem
15724:                 .layer(
15725:                   shapeLayer.name,
15726:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
15727:                 .remove();
15728:               app.project.activeItem
15729:                 .layer(
15730:                   shapeLayer.name,
15731:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
15732:                 .remove();
15733:               app.project.activeItem
15734:                 .layer(
15735:                   shapeLayer.name,
15736:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
15737:                 .remove();
15738:               app.project.activeItem
15739:                 .layer(
15740:                   shapeLayer.name,
15741:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
15742:                 .remove();
15743:               break;
15744:             case 1:
15745:               app.project.activeItem
15746:                 .layer(
15747:                   shapeLayer.name,
15748:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
15749:                 .remove();
15750:               app.project.activeItem
15751:                 .layer(
15752:                   shapeLayer.name,
15753:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
15754:                 .remove();
15755:           }
15756:         };
15757:         createBasic10 = function () {
15758:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
15759:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15760:             "ADBE Vector Shape - Rect",
15761:           )("ADBE Vector Rect Size").expression =
15762:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15763:             (EditTextCopies.text - 1) +
15764:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
15765:           shorten("Base Line")("ADBE Vectors Group")(
15766:             "ADBE Vector Shape - Rect",
15767:           )("ADBE Vector Rect Position").expression =
15768:             'try { if (effect("ADBE easyRulers")("Height")>0) { [(effect("ADBE easyRulers")("Gap")*' +
15769:             (EditTextCopies.text - 1) +
15770:             ')/2, -20 + effect("ADBE easyRulers")("Height")/2] } else { [(effect("ADBE easyRulers")("Gap")*' +
15771:             (EditTextCopies.text - 1) +
15772:             ')/2, -20 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
15773:           shorten("Base Line")("ADBE Vector Transform Group")(
15774:             "ADBE Vector Position",
15775:           ).setValue([0, 45]);
15776:           shorten("Base Line")("ADBE Vectors Group").addProperty(
15777:             "ADBE Vector Graphic - Fill",
15778:           )("ADBE Vector Fill Color").expression =
15779:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
15780:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
15781:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
15782:             "ADBE Vector Shape - Rect",
15783:           )("ADBE Vector Rect Size").expression =
15784:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
15785:           shorten("Big subdivisions")("ADBE Vectors Group")(
15786:             "ADBE Vector Shape - Rect",
15787:           )("ADBE Vector Rect Position").expression =
15788:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
15789:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
15790:             "ADBE Vector Graphic - Fill",
15791:           )("ADBE Vector Fill Color").expression =
15792:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
15793:           shorten("Big subdivisions")("ADBE Vectors Group")
15794:             .addProperty("ADBE Vector Filter - Repeater")(
15795:               "ADBE Vector Repeater Copies",
15796:             )
15797:             .setValue(
15798:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
15799:             );
15800:           shorten("Big subdivisions")("ADBE Vectors Group")(
15801:             "ADBE Vector Filter - Repeater",
15802:           )("ADBE Vector Repeater Transform")(
15803:             "ADBE Vector Repeater Position",
15804:           ).expression =
15805:             'try { [effect("ADBE easyRulers")("Gap")*' +
15806:             divideBy +
15807:             ", value[1]] } catch(e) { value }";
15808:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
15809:             "ADBE Vector Group Opacity",
15810:           ).expression =
15811:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
15812:           shorten.addProperty("ADBE Vector Group").name =
15813:             "Big subdivisions Base Line";
15814:           shorten("Big subdivisions Base Line")(
15815:             "ADBE Vectors Group",
15816:           ).addProperty("ADBE Vector Shape - Rect")(
15817:             "ADBE Vector Rect Size",
15818:           ).expression =
15819:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15820:             (EditTextCopies.text - 1) +
15821:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
15822:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
15823:             "ADBE Vector Position",
15824:           ).setValue([0, 45]);
15825:           shorten("Big subdivisions Base Line")(
15826:             "ADBE Vectors Group",
15827:           ).addProperty("ADBE Vector Graphic - Fill")(
15828:             "ADBE Vector Fill Color",
15829:           ).expression =
15830:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
15831:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
15832:             "ADBE Vector Shape - Rect",
15833:           )("ADBE Vector Rect Position").expression =
15834:             'try { if ((effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias"))>0) {                      if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                          [(effect("ADBE easyRulers")("Gap")*' +
15835:             (EditTextCopies.text - 1) +
15836:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                      } else {                          if (effect("ADBE easyRulers")("Height") <= 0 && effect("ADBE easyRulers")("Height Bias") > 0) {                              [(effect("ADBE easyRulers")("Gap")*' +
15837:             (EditTextCopies.text - 1) +
15838:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                          } else {                              if (effect("ADBE easyRulers")("Height") > 0 && effect("ADBE easyRulers")("Height Bias") <= 0) {                                  [(effect("ADBE easyRulers")("Gap")*' +
15839:             (EditTextCopies.text - 1) +
15840:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                              } else { [(effect("ADBE easyRulers")("Gap")*' +
15841:             (EditTextCopies.text - 1) +
15842:             ')/2, -20]                          }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
15843:             (EditTextCopies.text - 1) +
15844:             ')/2, -20 + effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
15845:           shorten.addProperty("ADBE Vector Group").name =
15846:             "Half subdivisions - Secondary Color";
15847:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
15848:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
15849:             "ADBE Vector Group",
15850:           ).name = "Stripes";
15851:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
15852:             "ADBE Vectors Group",
15853:           ).addProperty("ADBE Vector Shape - Rect")(
15854:             "ADBE Vector Rect Size",
15855:           ).expression =
15856:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
15857:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
15858:             "ADBE Vectors Group",
15859:           )("ADBE Vector Shape - Rect")(
15860:             "ADBE Vector Rect Position",
15861:           ).expression =
15862:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15863:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
15864:             "ADBE Vectors Group",
15865:           )
15866:             .addProperty("ADBE Vector Filter - Repeater")(
15867:               "ADBE Vector Repeater Copies",
15868:             )
15869:             .setValue(
15870:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
15871:                 1,
15872:             );
15873:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
15874:             "ADBE Vectors Group",
15875:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
15876:             "ADBE Vector Repeater Position",
15877:           ).expression =
15878:             'try { [effect("ADBE easyRulers")("Gap")*' +
15879:             divideBy / 2 +
15880:             ", value[1]] } catch(e) { value }";
15881:           shorten("Half subdivisions")("ADBE Vectors Group")
15882:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
15883:             .setValue(2);
15884:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
15885:             "ADBE Vector Group",
15886:           ).name = "Stripes Mask Big";
15887:           shorten("Half subdivisions")("ADBE Vectors Group")(
15888:             "Stripes Mask Big",
15889:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
15890:             "ADBE Vector Rect Size",
15891:           ).expression =
15892:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
15893:           shorten("Half subdivisions")("ADBE Vectors Group")(
15894:             "Stripes Mask Big",
15895:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
15896:             "ADBE Vector Rect Position",
15897:           ).expression =
15898:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
15899:           shorten("Half subdivisions")("ADBE Vectors Group")(
15900:             "Stripes Mask Big",
15901:           )("ADBE Vectors Group")
15902:             .addProperty("ADBE Vector Filter - Repeater")(
15903:               "ADBE Vector Repeater Copies",
15904:             )
15905:             .setValue(
15906:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
15907:             );
15908:           shorten("Half subdivisions")("ADBE Vectors Group")(
15909:             "Stripes Mask Big",
15910:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
15911:             "ADBE Vector Repeater Transform",
15912:           )("ADBE Vector Repeater Position").expression =
15913:             'try { [effect("ADBE easyRulers")("Gap")*' +
15914:             divideBy +
15915:             ", value[1]] } catch(e) { value }";
15916:           shorten("Half subdivisions")("ADBE Vectors Group")
15917:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
15918:             .setValue(3);
15919:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
15920:             "ADBE Vector Graphic - Fill",
15921:           )("ADBE Vector Fill Color").expression =
15922:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
15923:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
15924:             "ADBE Vector Group Opacity",
15925:           ).expression =
15926:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
15927:           shorten.addProperty("ADBE Vector Group").name =
15928:             "Half subdivisions Base Line";
15929:           shorten("Half subdivisions Base Line")(
15930:             "ADBE Vectors Group",
15931:           ).addProperty("ADBE Vector Shape - Rect")(
15932:             "ADBE Vector Rect Size",
15933:           ).expression =
15934:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
15935:             (EditTextCopies.text - 1) +
15936:             ') + effect("ADBE easyRulers")("Width") + 0.5, effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
15937:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
15938:             "ADBE Vector Shape - Rect",
15939:           )("ADBE Vector Rect Position").setValue([
15940:             (EditTextGap.text * EditTextCopies.text) / 2,
15941:             -20,
15942:           ]);
15943:           shorten("Half subdivisions Base Line")(
15944:             "ADBE Vectors Group",
15945:           ).addProperty("ADBE Vector Graphic - Fill")(
15946:             "ADBE Vector Fill Color",
15947:           ).expression =
15948:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
15949:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
15950:             "ADBE Vector Shape - Rect",
15951:           )("ADBE Vector Rect Position").expression =
15952:             'try { if ((effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2) > 0) {                      if (effect("ADBE easyRulers")("Height") > 0 && effect("ADBE easyRulers")("Height Bias") > 0) {                           [(effect("ADBE easyRulers")("Gap")*' +
15953:             (EditTextCopies.text - 1) +
15954:             ')/2, 45-effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")*2]                       } else {                           if (effect("ADBE easyRulers")("Height") <= 0 && effect("ADBE easyRulers")("Height Bias") > 0) {                               [(effect("ADBE easyRulers")("Gap")*' +
15955:             (EditTextCopies.text - 1) +
15956:             ')/2, 45-effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")*2]                           } else {                               if (effect("ADBE easyRulers")("Height") > 0 && effect("ADBE easyRulers")("Height Bias") <=0) {                                   [(effect("ADBE easyRulers")("Gap")*' +
15957:             (EditTextCopies.text - 1) +
15958:             ')/2, 45-effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                               } else { [(effect("ADBE easyRulers")("Gap")*' +
15959:             (EditTextCopies.text - 1) +
15960:             ')/2, 45]                           }}}               } else { [(effect("ADBE easyRulers")("Gap")*' +
15961:             (EditTextCopies.text - 1) +
15962:             ')/2, 45+effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
15963:           shorten.addProperty("ADBE Vector Group").name =
15964:             "Main lines - Secondary Color";
15965:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
15966:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15967:             "ADBE Vector Group",
15968:           ).name = "Stripes";
15969:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15970:             "ADBE Vectors Group",
15971:           ).addProperty("ADBE Vector Shape - Rect")(
15972:             "ADBE Vector Rect Size",
15973:           ).expression =
15974:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
15975:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15976:             "ADBE Vectors Group",
15977:           )("ADBE Vector Shape - Rect")(
15978:             "ADBE Vector Rect Position",
15979:           ).expression =
15980:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
15981:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15982:             "ADBE Vectors Group",
15983:           )
15984:             .addProperty("ADBE Vector Filter - Repeater")(
15985:               "ADBE Vector Repeater Copies",
15986:             )
15987:             .setValue(EditTextCopies.text);
15988:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
15989:             "ADBE Vectors Group",
15990:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
15991:             "ADBE Vector Repeater Position",
15992:           ).expression =
15993:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
15994:           shorten("Main lines")("ADBE Vectors Group")
15995:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
15996:             .setValue(2);
15997:           shorten("Main lines")("ADBE Vectors Group").addProperty(
15998:             "ADBE Vector Group",
15999:           ).name = "Stripes Mask Half";
16000:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Half")(
16001:             "ADBE Vectors Group",
16002:           ).addProperty("ADBE Vector Shape - Rect")(
16003:             "ADBE Vector Rect Size",
16004:           ).expression =
16005:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16006:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Half")(
16007:             "ADBE Vectors Group",
16008:           )("ADBE Vector Shape - Rect")(
16009:             "ADBE Vector Rect Position",
16010:           ).expression =
16011:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16012:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Half")(
16013:             "ADBE Vectors Group",
16014:           )
16015:             .addProperty("ADBE Vector Filter - Repeater")(
16016:               "ADBE Vector Repeater Copies",
16017:             )
16018:             .setValue(
16019:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) * 2 + 1,
16020:             );
16021:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Half")(
16022:             "ADBE Vectors Group",
16023:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
16024:             "ADBE Vector Repeater Position",
16025:           ).expression =
16026:             'try { [effect("ADBE easyRulers")("Gap")*' +
16027:             divideBy / 2 +
16028:             ", value[1]] } catch(e) { value }";
16029:           shorten("Main lines")("ADBE Vectors Group")
16030:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
16031:             .setValue(3);
16032:           shorten("Main lines")("ADBE Vectors Group").addProperty(
16033:             "ADBE Vector Graphic - Fill",
16034:           )("ADBE Vector Fill Color").expression =
16035:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
16036:           shorten("Main lines")("ADBE Vector Transform Group")(
16037:             "ADBE Vector Group Opacity",
16038:           ).expression =
16039:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
16040:           t("ADBE easyRulers")("Width").setValue(4);
16041:           t("ADBE easyRulers")("default Width").setValue(4);
16042:           t("ADBE easyRulers")("Height").setValue(20);
16043:           t("ADBE easyRulers")("default Height").setValue(20);
16044:           t("ADBE easyRulers")("Height Bias").setValue(10);
16045:           t("ADBE easyRulers")("default Height Bias").setValue(10);
16046:           if (SidesType.selection.index == 2) {
16047:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
16048:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
16049:           }
16050:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
16051:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
16052:           createPointerLinear();
16053:           shorten("Main lines - Secondary Color")(
16054:             "ADBE Vectors Group",
16055:           ).addProperty("ADBE Vector Shape - Rect")(
16056:             "ADBE Vector Rect Size",
16057:           ).expression =
16058:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16059:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16060:             "ADBE Vector Shape - Rect",
16061:           )("ADBE Vector Rect Position").expression =
16062:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
16063:           shorten("Main lines - Secondary Color")(
16064:             "ADBE Vectors Group",
16065:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
16066:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16067:             "ADBE Vector Graphic - Fill",
16068:           )("ADBE Vector Fill Color").expression =
16069:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16070:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16071:             "ADBE Vector Graphic - Fill",
16072:           )("ADBE Vector Fill Opacity").expression =
16073:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
16074:           shorten("Main lines - Secondary Color")(
16075:             "ADBE Vectors Group",
16076:           ).addProperty("ADBE Vector Filter - Repeater")(
16077:             "ADBE Vector Repeater Copies",
16078:           ).expression =
16079:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16080:             EditTextCopies.text +
16081:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16082:             EditTextCopies.text +
16083:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
16084:             (Number(EditTextCopies.text) - 1) +
16085:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16086:             EditTextCopies.text +
16087:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16088:             (Number(EditTextCopies.text) - 1) +
16089:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }               }} catch(e) { value }';
16090:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16091:             "ADBE Vector Filter - Repeater",
16092:           )("ADBE Vector Repeater Transform")(
16093:             "ADBE Vector Repeater Opacity 1",
16094:           ).expression =
16095:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16096:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16097:             "ADBE Vector Filter - Repeater",
16098:           )("ADBE Vector Repeater Transform")(
16099:             "ADBE Vector Repeater Opacity 2",
16100:           ).expression =
16101:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16102:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16103:             "ADBE Vector Filter - Repeater",
16104:           )("ADBE Vector Repeater Transform")(
16105:             "ADBE Vector Repeater Position",
16106:           ).expression =
16107:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
16108:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16109:             "ADBE Vector Filter - Repeater",
16110:           )("ADBE Vector Repeater Offset").expression =
16111:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16112:             EditTextCopies.text +
16113:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16114:             (Number(EditTextCopies.text) - 1) +
16115:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
16116:           shorten("Main lines - Secondary Color")(
16117:             "ADBE Vectors Group",
16118:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
16119:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16120:             "Fill End",
16121:           )("ADBE Vector Fill Color").expression =
16122:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16123:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16124:             "Fill End",
16125:           )("ADBE Vector Fill Opacity").expression =
16126:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
16127:           shorten("Main lines - Secondary Color")(
16128:             "ADBE Vector Transform Group",
16129:           )("ADBE Vector Group Opacity").expression =
16130:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16131:           shorten("Main lines - Secondary Color")(
16132:             "ADBE Vector Transform Group",
16133:           )("ADBE Vector Scale").expression =
16134:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16135:           secondary_lines = app.project.activeItem
16136:             .layer(
16137:               shapeLayer.name,
16138:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
16139:             .duplicate();
16140:           secondary_lines.name = "Big subdivisions - Secondary Color";
16141:           secondary_lines("ADBE Vectors Group")(
16142:             "ADBE Vector Filter - Repeater",
16143:           )("ADBE Vector Repeater Copies").expression =
16144:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16145:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16146:             1 +
16147:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16148:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16149:             1 +
16150:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
16151:             (Number(EditTextCopies.text) - 1) +
16152:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
16153:             divideBy +
16154:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16155:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16156:             1 +
16157:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16158:             (Number(EditTextCopies.text) - 1) +
16159:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
16160:             divideBy +
16161:             ") } else { 0 }              }} catch(e) { value }";
16162:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
16163:             "ADBE Vector Fill Opacity",
16164:           ).expression =
16165:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
16166:           secondary_lines("ADBE Vectors Group")(
16167:             "ADBE Vector Graphic - Fill",
16168:           ).name = "Fill Start";
16169:           secondary_lines("ADBE Vectors Group")("Fill Start")(
16170:             "ADBE Vector Fill Color",
16171:           ).expression =
16172:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16173:           secondary_lines("ADBE Vectors Group")(
16174:             "ADBE Vector Filter - Repeater",
16175:           )("ADBE Vector Repeater Offset").expression =
16176:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16177:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16178:             1 +
16179:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16180:             (Number(EditTextCopies.text) - 1) +
16181:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
16182:             divideBy +
16183:             ")} else { 0 }             }} catch(e) { value }";
16184:           secondary_lines("ADBE Vectors Group")(
16185:             "ADBE Vector Filter - Repeater",
16186:           )("ADBE Vector Repeater Transform")(
16187:             "ADBE Vector Repeater Opacity 1",
16188:           ).expression =
16189:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16190:           secondary_lines("ADBE Vectors Group")(
16191:             "ADBE Vector Filter - Repeater",
16192:           )("ADBE Vector Repeater Transform")(
16193:             "ADBE Vector Repeater Opacity 2",
16194:           ).expression =
16195:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16196:           secondary_lines("ADBE Vectors Group").addProperty(
16197:             "ADBE Vector Graphic - Fill",
16198:           ).name = "Fill End";
16199:           secondary_lines("ADBE Vectors Group")("Fill End")(
16200:             "ADBE Vector Fill Color",
16201:           ).expression =
16202:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16203:           secondary_lines("ADBE Vectors Group")("Fill End")(
16204:             "ADBE Vector Fill Opacity",
16205:           ).expression =
16206:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
16207:           secondary_lines("ADBE Vector Transform Group")(
16208:             "ADBE Vector Group Opacity",
16209:           ).expression =
16210:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16211:           secondary_lines("ADBE Vector Transform Group")(
16212:             "ADBE Vector Scale",
16213:           ).expression =
16214:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16215:           shorten("Half subdivisions - Secondary Color")(
16216:             "ADBE Vectors Group",
16217:           ).addProperty("ADBE Vector Shape - Rect")(
16218:             "ADBE Vector Rect Size",
16219:           ).expression =
16220:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16221:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16222:             "ADBE Vector Shape - Rect",
16223:           )("ADBE Vector Rect Position").expression =
16224:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16225:           shorten("Half subdivisions - Secondary Color")(
16226:             "ADBE Vectors Group",
16227:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
16228:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16229:             "ADBE Vector Graphic - Fill",
16230:           )("ADBE Vector Fill Color").expression =
16231:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16232:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16233:             "ADBE Vector Graphic - Fill",
16234:           )("ADBE Vector Fill Opacity").expression =
16235:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
16236:           shorten("Half subdivisions - Secondary Color")(
16237:             "ADBE Vectors Group",
16238:           ).addProperty("ADBE Vector Filter - Repeater")(
16239:             "ADBE Vector Repeater Copies",
16240:           ).expression =
16241:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16242:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
16243:             1 +
16244:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16245:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
16246:             1 +
16247:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
16248:             (Number(EditTextCopies.text) - 1) +
16249:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
16250:             divideBy / 2 +
16251:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16252:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
16253:             1 +
16254:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16255:             (Number(EditTextCopies.text) - 1) +
16256:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
16257:             divideBy / 2 +
16258:             ") } else { 0 }              }} catch(e) { value }";
16259:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16260:             "ADBE Vector Filter - Repeater",
16261:           )("ADBE Vector Repeater Transform")(
16262:             "ADBE Vector Repeater Opacity 1",
16263:           ).expression =
16264:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16265:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16266:             "ADBE Vector Filter - Repeater",
16267:           )("ADBE Vector Repeater Transform")(
16268:             "ADBE Vector Repeater Opacity 2",
16269:           ).expression =
16270:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16271:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16272:             "ADBE Vector Filter - Repeater",
16273:           )("ADBE Vector Repeater Transform")(
16274:             "ADBE Vector Repeater Position",
16275:           ).expression =
16276:             'try { [effect("ADBE easyRulers")("Gap")*' +
16277:             divideBy / 2 +
16278:             ", value[1]] } catch(e) { value }";
16279:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16280:             "ADBE Vector Filter - Repeater",
16281:           )("ADBE Vector Repeater Offset").expression =
16282:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16283:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
16284:             1 +
16285:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16286:             (Number(EditTextCopies.text) - 1) +
16287:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
16288:             divideBy / 2 +
16289:             ")} else { 0 }             }} catch(e) { value }";
16290:           shorten("Half subdivisions - Secondary Color")(
16291:             "ADBE Vectors Group",
16292:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
16293:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16294:             "Fill End",
16295:           )("ADBE Vector Fill Color").expression =
16296:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16297:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
16298:             "Fill End",
16299:           )("ADBE Vector Fill Opacity").expression =
16300:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
16301:           shorten("Half subdivisions - Secondary Color")(
16302:             "ADBE Vector Transform Group",
16303:           )("ADBE Vector Group Opacity").expression =
16304:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16305:           shorten("Half subdivisions - Secondary Color")(
16306:             "ADBE Vector Transform Group",
16307:           )("ADBE Vector Scale").expression =
16308:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16309:           app.project.activeItem
16310:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
16311:             .duplicate().name = "Ruler Mirror";
16312:           app.project.activeItem
16313:             .layer(
16314:               shapeLayer.name,
16315:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
16316:             .setValue([100, -100]);
16317:           switch (BaseLineDropdown.selection.index) {
16318:             case 0:
16319:               app.project.activeItem
16320:                 .layer(
16321:                   shapeLayer.name,
16322:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
16323:                 .remove();
16324:               app.project.activeItem
16325:                 .layer(
16326:                   shapeLayer.name,
16327:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
16328:                 .remove();
16329:               app.project.activeItem
16330:                 .layer(
16331:                   shapeLayer.name,
16332:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
16333:                 .remove();
16334:               app.project.activeItem
16335:                 .layer(
16336:                   shapeLayer.name,
16337:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
16338:                 .remove();
16339:               app.project.activeItem
16340:                 .layer(
16341:                   shapeLayer.name,
16342:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
16343:                 .remove();
16344:               app.project.activeItem
16345:                 .layer(
16346:                   shapeLayer.name,
16347:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
16348:                 .remove();
16349:               break;
16350:             case 1:
16351:               app.project.activeItem
16352:                 .layer(
16353:                   shapeLayer.name,
16354:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
16355:                 .remove();
16356:               app.project.activeItem
16357:                 .layer(
16358:                   shapeLayer.name,
16359:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
16360:                 .remove();
16361:               app.project.activeItem
16362:                 .layer(
16363:                   shapeLayer.name,
16364:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
16365:                 .remove();
16366:               app.project.activeItem
16367:                 .layer(
16368:                   shapeLayer.name,
16369:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
16370:                 .remove();
16371:           }
16372:         };
16373:         createBasic10b = function () {
16374:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
16375:           shorten("Base Line")("ADBE Vectors Group").addProperty(
16376:             "ADBE Vector Shape - Rect",
16377:           )("ADBE Vector Rect Size").expression =
16378:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
16379:             (EditTextCopies.text - 1) +
16380:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
16381:           shorten("Base Line")("ADBE Vectors Group")(
16382:             "ADBE Vector Shape - Rect",
16383:           )("ADBE Vector Rect Position").expression =
16384:             'try { if (effect("ADBE easyRulers")("Height")>0) { [(effect("ADBE easyRulers")("Gap")*' +
16385:             (EditTextCopies.text - 1) +
16386:             ')/2, -20 + effect("ADBE easyRulers")("Height")/2] } else { [(effect("ADBE easyRulers")("Gap")*' +
16387:             (EditTextCopies.text - 1) +
16388:             ')/2, -20 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
16389:           shorten("Base Line")("ADBE Vector Transform Group")(
16390:             "ADBE Vector Position",
16391:           ).setValue([0, 45]);
16392:           shorten("Base Line")("ADBE Vectors Group").addProperty(
16393:             "ADBE Vector Graphic - Fill",
16394:           )("ADBE Vector Fill Color").expression =
16395:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
16396:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
16397:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
16398:             "ADBE Vector Shape - Rect",
16399:           )("ADBE Vector Rect Size").expression =
16400:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
16401:           shorten("Big subdivisions")("ADBE Vectors Group")(
16402:             "ADBE Vector Shape - Rect",
16403:           )("ADBE Vector Rect Position").expression =
16404:             'try { [0, 25 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16405:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
16406:             "ADBE Vector Graphic - Fill",
16407:           )("ADBE Vector Fill Color").expression =
16408:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
16409:           shorten("Big subdivisions")("ADBE Vectors Group")
16410:             .addProperty("ADBE Vector Filter - Repeater")(
16411:               "ADBE Vector Repeater Copies",
16412:             )
16413:             .setValue(
16414:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
16415:             );
16416:           shorten("Big subdivisions")("ADBE Vectors Group")(
16417:             "ADBE Vector Filter - Repeater",
16418:           )("ADBE Vector Repeater Transform")(
16419:             "ADBE Vector Repeater Position",
16420:           ).expression =
16421:             'try { [effect("ADBE easyRulers")("Gap")*' +
16422:             divideBy +
16423:             ", value[1]] } catch(e) { value }";
16424:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
16425:             "ADBE Vector Group Opacity",
16426:           ).expression =
16427:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
16428:           shorten.addProperty("ADBE Vector Group").name =
16429:             "Big subdivisions Base Line";
16430:           shorten("Big subdivisions Base Line")(
16431:             "ADBE Vectors Group",
16432:           ).addProperty("ADBE Vector Shape - Rect")(
16433:             "ADBE Vector Rect Size",
16434:           ).expression =
16435:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
16436:             (EditTextCopies.text - 1) +
16437:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
16438:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
16439:             "ADBE Vector Position",
16440:           ).setValue([0, 45]);
16441:           shorten("Big subdivisions Base Line")(
16442:             "ADBE Vectors Group",
16443:           ).addProperty("ADBE Vector Graphic - Fill")(
16444:             "ADBE Vector Fill Color",
16445:           ).expression =
16446:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
16447:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
16448:             "ADBE Vector Shape - Rect",
16449:           )("ADBE Vector Rect Position").expression =
16450:             'try { if ((effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias"))>0) {                 if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                    [(effect("ADBE easyRulers")("Gap")*' +
16451:             (EditTextCopies.text - 1) +
16452:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                 } else {                     if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                         [(effect("ADBE easyRulers")("Gap")*' +
16453:             (EditTextCopies.text - 1) +
16454:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                     } else {                         if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                             [(effect("ADBE easyRulers")("Gap")*' +
16455:             (EditTextCopies.text - 1) +
16456:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2 - effect("ADBE easyRulers")("Height Bias")]                         } else { [(effect("ADBE easyRulers")("Gap")*' +
16457:             (EditTextCopies.text - 1) +
16458:             ')/2, -20]                     }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
16459:             (EditTextCopies.text - 1) +
16460:             ')/2, -20 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
16461:           shorten.addProperty("ADBE Vector Group").name =
16462:             "Fifth subdivisions - Secondary Color";
16463:           shorten.addProperty("ADBE Vector Group").name = "Fifth subdivisions";
16464:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
16465:             "ADBE Vector Group",
16466:           ).name = "Stripes";
16467:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Stripes")(
16468:             "ADBE Vectors Group",
16469:           ).addProperty("ADBE Vector Shape - Rect")(
16470:             "ADBE Vector Rect Size",
16471:           ).expression =
16472:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16473:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Stripes")(
16474:             "ADBE Vectors Group",
16475:           )("ADBE Vector Shape - Rect")(
16476:             "ADBE Vector Rect Position",
16477:           ).expression =
16478:             'try { [0, 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16479:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Stripes")(
16480:             "ADBE Vectors Group",
16481:           )
16482:             .addProperty("ADBE Vector Filter - Repeater")(
16483:               "ADBE Vector Repeater Copies",
16484:             )
16485:             .setValue(
16486:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16487:                 1,
16488:             );
16489:           shorten("Fifth subdivisions")("ADBE Vectors Group")("Stripes")(
16490:             "ADBE Vectors Group",
16491:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
16492:             "ADBE Vector Repeater Position",
16493:           ).expression =
16494:             'try { [effect("ADBE easyRulers")("Gap")*' +
16495:             divideBy / 5 +
16496:             ", value[1]] } catch(e) { value }";
16497:           shorten("Fifth subdivisions")("ADBE Vectors Group")
16498:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
16499:             .setValue(2);
16500:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
16501:             "ADBE Vector Group",
16502:           ).name = "Stripes Mask Big";
16503:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
16504:             "Stripes Mask Big",
16505:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
16506:             "ADBE Vector Rect Size",
16507:           ).expression =
16508:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
16509:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
16510:             "Stripes Mask Big",
16511:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
16512:             "ADBE Vector Rect Position",
16513:           ).expression =
16514:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16515:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
16516:             "Stripes Mask Big",
16517:           )("ADBE Vectors Group")
16518:             .addProperty("ADBE Vector Filter - Repeater")(
16519:               "ADBE Vector Repeater Copies",
16520:             )
16521:             .setValue(
16522:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
16523:             );
16524:           shorten("Fifth subdivisions")("ADBE Vectors Group")(
16525:             "Stripes Mask Big",
16526:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
16527:             "ADBE Vector Repeater Transform",
16528:           )("ADBE Vector Repeater Position").expression =
16529:             'try { [effect("ADBE easyRulers")("Gap")*' +
16530:             divideBy +
16531:             ", value[1]] } catch(e) { value }";
16532:           shorten("Fifth subdivisions")("ADBE Vectors Group")
16533:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
16534:             .setValue(3);
16535:           shorten("Fifth subdivisions")("ADBE Vectors Group").addProperty(
16536:             "ADBE Vector Graphic - Fill",
16537:           )("ADBE Vector Fill Color").expression =
16538:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
16539:           shorten("Fifth subdivisions")("ADBE Vector Transform Group")(
16540:             "ADBE Vector Group Opacity",
16541:           ).expression =
16542:             'if (content(1).content("Fifth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Fifth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
16543:           shorten.addProperty("ADBE Vector Group").name =
16544:             "Fifth subdivisions Base Line";
16545:           shorten("Fifth subdivisions Base Line")(
16546:             "ADBE Vectors Group",
16547:           ).addProperty("ADBE Vector Shape - Rect")(
16548:             "ADBE Vector Rect Size",
16549:           ).expression =
16550:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
16551:             (EditTextCopies.text - 1) +
16552:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
16553:           shorten("Fifth subdivisions Base Line")(
16554:             "ADBE Vector Transform Group",
16555:           )("ADBE Vector Position").setValue([0, 45]);
16556:           shorten("Fifth subdivisions Base Line")(
16557:             "ADBE Vectors Group",
16558:           ).addProperty("ADBE Vector Graphic - Fill")(
16559:             "ADBE Vector Fill Color",
16560:           ).expression =
16561:             'try { effect("ADBE easyRulers")("Fifth Subdivisions") } catch(e) { value }';
16562:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
16563:             "ADBE Vector Shape - Rect",
16564:           )("ADBE Vector Rect Position").setValue([
16565:             (EditTextGap.text * EditTextCopies.text) / 2,
16566:             -20,
16567:           ]);
16568:           shorten("Fifth subdivisions Base Line")("ADBE Vectors Group")(
16569:             "ADBE Vector Shape - Rect",
16570:           )("ADBE Vector Rect Position").expression =
16571:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2)>0) {                    if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                        [(effect("ADBE easyRulers")("Gap")*' +
16572:             (EditTextCopies.text - 1) +
16573:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                    } else {                         if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                             [(effect("ADBE easyRulers")("Gap")*' +
16574:             (EditTextCopies.text - 1) +
16575:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                         } else {                             if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                 [(effect("ADBE easyRulers")("Gap")*' +
16576:             (EditTextCopies.text - 1) +
16577:             ')/2, -20 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                             } else { [(effect("ADBE easyRulers")("Gap")*' +
16578:             (EditTextCopies.text - 1) +
16579:             ')/2, -20]                          }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
16580:             (EditTextCopies.text - 1) +
16581:             ')/2, -20 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
16582:           shorten.addProperty("ADBE Vector Group").name =
16583:             "Main lines - Secondary Color";
16584:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
16585:           shorten("Main lines")("ADBE Vectors Group").addProperty(
16586:             "ADBE Vector Group",
16587:           ).name = "Stripes";
16588:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
16589:             "ADBE Vectors Group",
16590:           ).addProperty("ADBE Vector Shape - Rect")(
16591:             "ADBE Vector Rect Size",
16592:           ).expression =
16593:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16594:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
16595:             "ADBE Vectors Group",
16596:           )("ADBE Vector Shape - Rect")(
16597:             "ADBE Vector Rect Position",
16598:           ).expression =
16599:             'try { [0, 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
16600:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
16601:             "ADBE Vectors Group",
16602:           )
16603:             .addProperty("ADBE Vector Filter - Repeater")(
16604:               "ADBE Vector Repeater Copies",
16605:             )
16606:             .setValue(EditTextCopies.text);
16607:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
16608:             "ADBE Vectors Group",
16609:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
16610:             "ADBE Vector Repeater Position",
16611:           ).expression =
16612:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
16613:           shorten("Main lines")("ADBE Vectors Group")
16614:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
16615:             .setValue(2);
16616:           shorten("Main lines")("ADBE Vectors Group").addProperty(
16617:             "ADBE Vector Group",
16618:           ).name = "Stripes Mask Fifth";
16619:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Fifth")(
16620:             "ADBE Vectors Group",
16621:           ).addProperty("ADBE Vector Shape - Rect")(
16622:             "ADBE Vector Rect Size",
16623:           ).expression =
16624:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16625:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Fifth")(
16626:             "ADBE Vectors Group",
16627:           )("ADBE Vector Shape - Rect")(
16628:             "ADBE Vector Rect Position",
16629:           ).expression =
16630:             'try { [0, 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16631:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Fifth")(
16632:             "ADBE Vectors Group",
16633:           )
16634:             .addProperty("ADBE Vector Filter - Repeater")(
16635:               "ADBE Vector Repeater Copies",
16636:             )
16637:             .setValue(
16638:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16639:                 1,
16640:             );
16641:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Fifth")(
16642:             "ADBE Vectors Group",
16643:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
16644:             "ADBE Vector Repeater Position",
16645:           ).expression =
16646:             'try { [effect("ADBE easyRulers")("Gap")*' +
16647:             divideBy / 5 +
16648:             ", value[1]] } catch(e) { value }";
16649:           shorten("Main lines")("ADBE Vectors Group")
16650:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
16651:             .setValue(3);
16652:           shorten("Main lines")("ADBE Vectors Group").addProperty(
16653:             "ADBE Vector Graphic - Fill",
16654:           )("ADBE Vector Fill Color").expression =
16655:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
16656:           shorten("Main lines")("ADBE Vector Transform Group")(
16657:             "ADBE Vector Group Opacity",
16658:           ).expression =
16659:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
16660:           t("ADBE easyRulers")("Width").setValue(4);
16661:           t("ADBE easyRulers")("default Width").setValue(4);
16662:           t("ADBE easyRulers")("Height").setValue(20);
16663:           t("ADBE easyRulers")("default Height").setValue(20);
16664:           t("ADBE easyRulers")("Height Bias").setValue(10);
16665:           t("ADBE easyRulers")("default Height Bias").setValue(10);
16666:           if (SidesType.selection.index == 2) {
16667:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
16668:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
16669:           }
16670:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
16671:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
16672:           createPointerLinear();
16673:           shorten("Main lines - Secondary Color")(
16674:             "ADBE Vectors Group",
16675:           ).addProperty("ADBE Vector Shape - Rect")(
16676:             "ADBE Vector Rect Size",
16677:           ).expression =
16678:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16679:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16680:             "ADBE Vector Shape - Rect",
16681:           )("ADBE Vector Rect Position").expression =
16682:             'try { [0, 25 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
16683:           shorten("Main lines - Secondary Color")(
16684:             "ADBE Vectors Group",
16685:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
16686:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16687:             "ADBE Vector Graphic - Fill",
16688:           )("ADBE Vector Fill Color").expression =
16689:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16690:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16691:             "ADBE Vector Graphic - Fill",
16692:           )("ADBE Vector Fill Opacity").expression =
16693:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
16694:           shorten("Main lines - Secondary Color")(
16695:             "ADBE Vectors Group",
16696:           ).addProperty("ADBE Vector Filter - Repeater")(
16697:             "ADBE Vector Repeater Copies",
16698:           ).expression =
16699:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16700:             EditTextCopies.text +
16701:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16702:             EditTextCopies.text +
16703:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
16704:             (Number(EditTextCopies.text) - 1) +
16705:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16706:             EditTextCopies.text +
16707:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16708:             (Number(EditTextCopies.text) - 1) +
16709:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }              }} catch(e) { value }';
16710:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16711:             "ADBE Vector Filter - Repeater",
16712:           )("ADBE Vector Repeater Transform")(
16713:             "ADBE Vector Repeater Opacity 1",
16714:           ).expression =
16715:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16716:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16717:             "ADBE Vector Filter - Repeater",
16718:           )("ADBE Vector Repeater Transform")(
16719:             "ADBE Vector Repeater Opacity 2",
16720:           ).expression =
16721:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16722:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16723:             "ADBE Vector Filter - Repeater",
16724:           )("ADBE Vector Repeater Transform")(
16725:             "ADBE Vector Repeater Position",
16726:           ).expression =
16727:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
16728:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16729:             "ADBE Vector Filter - Repeater",
16730:           )("ADBE Vector Repeater Offset").expression =
16731:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16732:             EditTextCopies.text +
16733:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16734:             (Number(EditTextCopies.text) - 1) +
16735:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
16736:           shorten("Main lines - Secondary Color")(
16737:             "ADBE Vectors Group",
16738:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
16739:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16740:             "Fill End",
16741:           )("ADBE Vector Fill Color").expression =
16742:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16743:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
16744:             "Fill End",
16745:           )("ADBE Vector Fill Opacity").expression =
16746:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
16747:           shorten("Main lines - Secondary Color")(
16748:             "ADBE Vector Transform Group",
16749:           )("ADBE Vector Group Opacity").expression =
16750:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16751:           shorten("Main lines - Secondary Color")(
16752:             "ADBE Vector Transform Group",
16753:           )("ADBE Vector Scale").expression =
16754:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16755:           secondary_lines = app.project.activeItem
16756:             .layer(
16757:               shapeLayer.name,
16758:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
16759:             .duplicate();
16760:           secondary_lines.name = "Big subdivisions - Secondary Color";
16761:           secondary_lines("ADBE Vectors Group")(
16762:             "ADBE Vector Filter - Repeater",
16763:           )("ADBE Vector Repeater Copies").expression =
16764:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16765:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16766:             1 +
16767:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16768:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16769:             1 +
16770:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
16771:             (Number(EditTextCopies.text) - 1) +
16772:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
16773:             divideBy +
16774:             ') }               } else {                     if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16775:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16776:             1 +
16777:             ' } else                     if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16778:             (Number(EditTextCopies.text) - 1) +
16779:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
16780:             divideBy +
16781:             ") } else { 0 }              }} catch(e) { value }";
16782:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
16783:             "ADBE Vector Fill Opacity",
16784:           ).expression =
16785:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
16786:           secondary_lines("ADBE Vectors Group")(
16787:             "ADBE Vector Graphic - Fill",
16788:           ).name = "Fill Start";
16789:           secondary_lines("ADBE Vectors Group")("Fill Start")(
16790:             "ADBE Vector Fill Color",
16791:           ).expression =
16792:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16793:           secondary_lines("ADBE Vectors Group")(
16794:             "ADBE Vector Filter - Repeater",
16795:           )("ADBE Vector Repeater Offset").expression =
16796:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16797:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
16798:             1 +
16799:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16800:             (Number(EditTextCopies.text) - 1) +
16801:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
16802:             divideBy +
16803:             ")} else { 0 }              }} catch(e) { value }";
16804:           secondary_lines("ADBE Vectors Group")(
16805:             "ADBE Vector Filter - Repeater",
16806:           )("ADBE Vector Repeater Transform")(
16807:             "ADBE Vector Repeater Opacity 1",
16808:           ).expression =
16809:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16810:           secondary_lines("ADBE Vectors Group")(
16811:             "ADBE Vector Filter - Repeater",
16812:           )("ADBE Vector Repeater Transform")(
16813:             "ADBE Vector Repeater Opacity 2",
16814:           ).expression =
16815:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16816:           secondary_lines("ADBE Vectors Group").addProperty(
16817:             "ADBE Vector Graphic - Fill",
16818:           ).name = "Fill End";
16819:           secondary_lines("ADBE Vectors Group")("Fill End")(
16820:             "ADBE Vector Fill Color",
16821:           ).expression =
16822:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16823:           secondary_lines("ADBE Vectors Group")("Fill End")(
16824:             "ADBE Vector Fill Opacity",
16825:           ).expression =
16826:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
16827:           secondary_lines("ADBE Vector Transform Group")(
16828:             "ADBE Vector Group Opacity",
16829:           ).expression =
16830:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16831:           secondary_lines("ADBE Vector Transform Group")(
16832:             "ADBE Vector Scale",
16833:           ).expression =
16834:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16835:           shorten("Fifth subdivisions - Secondary Color")(
16836:             "ADBE Vectors Group",
16837:           ).addProperty("ADBE Vector Shape - Rect")(
16838:             "ADBE Vector Rect Size",
16839:           ).expression =
16840:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
16841:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16842:             "ADBE Vector Shape - Rect",
16843:           )("ADBE Vector Rect Position").expression =
16844:             'try { [value[0], 25 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
16845:           shorten("Fifth subdivisions - Secondary Color")(
16846:             "ADBE Vectors Group",
16847:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
16848:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16849:             "ADBE Vector Graphic - Fill",
16850:           )("ADBE Vector Fill Color").expression =
16851:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
16852:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16853:             "ADBE Vector Graphic - Fill",
16854:           )("ADBE Vector Fill Opacity").expression =
16855:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
16856:           shorten("Fifth subdivisions - Secondary Color")(
16857:             "ADBE Vectors Group",
16858:           ).addProperty("ADBE Vector Filter - Repeater")(
16859:             "ADBE Vector Repeater Copies",
16860:           ).expression =
16861:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
16862:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16863:             1 +
16864:             '-content("Ruler").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
16865:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16866:             1 +
16867:             '-content("Ruler Mirror").content("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
16868:             (Number(EditTextCopies.text) - 1) +
16869:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
16870:             divideBy / 5 +
16871:             ') }               } else {                   if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
16872:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16873:             1 +
16874:             ' } else                   if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
16875:             (Number(EditTextCopies.text) - 1) +
16876:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
16877:             divideBy / 5 +
16878:             ") } else { 0 }              }} catch(e) { value }";
16879:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16880:             "ADBE Vector Filter - Repeater",
16881:           )("ADBE Vector Repeater Transform")(
16882:             "ADBE Vector Repeater Opacity 1",
16883:           ).expression =
16884:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16885:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16886:             "ADBE Vector Filter - Repeater",
16887:           )("ADBE Vector Repeater Transform")(
16888:             "ADBE Vector Repeater Opacity 2",
16889:           ).expression =
16890:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
16891:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16892:             "ADBE Vector Filter - Repeater",
16893:           )("ADBE Vector Repeater Transform")(
16894:             "ADBE Vector Repeater Position",
16895:           ).expression =
16896:             'try { [effect("ADBE easyRulers")("Gap")*' +
16897:             divideBy / 5 +
16898:             ", value[1]] } catch(e) { value }";
16899:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16900:             "ADBE Vector Filter - Repeater",
16901:           )("ADBE Vector Repeater Offset").expression =
16902:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
16903:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 5) +
16904:             1 +
16905:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
16906:             (Number(EditTextCopies.text) - 1) +
16907:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
16908:             divideBy / 5 +
16909:             ")} else { 0 }             }} catch(e) { value }";
16910:           shorten("Fifth subdivisions - Secondary Color")(
16911:             "ADBE Vectors Group",
16912:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
16913:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16914:             "Fill End",
16915:           )("ADBE Vector Fill Color").expression =
16916:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
16917:           shorten("Fifth subdivisions - Secondary Color")("ADBE Vectors Group")(
16918:             "Fill End",
16919:           )("ADBE Vector Fill Opacity").expression =
16920:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0038").value?100:0; } catch(e) { value }';
16921:           shorten("Fifth subdivisions - Secondary Color")(
16922:             "ADBE Vector Transform Group",
16923:           )("ADBE Vector Group Opacity").expression =
16924:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
16925:           shorten("Fifth subdivisions - Secondary Color")(
16926:             "ADBE Vector Transform Group",
16927:           )("ADBE Vector Scale").expression =
16928:             'if (content(1).content("Fifth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Fifth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
16929:           app.project.activeItem
16930:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
16931:             .duplicate().name = "Ruler Mirror";
16932:           app.project.activeItem
16933:             .layer(
16934:               shapeLayer.name,
16935:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
16936:             .setValue([100, -100]);
16937:           switch (BaseLineDropdown.selection.index) {
16938:             case 0:
16939:               app.project.activeItem
16940:                 .layer(
16941:                   shapeLayer.name,
16942:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
16943:                 .remove();
16944:               app.project.activeItem
16945:                 .layer(
16946:                   shapeLayer.name,
16947:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
16948:                 .remove();
16949:               app.project.activeItem
16950:                 .layer(
16951:                   shapeLayer.name,
16952:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
16953:                 .remove();
16954:               app.project.activeItem
16955:                 .layer(
16956:                   shapeLayer.name,
16957:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
16958:                 .remove();
16959:               app.project.activeItem
16960:                 .layer(
16961:                   shapeLayer.name,
16962:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
16963:                 .remove();
16964:               app.project.activeItem
16965:                 .layer(
16966:                   shapeLayer.name,
16967:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
16968:                 .remove();
16969:               break;
16970:             case 1:
16971:               app.project.activeItem
16972:                 .layer(
16973:                   shapeLayer.name,
16974:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
16975:                 .remove();
16976:               app.project.activeItem
16977:                 .layer(
16978:                   shapeLayer.name,
16979:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
16980:                 .remove();
16981:               app.project.activeItem
16982:                 .layer(
16983:                   shapeLayer.name,
16984:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Fifth subdivisions Base Line")
16985:                 .remove();
16986:               app.project.activeItem
16987:                 .layer(
16988:                   shapeLayer.name,
16989:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Fifth subdivisions Base Line")
16990:                 .remove();
16991:           }
16992:         };
16993:         createBasic16 = function () {
16994:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
16995:           shorten("Base Line")("ADBE Vectors Group").addProperty(
16996:             "ADBE Vector Shape - Rect",
16997:           )("ADBE Vector Rect Size").expression =
16998:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
16999:             (EditTextCopies.text - 1) +
17000:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
17001:           shorten("Base Line")("ADBE Vectors Group")(
17002:             "ADBE Vector Shape - Rect",
17003:           )("ADBE Vector Rect Position").expression =
17004:             'try { if (effect("ADBE easyRulers")("Height")>0) { [(effect("ADBE easyRulers")("Gap")*' +
17005:             (EditTextCopies.text - 1) +
17006:             ')/2, -15 + effect("ADBE easyRulers")("Height")/2] } else { [(effect("ADBE easyRulers")("Gap")*' +
17007:             (EditTextCopies.text - 1) +
17008:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17009:           shorten("Base Line")("ADBE Vector Transform Group")(
17010:             "ADBE Vector Position",
17011:           ).setValue([0, 45]);
17012:           shorten("Base Line")("ADBE Vectors Group").addProperty(
17013:             "ADBE Vector Graphic - Fill",
17014:           )("ADBE Vector Fill Color").expression =
17015:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
17016:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
17017:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
17018:             "ADBE Vector Shape - Rect",
17019:           )("ADBE Vector Rect Size").expression =
17020:             'try { [-0.5 + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
17021:           shorten("Big subdivisions")("ADBE Vectors Group")(
17022:             "ADBE Vector Shape - Rect",
17023:           )("ADBE Vector Rect Position").expression =
17024:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17025:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
17026:             "ADBE Vector Graphic - Fill",
17027:           )("ADBE Vector Fill Color").expression =
17028:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
17029:           shorten("Big subdivisions")("ADBE Vectors Group")
17030:             .addProperty("ADBE Vector Filter - Repeater")(
17031:               "ADBE Vector Repeater Copies",
17032:             )
17033:             .setValue(
17034:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
17035:             );
17036:           shorten("Big subdivisions")("ADBE Vectors Group")(
17037:             "ADBE Vector Filter - Repeater",
17038:           )("ADBE Vector Repeater Transform")(
17039:             "ADBE Vector Repeater Position",
17040:           ).expression =
17041:             'try { [effect("ADBE easyRulers")("Gap")*' +
17042:             divideBy +
17043:             ", value[1]] } catch(e) { value }";
17044:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
17045:             "ADBE Vector Group Opacity",
17046:           ).expression =
17047:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
17048:           shorten.addProperty("ADBE Vector Group").name =
17049:             "Big subdivisions Base Line";
17050:           shorten("Big subdivisions Base Line")(
17051:             "ADBE Vectors Group",
17052:           ).addProperty("ADBE Vector Shape - Rect")(
17053:             "ADBE Vector Rect Size",
17054:           ).expression =
17055:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
17056:             (EditTextCopies.text - 1) +
17057:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
17058:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
17059:             "ADBE Vector Position",
17060:           ).setValue([0, 45]);
17061:           shorten("Big subdivisions Base Line")(
17062:             "ADBE Vectors Group",
17063:           ).addProperty("ADBE Vector Graphic - Fill")(
17064:             "ADBE Vector Fill Color",
17065:           ).expression =
17066:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
17067:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
17068:             "ADBE Vector Shape - Rect",
17069:           )("ADBE Vector Rect Position").expression =
17070:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")/2)>0) {                  if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                     [(effect("ADBE easyRulers")("Gap")*' +
17071:             (EditTextCopies.text - 1) +
17072:             ')/2, -15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                  } else{                       if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                           [(effect("ADBE easyRulers")("Gap")*' +
17073:             (EditTextCopies.text - 1) +
17074:             ')/2, -15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                       } else {                           if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                              [(effect("ADBE easyRulers")("Gap")*' +
17075:             (EditTextCopies.text - 1) +
17076:             ')/2,-15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                           } else { [(effect("ADBE easyRulers")("Gap")*' +
17077:             (EditTextCopies.text - 1) +
17078:             ')/2, -15]              }}}} else { [(effect("ADBE easyRulers")("Gap")*' +
17079:             (EditTextCopies.text - 1) +
17080:             ')/2,-15+effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17081:           shorten.addProperty("ADBE Vector Group").name =
17082:             "Half subdivisions - Secondary Color";
17083:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
17084:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
17085:             "ADBE Vector Group",
17086:           ).name = "Stripes";
17087:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17088:             "ADBE Vectors Group",
17089:           ).addProperty("ADBE Vector Shape - Rect")(
17090:             "ADBE Vector Rect Size",
17091:           ).expression =
17092:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17093:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17094:             "ADBE Vectors Group",
17095:           )("ADBE Vector Shape - Rect")(
17096:             "ADBE Vector Rect Position",
17097:           ).expression =
17098:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17099:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17100:             "ADBE Vectors Group",
17101:           )
17102:             .addProperty("ADBE Vector Filter - Repeater")(
17103:               "ADBE Vector Repeater Copies",
17104:             )
17105:             .setValue(
17106:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17107:                 1,
17108:             );
17109:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17110:             "ADBE Vectors Group",
17111:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17112:             "ADBE Vector Repeater Position",
17113:           ).expression =
17114:             'try { [effect("ADBE easyRulers")("Gap")*' +
17115:             divideBy / 2 +
17116:             ", value[1]] } catch(e) { value }";
17117:           shorten("Half subdivisions")("ADBE Vectors Group")
17118:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17119:             .setValue(2);
17120:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
17121:             "ADBE Vector Group",
17122:           ).name = "Stripes Mask Big";
17123:           shorten("Half subdivisions")("ADBE Vectors Group")(
17124:             "Stripes Mask Big",
17125:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
17126:             "ADBE Vector Rect Size",
17127:           ).expression =
17128:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
17129:           shorten("Half subdivisions")("ADBE Vectors Group")(
17130:             "Stripes Mask Big",
17131:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
17132:             "ADBE Vector Rect Position",
17133:           ).expression =
17134:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17135:           shorten("Half subdivisions")("ADBE Vectors Group")(
17136:             "Stripes Mask Big",
17137:           )("ADBE Vectors Group")
17138:             .addProperty("ADBE Vector Filter - Repeater")(
17139:               "ADBE Vector Repeater Copies",
17140:             )
17141:             .setValue(
17142:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
17143:             );
17144:           shorten("Half subdivisions")("ADBE Vectors Group")(
17145:             "Stripes Mask Big",
17146:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
17147:             "ADBE Vector Repeater Transform",
17148:           )("ADBE Vector Repeater Position").expression =
17149:             'try { [effect("ADBE easyRulers")("Gap")*' +
17150:             divideBy +
17151:             ", value[1]] } catch(e) { value }";
17152:           shorten("Half subdivisions")("ADBE Vectors Group")
17153:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17154:             .setValue(3);
17155:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
17156:             "ADBE Vector Graphic - Fill",
17157:           )("ADBE Vector Fill Color").expression =
17158:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
17159:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
17160:             "ADBE Vector Group Opacity",
17161:           ).expression =
17162:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
17163:           shorten.addProperty("ADBE Vector Group").name =
17164:             "Half subdivisions Base Line";
17165:           shorten("Half subdivisions Base Line")(
17166:             "ADBE Vectors Group",
17167:           ).addProperty("ADBE Vector Shape - Rect")(
17168:             "ADBE Vector Rect Size",
17169:           ).expression =
17170:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
17171:             (EditTextCopies.text - 1) +
17172:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
17173:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
17174:             "ADBE Vector Position",
17175:           ).setValue([0, 45]);
17176:           shorten("Half subdivisions Base Line")(
17177:             "ADBE Vectors Group",
17178:           ).addProperty("ADBE Vector Graphic - Fill")(
17179:             "ADBE Vector Fill Color",
17180:           ).expression =
17181:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
17182:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
17183:             "ADBE Vector Shape - Rect",
17184:           )("ADBE Vector Rect Position").expression =
17185:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias"))>0) {                    if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                         [(effect("ADBE easyRulers")("Gap")*' +
17186:             (EditTextCopies.text - 1) +
17187:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                    } else {                          if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                              [(effect("ADBE easyRulers")("Gap")*' +
17188:             (EditTextCopies.text - 1) +
17189:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                          } else {                              if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                  [(effect("ADBE easyRulers")("Gap")*' +
17190:             (EditTextCopies.text - 1) +
17191:             ')/2,-15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                              } else { [(effect("ADBE easyRulers")("Gap")*' +
17192:             (EditTextCopies.text - 1) +
17193:             ')/2, -15]              }}}} else { [(effect("ADBE easyRulers")("Gap")*' +
17194:             (EditTextCopies.text - 1) +
17195:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17196:           shorten.addProperty("ADBE Vector Group").name =
17197:             "Quarter subdivisions - Secondary Color";
17198:           shorten.addProperty("ADBE Vector Group").name =
17199:             "Quarter subdivisions";
17200:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
17201:             "ADBE Vector Group",
17202:           ).name = "Stripes";
17203:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
17204:             "ADBE Vectors Group",
17205:           ).addProperty("ADBE Vector Shape - Rect")(
17206:             "ADBE Vector Rect Size",
17207:           ).expression =
17208:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17209:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
17210:             "ADBE Vectors Group",
17211:           )("ADBE Vector Shape - Rect")(
17212:             "ADBE Vector Rect Position",
17213:           ).expression =
17214:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
17215:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
17216:             "ADBE Vectors Group",
17217:           )
17218:             .addProperty("ADBE Vector Filter - Repeater")(
17219:               "ADBE Vector Repeater Copies",
17220:             )
17221:             .setValue(
17222:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17223:                 1,
17224:             );
17225:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
17226:             "ADBE Vectors Group",
17227:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17228:             "ADBE Vector Repeater Position",
17229:           ).expression =
17230:             'try { [effect("ADBE easyRulers")("Gap")*' +
17231:             divideBy / 4 +
17232:             ", value[1]] } catch(e) { value }";
17233:           shorten("Quarter subdivisions")("ADBE Vectors Group")
17234:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17235:             .setValue(2);
17236:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
17237:             "ADBE Vector Group",
17238:           ).name = "Stripes Mask Half";
17239:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
17240:             "Stripes Mask Half",
17241:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
17242:             "ADBE Vector Rect Size",
17243:           ).expression =
17244:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17245:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
17246:             "Stripes Mask Half",
17247:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
17248:             "ADBE Vector Rect Position",
17249:           ).expression =
17250:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17251:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
17252:             "Stripes Mask Half",
17253:           )("ADBE Vectors Group")
17254:             .addProperty("ADBE Vector Filter - Repeater")(
17255:               "ADBE Vector Repeater Copies",
17256:             )
17257:             .setValue(
17258:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17259:                 1,
17260:             );
17261:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
17262:             "Stripes Mask Half",
17263:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
17264:             "ADBE Vector Repeater Transform",
17265:           )("ADBE Vector Repeater Position").expression =
17266:             'try { [effect("ADBE easyRulers")("Gap")*' +
17267:             divideBy / 2 +
17268:             ", value[1]] } catch(e) { value }";
17269:           shorten("Quarter subdivisions")("ADBE Vectors Group")
17270:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17271:             .setValue(3);
17272:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
17273:             "ADBE Vector Graphic - Fill",
17274:           )("ADBE Vector Fill Color").expression =
17275:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
17276:           shorten("Quarter subdivisions")("ADBE Vector Transform Group")(
17277:             "ADBE Vector Group Opacity",
17278:           ).expression =
17279:             'if (content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
17280:           shorten.addProperty("ADBE Vector Group").name =
17281:             "Quarter subdivisions Base Line";
17282:           shorten("Quarter subdivisions Base Line")(
17283:             "ADBE Vectors Group",
17284:           ).addProperty("ADBE Vector Shape - Rect")(
17285:             "ADBE Vector Rect Size",
17286:           ).expression =
17287:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
17288:             (EditTextCopies.text - 1) +
17289:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
17290:           shorten("Quarter subdivisions Base Line")(
17291:             "ADBE Vector Transform Group",
17292:           )("ADBE Vector Position").setValue([0, 45]);
17293:           shorten("Quarter subdivisions Base Line")(
17294:             "ADBE Vectors Group",
17295:           ).addProperty("ADBE Vector Graphic - Fill")(
17296:             "ADBE Vector Fill Color",
17297:           ).expression =
17298:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
17299:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
17300:             "ADBE Vector Shape - Rect",
17301:           )("ADBE Vector Rect Position").expression =
17302:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2)>0) {                     if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                         [(effect("ADBE easyRulers")("Gap")*' +
17303:             (EditTextCopies.text - 1) +
17304:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                     } else {                          if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                              [(effect("ADBE easyRulers")("Gap")*' +
17305:             (EditTextCopies.text - 1) +
17306:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                           } else {                                if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                    [(effect("ADBE easyRulers")("Gap")*' +
17307:             (EditTextCopies.text - 1) +
17308:             ')/2,-15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                                } else { [(effect("ADBE easyRulers")("Gap")*' +
17309:             (EditTextCopies.text - 1) +
17310:             ')/2, -15]              }}}} else { [(effect("ADBE easyRulers")("Gap")*' +
17311:             (EditTextCopies.text - 1) +
17312:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17313:           shorten.addProperty("ADBE Vector Group").name =
17314:             "Main lines - Secondary Color";
17315:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
17316:           shorten("Main lines")("ADBE Vectors Group").addProperty(
17317:             "ADBE Vector Group",
17318:           ).name = "Stripes";
17319:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
17320:             "ADBE Vectors Group",
17321:           ).addProperty("ADBE Vector Shape - Rect")(
17322:             "ADBE Vector Rect Size",
17323:           ).expression =
17324:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
17325:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
17326:             "ADBE Vectors Group",
17327:           )("ADBE Vector Shape - Rect")(
17328:             "ADBE Vector Rect Position",
17329:           ).expression =
17330:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
17331:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
17332:             "ADBE Vectors Group",
17333:           )
17334:             .addProperty("ADBE Vector Filter - Repeater")(
17335:               "ADBE Vector Repeater Copies",
17336:             )
17337:             .setValue(EditTextCopies.text);
17338:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
17339:             "ADBE Vectors Group",
17340:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17341:             "ADBE Vector Repeater Position",
17342:           ).expression =
17343:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
17344:           shorten("Main lines")("ADBE Vectors Group")
17345:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17346:             .setValue(2);
17347:           shorten("Main lines")("ADBE Vectors Group").addProperty(
17348:             "ADBE Vector Group",
17349:           ).name = "Stripes Mask Quarter";
17350:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Quarter")(
17351:             "ADBE Vectors Group",
17352:           ).addProperty("ADBE Vector Shape - Rect")(
17353:             "ADBE Vector Rect Size",
17354:           ).expression =
17355:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17356:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Quarter")(
17357:             "ADBE Vectors Group",
17358:           )("ADBE Vector Shape - Rect")(
17359:             "ADBE Vector Rect Position",
17360:           ).expression =
17361:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
17362:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Quarter")(
17363:             "ADBE Vectors Group",
17364:           )
17365:             .addProperty("ADBE Vector Filter - Repeater")(
17366:               "ADBE Vector Repeater Copies",
17367:             )
17368:             .setValue(
17369:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17370:                 1,
17371:             );
17372:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Quarter")(
17373:             "ADBE Vectors Group",
17374:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17375:             "ADBE Vector Repeater Position",
17376:           ).expression =
17377:             'try { [effect("ADBE easyRulers")("Gap")*' +
17378:             divideBy / 4 +
17379:             ", value[1]] } catch(e) { value }";
17380:           shorten("Main lines")("ADBE Vectors Group")
17381:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17382:             .setValue(3);
17383:           shorten("Main lines")("ADBE Vectors Group").addProperty(
17384:             "ADBE Vector Graphic - Fill",
17385:           )("ADBE Vector Fill Color").expression =
17386:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
17387:           shorten("Main lines")("ADBE Vector Transform Group")(
17388:             "ADBE Vector Group Opacity",
17389:           ).expression =
17390:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
17391:           t("ADBE easyRulers")("Width").setValue(4);
17392:           t("ADBE easyRulers")("default Width").setValue(4);
17393:           t("ADBE easyRulers")("Height").setValue(10);
17394:           t("ADBE easyRulers")("default Height").setValue(10);
17395:           t("ADBE easyRulers")("Height Bias").setValue(12);
17396:           t("ADBE easyRulers")("default Height Bias").setValue(12);
17397:           if (SidesType.selection.index == 2) {
17398:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
17399:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
17400:           }
17401:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(65);
17402:           t("ADBE easyRulers")("default Pointer Distance").setValue(65);
17403:           createPointerLinear();
17404:           shorten("Main lines - Secondary Color")(
17405:             "ADBE Vectors Group",
17406:           ).addProperty("ADBE Vector Shape - Rect")(
17407:             "ADBE Vector Rect Size",
17408:           ).expression =
17409:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
17410:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17411:             "ADBE Vector Shape - Rect",
17412:           )("ADBE Vector Rect Position").expression =
17413:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
17414:           shorten("Main lines - Secondary Color")(
17415:             "ADBE Vectors Group",
17416:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
17417:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17418:             "ADBE Vector Graphic - Fill",
17419:           )("ADBE Vector Fill Color").expression =
17420:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
17421:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17422:             "ADBE Vector Graphic - Fill",
17423:           )("ADBE Vector Fill Opacity").expression =
17424:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
17425:           shorten("Main lines - Secondary Color")(
17426:             "ADBE Vectors Group",
17427:           ).addProperty("ADBE Vector Filter - Repeater")(
17428:             "ADBE Vector Repeater Copies",
17429:           ).expression =
17430:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
17431:             EditTextCopies.text +
17432:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
17433:             EditTextCopies.text +
17434:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
17435:             (Number(EditTextCopies.text) - 1) +
17436:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                     if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
17437:             EditTextCopies.text +
17438:             ' } else                     if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
17439:             (Number(EditTextCopies.text) - 1) +
17440:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }               }} catch(e) { value }';
17441:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17442:             "ADBE Vector Filter - Repeater",
17443:           )("ADBE Vector Repeater Transform")(
17444:             "ADBE Vector Repeater Opacity 1",
17445:           ).expression =
17446:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17447:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17448:             "ADBE Vector Filter - Repeater",
17449:           )("ADBE Vector Repeater Transform")(
17450:             "ADBE Vector Repeater Opacity 2",
17451:           ).expression =
17452:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17453:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17454:             "ADBE Vector Filter - Repeater",
17455:           )("ADBE Vector Repeater Transform")(
17456:             "ADBE Vector Repeater Position",
17457:           ).expression =
17458:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
17459:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17460:             "ADBE Vector Filter - Repeater",
17461:           )("ADBE Vector Repeater Offset").expression =
17462:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                 if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
17463:             EditTextCopies.text +
17464:             ' } else                 if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
17465:             (Number(EditTextCopies.text) - 1) +
17466:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
17467:           shorten("Main lines - Secondary Color")(
17468:             "ADBE Vectors Group",
17469:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
17470:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17471:             "Fill End",
17472:           )("ADBE Vector Fill Color").expression =
17473:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
17474:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
17475:             "Fill End",
17476:           )("ADBE Vector Fill Opacity").expression =
17477:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
17478:           shorten("Main lines - Secondary Color")(
17479:             "ADBE Vector Transform Group",
17480:           )("ADBE Vector Group Opacity").expression =
17481:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
17482:           shorten("Main lines - Secondary Color")(
17483:             "ADBE Vector Transform Group",
17484:           )("ADBE Vector Scale").expression =
17485:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
17486:           secondary_lines = app.project.activeItem
17487:             .layer(
17488:               shapeLayer.name,
17489:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
17490:             .duplicate();
17491:           secondary_lines.name = "Big subdivisions - Secondary Color";
17492:           secondary_lines("ADBE Vectors Group")(
17493:             "ADBE Vector Filter - Repeater",
17494:           )("ADBE Vector Repeater Copies").expression =
17495:             'try  { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
17496:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
17497:             1 +
17498:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
17499:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
17500:             1 +
17501:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
17502:             (Number(EditTextCopies.text) - 1) +
17503:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
17504:             divideBy +
17505:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
17506:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
17507:             1 +
17508:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
17509:             (Number(EditTextCopies.text) - 1) +
17510:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
17511:             divideBy +
17512:             ") } else { 0 }              }} catch(e) { value }";
17513:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
17514:             "ADBE Vector Fill Opacity",
17515:           ).expression =
17516:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
17517:           secondary_lines("ADBE Vectors Group")(
17518:             "ADBE Vector Graphic - Fill",
17519:           ).name = "Fill Start";
17520:           secondary_lines("ADBE Vectors Group")("Fill Start")(
17521:             "ADBE Vector Fill Color",
17522:           ).expression =
17523:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
17524:           secondary_lines("ADBE Vectors Group")(
17525:             "ADBE Vector Filter - Repeater",
17526:           )("ADBE Vector Repeater Offset").expression =
17527:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
17528:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
17529:             1 +
17530:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
17531:             (Number(EditTextCopies.text) - 1) +
17532:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
17533:             divideBy +
17534:             ")} else { 0 }             }} catch(e) { value }";
17535:           secondary_lines("ADBE Vectors Group")(
17536:             "ADBE Vector Filter - Repeater",
17537:           )("ADBE Vector Repeater Transform")(
17538:             "ADBE Vector Repeater Opacity 1",
17539:           ).expression =
17540:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17541:           secondary_lines("ADBE Vectors Group")(
17542:             "ADBE Vector Filter - Repeater",
17543:           )("ADBE Vector Repeater Transform")(
17544:             "ADBE Vector Repeater Opacity 2",
17545:           ).expression =
17546:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17547:           secondary_lines("ADBE Vectors Group").addProperty(
17548:             "ADBE Vector Graphic - Fill",
17549:           ).name = "Fill End";
17550:           secondary_lines("ADBE Vectors Group")("Fill End")(
17551:             "ADBE Vector Fill Color",
17552:           ).expression =
17553:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
17554:           secondary_lines("ADBE Vectors Group")("Fill End")(
17555:             "ADBE Vector Fill Opacity",
17556:           ).expression =
17557:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
17558:           secondary_lines("ADBE Vector Transform Group")(
17559:             "ADBE Vector Group Opacity",
17560:           ).expression =
17561:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
17562:           secondary_lines("ADBE Vector Transform Group")(
17563:             "ADBE Vector Scale",
17564:           ).expression =
17565:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
17566:           shorten("Half subdivisions - Secondary Color")(
17567:             "ADBE Vectors Group",
17568:           ).addProperty("ADBE Vector Shape - Rect")(
17569:             "ADBE Vector Rect Size",
17570:           ).expression =
17571:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17572:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17573:             "ADBE Vector Shape - Rect",
17574:           )("ADBE Vector Rect Position").expression =
17575:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17576:           shorten("Half subdivisions - Secondary Color")(
17577:             "ADBE Vectors Group",
17578:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
17579:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17580:             "ADBE Vector Graphic - Fill",
17581:           )("ADBE Vector Fill Color").expression =
17582:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
17583:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17584:             "ADBE Vector Graphic - Fill",
17585:           )("ADBE Vector Fill Opacity").expression =
17586:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
17587:           shorten("Half subdivisions - Secondary Color")(
17588:             "ADBE Vectors Group",
17589:           ).addProperty("ADBE Vector Filter - Repeater")(
17590:             "ADBE Vector Repeater Copies",
17591:           ).expression =
17592:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
17593:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17594:             1 +
17595:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
17596:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17597:             1 +
17598:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
17599:             (Number(EditTextCopies.text) - 1) +
17600:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
17601:             divideBy / 2 +
17602:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
17603:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17604:             1 +
17605:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
17606:             (Number(EditTextCopies.text) - 1) +
17607:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
17608:             divideBy / 2 +
17609:             ") } else { 0 }              }} catch(e) { value }";
17610:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17611:             "ADBE Vector Filter - Repeater",
17612:           )("ADBE Vector Repeater Transform")(
17613:             "ADBE Vector Repeater Opacity 1",
17614:           ).expression =
17615:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17616:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17617:             "ADBE Vector Filter - Repeater",
17618:           )("ADBE Vector Repeater Transform")(
17619:             "ADBE Vector Repeater Opacity 2",
17620:           ).expression =
17621:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17622:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17623:             "ADBE Vector Filter - Repeater",
17624:           )("ADBE Vector Repeater Transform")(
17625:             "ADBE Vector Repeater Position",
17626:           ).expression =
17627:             'try { [effect("ADBE easyRulers")("Gap")*' +
17628:             divideBy / 2 +
17629:             ", value[1]] } catch(e) { value }";
17630:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17631:             "ADBE Vector Filter - Repeater",
17632:           )("ADBE Vector Repeater Offset").expression =
17633:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
17634:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17635:             1 +
17636:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
17637:             (Number(EditTextCopies.text) - 1) +
17638:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
17639:             divideBy / 2 +
17640:             ")} else { 0 }             }} catch(e) { value }";
17641:           shorten("Half subdivisions - Secondary Color")(
17642:             "ADBE Vectors Group",
17643:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
17644:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17645:             "Fill End",
17646:           )("ADBE Vector Fill Color").expression =
17647:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
17648:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
17649:             "Fill End",
17650:           )("ADBE Vector Fill Opacity").expression =
17651:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
17652:           shorten("Half subdivisions - Secondary Color")(
17653:             "ADBE Vector Transform Group",
17654:           )("ADBE Vector Group Opacity").expression =
17655:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
17656:           shorten("Half subdivisions - Secondary Color")(
17657:             "ADBE Vector Transform Group",
17658:           )("ADBE Vector Scale").expression =
17659:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
17660:           shorten("Quarter subdivisions - Secondary Color")(
17661:             "ADBE Vectors Group",
17662:           ).addProperty("ADBE Vector Shape - Rect")(
17663:             "ADBE Vector Rect Size",
17664:           ).expression =
17665:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17666:           shorten("Quarter subdivisions - Secondary Color")(
17667:             "ADBE Vectors Group",
17668:           )("ADBE Vector Shape - Rect")(
17669:             "ADBE Vector Rect Position",
17670:           ).expression =
17671:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
17672:           shorten("Quarter subdivisions - Secondary Color")(
17673:             "ADBE Vectors Group",
17674:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
17675:           shorten("Quarter subdivisions - Secondary Color")(
17676:             "ADBE Vectors Group",
17677:           )("ADBE Vector Graphic - Fill")("ADBE Vector Fill Color").expression =
17678:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
17679:           shorten("Quarter subdivisions - Secondary Color")(
17680:             "ADBE Vectors Group",
17681:           )("ADBE Vector Graphic - Fill")(
17682:             "ADBE Vector Fill Opacity",
17683:           ).expression =
17684:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
17685:           shorten("Quarter subdivisions - Secondary Color")(
17686:             "ADBE Vectors Group",
17687:           ).addProperty("ADBE Vector Filter - Repeater")(
17688:             "ADBE Vector Repeater Copies",
17689:           ).expression =
17690:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
17691:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17692:             1 +
17693:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
17694:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17695:             1 +
17696:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
17697:             (Number(EditTextCopies.text) - 1) +
17698:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
17699:             divideBy / 4 +
17700:             ') }                } else {                     if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
17701:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17702:             1 +
17703:             ' } else                     if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
17704:             (Number(EditTextCopies.text) - 1) +
17705:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
17706:             divideBy / 4 +
17707:             ") } else { 0 }               }} catch(e) { value }";
17708:           shorten("Quarter subdivisions - Secondary Color")(
17709:             "ADBE Vectors Group",
17710:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17711:             "ADBE Vector Repeater Opacity 1",
17712:           ).expression =
17713:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17714:           shorten("Quarter subdivisions - Secondary Color")(
17715:             "ADBE Vectors Group",
17716:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17717:             "ADBE Vector Repeater Opacity 2",
17718:           ).expression =
17719:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 - effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
17720:           shorten("Quarter subdivisions - Secondary Color")(
17721:             "ADBE Vectors Group",
17722:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17723:             "ADBE Vector Repeater Position",
17724:           ).expression =
17725:             'try { [effect("ADBE easyRulers")("Gap")*' +
17726:             divideBy / 4 +
17727:             ", value[1]] } catch(e) { value }";
17728:           shorten("Quarter subdivisions - Secondary Color")(
17729:             "ADBE Vectors Group",
17730:           )("ADBE Vector Filter - Repeater")(
17731:             "ADBE Vector Repeater Offset",
17732:           ).expression =
17733:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                   if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
17734:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
17735:             1 +
17736:             ' } else                   if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
17737:             (Number(EditTextCopies.text) - 1) +
17738:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
17739:             divideBy / 4 +
17740:             ")} else { 0 }              }} catch(e) { value }";
17741:           shorten("Quarter subdivisions - Secondary Color")(
17742:             "ADBE Vectors Group",
17743:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
17744:           shorten("Quarter subdivisions - Secondary Color")(
17745:             "ADBE Vectors Group",
17746:           )("Fill End")("ADBE Vector Fill Color").expression =
17747:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
17748:           shorten("Quarter subdivisions - Secondary Color")(
17749:             "ADBE Vectors Group",
17750:           )("Fill End")("ADBE Vector Fill Opacity").expression =
17751:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
17752:           shorten("Quarter subdivisions - Secondary Color")(
17753:             "ADBE Vector Transform Group",
17754:           )("ADBE Vector Group Opacity").expression =
17755:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
17756:           shorten("Quarter subdivisions - Secondary Color")(
17757:             "ADBE Vector Transform Group",
17758:           )("ADBE Vector Scale").expression =
17759:             'if (content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
17760:           app.project.activeItem
17761:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
17762:             .duplicate().name = "Ruler Mirror";
17763:           app.project.activeItem
17764:             .layer(
17765:               shapeLayer.name,
17766:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
17767:             .setValue([100, -100]);
17768:           switch (BaseLineDropdown.selection.index) {
17769:             case 0:
17770:               app.project.activeItem
17771:                 .layer(
17772:                   shapeLayer.name,
17773:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
17774:                 .remove();
17775:               app.project.activeItem
17776:                 .layer(
17777:                   shapeLayer.name,
17778:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
17779:                 .remove();
17780:               app.project.activeItem
17781:                 .layer(
17782:                   shapeLayer.name,
17783:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
17784:                 .remove();
17785:               app.project.activeItem
17786:                 .layer(
17787:                   shapeLayer.name,
17788:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
17789:                 .remove();
17790:               app.project.activeItem
17791:                 .layer(
17792:                   shapeLayer.name,
17793:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
17794:                 .remove();
17795:               app.project.activeItem
17796:                 .layer(
17797:                   shapeLayer.name,
17798:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
17799:                 .remove();
17800:               app.project.activeItem
17801:                 .layer(
17802:                   shapeLayer.name,
17803:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
17804:                 .remove();
17805:               app.project.activeItem
17806:                 .layer(
17807:                   shapeLayer.name,
17808:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
17809:                 .remove();
17810:               break;
17811:             case 1:
17812:               app.project.activeItem
17813:                 .layer(
17814:                   shapeLayer.name,
17815:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
17816:                 .remove();
17817:               app.project.activeItem
17818:                 .layer(
17819:                   shapeLayer.name,
17820:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
17821:                 .remove();
17822:               app.project.activeItem
17823:                 .layer(
17824:                   shapeLayer.name,
17825:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
17826:                 .remove();
17827:               app.project.activeItem
17828:                 .layer(
17829:                   shapeLayer.name,
17830:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
17831:                 .remove();
17832:               app.project.activeItem
17833:                 .layer(
17834:                   shapeLayer.name,
17835:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
17836:                 .remove();
17837:               app.project.activeItem
17838:                 .layer(
17839:                   shapeLayer.name,
17840:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
17841:                 .remove();
17842:           }
17843:         };
17844:         createBasic16b = function () {
17845:           shorten.addProperty("ADBE Vector Group").name = "Base Line";
17846:           shorten("Base Line")("ADBE Vectors Group").addProperty(
17847:             "ADBE Vector Shape - Rect",
17848:           )("ADBE Vector Rect Size").expression =
17849:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
17850:             (EditTextCopies.text - 1) +
17851:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")] } catch(e) { value }';
17852:           shorten("Base Line")("ADBE Vectors Group")(
17853:             "ADBE Vector Shape - Rect",
17854:           )("ADBE Vector Rect Position").setValue([
17855:             (EditTextGap.text * EditTextCopies.text) / 2,
17856:             -15,
17857:           ]);
17858:           shorten("Base Line")("ADBE Vectors Group")(
17859:             "ADBE Vector Shape - Rect",
17860:           )("ADBE Vector Rect Position").expression =
17861:             'try { if (effect("ADBE easyRulers")("Height")>0) { [(effect("ADBE easyRulers")("Gap")*' +
17862:             (EditTextCopies.text - 1) +
17863:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } else { [(effect("ADBE easyRulers")("Gap")*' +
17864:             (EditTextCopies.text - 1) +
17865:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17866:           shorten("Base Line")("ADBE Vector Transform Group")(
17867:             "ADBE Vector Position",
17868:           ).setValue([0, 45]);
17869:           shorten("Base Line")("ADBE Vectors Group").addProperty(
17870:             "ADBE Vector Graphic - Fill",
17871:           )("ADBE Vector Fill Color").expression =
17872:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
17873:           shorten.addProperty("ADBE Vector Group").name = "Big subdivisions";
17874:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
17875:             "ADBE Vector Shape - Rect",
17876:           )("ADBE Vector Rect Size").expression =
17877:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
17878:           shorten("Big subdivisions")("ADBE Vectors Group")(
17879:             "ADBE Vector Shape - Rect",
17880:           )("ADBE Vector Rect Position").expression =
17881:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17882:           shorten("Big subdivisions")("ADBE Vectors Group").addProperty(
17883:             "ADBE Vector Graphic - Fill",
17884:           )("ADBE Vector Fill Color").expression =
17885:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
17886:           shorten("Big subdivisions")("ADBE Vectors Group")
17887:             .addProperty("ADBE Vector Filter - Repeater")(
17888:               "ADBE Vector Repeater Copies",
17889:             )
17890:             .setValue(
17891:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
17892:             );
17893:           shorten("Big subdivisions")("ADBE Vectors Group")(
17894:             "ADBE Vector Filter - Repeater",
17895:           )("ADBE Vector Repeater Transform")(
17896:             "ADBE Vector Repeater Position",
17897:           ).expression =
17898:             'try { [effect("ADBE easyRulers")("Gap")*' +
17899:             divideBy +
17900:             ", value[1]] } catch(e) { value }";
17901:           shorten("Big subdivisions")("ADBE Vector Transform Group")(
17902:             "ADBE Vector Group Opacity",
17903:           ).expression =
17904:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
17905:           shorten.addProperty("ADBE Vector Group").name =
17906:             "Big subdivisions Base Line";
17907:           shorten("Big subdivisions Base Line")(
17908:             "ADBE Vectors Group",
17909:           ).addProperty("ADBE Vector Shape - Rect")(
17910:             "ADBE Vector Rect Size",
17911:           ).expression =
17912:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
17913:             (EditTextCopies.text - 1) +
17914:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
17915:           shorten("Big subdivisions Base Line")("ADBE Vector Transform Group")(
17916:             "ADBE Vector Position",
17917:           ).setValue([0, 45]);
17918:           shorten("Big subdivisions Base Line")(
17919:             "ADBE Vectors Group",
17920:           ).addProperty("ADBE Vector Graphic - Fill")(
17921:             "ADBE Vector Fill Color",
17922:           ).expression =
17923:             'try { effect("ADBE easyRulers")("Big Subdivisions") } catch(e) { value }';
17924:           shorten("Big subdivisions Base Line")("ADBE Vectors Group")(
17925:             "ADBE Vector Shape - Rect",
17926:           )("ADBE Vector Rect Position").expression =
17927:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")/4)>0) {                 if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                    [(effect("ADBE easyRulers")("Gap")*' +
17928:             (EditTextCopies.text - 1) +
17929:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                 } else {                     if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                         [(effect("ADBE easyRulers")("Gap")*' +
17930:             (EditTextCopies.text - 1) +
17931:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                     } else {                         if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                             [(effect("ADBE easyRulers")("Gap")*' +
17932:             (EditTextCopies.text - 1) +
17933:             ')/2,-15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                         } else { [(effect("ADBE easyRulers")("Gap")*' +
17934:             (EditTextCopies.text - 1) +
17935:             ')/2, -15]                     }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
17936:             (EditTextCopies.text - 1) +
17937:             ')/2,-15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
17938:           shorten.addProperty("ADBE Vector Group").name =
17939:             "Half subdivisions - Secondary Color";
17940:           shorten.addProperty("ADBE Vector Group").name = "Half subdivisions";
17941:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
17942:             "ADBE Vector Group",
17943:           ).name = "Stripes";
17944:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17945:             "ADBE Vectors Group",
17946:           ).addProperty("ADBE Vector Shape - Rect")(
17947:             "ADBE Vector Rect Size",
17948:           ).expression =
17949:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17950:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17951:             "ADBE Vectors Group",
17952:           )("ADBE Vector Shape - Rect")(
17953:             "ADBE Vector Rect Position",
17954:           ).expression =
17955:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
17956:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17957:             "ADBE Vectors Group",
17958:           )
17959:             .addProperty("ADBE Vector Filter - Repeater")(
17960:               "ADBE Vector Repeater Copies",
17961:             )
17962:             .setValue(
17963:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
17964:                 1,
17965:             );
17966:           shorten("Half subdivisions")("ADBE Vectors Group")("Stripes")(
17967:             "ADBE Vectors Group",
17968:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
17969:             "ADBE Vector Repeater Position",
17970:           ).expression =
17971:             'try { [effect("ADBE easyRulers")("Gap")*' +
17972:             divideBy / 2 +
17973:             ", value[1]] } catch(e) { value }";
17974:           shorten("Half subdivisions")("ADBE Vectors Group")
17975:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
17976:             .setValue(2);
17977:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
17978:             "ADBE Vector Group",
17979:           ).name = "Stripes Mask Big";
17980:           shorten("Half subdivisions")("ADBE Vectors Group")(
17981:             "Stripes Mask Big",
17982:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
17983:             "ADBE Vector Rect Size",
17984:           ).expression =
17985:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*4] } catch(e) { value }';
17986:           shorten("Half subdivisions")("ADBE Vectors Group")(
17987:             "Stripes Mask Big",
17988:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
17989:             "ADBE Vector Rect Position",
17990:           ).expression =
17991:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
17992:           shorten("Half subdivisions")("ADBE Vectors Group")(
17993:             "Stripes Mask Big",
17994:           )("ADBE Vectors Group")
17995:             .addProperty("ADBE Vector Filter - Repeater")(
17996:               "ADBE Vector Repeater Copies",
17997:             )
17998:             .setValue(
17999:               Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1,
18000:             );
18001:           shorten("Half subdivisions")("ADBE Vectors Group")(
18002:             "Stripes Mask Big",
18003:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
18004:             "ADBE Vector Repeater Transform",
18005:           )("ADBE Vector Repeater Position").expression =
18006:             'try { [effect("ADBE easyRulers")("Gap")*' +
18007:             divideBy +
18008:             ", value[1]] } catch(e) { value }";
18009:           shorten("Half subdivisions")("ADBE Vectors Group")
18010:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18011:             .setValue(3);
18012:           shorten("Half subdivisions")("ADBE Vectors Group").addProperty(
18013:             "ADBE Vector Graphic - Fill",
18014:           )("ADBE Vector Fill Color").expression =
18015:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
18016:           shorten("Half subdivisions")("ADBE Vector Transform Group")(
18017:             "ADBE Vector Group Opacity",
18018:           ).expression =
18019:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
18020:           shorten.addProperty("ADBE Vector Group").name =
18021:             "Half subdivisions Base Line";
18022:           shorten("Half subdivisions Base Line")(
18023:             "ADBE Vectors Group",
18024:           ).addProperty("ADBE Vector Shape - Rect")(
18025:             "ADBE Vector Rect Size",
18026:           ).expression =
18027:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
18028:             (EditTextCopies.text - 1) +
18029:             ') + effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
18030:           shorten("Half subdivisions Base Line")("ADBE Vector Transform Group")(
18031:             "ADBE Vector Position",
18032:           ).setValue([0, 45]);
18033:           shorten("Half subdivisions Base Line")(
18034:             "ADBE Vectors Group",
18035:           ).addProperty("ADBE Vector Graphic - Fill")(
18036:             "ADBE Vector Fill Color",
18037:           ).expression =
18038:             'try { effect("ADBE easyRulers")("Half Subdivisions") } catch(e) { value }';
18039:           shorten("Half subdivisions Base Line")("ADBE Vectors Group")(
18040:             "ADBE Vector Shape - Rect",
18041:           )("ADBE Vector Rect Position").expression =
18042:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")/2)>0) {                    if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                        [(effect("ADBE easyRulers")("Gap")*' +
18043:             (EditTextCopies.text - 1) +
18044:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                    } else {                        if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                            [(effect("ADBE easyRulers")("Gap")*' +
18045:             (EditTextCopies.text - 1) +
18046:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/2]                        } else {                             if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                 [(effect("ADBE easyRulers")("Gap")*' +
18047:             (EditTextCopies.text - 1) +
18048:             ')/2,-15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                             } else { [(effect("ADBE easyRulers")("Gap")*' +
18049:             (EditTextCopies.text - 1) +
18050:             ')/2, -15]                         }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
18051:             (EditTextCopies.text - 1) +
18052:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
18053:           shorten.addProperty("ADBE Vector Group").name =
18054:             "Quarter subdivisions - Secondary Color";
18055:           shorten.addProperty("ADBE Vector Group").name =
18056:             "Quarter subdivisions";
18057:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
18058:             "ADBE Vector Group",
18059:           ).name = "Stripes";
18060:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
18061:             "ADBE Vectors Group",
18062:           ).addProperty("ADBE Vector Shape - Rect")(
18063:             "ADBE Vector Rect Size",
18064:           ).expression =
18065:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
18066:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
18067:             "ADBE Vectors Group",
18068:           )("ADBE Vector Shape - Rect")(
18069:             "ADBE Vector Rect Position",
18070:           ).expression =
18071:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18072:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
18073:             "ADBE Vectors Group",
18074:           )
18075:             .addProperty("ADBE Vector Filter - Repeater")(
18076:               "ADBE Vector Repeater Copies",
18077:             )
18078:             .setValue(
18079:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18080:                 1,
18081:             );
18082:           shorten("Quarter subdivisions")("ADBE Vectors Group")("Stripes")(
18083:             "ADBE Vectors Group",
18084:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18085:             "ADBE Vector Repeater Position",
18086:           ).expression =
18087:             'try { [effect("ADBE easyRulers")("Gap")*' +
18088:             divideBy / 4 +
18089:             ", value[1]] } catch(e) { value }";
18090:           shorten("Quarter subdivisions")("ADBE Vectors Group")
18091:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18092:             .setValue(2);
18093:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
18094:             "ADBE Vector Group",
18095:           ).name = "Stripes Mask Half";
18096:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
18097:             "Stripes Mask Half",
18098:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
18099:             "ADBE Vector Rect Size",
18100:           ).expression =
18101:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
18102:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
18103:             "Stripes Mask Half",
18104:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
18105:             "ADBE Vector Rect Position",
18106:           ).expression =
18107:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
18108:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
18109:             "Stripes Mask Half",
18110:           )("ADBE Vectors Group")
18111:             .addProperty("ADBE Vector Filter - Repeater")(
18112:               "ADBE Vector Repeater Copies",
18113:             )
18114:             .setValue(
18115:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
18116:                 1,
18117:             );
18118:           shorten("Quarter subdivisions")("ADBE Vectors Group")(
18119:             "Stripes Mask Half",
18120:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
18121:             "ADBE Vector Repeater Transform",
18122:           )("ADBE Vector Repeater Position").expression =
18123:             'try { [effect("ADBE easyRulers")("Gap")*' +
18124:             divideBy / 2 +
18125:             ", value[1]] } catch(e) { value }";
18126:           shorten("Quarter subdivisions")("ADBE Vectors Group")
18127:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18128:             .setValue(3);
18129:           shorten("Quarter subdivisions")("ADBE Vectors Group").addProperty(
18130:             "ADBE Vector Graphic - Fill",
18131:           )("ADBE Vector Fill Color").expression =
18132:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
18133:           shorten("Quarter subdivisions")("ADBE Vector Transform Group")(
18134:             "ADBE Vector Group Opacity",
18135:           ).expression =
18136:             'if (content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
18137:           shorten.addProperty("ADBE Vector Group").name =
18138:             "Quarter subdivisions Base Line";
18139:           shorten("Quarter subdivisions Base Line")(
18140:             "ADBE Vectors Group",
18141:           ).addProperty("ADBE Vector Shape - Rect")(
18142:             "ADBE Vector Rect Size",
18143:           ).expression =
18144:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
18145:             (EditTextCopies.text - 1) +
18146:             ')+effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
18147:           shorten("Quarter subdivisions Base Line")(
18148:             "ADBE Vector Transform Group",
18149:           )("ADBE Vector Position").setValue([0, 45]);
18150:           shorten("Quarter subdivisions Base Line")(
18151:             "ADBE Vectors Group",
18152:           ).addProperty("ADBE Vector Graphic - Fill")(
18153:             "ADBE Vector Fill Color",
18154:           ).expression =
18155:             'try { effect("ADBE easyRulers")("Quarter Subdivisions") } catch(e) { value }';
18156:           shorten("Quarter subdivisions Base Line")("ADBE Vectors Group")(
18157:             "ADBE Vector Shape - Rect",
18158:           )("ADBE Vector Rect Position").expression =
18159:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias"))>0) {                    if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                        [(effect("ADBE easyRulers")("Gap")*' +
18160:             (EditTextCopies.text - 1) +
18161:             ')/2, -15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                    } else {                        if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                            [(effect("ADBE easyRulers")("Gap")*' +
18162:             (EditTextCopies.text - 1) +
18163:             ')/2, -15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")]                        } else {                            if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                [(effect("ADBE easyRulers")("Gap")*' +
18164:             (EditTextCopies.text - 1) +
18165:             ')/2,-15-effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                            } else { [(effect("ADBE easyRulers")("Gap")*' +
18166:             (EditTextCopies.text - 1) +
18167:             ')/2,-15]                         }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
18168:             (EditTextCopies.text - 1) +
18169:             ')/2, -15+effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
18170:           shorten.addProperty("ADBE Vector Group").name =
18171:             "Eighth subdivisions - Secondary Color";
18172:           shorten.addProperty("ADBE Vector Group").name = "Eighth subdivisions";
18173:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
18174:             "ADBE Vector Group",
18175:           ).name = "Stripes";
18176:           shorten("Eighth subdivisions")("ADBE Vectors Group")("Stripes")(
18177:             "ADBE Vectors Group",
18178:           ).addProperty("ADBE Vector Shape - Rect")(
18179:             "ADBE Vector Rect Size",
18180:           ).expression =
18181:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18182:           shorten("Eighth subdivisions")("ADBE Vectors Group")("Stripes")(
18183:             "ADBE Vectors Group",
18184:           )("ADBE Vector Shape - Rect")(
18185:             "ADBE Vector Rect Position",
18186:           ).expression =
18187:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
18188:           shorten("Eighth subdivisions")("ADBE Vectors Group")("Stripes")(
18189:             "ADBE Vectors Group",
18190:           )
18191:             .addProperty("ADBE Vector Filter - Repeater")(
18192:               "ADBE Vector Repeater Copies",
18193:             )
18194:             .setValue(
18195:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18196:                 1,
18197:             );
18198:           shorten("Eighth subdivisions")("ADBE Vectors Group")("Stripes")(
18199:             "ADBE Vectors Group",
18200:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18201:             "ADBE Vector Repeater Position",
18202:           ).expression =
18203:             'try { [effect("ADBE easyRulers")("Gap")*' +
18204:             divideBy / 8 +
18205:             ", value[1]] } catch(e) { value }";
18206:           shorten("Eighth subdivisions")("ADBE Vectors Group")
18207:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18208:             .setValue(2);
18209:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
18210:             "ADBE Vector Group",
18211:           ).name = "Stripes Mask Quarter";
18212:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
18213:             "Stripes Mask Quarter",
18214:           )("ADBE Vectors Group").addProperty("ADBE Vector Shape - Rect")(
18215:             "ADBE Vector Rect Size",
18216:           ).expression =
18217:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
18218:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
18219:             "Stripes Mask Quarter",
18220:           )("ADBE Vectors Group")("ADBE Vector Shape - Rect")(
18221:             "ADBE Vector Rect Position",
18222:           ).expression =
18223:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18224:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
18225:             "Stripes Mask Quarter",
18226:           )("ADBE Vectors Group")
18227:             .addProperty("ADBE Vector Filter - Repeater")(
18228:               "ADBE Vector Repeater Copies",
18229:             )
18230:             .setValue(
18231:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18232:                 1,
18233:             );
18234:           shorten("Eighth subdivisions")("ADBE Vectors Group")(
18235:             "Stripes Mask Quarter",
18236:           )("ADBE Vectors Group")("ADBE Vector Filter - Repeater")(
18237:             "ADBE Vector Repeater Transform",
18238:           )("ADBE Vector Repeater Position").expression =
18239:             'try { [effect("ADBE easyRulers")("Gap")*' +
18240:             divideBy / 4 +
18241:             ", value[1]] } catch(e) { value }";
18242:           shorten("Eighth subdivisions")("ADBE Vectors Group")
18243:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18244:             .setValue(3);
18245:           shorten("Eighth subdivisions")("ADBE Vectors Group").addProperty(
18246:             "ADBE Vector Graphic - Fill",
18247:           )("ADBE Vector Fill Color").expression =
18248:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
18249:           shorten("Eighth subdivisions")("ADBE Vector Transform Group")(
18250:             "ADBE Vector Group Opacity",
18251:           ).expression =
18252:             'if (content(1).content("Eighth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Eighth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
18253:           shorten.addProperty("ADBE Vector Group").name =
18254:             "Eighth subdivisions Base Line";
18255:           shorten("Eighth subdivisions Base Line")(
18256:             "ADBE Vectors Group",
18257:           ).addProperty("ADBE Vector Shape - Rect")(
18258:             "ADBE Vector Rect Size",
18259:           ).expression =
18260:             'try { [(Math.abs(effect("ADBE easyRulers")("Gap"))*' +
18261:             (EditTextCopies.text - 1) +
18262:             ')+effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Width")/2] } catch(e) { value }';
18263:           shorten("Eighth subdivisions Base Line")(
18264:             "ADBE Vector Transform Group",
18265:           )("ADBE Vector Position").setValue([0, 45]);
18266:           shorten("Eighth subdivisions Base Line")(
18267:             "ADBE Vectors Group",
18268:           ).addProperty("ADBE Vector Graphic - Fill")(
18269:             "ADBE Vector Fill Color",
18270:           ).expression =
18271:             'try { effect("ADBE easyRulers")("Eighth Subdivisions") } catch(e) { value }';
18272:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
18273:             "ADBE Vector Shape - Rect",
18274:           )("ADBE Vector Rect Position").setValue([
18275:             (EditTextGap.text * EditTextCopies.text) / 2,
18276:             -15,
18277:           ]);
18278:           shorten("Eighth subdivisions Base Line")("ADBE Vectors Group")(
18279:             "ADBE Vector Shape - Rect",
18280:           )("ADBE Vector Rect Position").expression =
18281:             'try { if ((effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")*2)>0) {                    if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")>0) {                        [(effect("ADBE easyRulers")("Gap")*' +
18282:             (EditTextCopies.text - 1) +
18283:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                    } else {                         if (effect("ADBE easyRulers")("Height")<=0 && effect("ADBE easyRulers")("Height Bias")>0) {                             [(effect("ADBE easyRulers")("Gap")*' +
18284:             (EditTextCopies.text - 1) +
18285:             ')/2, -15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")*2]                         } else {                             if (effect("ADBE easyRulers")("Height")>0 && effect("ADBE easyRulers")("Height Bias")<=0) {                                 [(effect("ADBE easyRulers")("Gap")*' +
18286:             (EditTextCopies.text - 1) +
18287:             ')/2,-15 -effect("ADBE easyRulers")("Height")/2-effect("ADBE easyRulers")("Height Bias")/4]                             } else { [(effect("ADBE easyRulers")("Gap")*' +
18288:             (EditTextCopies.text - 1) +
18289:             ')/2,-15]                         }}}              } else { [(effect("ADBE easyRulers")("Gap")*' +
18290:             (EditTextCopies.text - 1) +
18291:             ')/2, -15 +effect("ADBE easyRulers")("Height")/2] } } catch(e) { value }';
18292:           shorten.addProperty("ADBE Vector Group").name =
18293:             "Main lines - Secondary Color";
18294:           shorten.addProperty("ADBE Vector Group").name = "Main lines";
18295:           shorten("Main lines")("ADBE Vectors Group").addProperty(
18296:             "ADBE Vector Group",
18297:           ).name = "Stripes";
18298:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
18299:             "ADBE Vectors Group",
18300:           ).addProperty("ADBE Vector Shape - Rect")(
18301:             "ADBE Vector Rect Size",
18302:           ).expression =
18303:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
18304:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
18305:             "ADBE Vectors Group",
18306:           )("ADBE Vector Shape - Rect")(
18307:             "ADBE Vector Rect Position",
18308:           ).expression =
18309:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/8] } catch(e) { value }';
18310:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
18311:             "ADBE Vectors Group",
18312:           )
18313:             .addProperty("ADBE Vector Filter - Repeater")(
18314:               "ADBE Vector Repeater Copies",
18315:             )
18316:             .setValue(EditTextCopies.text);
18317:           shorten("Main lines")("ADBE Vectors Group")("Stripes")(
18318:             "ADBE Vectors Group",
18319:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18320:             "ADBE Vector Repeater Position",
18321:           ).expression =
18322:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
18323:           shorten("Main lines")("ADBE Vectors Group")
18324:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18325:             .setValue(2);
18326:           shorten("Main lines")("ADBE Vectors Group").addProperty(
18327:             "ADBE Vector Group",
18328:           ).name = "Stripes Mask Eighth";
18329:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Eighth")(
18330:             "ADBE Vectors Group",
18331:           ).addProperty("ADBE Vector Shape - Rect")(
18332:             "ADBE Vector Rect Size",
18333:           ).expression =
18334:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height")+effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18335:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Eighth")(
18336:             "ADBE Vectors Group",
18337:           )("ADBE Vector Shape - Rect")(
18338:             "ADBE Vector Rect Position",
18339:           ).expression =
18340:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
18341:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Eighth")(
18342:             "ADBE Vectors Group",
18343:           )
18344:             .addProperty("ADBE Vector Filter - Repeater")(
18345:               "ADBE Vector Repeater Copies",
18346:             )
18347:             .setValue(
18348:               Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18349:                 1,
18350:             );
18351:           shorten("Main lines")("ADBE Vectors Group")("Stripes Mask Eighth")(
18352:             "ADBE Vectors Group",
18353:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18354:             "ADBE Vector Repeater Position",
18355:           ).expression =
18356:             'try { [effect("ADBE easyRulers")("Gap")*' +
18357:             divideBy / 8 +
18358:             ", value[1]] } catch(e) { value }";
18359:           shorten("Main lines")("ADBE Vectors Group")
18360:             .addProperty("ADBE Vector Filter - Merge")("ADBE Vector Merge Type")
18361:             .setValue(3);
18362:           shorten("Main lines")("ADBE Vectors Group").addProperty(
18363:             "ADBE Vector Graphic - Fill",
18364:           )("ADBE Vector Fill Color").expression =
18365:             'try { effect("ADBE easyRulers")("Main Divisions") } catch(e) { value }';
18366:           shorten("Main lines")("ADBE Vector Transform Group")(
18367:             "ADBE Vector Group Opacity",
18368:           ).expression =
18369:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { 0 } else { 100 }';
18370:           t("ADBE easyRulers")("Width").setValue(4);
18371:           t("ADBE easyRulers")("default Width").setValue(4);
18372:           t("ADBE easyRulers")("Height").setValue(15);
18373:           t("ADBE easyRulers")("default Height").setValue(15);
18374:           t("ADBE easyRulers")("Height Bias").setValue(12);
18375:           t("ADBE easyRulers")("default Height Bias").setValue(12);
18376:           if (SidesType.selection.index == 2) {
18377:             t("ADBE easyRulers")("Sides Distance").setValue(-120);
18378:             t("ADBE easyRulers")("default Sides Distance").setValue(-120);
18379:           }
18380:           t("ADBE easyRulers")("ADBE easyRulers-0049").setValue(70);
18381:           t("ADBE easyRulers")("default Pointer Distance").setValue(70);
18382:           createPointerLinear();
18383:           shorten("Main lines - Secondary Color")(
18384:             "ADBE Vectors Group",
18385:           ).addProperty("ADBE Vector Shape - Rect")(
18386:             "ADBE Vector Rect Size",
18387:           ).expression =
18388:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
18389:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18390:             "ADBE Vector Shape - Rect",
18391:           )("ADBE Vector Rect Position").expression =
18392:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/8] } catch(e) { value }';
18393:           shorten("Main lines - Secondary Color")(
18394:             "ADBE Vectors Group",
18395:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
18396:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18397:             "ADBE Vector Graphic - Fill",
18398:           )("ADBE Vector Fill Color").expression =
18399:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
18400:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18401:             "ADBE Vector Graphic - Fill",
18402:           )("ADBE Vector Fill Opacity").expression =
18403:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
18404:           shorten("Main lines - Secondary Color")(
18405:             "ADBE Vectors Group",
18406:           ).addProperty("ADBE Vector Filter - Repeater")(
18407:             "ADBE Vector Repeater Copies",
18408:           ).expression =
18409:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
18410:             EditTextCopies.text +
18411:             '-content("Ruler").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
18412:             EditTextCopies.text +
18413:             '-content("Ruler Mirror").content("Main lines - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
18414:             (Number(EditTextCopies.text) - 1) +
18415:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100)) }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
18416:             EditTextCopies.text +
18417:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
18418:             (Number(EditTextCopies.text) - 1) +
18419:             ' * (effect("ADBE easyRulers")("Completion")/100)) } else { 0 }               }} catch(e) { value }';
18420:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18421:             "ADBE Vector Filter - Repeater",
18422:           )("ADBE Vector Repeater Transform")(
18423:             "ADBE Vector Repeater Opacity 1",
18424:           ).expression =
18425:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18426:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18427:             "ADBE Vector Filter - Repeater",
18428:           )("ADBE Vector Repeater Transform")(
18429:             "ADBE Vector Repeater Opacity 2",
18430:           ).expression =
18431:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18432:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18433:             "ADBE Vector Filter - Repeater",
18434:           )("ADBE Vector Repeater Transform")(
18435:             "ADBE Vector Repeater Position",
18436:           ).expression =
18437:             'try { [effect("ADBE easyRulers")("Gap"), value[1]] } catch(e) { value }';
18438:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18439:             "ADBE Vector Filter - Repeater",
18440:           )("ADBE Vector Repeater Offset").expression =
18441:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
18442:             EditTextCopies.text +
18443:             ' } else                if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
18444:             (Number(EditTextCopies.text) - 1) +
18445:             ' * (effect("ADBE easyRulers")("Offset %")/100)) } else { 0 }              }} catch(e) { value }';
18446:           shorten("Main lines - Secondary Color")(
18447:             "ADBE Vectors Group",
18448:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
18449:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18450:             "Fill End",
18451:           )("ADBE Vector Fill Color").expression =
18452:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
18453:           shorten("Main lines - Secondary Color")("ADBE Vectors Group")(
18454:             "Fill End",
18455:           )("ADBE Vector Fill Opacity").expression =
18456:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0034").value?100:0; } catch(e) { value }';
18457:           shorten("Main lines - Secondary Color")(
18458:             "ADBE Vector Transform Group",
18459:           )("ADBE Vector Group Opacity").expression =
18460:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
18461:           shorten("Main lines - Secondary Color")(
18462:             "ADBE Vector Transform Group",
18463:           )("ADBE Vector Scale").expression =
18464:             'if (content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Main lines").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
18465:           secondary_lines = app.project.activeItem
18466:             .layer(
18467:               shapeLayer.name,
18468:             )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions")
18469:             .duplicate();
18470:           secondary_lines.name = "Big subdivisions - Secondary Color";
18471:           secondary_lines("ADBE Vectors Group")(
18472:             "ADBE Vector Filter - Repeater",
18473:           )("ADBE Vector Repeater Copies").expression =
18474:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
18475:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
18476:             1 +
18477:             '-content("Ruler").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
18478:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
18479:             1 +
18480:             '-content("Ruler Mirror").content("Big subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
18481:             (Number(EditTextCopies.text) - 1) +
18482:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
18483:             divideBy +
18484:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
18485:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
18486:             1 +
18487:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
18488:             (Number(EditTextCopies.text) - 1) +
18489:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
18490:             divideBy +
18491:             ") } else { 0 }               }} catch(e) { value }";
18492:           secondary_lines("ADBE Vectors Group")("ADBE Vector Graphic - Fill")(
18493:             "ADBE Vector Fill Opacity",
18494:           ).expression =
18495:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
18496:           secondary_lines("ADBE Vectors Group")(
18497:             "ADBE Vector Graphic - Fill",
18498:           ).name = "Fill Start";
18499:           secondary_lines("ADBE Vectors Group")("Fill Start")(
18500:             "ADBE Vector Fill Color",
18501:           ).expression =
18502:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
18503:           secondary_lines("ADBE Vectors Group")(
18504:             "ADBE Vector Filter - Repeater",
18505:           )("ADBE Vector Repeater Offset").expression =
18506:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
18507:             Math.floor((Number(EditTextCopies.text) - 1) / divideBy) +
18508:             1 +
18509:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
18510:             (Number(EditTextCopies.text) - 1) +
18511:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
18512:             divideBy +
18513:             ")} else { 0 }              }} catch(e) { value }";
18514:           secondary_lines("ADBE Vectors Group")(
18515:             "ADBE Vector Filter - Repeater",
18516:           )("ADBE Vector Repeater Transform")(
18517:             "ADBE Vector Repeater Opacity 1",
18518:           ).expression =
18519:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18520:           secondary_lines("ADBE Vectors Group")(
18521:             "ADBE Vector Filter - Repeater",
18522:           )("ADBE Vector Repeater Transform")(
18523:             "ADBE Vector Repeater Opacity 2",
18524:           ).expression =
18525:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18526:           secondary_lines("ADBE Vectors Group").addProperty(
18527:             "ADBE Vector Graphic - Fill",
18528:           ).name = "Fill End";
18529:           secondary_lines("ADBE Vectors Group")("Fill End")(
18530:             "ADBE Vector Fill Color",
18531:           ).expression =
18532:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
18533:           secondary_lines("ADBE Vectors Group")("Fill End")(
18534:             "ADBE Vector Fill Opacity",
18535:           ).expression =
18536:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0035").value?100:0; } catch(e) { value }';
18537:           secondary_lines("ADBE Vector Transform Group")(
18538:             "ADBE Vector Group Opacity",
18539:           ).expression =
18540:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
18541:           secondary_lines("ADBE Vector Transform Group")(
18542:             "ADBE Vector Scale",
18543:           ).expression =
18544:             'if (content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Big subdivisions").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
18545:           shorten("Half subdivisions - Secondary Color")(
18546:             "ADBE Vectors Group",
18547:           ).addProperty("ADBE Vector Shape - Rect")(
18548:             "ADBE Vector Rect Size",
18549:           ).expression =
18550:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")*2] } catch(e) { value }';
18551:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18552:             "ADBE Vector Shape - Rect",
18553:           )("ADBE Vector Rect Position").expression =
18554:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
18555:           shorten("Half subdivisions - Secondary Color")(
18556:             "ADBE Vectors Group",
18557:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
18558:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18559:             "ADBE Vector Graphic - Fill",
18560:           )("ADBE Vector Fill Color").expression =
18561:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
18562:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18563:             "ADBE Vector Graphic - Fill",
18564:           )("ADBE Vector Fill Opacity").expression =
18565:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
18566:           shorten("Half subdivisions - Secondary Color")(
18567:             "ADBE Vectors Group",
18568:           ).addProperty("ADBE Vector Filter - Repeater")(
18569:             "ADBE Vector Repeater Copies",
18570:           ).expression =
18571:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                  if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
18572:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
18573:             1 +
18574:             '-content("Ruler").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
18575:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
18576:             1 +
18577:             '-content("Ruler Mirror").content("Half subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                  } else { Math.ceil(' +
18578:             (Number(EditTextCopies.text) - 1) +
18579:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
18580:             divideBy / 2 +
18581:             ') }               } else {                    if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
18582:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
18583:             1 +
18584:             ' } else                    if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
18585:             (Number(EditTextCopies.text) - 1) +
18586:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
18587:             divideBy / 2 +
18588:             ") } else { 0 }              }} catch(e) { value }";
18589:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18590:             "ADBE Vector Filter - Repeater",
18591:           )("ADBE Vector Repeater Transform")(
18592:             "ADBE Vector Repeater Opacity 1",
18593:           ).expression =
18594:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18595:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18596:             "ADBE Vector Filter - Repeater",
18597:           )("ADBE Vector Repeater Transform")(
18598:             "ADBE Vector Repeater Opacity 2",
18599:           ).expression =
18600:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18601:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18602:             "ADBE Vector Filter - Repeater",
18603:           )("ADBE Vector Repeater Transform")(
18604:             "ADBE Vector Repeater Position",
18605:           ).expression =
18606:             'try { [effect("ADBE easyRulers")("Gap")*' +
18607:             divideBy / 2 +
18608:             ", value[1]] } catch(e) { value }";
18609:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18610:             "ADBE Vector Filter - Repeater",
18611:           )("ADBE Vector Repeater Offset").expression =
18612:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                   if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
18613:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 2) +
18614:             1 +
18615:             ' } else                   if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
18616:             (Number(EditTextCopies.text) - 1) +
18617:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
18618:             divideBy / 2 +
18619:             ")} else { 0 }              }} catch(e) { value }";
18620:           shorten("Half subdivisions - Secondary Color")(
18621:             "ADBE Vectors Group",
18622:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
18623:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18624:             "Fill End",
18625:           )("ADBE Vector Fill Color").expression =
18626:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
18627:           shorten("Half subdivisions - Secondary Color")("ADBE Vectors Group")(
18628:             "Fill End",
18629:           )("ADBE Vector Fill Opacity").expression =
18630:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0036").value?100:0; } catch(e) { value }';
18631:           shorten("Half subdivisions - Secondary Color")(
18632:             "ADBE Vector Transform Group",
18633:           )("ADBE Vector Group Opacity").expression =
18634:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
18635:           shorten("Half subdivisions - Secondary Color")(
18636:             "ADBE Vector Transform Group",
18637:           )("ADBE Vector Scale").expression =
18638:             'if (content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Half subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
18639:           shorten("Quarter subdivisions - Secondary Color")(
18640:             "ADBE Vectors Group",
18641:           ).addProperty("ADBE Vector Shape - Rect")(
18642:             "ADBE Vector Rect Size",
18643:           ).expression =
18644:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")] } catch(e) { value }';
18645:           shorten("Quarter subdivisions - Secondary Color")(
18646:             "ADBE Vectors Group",
18647:           )("ADBE Vector Shape - Rect")(
18648:             "ADBE Vector Rect Position",
18649:           ).expression =
18650:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18651:           shorten("Quarter subdivisions - Secondary Color")(
18652:             "ADBE Vectors Group",
18653:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
18654:           shorten("Quarter subdivisions - Secondary Color")(
18655:             "ADBE Vectors Group",
18656:           )("ADBE Vector Graphic - Fill")("ADBE Vector Fill Color").expression =
18657:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
18658:           shorten("Quarter subdivisions - Secondary Color")(
18659:             "ADBE Vectors Group",
18660:           )("ADBE Vector Graphic - Fill")(
18661:             "ADBE Vector Fill Opacity",
18662:           ).expression =
18663:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
18664:           shorten("Quarter subdivisions - Secondary Color")(
18665:             "ADBE Vectors Group",
18666:           ).addProperty("ADBE Vector Filter - Repeater")(
18667:             "ADBE Vector Repeater Copies",
18668:           ).expression =
18669:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                   if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
18670:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18671:             1 +
18672:             '-content("Ruler").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
18673:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18674:             1 +
18675:             '-content("Ruler Mirror").content("Quarter subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                   } else { Math.ceil(' +
18676:             (Number(EditTextCopies.text) - 1) +
18677:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
18678:             divideBy / 4 +
18679:             ') }                } else {                     if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
18680:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18681:             1 +
18682:             ' } else                     if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
18683:             (Number(EditTextCopies.text) - 1) +
18684:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
18685:             divideBy / 4 +
18686:             ") } else { 0 }               }} catch(e) { value }";
18687:           shorten("Quarter subdivisions - Secondary Color")(
18688:             "ADBE Vectors Group",
18689:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18690:             "ADBE Vector Repeater Opacity 1",
18691:           ).expression =
18692:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18693:           shorten("Quarter subdivisions - Secondary Color")(
18694:             "ADBE Vectors Group",
18695:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18696:             "ADBE Vector Repeater Opacity 2",
18697:           ).expression =
18698:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18699:           shorten("Quarter subdivisions - Secondary Color")(
18700:             "ADBE Vectors Group",
18701:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18702:             "ADBE Vector Repeater Position",
18703:           ).expression =
18704:             'try { [effect("ADBE easyRulers")("Gap")*' +
18705:             divideBy / 4 +
18706:             ", value[1]] } catch(e) { value }";
18707:           shorten("Quarter subdivisions - Secondary Color")(
18708:             "ADBE Vectors Group",
18709:           )("ADBE Vector Filter - Repeater")(
18710:             "ADBE Vector Repeater Offset",
18711:           ).expression =
18712:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                   if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
18713:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 4) +
18714:             1 +
18715:             ' } else                   if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
18716:             (Number(EditTextCopies.text) - 1) +
18717:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
18718:             divideBy / 4 +
18719:             ")} else { 0 }              }} catch(e) { value }";
18720:           shorten("Quarter subdivisions - Secondary Color")(
18721:             "ADBE Vectors Group",
18722:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
18723:           shorten("Quarter subdivisions - Secondary Color")(
18724:             "ADBE Vectors Group",
18725:           )("Fill End")("ADBE Vector Fill Color").expression =
18726:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
18727:           shorten("Quarter subdivisions - Secondary Color")(
18728:             "ADBE Vectors Group",
18729:           )("Fill End")("ADBE Vector Fill Opacity").expression =
18730:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0037").value?100:0; } catch(e) { value }';
18731:           shorten("Quarter subdivisions - Secondary Color")(
18732:             "ADBE Vector Transform Group",
18733:           )("ADBE Vector Group Opacity").expression =
18734:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
18735:           shorten("Quarter subdivisions - Secondary Color")(
18736:             "ADBE Vector Transform Group",
18737:           )("ADBE Vector Scale").expression =
18738:             'if (content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Quarter subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
18739:           shorten("Eighth subdivisions - Secondary Color")(
18740:             "ADBE Vectors Group",
18741:           ).addProperty("ADBE Vector Shape - Rect")(
18742:             "ADBE Vector Rect Size",
18743:           ).expression =
18744:             'try { [effect("ADBE easyRulers")("Width"), effect("ADBE easyRulers")("Height") + effect("ADBE easyRulers")("Height Bias")/2] } catch(e) { value }';
18745:           shorten("Eighth subdivisions - Secondary Color")(
18746:             "ADBE Vectors Group",
18747:           )("ADBE Vector Shape - Rect")(
18748:             "ADBE Vector Rect Position",
18749:           ).expression =
18750:             'try { [0, 30 - effect("ADBE easyRulers")("Height Bias")/4] } catch(e) { value }';
18751:           shorten("Eighth subdivisions - Secondary Color")(
18752:             "ADBE Vectors Group",
18753:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill Start";
18754:           shorten("Eighth subdivisions - Secondary Color")(
18755:             "ADBE Vectors Group",
18756:           )("ADBE Vector Graphic - Fill")("ADBE Vector Fill Color").expression =
18757:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0031") } catch(e) { value }';
18758:           shorten("Eighth subdivisions - Secondary Color")(
18759:             "ADBE Vectors Group",
18760:           )("ADBE Vector Graphic - Fill")(
18761:             "ADBE Vector Fill Opacity",
18762:           ).expression =
18763:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
18764:           shorten("Eighth subdivisions - Secondary Color")(
18765:             "ADBE Vectors Group",
18766:           ).addProperty("ADBE Vector Filter - Repeater")(
18767:             "ADBE Vector Repeater Copies",
18768:           ).expression =
18769:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == false) {                 if (effect("ADBE easyRulers")("Offset %") >= 0) { try {Math.round(' +
18770:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18771:             1 +
18772:             '-content("Ruler").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); } catch(e) { Math.round(' +
18773:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18774:             1 +
18775:             '-content("Ruler Mirror").content("Eighth subdivisions - Secondary Color")("ADBE Vectors Group")("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Offset")); }                 } else { Math.ceil(' +
18776:             (Number(EditTextCopies.text) - 1) +
18777:             ' * ((100 + effect("ADBE easyRulers")("Offset %"))/100) /' +
18778:             divideBy / 8 +
18779:             ') }              } else {                  if (effect("ADBE easyRulers")("Completion") >= 100) { ' +
18780:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18781:             1 +
18782:             ' } else                  if (effect("ADBE easyRulers")("Completion") > 0) { Math.ceil(' +
18783:             (Number(EditTextCopies.text) - 1) +
18784:             ' * (effect("ADBE easyRulers")("Completion")/100) / ' +
18785:             divideBy / 8 +
18786:             ") } else { 0 }              }} catch(e) { value }";
18787:           shorten("Eighth subdivisions - Secondary Color")(
18788:             "ADBE Vectors Group",
18789:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18790:             "ADBE Vector Repeater Opacity 1",
18791:           ).expression =
18792:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100 } else { 100-effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18793:           shorten("Eighth subdivisions - Secondary Color")(
18794:             "ADBE Vectors Group",
18795:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18796:             "ADBE Vector Repeater Opacity 2",
18797:           ).expression =
18798:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %") == true) { 100-effect("ADBE easyRulers")("ADBE easyRulers-0045") } else { -effect("ADBE easyRulers")("ADBE easyRulers-0032") } } catch(e) { value }';
18799:           shorten("Eighth subdivisions - Secondary Color")(
18800:             "ADBE Vectors Group",
18801:           )("ADBE Vector Filter - Repeater")("ADBE Vector Repeater Transform")(
18802:             "ADBE Vector Repeater Position",
18803:           ).expression =
18804:             'try { [effect("ADBE easyRulers")("Gap")*' +
18805:             divideBy / 8 +
18806:             ", value[1]] } catch(e) { value }";
18807:           shorten("Eighth subdivisions - Secondary Color")(
18808:             "ADBE Vectors Group",
18809:           )("ADBE Vector Filter - Repeater")(
18810:             "ADBE Vector Repeater Offset",
18811:           ).expression =
18812:             'try { if (effect("ADBE easyRulers")("Link to Pointer Completion %").value) { 0 } else {                  if (effect("ADBE easyRulers")("Offset %") >= 100) {' +
18813:             Math.floor(((Number(EditTextCopies.text) - 1) / divideBy) * 8) +
18814:             1 +
18815:             ' } else                  if (effect("ADBE easyRulers")("Offset %") > 0) { Math.ceil(' +
18816:             (Number(EditTextCopies.text) - 1) +
18817:             ' * (effect("ADBE easyRulers")("Offset %")/100) / ' +
18818:             divideBy / 8 +
18819:             ")} else { 0 }              }} catch(e) { value }";
18820:           shorten("Eighth subdivisions - Secondary Color")(
18821:             "ADBE Vectors Group",
18822:           ).addProperty("ADBE Vector Graphic - Fill").name = "Fill End";
18823:           shorten("Eighth subdivisions - Secondary Color")(
18824:             "ADBE Vectors Group",
18825:           )("Fill End")("ADBE Vector Fill Color").expression =
18826:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0079") } catch(e) { value }';
18827:           shorten("Eighth subdivisions - Secondary Color")(
18828:             "ADBE Vectors Group",
18829:           )("Fill End")("ADBE Vector Fill Opacity").expression =
18830:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0039").value?100:0; } catch(e) { value }';
18831:           shorten("Eighth subdivisions - Secondary Color")(
18832:             "ADBE Vector Transform Group",
18833:           )("ADBE Vector Group Opacity").expression =
18834:             'try { effect("ADBE easyRulers")("ADBE easyRulers-0030").value?100:0; } catch(e) { value }';
18835:           shorten("Eighth subdivisions - Secondary Color")(
18836:             "ADBE Vector Transform Group",
18837:           )("ADBE Vector Scale").expression =
18838:             'if (content(1).content("Eighth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[0] == 0 || content(1).content("Eighth subdivisions").content("Stripes").content("ADBE Vector Shape - Rect").size[1] == 0) { [0,0] } else { [100,100] }';
18839:           app.project.activeItem
18840:             .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
18841:             .duplicate().name = "Ruler Mirror";
18842:           app.project.activeItem
18843:             .layer(
18844:               shapeLayer.name,
18845:             )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vector Transform Group")("ADBE Vector Scale")
18846:             .setValue([100, -100]);
18847:           switch (BaseLineDropdown.selection.index) {
18848:             case 0:
18849:               app.project.activeItem
18850:                 .layer(
18851:                   shapeLayer.name,
18852:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Base Line")
18853:                 .remove();
18854:               app.project.activeItem
18855:                 .layer(
18856:                   shapeLayer.name,
18857:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Base Line")
18858:                 .remove();
18859:               app.project.activeItem
18860:                 .layer(
18861:                   shapeLayer.name,
18862:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
18863:                 .remove();
18864:               app.project.activeItem
18865:                 .layer(
18866:                   shapeLayer.name,
18867:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
18868:                 .remove();
18869:               app.project.activeItem
18870:                 .layer(
18871:                   shapeLayer.name,
18872:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
18873:                 .remove();
18874:               app.project.activeItem
18875:                 .layer(
18876:                   shapeLayer.name,
18877:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
18878:                 .remove();
18879:               app.project.activeItem
18880:                 .layer(
18881:                   shapeLayer.name,
18882:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
18883:                 .remove();
18884:               app.project.activeItem
18885:                 .layer(
18886:                   shapeLayer.name,
18887:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
18888:                 .remove();
18889:               app.project.activeItem
18890:                 .layer(
18891:                   shapeLayer.name,
18892:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
18893:                 .remove();
18894:               app.project.activeItem
18895:                 .layer(
18896:                   shapeLayer.name,
18897:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
18898:                 .remove();
18899:               break;
18900:             case 1:
18901:               app.project.activeItem
18902:                 .layer(
18903:                   shapeLayer.name,
18904:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Big subdivisions Base Line")
18905:                 .remove();
18906:               app.project.activeItem
18907:                 .layer(
18908:                   shapeLayer.name,
18909:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Big subdivisions Base Line")
18910:                 .remove();
18911:               app.project.activeItem
18912:                 .layer(
18913:                   shapeLayer.name,
18914:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Half subdivisions Base Line")
18915:                 .remove();
18916:               app.project.activeItem
18917:                 .layer(
18918:                   shapeLayer.name,
18919:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Half subdivisions Base Line")
18920:                 .remove();
18921:               app.project.activeItem
18922:                 .layer(
18923:                   shapeLayer.name,
18924:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Quarter subdivisions Base Line")
18925:                 .remove();
18926:               app.project.activeItem
18927:                 .layer(
18928:                   shapeLayer.name,
18929:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Quarter subdivisions Base Line")
18930:                 .remove();
18931:               app.project.activeItem
18932:                 .layer(
18933:                   shapeLayer.name,
18934:                 )("ADBE Root Vectors Group")("Ruler")("ADBE Vectors Group")("Eighth subdivisions Base Line")
18935:                 .remove();
18936:               app.project.activeItem
18937:                 .layer(
18938:                   shapeLayer.name,
18939:                 )("ADBE Root Vectors Group")("Ruler Mirror")("ADBE Vectors Group")("Eighth subdivisions Base Line")
18940:                 .remove();
18941:           }
18942:         };
18943:         if (LinesTypeDropdown.selection.index == 0) {
18944:           if (rulerLine.value) {
18945:             switch (easyRulers_params.typeOfDivisions) {
18946:               case 0:
18947:                 createBasicNoDivs();
18948:                 break;
18949:               case 1:
18950:               case 2:
18951:               case 3:
18952:               case 6:
18953:                 createBasic();
18954:                 break;
18955:               case 4:
18956:                 createBasic10();
18957:                 break;
18958:               case 5:
18959:                 createBasic10b();
18960:                 break;
18961:               case 7:
18962:                 createBasic16();
18963:                 break;
18964:               case 8:
18965:                 createBasic16b();
18966:             }
18967:             switch (SidesType.selection.index) {
18968:               case 0:
18969:                 app.project.activeItem
18970:                   .layer(
18971:                     shapeLayer.name,
18972:                   )("ADBE Root Vectors Group")("Ruler Mirror")
18973:                   .remove();
18974:                 break;
18975:               case 1:
18976:                 app.project.activeItem
18977:                   .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
18978:                   .remove();
18979:                 app.project.activeItem.layer(shapeLayer.name)(
18980:                   "ADBE Root Vectors Group",
18981:                 )("Ruler Mirror")("ADBE Vector Transform Group")(
18982:                   "ADBE Vector Position",
18983:                 ).expression = "[0,-120]";
18984:                 break;
18985:               case 2:
18986:                 app.project.activeItem.layer(shapeLayer.name)(
18987:                   "ADBE Root Vectors Group",
18988:                 )("Ruler Mirror")("ADBE Vector Transform Group")(
18989:                   "ADBE Vector Position",
18990:                 ).expression =
18991:                   'try { [value[0], value[1] + effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }';
18992:             }
18993:           } else {
18994:             switch (easyRulers_params.typeOfDivisions) {
18995:               case 0:
18996:                 createBasicNoDivs_circle();
18997:                 break;
18998:               case 1:
18999:               case 2:
19000:               case 3:
19001:               case 6:
19002:                 createBasic_circle();
19003:                 break;
19004:               case 4:
19005:                 createBasic10_circle();
19006:                 break;
19007:               case 5:
19008:                 createBasic10b_circle();
19009:                 break;
19010:               case 7:
19011:                 createBasic16_circle();
19012:                 break;
19013:               case 8:
19014:                 createBasic16b_circle();
19015:             }
19016:           }
19017:         } else {
19018:           if (rulerLine.value) {
19019:             switch (easyRulers_params.typeOfDivisions) {
19020:               case 0:
19021:                 createBasicNoDivs_DotLines();
19022:                 break;
19023:               case 1:
19024:               case 2:
19025:               case 3:
19026:               case 6:
19027:                 createBasic_DotLines();
19028:                 break;
19029:               case 4:
19030:                 createBasic10_DotLines();
19031:                 break;
19032:               case 5:
19033:                 createBasic10b_DotLines();
19034:                 break;
19035:               case 7:
19036:                 createBasic16_DotLines();
19037:                 break;
19038:               case 8:
19039:                 createBasic16b_DotLines();
19040:             }
19041:             switch (SidesType.selection.index) {
19042:               case 0:
19043:                 app.project.activeItem
19044:                   .layer(
19045:                     shapeLayer.name,
19046:                   )("ADBE Root Vectors Group")("Ruler Mirror")
19047:                   .remove();
19048:                 break;
19049:               case 1:
19050:                 app.project.activeItem
19051:                   .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
19052:                   .remove();
19053:                 app.project.activeItem.layer(shapeLayer.name)(
19054:                   "ADBE Root Vectors Group",
19055:                 )("Ruler Mirror")("ADBE Vector Transform Group")(
19056:                   "ADBE Vector Position",
19057:                 ).expression = "[0,-120]";
19058:                 break;
19059:               case 2:
19060:                 app.project.activeItem.layer(shapeLayer.name)(
19061:                   "ADBE Root Vectors Group",
19062:                 )("Ruler Mirror")("ADBE Vector Transform Group")(
19063:                   "ADBE Vector Position",
19064:                 ).expression =
19065:                   'try { [value[0], value[1] + effect("ADBE easyRulers")("Sides Distance")] } catch(e) { value }';
19066:             }
19067:           } else {
19068:             switch (easyRulers_params.typeOfDivisions) {
19069:               case 0:
19070:                 createBasicNoDivs_circle_DotLines();
19071:                 break;
19072:               case 1:
19073:               case 2:
19074:               case 3:
19075:               case 6:
19076:                 createBasic_circle_DotLines();
19077:                 break;
19078:               case 4:
19079:                 createBasic10_circle_DotLines();
19080:                 break;
19081:               case 5:
19082:                 createBasic10b_circle_DotLines();
19083:                 break;
19084:               case 7:
19085:                 createBasic16_circle_DotLines();
19086:                 break;
19087:               case 8:
19088:                 createBasic16b_circle_DotLines();
19089:             }
19090:             switch (SidesType.selection.index) {
19091:               case 0:
19092:                 app.project.activeItem
19093:                   .layer(
19094:                     shapeLayer.name,
19095:                   )("ADBE Root Vectors Group")("Ruler Mirror")
19096:                   .remove();
19097:                 break;
19098:               case 1:
19099:                 app.project.activeItem
19100:                   .layer(shapeLayer.name)("ADBE Root Vectors Group")("Ruler")
19101:                   .remove();
19102:                 app.project.activeItem.layer(shapeLayer.name)(
19103:                   "ADBE Root Vectors Group",
19104:                 )("Ruler Mirror")("ADBE Vectors Group")("pointer").enabled =
19105:                   true;
19106:             }
19107:           }
19108:         }
19109:       }
19110:     }
19111:     var isTrial = FF092D.t();
19112:     var mainPalette =
19113:       thisObj instanceof Panel
19114:         ? thisObj
19115:         : new Window(
19116:             "palette",
19117:             FF092D.t() ? "easyRulers 2 - Trial" : "easyRulers 2",
19118:             undefined,
19119:             { resizeable: true },
19120:           );
19121:     if (mainPalette == null) {
19122:       return;
19123:     }
19124:     mainPalette.margins = 9;
19125:     mainPalette.spacing = 0;
19126:     function loadImage(e, r, t) {
19127:       var s = Folder.userData.fsName + "/Adobe/ScriptData/" + t;
19128:       if (!Folder(s).exists) {
19129:         Folder(s).create();
19130:         if (!Folder(s).exists) {
19131:           alert("Could not create folder: " + s + ".");
19132:           return;
19133:         }
19134:       }
19135:       var o = s + "/" + r + ".png";
19136:       var a = new File(o);
19137:       if (!a.exists) {
19138:         a.encoding = "BINARY";
19139:         a.open("w");
19140:         a.write(e);
19141:         a.close();
19142:         if (!a.exists) {
19143:           alert("Could not create file in: " + s + ".");
19144:           return;
19145:         }
19146:       }
19147:       return a;
19148:     }
19149:     var myWin = mainPalette.add("group");
19150:     myWin.orientation = "column";
19151:     myWin.spacing = 2;
19152:     var easyRulers_params = {
19153:       baseline: 0,
19154:       enableNumbers: 0,
19155:       enableTracking: 0,
19156:       rulerType: 0,
19157:       shapeOfDivisions: 0,
19158:       sides: 0,
19159:       typeOfDivisions: 4,
19160:     };
19161:     var MainColorRGB = { blue: 255, green: 255, red: 255 };
19162:     var NumbersColorRGB = { blue: 255, green: 255, red: 255 };
19163:     var BigColorRGB = { blue: 255, green: 255, red: 255 };
19164:     var HalfColorRGB = { blue: 255, green: 255, red: 255 };
19165:     var QuarterColorRGB = { blue: 255, green: 255, red: 255 };
19166:     var EighthsColorRGB = { blue: 255, green: 255, red: 255 };
19167:     var PointerColorRGB = { blue: 255, green: 255, red: 255 };
19168:     var divideBy = 10;
19169:     var tempDistance = 0;
19170:     var myDecColor1 = 16777215;
19171:     var myDecColor2 = 16777215;
19172:     var myDecColor3 = 16777215;
19173:     var myDecColor4 = 16777215;
19174:     var myDecColor5 = 16777215;
19175:     var myDecColor6 = 16777215;
19176:     var shape = new Shape();
19177:     shape.vertices = [
19178:       [0, 250],
19179:       [-250, 0],
19180:       [0, -250],
19181:       [250, 0],
19182:     ];
19183:     shape.inTangents = [
19184:       [138.071182250977, 0],
19185:       [0, 138.071182250977],
19186:       [-138.071166992188, 0],
19187:       [0, -138.071166992188],
19188:     ];
19189:     shape.outTangents = [
19190:       [-138.071166992188, 0],
19191:       [0, -138.071166992188],
19192:       [138.071182250977, 0],
19193:       [0, 138.071182250977],
19194:     ];
19195:     shape.closed = true;
19196:     var ruler = 0;
19197:     var shapeLayer = "";
19198:     var labelColor = 0;
19199:     var imagelogo = __BLOB__BLOB_000595__;
19200:     var button_arc = __BLOB__BLOB_000596__;
19201:     var button_linear = __BLOB__BLOB_000597__;
19202:     align_left_image = __BLOB__BLOB_000598__;
19203:     align_right_image = __BLOB__BLOB_000599__;
19204:     align_center_image = __BLOB__BLOB_000600__;
19205:     if (parseFloat(app.version) < 14) {
19206:       var ruler_1_icon = __BLOB__BLOB_000601__;
19207:       var ruler_2_icon = __BLOB__BLOB_000602__;
19208:       var ruler_3_icon = __BLOB__BLOB_000603__;
19209:       var ruler_4_icon = __BLOB__BLOB_CLEANED__;
19210:       var ruler_5_icon = __BLOB__BLOB_000604__;
19211:       var ruler_6_icon = __BLOB__BLOB_000605__;
19212:       var ruler_7_icon = __BLOB__BLOB_000606__;
19213:       var ruler_8_icon = __BLOB__BLOB_000607__;
19214:       var ruler_9_icon = __BLOB__BLOB_000608__;
19215:       var ruler_1_dots_icon = __BLOB__BLOB_000609__;
19216:       var ruler_2_dots_icon = __BLOB__BLOB_000610__;
19217:       var ruler_3_dots_icon = __BLOB__BLOB_000611__;
19218:       var ruler_4_dots_icon = __BLOB__BLOB_000612__;
19219:       var ruler_5_dots_icon = __BLOB__BLOB_000613__;
19220:       var ruler_6_dots_icon = __BLOB__BLOB_000614__;
19221:       var ruler_7_dots_icon = __BLOB__BLOB_000615__;
19222:       var ruler_8_dots_icon = __BLOB__BLOB_000616__;
19223:       var ruler_9_dots_icon = __BLOB__BLOB_000617__;
19224:       var ruler_1_curved_dots_icon = __BLOB__BLOB_000618__;
19225:       var ruler_2_curved_dots_icon = __BLOB__BLOB_000619__;
19226:       var ruler_3_curved_dots_icon = __BLOB__BLOB_000620__;
19227:       var ruler_4_curved_dots_icon = __BLOB__BLOB_000621__;
19228:       var ruler_5_curved_dots_icon = __BLOB__BLOB_000622__;
19229:       var ruler_6_curved_dots_icon = __BLOB__BLOB_000623__;
19230:       var ruler_7_curved_dots_icon = __BLOB__BLOB_000624__;
19231:       var ruler_8_curved_dots_icon = __BLOB__BLOB_000625__;
19232:       var ruler_9_curved_dots_icon = __BLOB__BLOB_000626__;
19233:       var ruler_1_curved_stripes_icon = __BLOB__BLOB_000627__;
19234:       var ruler_2_curved_stripes_icon = __BLOB__BLOB_000628__;
19235:       var ruler_3_curved_stripes_icon = __BLOB__BLOB_000629__;
19236:       var ruler_4_curved_stripes_icon = __BLOB__BLOB_000630__;
19237:       var ruler_5_curved_stripes_icon = __BLOB__BLOB_000631__;
19238:       var ruler_6_curved_stripes_icon = __BLOB__BLOB_000632__;
19239:       var ruler_7_curved_stripes_icon = __BLOB__BLOB_000633__;
19240:       var ruler_8_curved_stripes_icon = __BLOB__BLOB_000634__;
19241:       var ruler_9_curved_stripes_icon = __BLOB__BLOB_000635__;
19242:     } else {
19243:       var ruler_1_icon = __BLOB__BLOB_CLEANED__;
19244:       var ruler_2_icon = __BLOB__BLOB_000636__;
19245:       var ruler_3_icon = __BLOB__BLOB_CLEANED__;
19246:       var ruler_4_icon = __BLOB__BLOB_000637__;
19247:       var ruler_5_icon = __BLOB__BLOB_000638__;
19248:       var ruler_6_icon = __BLOB__BLOB_000639__;
19249:       var ruler_7_icon = __BLOB__BLOB_000640__;
19250:       var ruler_8_icon = __BLOB__BLOB_CLEANED__;
19251:       var ruler_9_icon = __BLOB__BLOB_000641__;
19252:       var ruler_1_dots_icon = __BLOB__BLOB_000642__;
19253:       var ruler_2_dots_icon = __BLOB__BLOB_000643__;
19254:       var ruler_3_dots_icon = __BLOB__BLOB_000644__;
19255:       var ruler_4_dots_icon = __BLOB__BLOB_CLEANED__;
19256:       var ruler_5_dots_icon = __BLOB__BLOB_000645__;
19257:       var ruler_6_dots_icon = __BLOB__BLOB_000646__;
19258:       var ruler_7_dots_icon = __BLOB__BLOB_000647__;
19259:       var ruler_8_dots_icon = __BLOB__BLOB_000648__;
19260:       var ruler_9_dots_icon = __BLOB__BLOB_000649__;
19261:       var ruler_1_curved_dots_icon = __BLOB__BLOB_000650__;
19262:       var ruler_2_curved_dots_icon = __BLOB__BLOB_000651__;
19263:       var ruler_3_curved_dots_icon = __BLOB__BLOB_000652__;
19264:       var ruler_4_curved_dots_icon = __BLOB__BLOB_CLEANED__;
19265:       var ruler_5_curved_dots_icon = __BLOB__BLOB_000653__;
19266:       var ruler_6_curved_dots_icon = __BLOB__BLOB_CLEANED__;
19267:       var ruler_7_curved_dots_icon = __BLOB__BLOB_000654__;
19268:       var ruler_8_curved_dots_icon = __BLOB__BLOB_000655__;
19269:       var ruler_9_curved_dots_icon = __BLOB__BLOB_000656__;
19270:       var ruler_1_curved_stripes_icon = __BLOB__BLOB_000657__;
19271:       var ruler_2_curved_stripes_icon = __BLOB__BLOB_000658__;
19272:       var ruler_3_curved_stripes_icon = __BLOB__BLOB_000659__;
19273:       var ruler_4_curved_stripes_icon = __BLOB__BLOB_000660__;
19274:       var ruler_5_curved_stripes_icon = __BLOB__BLOB_000661__;
19275:       var ruler_6_curved_stripes_icon = __BLOB__BLOB_000662__;
19276:       var ruler_7_curved_stripes_icon = __BLOB__BLOB_000663__;
19277:       var ruler_8_curved_stripes_icon = __BLOB__BLOB_000664__;
19278:       var ruler_9_curved_stripes_icon = __BLOB__BLOB_CLEANED__;
19279:     }
19280:     var logo = myWin.add(
19281:       "iconbutton",
19282:       undefined,
19283:       parseFloat(app.version) < 12
19284:         ? loadImage(imagelogo, "easyRulersLogoSmall", "easyRulers")
19285:         : imagelogo,
19286:       { style: "toolbutton" },
19287:     );
19288:     logo.alignment = ["left", "fill"];
19289:     logo.onClick = FF092D.helpUI;
19290:     logo.helpTip = "easyRulers 2 - click for options and help.";
19291:     var groupOne = myWin.add("group", undefined, "GroupOne");
19292:     groupOne.orientation = "row";
19293:     groupOne.alignment = ["fill", "fill"];
19294:     groupOne.spacing = 5;
19295:     var StaticTextCopiesLabel = groupOne.add(
19296:       "StaticText",
19297:       undefined,
19298:       "Ruler lines:",
19299:     );
19300:     StaticTextCopiesLabel.size =
19301:       parseFloat(app.version) < 12 ? [61, 16] : [61, 23];
19302:     StaticTextCopiesLabel.justify = "right";
19303:     var EditTextCopies = groupOne.add(
19304:       'EditText {text:51, justify: "center"}',
19305:       undefined,
19306:       51,
19307:     );
19308:     EditTextCopies.size = parseFloat(app.version) < 12 ? [38, 18] : [38, 23];
19309:     EditTextCopies.helpTip = "Set the total lines of the ruler.";
19310:     EditTextCopies.addEventListener("keydown", function (e) {
19311:       arrowsPressed(EditTextCopies);
19312:     });
19313:     var CopiesSlider = groupOne.add("Slider", undefined, 51, 1, 250);
19314:     CopiesSlider.helpTip = "Set the total divisions of the ruler.";
19315:     CopiesSlider.size = parseFloat(app.version) < 12 ? [150, 18] : [150, 23];
19316:     var groupTwo = myWin.add("group", undefined, "GroupTwo");
19317:     groupTwo.orientation = "row";
19318:     groupTwo.alignment = ["fill", "fill"];
19319:     groupTwo.margins = [13, 0, 0, 13];
19320:     groupTwo.spacing = 5;
19321:     var StaticTextGapLabel = groupTwo.add("StaticText", undefined, "Gap:");
19322:     StaticTextGapLabel.justify = "right";
19323:     StaticTextGapLabel.size =
19324:       parseFloat(app.version) < 12 ? [48, 16] : [48, 23];
19325:     var EditTextGap = groupTwo.add(
19326:       'EditText {text:15, justify: "center"}',
19327:       undefined,
19328:       15,
19329:     );
19330:     EditTextGap.size = parseFloat(app.version) < 12 ? [38, 18] : [38, 23];
19331:     EditTextGap.helpTip = "Set the gap between the divisions of the ruler.";
19332:     EditTextGap.addEventListener("keydown", function (e) {
19333:       arrowsPressed(EditTextGap);
19334:     });
19335:     var GapSlider = groupTwo.add("Slider", undefined, 15, 1, 100);
19336:     GapSlider.helpTip = "Set the gap between the lines of the ruler.";
19337:     GapSlider.size = parseFloat(app.version) < 12 ? [150, 18] : [150, 23];
19338:     var er_panels = myWin.add("tabbedpanel");
19339:     if (parseFloat(app.version) < 13) {
19340:       er_panels.minimumSize = [260, "fill"];
19341:     }
19342:     er_panels.maximumSize = [260, 500];
19343:     er_panels.spacing = 0;
19344:     er_panels.margins = 0;
19345:     var rulerType_tab = er_panels.add("tab", undefined, "type");
19346:     rulerType_tab.spacing = 0;
19347:     rulerType_tab.margins =
19348:       parseFloat(app.version) < 12 ? [8, 8, 8, 8] : [10, 8, 0, 0];
19349:     var rulerLineCircleGroup = rulerType_tab.add(
19350:       parseFloat(app.version) < 12 ? "group" : "panel",
19351:       undefined,
19352:       "",
19353:     );
19354:     rulerLineCircleGroup.orientation = "row";
19355:     rulerLineCircleGroup.spacing = 0;
19356:     rulerLineCircleGroup.alignment = ["fill", "fill"];
19357:     var rulerLineIconGroup = rulerLineCircleGroup.add(
19358:       "group",
19359:       undefined,
19360:       "Line Icon",
19361:     );
19362:     rulerLineIconGroup.orientation = "column";
19363:     rulerLineIconGroup.alignment = ["fill", ""];
19364:     var rulerLine = rulerLineIconGroup.add(
19365:       "iconbutton",
19366:       undefined,
19367:       parseFloat(app.version) < 12
19368:         ? loadImage(button_linear, "rulerLineIcon", "easyRulers")
19369:         : button_linear,
19370:       { style: "toolbutton", toggle: true },
19371:     );
19372:     rulerLine.value = true;
19373:     rulerLine.helpTip = "Create a ruler in a straight line.";
19374:     rulerLine.size = [95, 40];
19375:     var rulerLineIconLabel = rulerLineIconGroup.add(
19376:       "StaticText",
19377:       undefined,
19378:       "Linear",
19379:     );
19380:     rulerLineIconLabel.justify = "center";
19381:     rulerLineIconLabel.size =
19382:       parseFloat(app.version) < 12 ? [90, 14] : [90, 10];
19383:     var rulerCircleIconGroup = rulerLineCircleGroup.add(
19384:       "group",
19385:       undefined,
19386:       "Circle Icon",
19387:     );
19388:     rulerCircleIconGroup.orientation = "column";
19389:     rulerCircleIconGroup.alignment = ["fill", ""];
19390:     var rulerCircle = rulerCircleIconGroup.add(
19391:       "iconbutton",
19392:       undefined,
19393:       parseFloat(app.version) < 12
19394:         ? loadImage(button_arc, "rulerCircleIcon", "easyRulers")
19395:         : button_arc,
19396:       { style: "toolbutton", toggle: true },
19397:     );
19398:     rulerCircle.value = false;
19399:     rulerCircle.helpTip = "Create a ruler in a arc/circle.";
19400:     rulerCircle.size = [95, 40];
19401:     var rulerCircleIconLabel = rulerCircleIconGroup.add(
19402:       "StaticText",
19403:       undefined,
19404:       "Arc/Circle",
19405:     );
19406:     rulerCircleIconLabel.justify = "center";
19407:     rulerCircleIconLabel.size =
19408:       parseFloat(app.version) < 12 ? [90, 14] : [90, 10];
19409:     var SidesTypeGroup = rulerType_tab.add("group", undefined, "Sides");
19410:     SidesTypeGroup.orientation = "row";
19411:     SidesTypeGroup.margins = [0, 5, 0, 0];
19412:     SidesTypeGroup.alignment = "right";
19413:     var SidesTypeLabel = SidesTypeGroup.add("StaticText", undefined, "Side:");
19414:     SidesTypeLabel.justify = "right";
19415:     SidesTypeLabel.size = parseFloat(app.version) < 12 ? [67, 16] : [67, 23];
19416:     var SidesStack = SidesTypeGroup.add("group", undefined, "SidesStack");
19417:     SidesStack.orientation = "stack";
19418:     var SidesType = SidesStack.add("dropdownlist", undefined, [
19419:       "Side A - Lower",
19420:       "Side B - Upper",
19421:       "Both",
19422:     ]);
19423:     SidesType.helpTip = "Select which side of the ruler to create.";
19424:     SidesType.size = [135, 24];
19425:     SidesType.selection = 0;
19426:     var SidesTypeCircle = SidesStack.add("dropdownlist", undefined, [
19427:       "Side A - Outer",
19428:       "Side B - Inner",
19429:       "Both",
19430:     ]);
19431:     SidesTypeCircle.helpTip = "Select which side of the ruler to create.";
19432:     SidesTypeCircle.size = [135, 24];
19433:     SidesTypeCircle.selection = 0;
19434:     SidesTypeCircle.visible = false;
19435:     var BaseLineGroup = rulerType_tab.add("group", undefined, "Baseline");
19436:     BaseLineGroup.orientation = "row";
19437:     BaseLineGroup.alignment = "right";
19438:     var BaseLineLabel = BaseLineGroup.add("StaticText", undefined, "Baseline:");
19439:     BaseLineLabel.justify = "right";
19440:     BaseLineLabel.size = parseFloat(app.version) < 12 ? [67, 16] : [67, 23];
19441:     var BaseLineDropdown = BaseLineGroup.add("dropdownlist", undefined, [
19442:       "None",
19443:       "Bottom Only",
19444:       "Mulitple",
19445:     ]);
19446:     BaseLineDropdown.helpTip = "Select the type of the baseline.";
19447:     BaseLineDropdown.size = [135, 24];
19448:     BaseLineDropdown.selection = 0;
19449:     var lines_tab = er_panels.add("tab", undefined, "divisions");
19450:     lines_tab.margins =
19451:       parseFloat(app.version) < 12 ? [8, 8, 8, 8] : [9, 5, 0, 15];
19452:     lines_tab.spacing = 0;
19453:     var rulerSidesLinesTyperGroup = lines_tab.add("group", undefined, "shape");
19454:     rulerSidesLinesTyperGroup.orientation = "row";
19455:     rulerSidesLinesTyperGroup.alignment = ["right", "fill"];
19456:     rulerSidesLinesTyperGroup.margins = [0, 5, 0, 0];
19457:     var shapeDivisionsLabel = rulerSidesLinesTyperGroup.add(
19458:       "StaticText",
19459:       undefined,
19460:       "Shape of divisions:",
19461:     );
19462:     shapeDivisionsLabel.justify = "right";
19463:     shapeDivisionsLabel.size =
19464:       parseFloat(app.version) < 12 ? [105, 16] : [105, 23];
19465:     var LinesTypeDropdown = rulerSidesLinesTyperGroup.add(
19466:       "dropdownlist",
19467:       undefined,
19468:       ["Stripes", "Dots"],
19469:     );
19470:     LinesTypeDropdown.helpTip = "Select the type of the divisions.";
19471:     LinesTypeDropdown.size = [85, 24];
19472:     LinesTypeDropdown.selection = 0;
19473:     var rulerTypeGroup = lines_tab.add("group", undefined, "stack drodowns");
19474:     rulerTypeGroup.orientation = "stack";
19475:     var rulerType = rulerTypeGroup.add("dropdownlist", undefined, [
19476:       " (a)  1/1  (main stripes only)",
19477:       " (b)  /2 + 1/1",
19478:       " (c)  /5 + 1/1",
19479:       " (d)  /10 + 1/1",
19480:       " (e)  /10 + 1/1 + 1/2",
19481:       " (f)  /10 + 1/1 + 1/5",
19482:       " (g)  /12 + 1/1 (time/clock)",
19483:       " (h)  /16 + 1/1 + 1/2 + 1/4",
19484:       " (i)  /16+1/1+1/2+1/4+1/8",
19485:     ]);
19486:     rulerType.helpTip = "Set the type of the ruler.";
19487:     rulerType.size = [240, 44];
19488:     rulerType.selection = 4;
19489:     rulerType.itemSize = parseFloat(app.version) < 14 ? [25, 60] : [25, 29];
19490:     rulerType.alignment = ["fill", ""];
19491:     rulerType.margins = 0;
19492:     rulerType.spacing = 0;
19493:     rulerType.items[0].image = ScriptUI.newImage(
19494:       parseFloat(app.version) < 12
19495:         ? loadImage(ruler_1_icon, "easyRulersIcon1", "easyRulers")
19496:         : ruler_1_icon,
19497:     );
19498:     rulerType.items[1].image = ScriptUI.newImage(
19499:       parseFloat(app.version) < 12
19500:         ? loadImage(ruler_2_icon, "easyRulersIcon2", "easyRulers")
19501:         : ruler_2_icon,
19502:     );
19503:     rulerType.items[2].image = ScriptUI.newImage(
19504:       parseFloat(app.version) < 12
19505:         ? loadImage(ruler_3_icon, "easyRulersIcon3", "easyRulers")
19506:         : ruler_3_icon,
19507:     );
19508:     rulerType.items[3].image = ScriptUI.newImage(
19509:       parseFloat(app.version) < 12
19510:         ? loadImage(ruler_4_icon, "easyRulersIcon4", "easyRulers")
19511:         : ruler_4_icon,
19512:     );
19513:     rulerType.items[4].image = ScriptUI.newImage(
19514:       parseFloat(app.version) < 12
19515:         ? loadImage(ruler_5_icon, "easyRulersIcon5", "easyRulers")
19516:         : ruler_5_icon,
19517:     );
19518:     rulerType.items[5].image = ScriptUI.newImage(
19519:       parseFloat(app.version) < 12
19520:         ? loadImage(ruler_6_icon, "easyRulersIcon6", "easyRulers")
19521:         : ruler_6_icon,
19522:     );
19523:     rulerType.items[6].image = ScriptUI.newImage(
19524:       parseFloat(app.version) < 12
19525:         ? loadImage(ruler_7_icon, "easyRulersIcon7", "easyRulers")
19526:         : ruler_7_icon,
19527:     );
19528:     rulerType.items[7].image = ScriptUI.newImage(
19529:       parseFloat(app.version) < 12
19530:         ? loadImage(ruler_8_icon, "easyRulersIcon8", "easyRulers")
19531:         : ruler_8_icon,
19532:     );
19533:     rulerType.items[8].image = ScriptUI.newImage(
19534:       parseFloat(app.version) < 12
19535:         ? loadImage(ruler_9_icon, "easyRulersIcon9", "easyRulers")
19536:         : ruler_9_icon,
19537:     );
19538:     var rulerTypeDots = rulerTypeGroup.add("dropdownlist", undefined, [
19539:       " (a)  1/1  (main dots only)",
19540:       " (b)  /2 + 1/1",
19541:       " (c)  /5 + 1/1",
19542:       " (d)  /10 + 1/1",
19543:       " (e)  /10 + 1/1 + 1/2",
19544:       " (f)  /10 + 1/1 + 1/5",
19545:       " (g)  /12 + 1/1 (time/clock)",
19546:       " (h)  /16 + 1/1 + 1/2 + 1/4",
19547:       " (i)  /16+1/1+1/2+1/4+1/8",
19548:     ]);
19549:     rulerTypeDots.helpTip = "Set the type of the ruler.";
19550:     rulerTypeDots.size = [240, 44];
19551:     rulerTypeDots.selection = 4;
19552:     rulerTypeDots.itemSize = parseFloat(app.version) < 14 ? [25, 60] : [25, 29];
19553:     rulerTypeDots.alignment = ["fill", ""];
19554:     rulerTypeDots.margins = 0;
19555:     rulerTypeDots.spacing = 0;
19556:     rulerTypeDots.visible = false;
19557:     rulerTypeDots.items[0].image = ScriptUI.newImage(
19558:       parseFloat(app.version) < 12
19559:         ? loadImage(ruler_1_dots_icon, "easyRulersIcon10", "easyRulers")
19560:         : ruler_1_dots_icon,
19561:     );
19562:     rulerTypeDots.items[1].image = ScriptUI.newImage(
19563:       parseFloat(app.version) < 12
19564:         ? loadImage(ruler_2_dots_icon, "easyRulersIcon11", "easyRulers")
19565:         : ruler_2_dots_icon,
19566:     );
19567:     rulerTypeDots.items[2].image = ScriptUI.newImage(
19568:       parseFloat(app.version) < 12
19569:         ? loadImage(ruler_3_dots_icon, "easyRulersIcon12", "easyRulers")
19570:         : ruler_3_dots_icon,
19571:     );
19572:     rulerTypeDots.items[3].image = ScriptUI.newImage(
19573:       parseFloat(app.version) < 12
19574:         ? loadImage(ruler_4_dots_icon, "easyRulersIcon13", "easyRulers")
19575:         : ruler_4_dots_icon,
19576:     );
19577:     rulerTypeDots.items[4].image = ScriptUI.newImage(
19578:       parseFloat(app.version) < 12
19579:         ? loadImage(ruler_5_dots_icon, "easyRulersIcon14", "easyRulers")
19580:         : ruler_5_dots_icon,
19581:     );
19582:     rulerTypeDots.items[5].image = ScriptUI.newImage(
19583:       parseFloat(app.version) < 12
19584:         ? loadImage(ruler_6_dots_icon, "easyRulersIcon15", "easyRulers")
19585:         : ruler_6_dots_icon,
19586:     );
19587:     rulerTypeDots.items[6].image = ScriptUI.newImage(
19588:       parseFloat(app.version) < 12
19589:         ? loadImage(ruler_7_dots_icon, "easyRulersIcon16", "easyRulers")
19590:         : ruler_7_dots_icon,
19591:     );
19592:     rulerTypeDots.items[7].image = ScriptUI.newImage(
19593:       parseFloat(app.version) < 12
19594:         ? loadImage(ruler_8_dots_icon, "easyRulersIcon17", "easyRulers")
19595:         : ruler_8_dots_icon,
19596:     );
19597:     rulerTypeDots.items[8].image = ScriptUI.newImage(
19598:       parseFloat(app.version) < 12
19599:         ? loadImage(ruler_9_dots_icon, "easyRulersIcon18", "easyRulers")
19600:         : ruler_9_dots_icon,
19601:     );
19602:     var rulerTypeCurvedDots = rulerTypeGroup.add("dropdownlist", undefined, [
19603:       " (a)  1/1  (main dots only)",
19604:       " (b)  /2 + 1/1",
19605:       " (c)  /5 + 1/1",
19606:       " (d)  /10 + 1/1",
19607:       " (e)  /10 + 1/1 + 1/2",
19608:       " (f)  /10 + 1/1 + 1/5",
19609:       " (g)  /12 + 1/1 (time/clock)",
19610:       " (h)  /16 + 1/1 + 1/2 + 1/4",
19611:       " (i)  /16+1/1+1/2+1/4+1/8",
19612:     ]);
19613:     rulerTypeCurvedDots.helpTip = "Set the type of the ruler.";
19614:     rulerTypeCurvedDots.size = [240, 44];
19615:     rulerTypeCurvedDots.selection = 4;
19616:     rulerTypeCurvedDots.itemSize =
19617:       parseFloat(app.version) < 14 ? [25, 60] : [25, 29];
19618:     rulerTypeCurvedDots.alignment = ["fill", ""];
19619:     rulerTypeCurvedDots.margins = 0;
19620:     rulerTypeCurvedDots.spacing = 0;
19621:     rulerTypeCurvedDots.visible = false;
19622:     rulerTypeCurvedDots.items[0].image = ScriptUI.newImage(
19623:       parseFloat(app.version) < 12
19624:         ? loadImage(ruler_1_curved_dots_icon, "easyRulersIcon19", "easyRulers")
19625:         : ruler_1_curved_dots_icon,
19626:     );
19627:     rulerTypeCurvedDots.items[1].image = ScriptUI.newImage(
19628:       parseFloat(app.version) < 12
19629:         ? loadImage(ruler_2_curved_dots_icon, "easyRulersIcon20", "easyRulers")
19630:         : ruler_2_curved_dots_icon,
19631:     );
19632:     rulerTypeCurvedDots.items[2].image = ScriptUI.newImage(
19633:       parseFloat(app.version) < 12
19634:         ? loadImage(ruler_3_curved_dots_icon, "easyRulersIcon21", "easyRulers")
19635:         : ruler_3_curved_dots_icon,
19636:     );
19637:     rulerTypeCurvedDots.items[3].image = ScriptUI.newImage(
19638:       parseFloat(app.version) < 12
19639:         ? loadImage(ruler_4_curved_dots_icon, "easyRulersIcon22", "easyRulers")
19640:         : ruler_4_curved_dots_icon,
19641:     );
19642:     rulerTypeCurvedDots.items[4].image = ScriptUI.newImage(
19643:       parseFloat(app.version) < 12
19644:         ? loadImage(ruler_5_curved_dots_icon, "easyRulersIcon23", "easyRulers")
19645:         : ruler_5_curved_dots_icon,
19646:     );
19647:     rulerTypeCurvedDots.items[5].image = ScriptUI.newImage(
19648:       parseFloat(app.version) < 12
19649:         ? loadImage(ruler_6_curved_dots_icon, "easyRulersIcon24", "easyRulers")
19650:         : ruler_6_curved_dots_icon,
19651:     );
19652:     rulerTypeCurvedDots.items[6].image = ScriptUI.newImage(
19653:       parseFloat(app.version) < 12
19654:         ? loadImage(ruler_7_curved_dots_icon, "easyRulersIcon25", "easyRulers")
19655:         : ruler_7_curved_dots_icon,
19656:     );
19657:     rulerTypeCurvedDots.items[7].image = ScriptUI.newImage(
19658:       parseFloat(app.version) < 12
19659:         ? loadImage(ruler_8_curved_dots_icon, "easyRulersIcon26", "easyRulers")
19660:         : ruler_8_curved_dots_icon,
19661:     );
19662:     rulerTypeCurvedDots.items[8].image = ScriptUI.newImage(
19663:       parseFloat(app.version) < 12
19664:         ? loadImage(ruler_9_curved_dots_icon, "easyRulersIcon27", "easyRulers")
19665:         : ruler_9_curved_dots_icon,
19666:     );
19667:     var rulerTypeCurvedStripes = rulerTypeGroup.add("dropdownlist", undefined, [
19668:       " (a)  1/1  (main stripes only)",
19669:       " (b)  /2 + 1/1",
19670:       " (c)  /5 + 1/1",
19671:       " (d)  /10 + 1/1",
19672:       " (e)  /10 + 1/1 + 1/2",
19673:       " (f)  /10 + 1/1 + 1/5",
19674:       " (g)  /12 + 1/1 (time/clock)",
19675:       " (h)  /16 + 1/1 + 1/2 + 1/4",
19676:       " (i)  /16+1/1+1/2+1/4+1/8",
19677:     ]);
19678:     rulerTypeCurvedStripes.helpTip = "Set the type of the ruler.";
19679:     rulerTypeCurvedStripes.size = [240, 44];
19680:     rulerTypeCurvedStripes.selection = 4;
19681:     rulerTypeCurvedStripes.itemSize =
19682:       parseFloat(app.version) < 14 ? [25, 60] : [25, 29];
19683:     rulerTypeCurvedStripes.alignment = ["fill", ""];
19684:     rulerTypeCurvedStripes.margins = 0;
19685:     rulerTypeCurvedStripes.spacing = 0;
19686:     rulerTypeCurvedStripes.visible = false;
19687:     rulerTypeCurvedStripes.items[0].image = ScriptUI.newImage(
19688:       parseFloat(app.version) < 12
19689:         ? loadImage(
19690:             ruler_1_curved_stripes_icon,
19691:             "easyRulersIcon28",
19692:             "easyRulers",
19693:           )
19694:         : ruler_1_curved_stripes_icon,
19695:     );
19696:     rulerTypeCurvedStripes.items[1].image = ScriptUI.newImage(
19697:       parseFloat(app.version) < 12
19698:         ? loadImage(
19699:             ruler_2_curved_stripes_icon,
19700:             "easyRulersIcon29",
19701:             "easyRulers",
19702:           )
19703:         : ruler_2_curved_stripes_icon,
19704:     );
19705:     rulerTypeCurvedStripes.items[2].image = ScriptUI.newImage(
19706:       parseFloat(app.version) < 12
19707:         ? loadImage(
19708:             ruler_3_curved_stripes_icon,
19709:             "easyRulersIcon30",
19710:             "easyRulers",
19711:           )
19712:         : ruler_3_curved_stripes_icon,
19713:     );
19714:     rulerTypeCurvedStripes.items[3].image = ScriptUI.newImage(
19715:       parseFloat(app.version) < 12
19716:         ? loadImage(
19717:             ruler_4_curved_stripes_icon,
19718:             "easyRulersIcon31",
19719:             "easyRulers",
19720:           )
19721:         : ruler_4_curved_stripes_icon,
19722:     );
19723:     rulerTypeCurvedStripes.items[4].image = ScriptUI.newImage(
19724:       parseFloat(app.version) < 12
19725:         ? loadImage(
19726:             ruler_5_curved_stripes_icon,
19727:             "easyRulersIcon32",
19728:             "easyRulers",
19729:           )
19730:         : ruler_5_curved_stripes_icon,
19731:     );
19732:     rulerTypeCurvedStripes.items[5].image = ScriptUI.newImage(
19733:       parseFloat(app.version) < 12
19734:         ? loadImage(
19735:             ruler_6_curved_stripes_icon,
19736:             "easyRulersIcon33",
19737:             "easyRulers",
19738:           )
19739:         : ruler_6_curved_stripes_icon,
19740:     );
19741:     rulerTypeCurvedStripes.items[6].image = ScriptUI.newImage(
19742:       parseFloat(app.version) < 12
19743:         ? loadImage(
19744:             ruler_7_curved_stripes_icon,
19745:             "easyRulersIcon34",
19746:             "easyRulers",
19747:           )
19748:         : ruler_7_curved_stripes_icon,
19749:     );
19750:     rulerTypeCurvedStripes.items[7].image = ScriptUI.newImage(
19751:       parseFloat(app.version) < 12
19752:         ? loadImage(
19753:             ruler_8_curved_stripes_icon,
19754:             "easyRulersIcon35",
19755:             "easyRulers",
19756:           )
19757:         : ruler_8_curved_stripes_icon,
19758:     );
19759:     rulerTypeCurvedStripes.items[8].image = ScriptUI.newImage(
19760:       parseFloat(app.version) < 12
19761:         ? loadImage(
19762:             ruler_9_curved_stripes_icon,
19763:             "easyRulersIcon36",
19764:             "easyRulers",
19765:           )
19766:         : ruler_9_curved_stripes_icon,
19767:     );
19768:     var numbers_tab = er_panels.add("tab", undefined, "123 ");
19769:     numbers_tab.margins =
19770:       parseFloat(app.version) < 12 ? [8, 8, 8, 8] : [0, 5, 0, 0];
19771:     var NumbersGroup1 = numbers_tab.add("group", undefined, "Numbers");
19772:     NumbersGroup1.alignment = ["right", "fill"];
19773:     NumbersGroup1.margins = [10, 2, 4, 5];
19774:     var NumbersCheckBox = NumbersGroup1.add(
19775:       "checkbox",
19776:       undefined,
19777:       " Create numbers ?",
19778:     );
19779:     NumbersCheckBox.size = [122, 14];
19780:     NumbersCheckBox.value = true;
19781:     NumbersCheckBox.helpTip =
19782:       "Choose if you want to create text layers with numbers.";
19783:     var AlignGroup = NumbersGroup1.add("group", undefined, "");
19784:     AlignGroup.margins = [3, 3, 3, 3];
19785:     AlignGroup.spacing = 3;
19786:     AlignGroup.orientation = "row";
19787:     var alignLeft = AlignGroup.add(
19788:       "iconbutton",
19789:       undefined,
19790:       parseFloat(app.version) < 12
19791:         ? loadImage(align_left_image, "easyRulersAlignLeftIcon", "easyRulers")
19792:         : align_left_image,
19793:       { style: "toolbutton", toggle: true },
19794:     );
19795:     alignLeft.value = false;
19796:     alignLeft.alignment = ["fill", "fill"];
19797:     alignLeft.helpTip = "Align numbers to the left.";
19798:     var alignCenter = AlignGroup.add(
19799:       "iconbutton",
19800:       undefined,
19801:       parseFloat(app.version) < 12
19802:         ? loadImage(
19803:             align_center_image,
19804:             "easyRulersAlignCenterIcon",
19805:             "easyRulers",
19806:           )
19807:         : align_center_image,
19808:       { style: "toolbutton", toggle: true },
19809:     );
19810:     alignCenter.value = true;
19811:     alignCenter.helpTip = "Align numbers in the center.";
19812:     var alignRight = AlignGroup.add(
19813:       "iconbutton",
19814:       undefined,
19815:       parseFloat(app.version) < 12
19816:         ? loadImage(align_right_image, "easyRulersAlignRightIcon", "easyRulers")
19817:         : align_right_image,
19818:       { style: "toolbutton", toggle: true },
19819:     );
19820:     alignRight.value = false;
19821:     alignRight.helpTip = "Align numbers to the right.";
19822:     var NumbersGroup2 = numbers_tab.add("group", undefined, "Numbers");
19823:     NumbersGroup2.margins = [7, 0, 0, 0];
19824:     NumbersGroup2.spacing = 4;
19825:     NumbersGroup2.alignment = ["center", "fill"];
19826:     var StartFromLabel = NumbersGroup2.add(
19827:       'StaticText {text:"Start From:", justify: "right"}',
19828:       undefined,
19829:     );
19830:     StartFromLabel.size = [60, 20];
19831:     var StartFrom = NumbersGroup2.add(
19832:       'EditText {text:00, justify: "center"}',
19833:       undefined,
19834:       0,
19835:     );
19836:     StartFrom.size = [40, 20];
19837:     StartFrom.helpTip = "Set the starting number of the ruler numbering.";
19838:     StartFrom.addEventListener("keydown", function (e) {
19839:       arrowsPressed(StartFrom);
19840:     });
19841:     var NumbersSizeLabel = NumbersGroup2.add(
19842:       'StaticText {text:"Text Size:", justify: "right"}',
19843:       undefined,
19844:     );
19845:     NumbersSizeLabel.size = [70, 20];
19846:     var NumbersSize = NumbersGroup2.add(
19847:       'EditText {text:50, justify: "center"}',
19848:       undefined,
19849:       50,
19850:     );
19851:     NumbersSize.size = [40, 20];
19852:     NumbersSize.helpTip = "Set the font size for the ruler numbers.";
19853:     NumbersSize.addEventListener("keydown", function (e) {
19854:       arrowsPressed(NumbersSize);
19855:     });
19856:     var NumbersGroup3 = numbers_tab.add("group", undefined, "Numbers");
19857:     NumbersGroup3.alignment = ["center", "fill"];
19858:     NumbersGroup3.spacing = 4;
19859:     var SteppingLabel = NumbersGroup3.add(
19860:       'StaticText {text:"Stepping:", justify: "right"}',
19861:       undefined,
19862:     );
19863:     SteppingLabel.size = [67, 20];
19864:     var Stepping = NumbersGroup3.add(
19865:       'EditText {text:01, justify: "center"}',
19866:       undefined,
19867:       1,
19868:     );
19869:     Stepping.size = [40, 20];
19870:     Stepping.helpTip = "Set the stepping of the numbering.";
19871:     Stepping.addEventListener("keydown", function (e) {
19872:       arrowsPressed(Stepping);
19873:     });
19874:     var NumbersColorLabel = NumbersGroup3.add(
19875:       'StaticText {text:"Text Color: ", justify: "right"}',
19876:       undefined,
19877:     );
19878:     NumbersColorLabel.size = [72, 20];
19879:     var NumbersColor = NumbersGroup3.add("iconbutton", undefined, undefined, {
19880:       name: "numbers_color_box",
19881:       style: "toolbutton",
19882:     });
19883:     NumbersColor.size = [37, 18];
19884:     NumbersColor.fillBrush = NumbersColor.graphics.newBrush(
19885:       NumbersColor.graphics.BrushType.SOLID_COLOR,
19886:       [
19887:         MainColorRGB.red / 255,
19888:         MainColorRGB.green / 255,
19889:         MainColorRGB.blue / 255,
19890:         1,
19891:       ],
19892:     );
19893:     NumbersColor.helpTip = "Set the color of the text numbers.";
19894:     NumbersColor.onDraw = fillRect;
19895:     var PreSufGroup = numbers_tab.add("group", undefined, "Numbers");
19896:     PreSufGroup.alignment = ["fill", "fill"];
19897:     PreSufGroup.spacing = 0;
19898:     PreSufGroup.margins = [0, 0, 0, 8];
19899:     PreSufGroup.orientation = "row";
19900:     var NumbersGroup4 = PreSufGroup.add("group", undefined, "Numbers");
19901:     NumbersGroup4.alignment = ["fill", "fill"];
19902:     NumbersGroup4.margins =
19903:       parseFloat(app.version) < 12 ? [15, 0, 0, 0] : [21, 0, 0, 0];
19904:     NumbersGroup4.spacing = 3;
19905:     var PrefixCheckbox = NumbersGroup4.add("checkbox", undefined, " Prefix:");
19906:     PrefixCheckbox.value = false;
19907:     PrefixCheckbox.helpTip =
19908:       "Enable the insertion of a prefix to the text number layers.";
19909:     PrefixCheckbox.size = [56, 14];
19910:     var Prefix = NumbersGroup4.add(
19911:       'EditText {text:"> ", justify: "center"}',
19912:       undefined,
19913:       1,
19914:     );
19915:     Prefix.size = [40, 20];
19916:     Prefix.helpTip = "Set a prefix for the text numbers.";
19917:     Prefix.enabled = false;
19918:     var NumbersGroup5 = PreSufGroup.add("group", undefined, "Numbers");
19919:     NumbersGroup5.alignment = ["fill", "left"];
19920:     NumbersGroup5.margins = [10, 0, 0, 0];
19921:     NumbersGroup5.spacing = 3;
19922:     var SuffixCheckbox = NumbersGroup5.add("checkbox", undefined, " Suffix:");
19923:     SuffixCheckbox.value = false;
19924:     SuffixCheckbox.helpTip =
19925:       "Enable the insertion of a suffix to the text number layers.";
19926:     SuffixCheckbox.size = [56, 14];
19927:     var Suffix = NumbersGroup5.add(
19928:       'EditText {text:" mm", justify: "center"}',
19929:       undefined,
19930:       1,
19931:     );
19932:     Suffix.size = [40, 20];
19933:     Suffix.helpTip = "Set a suffix for the text numbers.";
19934:     Suffix.enabled = false;
19935:     var AlignAnchorGroup = numbers_tab.add("group", undefined, "Numbers");
19936:     AlignAnchorGroup.alignment = ["center", "fill"];
19937:     AlignAnchorGroup.spacing = 0;
19938:     AlignAnchorGroup.margins =
19939:       parseFloat(app.version) < 12 ? [14, 0, 0, 0] : [20, 0, 0, 0];
19940:     AlignAnchorGroup.orientation = "row";
19941:     var AnchorGroupCheckBox = AlignAnchorGroup.add(
19942:       "checkbox",
19943:       undefined,
19944:       " Anchor Point Grouping per character?",
19945:     );
19946:     AnchorGroupCheckBox.size = [224, 20];
19947:     AnchorGroupCheckBox.value = false;
19948:     AnchorGroupCheckBox.enabled = false;
19949:     AnchorGroupCheckBox.helpTip =
19950:       "If checked, texts will curve around the circle/arc on per character basis. Otherwise texts will be treated as whole words and will not curve around the circle.";
19951:     var settings_tab = er_panels.add("tab", undefined, "?");
19952:     settings_tab.margins =
19953:       parseFloat(app.version) < 12 ? [8, 8, 8, 8] : [10, 0, 0, 0];
19954:     var SettingsGroup = settings_tab.add("group", undefined, "GroupFive");
19955:     SettingsGroup.orientation = "column";
19956:     if ($.os.indexOf("Windows") == 0) {
19957:       SettingsGroup.margins = [13, 30, 0, 0];
19958:     } else {
19959:       SettingsGroup.margins = [0, 30, 0, 0];
19960:     }
19961:     var ShyTextLayers = SettingsGroup.add(
19962:       "checkbox",
19963:       undefined,
19964:       "  Shy Text Layers",
19965:     );
19966:     ShyTextLayers.value = false;
19967:     ShyTextLayers.size = [120, 30];
19968:     ShyTextLayers.helpTip =
19969:       "Enables the shy switch, on all generated text laters ";
19970:     var Settings2Group = settings_tab.add("group", undefined, "GroupFive");
19971:     Settings2Group.orientation = "column";
19972:     Settings2Group.margins = [0, 10, 0, 0];
19973:     var ResetButton = Settings2Group.add(
19974:       "button",
19975:       undefined,
19976:       "Reset to defaults",
19977:     );
19978:     ResetButton.alignment = ["fill", "fill"];
19979:     ResetButton.size = [160, 40];
19980:     ResetButton.helpTip =
19981:       "Resets all parameters of easyRulers,\nback to their defaults.";
19982:     var BottomGroup = myWin.add("group", undefined, "GroupSix");
19983:     BottomGroup.orientation = "column";
19984:     BottomGroup.alignment = ["fill", "fill"];
19985:     BottomGroup.margins =
19986:       parseFloat(app.version) < 12 ? [0, 5, 0, 0] : [0, 0, 0, 0];
19987:     var TeoButton = BottomGroup.add(
19988:       "button",
19989:       undefined,
19990:       "Create Ruler [ 0  ...  5 ]",
19991:     );
19992:     TeoButton.alignment = ["fill", "fill"];
19993:     TeoButton.size = parseFloat(app.version) < 12 ? ["", 20] : ["", 48];
19994:     TeoButton.helpTip = "Let\'s create some rulers!";
19995:     var PB = BottomGroup.add("progressbar", undefined, 0, 100);
19996:     PB.alignment = ["fill", "fill"];
19997:     PB.size = ["fill", 6];
19998:     if (mainPalette instanceof Panel) {
19999:       PB.hide();
20000:     }
20001:     InfoFunction = function () {
20002:       Prefix.text = Prefix.text.slice(0, 5);
20003:       Suffix.text = Suffix.text.slice(0, 5);
20004:       var e =
20005:         Math.floor((Number(EditTextCopies.text) - 1) / divideBy) *
20006:         Number(Stepping.text.replace(",", "."));
20007:       var r = "";
20008:       if ((Number(EditTextCopies.text) - 1) % divideBy !== 0) {
20009:         r = "+";
20010:       } else {
20011:         r = "";
20012:       }
20013:       if (NumbersCheckBox.value) {
20014:         TeoButton.text =
20015:           "Create Ruler [ " + PrefixCheckbox.value
20016:             ? Prefix.text
20017:             : "" + StartFrom.text + SuffixCheckbox.value
20018:               ? Suffix.text
20019:               : "" + "  ...  " + PrefixCheckbox.value
20020:                 ? Prefix.text
20021:                 : "" + Stepping.text.indexOf(".") == -1
20022:                   ? String(Number(e + Number(StartFrom.text))).replace(".", ",")
20023:                   : Number(e + Number(StartFrom.text)) + SuffixCheckbox.value
20024:                     ? Suffix.text
20025:                     : "" + r + " ]";
20026:       } else {
20027:         TeoButton.text = "Create Ruler " + r;
20028:       }
20029:     };
20030:     Stepping.onChange = function () {
20031:       this.text = this.text.match(/^[-+]?(?:[0-9]+[,\.])?[0-9]+\+?/g, "");
20032:       if (this.text == "null" || this.text == "" || this.text == 0) {
20033:         this.text = 1;
20034:       }
20035:       this.text = this.text.slice(0, 10);
20036:       InfoFunction();
20037:     };
20038:     StartFrom.onChange = function () {
20039:       this.text = this.text.replace(/[^\d\-]/g, "");
20040:       if (this.text == "") {
20041:         this.text = 0;
20042:       }
20043:       this.text = this.text.slice(0, 10);
20044:       InfoFunction();
20045:     };
20046:     NumbersSize.onChange = function () {
20047:       this.text = this.text.replace(/[^\d+$]/g, "");
20048:       if (this.text == 0) {
20049:         this.text = 1;
20050:       }
20051:       this.text = this.text.slice(0, 4);
20052:     };
20053:     EditTextCopies.onChange = function () {
20054:       CopiesSlider.value = this.text = this.text.replace(/[^\d+$]/g, "");
20055:       if (this.text == 0) {
20056:         CopiesSlider.value = this.text = 1;
20057:       }
20058:     };
20059:     EditTextGap.onChange = function () {
20060:       GapSlider.value = this.text = this.text.replace(/[^\d+$]/g, "");
20061:     };
20062:     EditTextCopies.onChanging = function () {
20063:       CopiesSlider.value = this.text;
20064:       InfoFunction();
20065:     };
20066:     EditTextGap.onChanging = function e() {
20067:       GapSlider.value = this.text;
20068:     };
20069:     Prefix.onChanging = Suffix.onChanging = function () {
20070:       InfoFunction();
20071:     };
20072:     CopiesSlider.onChanging = CopiesSlider.onChange = function () {
20073:       EditTextCopies.text = Math.round(this.value);
20074:       InfoFunction();
20075:     };
20076:     GapSlider.onChanging = GapSlider.onChange = function () {
20077:       EditTextGap.text = Math.round(this.value);
20078:     };
20079:     LinesTypeDropdown.onChange = function () {
20080:       switch (LinesTypeDropdown.selection.index) {
20081:         case 0:
20082:           if (rulerLine.value) {
20083:             rulerType.visible = true;
20084:             rulerType.selection = easyRulers_params.typeOfDivisions;
20085:             rulerTypeDots.visible = false;
20086:             rulerTypeCurvedDots.visible = false;
20087:             rulerTypeCurvedStripes.visible = false;
20088:           } else {
20089:             rulerType.visible = false;
20090:             rulerTypeDots.visible = false;
20091:             rulerTypeCurvedDots.visible = false;
20092:             rulerTypeCurvedStripes.visible = true;
20093:             rulerTypeCurvedStripes.selection =
20094:               easyRulers_params.typeOfDivisions;
20095:           }
20096:           easyRulers_params.shapeOfDivisions = 0;
20097:           break;
20098:         case 1:
20099:           if (rulerLine.value) {
20100:             rulerType.visible = false;
20101:             rulerTypeDots.visible = true;
20102:             rulerTypeDots.selection = easyRulers_params.typeOfDivisions;
20103:             rulerTypeCurvedDots.visible = false;
20104:             rulerTypeCurvedStripes.visible = false;
20105:           } else {
20106:             rulerType.visible = false;
20107:             rulerTypeDots.visible = false;
20108:             rulerTypeCurvedDots.visible = true;
20109:             rulerTypeCurvedDots.selection = easyRulers_params.typeOfDivisions;
20110:             rulerTypeCurvedStripes.visible = false;
20111:           }
20112:           easyRulers_params.shapeOfDivisions = 1;
20113:       }
20114:     };
20115:     SidesTypeCircle.onChange = function () {
20116:       easyRulers_params.sides = SidesType.selection =
20117:         SidesTypeCircle.selection.index;
20118:     };
20119:     SidesType.onChange = function () {
20120:       easyRulers_params.sides = SidesTypeCircle.selection =
20121:         SidesType.selection.index;
20122:     };
20123:     rulerType.onChange =
20124:       rulerTypeDots.onChange =
20125:       rulerTypeCurvedDots.onChange =
20126:       rulerTypeCurvedStripes.onChange =
20127:         function () {
20128:           if (this.selection == null) {
20129:             this.selection = 0;
20130:             easyRulers_params.typeOfDivisions = 0;
20131:             BaseLineDropdown.items[2].enabled = false;
20132:           }
20133:           switch (this.selection.index) {
20134:             case 0:
20135:               divideBy = 1;
20136:               if (BaseLineDropdown.selection.index == 2) {
20137:                 BaseLineDropdown.selection = 0;
20138:               }
20139:               BaseLineDropdown.items[2].enabled = false;
20140:               break;
20141:             case 1:
20142:               divideBy = 2;
20143:               BaseLineDropdown.items[2].enabled = true;
20144:               break;
20145:             case 2:
20146:               divideBy = 5;
20147:               BaseLineDropdown.items[2].enabled = true;
20148:               break;
20149:             case 3:
20150:             case 4:
20151:             case 5:
20152:               divideBy = 10;
20153:               BaseLineDropdown.items[2].enabled = true;
20154:               break;
20155:             case 6:
20156:               if (!FF092D.t()) {
20157:                 divideBy = 12;
20158:                 BaseLineDropdown.items[2].enabled = true;
20159:               } else {
20160:                 this.selection = 0;
20161:                 BaseLineDropdown.items[2].enabled = false;
20162:                 alert(
20163:                   "This feature is not available in trial mode.",
20164:                   "easyRulers alert",
20165:                 );
20166:               }
20167:               break;
20168:             case 7:
20169:             case 8:
20170:               if (!FF092D.t()) {
20171:                 divideBy = 16;
20172:                 BaseLineDropdown.items[2].enabled = true;
20173:               } else {
20174:                 this.selection = 0;
20175:                 BaseLineDropdown.items[2].enabled = false;
20176:                 alert(
20177:                   "This feature is not available in trial mode.",
20178:                   "easyRulers alert",
20179:                 );
20180:               }
20181:           }
20182:           easyRulers_params.typeOfDivisions = this.selection.index;
20183:           InfoFunction();
20184:         };
20185:     BaseLineDropdown.onChange = function () {
20186:       if (BaseLineDropdown.selection == null) {
20187:         BaseLineDropdown.selection = 0;
20188:       }
20189:       easyRulers_params.baseline = BaseLineDropdown.selection.index;
20190:     };
20191:     alignLeft.onClick = function () {
20192:       alignLeft.value = true;
20193:       alignCenter.value = alignRight.value = false;
20194:     };
20195:     alignCenter.onClick = function () {
20196:       alignCenter.value = true;
20197:       alignLeft.value = alignRight.value = false;
20198:     };
20199:     alignRight.onClick = function () {
20200:       alignRight.value = true;
20201:       alignLeft.value = alignCenter.value = false;
20202:     };
20203:     rulerCircle.onClick = function () {
20204:       AnchorGroupCheckBox.enabled = true;
20205:       rulerCircle.value = true;
20206:       SidesTypeCircle.visible = true;
20207:       SidesTypeCircle.selection = SidesType.selection.index;
20208:       SidesType.visible = false;
20209:       rulerLine.value = false;
20210:       rulerTypeDots.visible = false;
20211:       if (LinesTypeDropdown.selection.index == 0) {
20212:         rulerTypeCurvedDots.visible = false;
20213:         rulerTypeCurvedStripes.visible = true;
20214:         rulerTypeCurvedStripes.selection = easyRulers_params.typeOfDivisions;
20215:       } else {
20216:         rulerTypeCurvedDots.visible = true;
20217:         rulerTypeCurvedStripes.visible = false;
20218:         rulerTypeCurvedDots.selection = easyRulers_params.typeOfDivisions;
20219:       }
20220:       easyRulers_params.rulerType = 1;
20221:     };
20222:     rulerLine.onClick = function () {
20223:       AnchorGroupCheckBox.enabled = false;
20224:       rulerLine.value = true;
20225:       SidesType.visible = true;
20226:       SidesType.selection = SidesTypeCircle.selection.index;
20227:       SidesTypeCircle.visible = false;
20228:       rulerCircle.value = false;
20229:       rulerTypeCurvedDots.visible = false;
20230:       rulerTypeCurvedStripes.visible = false;
20231:       if (LinesTypeDropdown.selection.index == 0) {
20232:         rulerType.visible = true;
20233:         rulerTypeDots.visible = false;
20234:         rulerType.selection = easyRulers_params.typeOfDivisions;
20235:       } else {
20236:         rulerType.visible = false;
20237:         rulerTypeDots.visible = true;
20238:         rulerTypeDots.selection = easyRulers_params.typeOfDivisions;
20239:       }
20240:       easyRulers_params.rulerType = 0;
20241:     };
20242:     TeoButton.onClick = function () {
20243:       isTrial = !FF092D.s();
20244:       var e = app.project.activeItem;
20245:       if (e == null || !(e instanceof CompItem)) {
20246:         alert("Please select a comp first!", "easyRulers alert");
20247:       } else {
20248:         var r = Math.floor((Number(EditTextCopies.text) - 1) / divideBy) + 1;
20249:         app.beginUndoGroup("Creation of easyRuler");
20250:         if (!FF092D.t()) {
20251:           if (r > 50 && NumbersCheckBox.value) {
20252:             if (
20253:               confirm(
20254:                 "The settings you have selected will create " +
20255:                   r +
20256:                   " text layers.\n Are you sure you want to continue?",
20257:                 "noAsDefault",
20258:                 "easyRulers",
20259:               ) == true
20260:             ) {
20261:               createRuler();
20262:               rulerCircle.value ? createNumbers_circle() : createNumbers();
20263:             }
20264:           } else {
20265:             createRuler();
20266:             if (NumbersCheckBox.value) {
20267:               rulerCircle.value ? createNumbers_circle() : createNumbers();
20268:             }
20269:           }
20270:         } else {
20271:           if (r > 10 && NumbersCheckBox.value) {
20272:             alert(
20273:               "The settings you have selected will create " +
20274:                 r +
20275:                 " text layers.\nThe trial mode is limited to 10 text layers, max.\n\nPlease reduce the \'Ruler lines\' number or choose a different type of ruler subdivision and try again.",
20276:               "easyRulers alert",
20277:             );
20278:           } else {
20279:             createRuler();
20280:             if (NumbersCheckBox.value) {
20281:               rulerCircle.value ? createNumbers_circle() : createNumbers();
20282:             }
20283:           }
20284:         }
20285:         app.endUndoGroup();
20286:       }
20287:     };
20288:     ResetButton.onClick = function () {
20289:       isTrial = !FF092D.s();
20290:       easyRulers_params.rulerType = 0;
20291:       easyRulers_params.sides = 0;
20292:       easyRulers_params.baseline = 0;
20293:       easyRulers_params.shapeOfDivisions = 0;
20294:       easyRulers_params.typeOfDivisions = 4;
20295:       easyRulers_params.enableNumbers = 0;
20296:       easyRulers_params.enableTracking = 0;
20297:       MainColorRGB.red =
20298:         MainColorRGB.green =
20299:         MainColorRGB.blue =
20300:         NumbersColorRGB.red =
20301:         NumbersColorRGB.green =
20302:         NumbersColorRGB.blue =
20303:         BigColorRGB.red =
20304:         BigColorRGB.green =
20305:         BigColorRGB.blue =
20306:         HalfColorRGB.red =
20307:         HalfColorRGB.green =
20308:         HalfColorRGB.blue =
20309:         QuarterColorRGB.red =
20310:         QuarterColorRGB.green =
20311:         QuarterColorRGB.blue =
20312:         HalfColorRGB.blue =
20313:         EighthsColorRGB.red =
20314:         EighthsColorRGB.green =
20315:         EighthsColorRGB.blue =
20316:         PointerColorRGB.red =
20317:         PointerColorRGB.green =
20318:         PointerColorRGB.blue =
20319:           255;
20320:       divideBy = 10;
20321:       myDecColor1 =
20322:         myDecColor2 =
20323:         myDecColor3 =
20324:         myDecColor4 =
20325:         myDecColor5 =
20326:         myDecColor6 =
20327:           16777215;
20328:       ruler = 0;
20329:       shapeLayer = "";
20330:       labelColor = 0;
20331:       var e = new Shape();
20332:       e.vertices = [
20333:         [0, 250],
20334:         [-250, 0],
20335:         [0, -250],
20336:         [250, 0],
20337:       ];
20338:       e.inTangents = [
20339:         [138.071182250977, 0],
20340:         [0, 138.071182250977],
20341:         [-138.071166992188, 0],
20342:         [0, -138.071166992188],
20343:       ];
20344:       e.outTangents = [
20345:         [-138.071166992188, 0],
20346:         [0, -138.071166992188],
20347:         [138.071182250977, 0],
20348:         [0, 138.071182250977],
20349:       ];
20350:       e.closed = true;
20351:       EditTextCopies.text = 51;
20352:       CopiesSlider.value = 51;
20353:       EditTextGap.text = 15;
20354:       GapSlider.value = 15;
20355:       rulerLine.value = true;
20356:       rulerCircle.value = false;
20357:       SidesType.visible = true;
20358:       SidesTypeCircle.visible = false;
20359:       SidesType.selection = 0;
20360:       BaseLineDropdown.selection = 0;
20361:       LinesTypeDropdown.selection = 0;
20362:       tempDistance = 0;
20363:       rulerTypeDots.visible =
20364:         rulerTypeCurvedDots.visible =
20365:         rulerTypeCurvedStripes.visible =
20366:           false;
20367:       rulerType.visible = true;
20368:       rulerType.selection = 4;
20369:       easyRulers_params = {
20370:         baseline: 0,
20371:         enableNumbers: 0,
20372:         enableTracking: 0,
20373:         rulerType: 0,
20374:         shapeOfDivisions: 0,
20375:         sides: 0,
20376:         typeOfDivisions: 4,
20377:       };
20378:       if (NumbersCheckBox.value == false) {
20379:         NumbersCheckBox.value = true;
20380:         NumbersCheckBox.onClick();
20381:       }
20382:       NumbersColor.fillBrush = NumbersColor.graphics.newBrush(
20383:         NumbersColor.graphics.BrushType.SOLID_COLOR,
20384:         [
20385:           MainColorRGB.red / 255,
20386:           MainColorRGB.green / 255,
20387:           MainColorRGB.blue / 255,
20388:           1,
20389:         ],
20390:       );
20391:       NumbersColor.onDraw = fillRect;
20392:       Prefix.text = "> ";
20393:       Prefix.enabled = false;
20394:       PrefixCheckbox.value = false;
20395:       StartFrom.text = 0;
20396:       NumbersSize.text = 50;
20397:       Stepping.text = 1;
20398:       SuffixCheckbox.value = false;
20399:       Suffix.text = " mm";
20400:       Suffix.enabled = false;
20401:       AlignGroup.enabled = true;
20402:       AnchorGroupCheckBox.value = false;
20403:       AnchorGroupCheckBox.enabled = false;
20404:       alignCenter.value = true;
20405:       alignLeft.value = false;
20406:       alignRight.value = false;
20407:       PB.value = 0;
20408:       ShyTextLayers.value = false;
20409:       InfoFunction();
20410:       writeLn("easyRulers reset to defaults");
20411:     };
20412:     NumbersCheckBox.onClick = function () {
20413:       if (NumbersCheckBox.value) {
20414:         easyRulers_params.enableNumbers = 0;
20415:         NumbersColor.enabled =
20416:           NumbersColorLabel.enabled =
20417:           NumbersSize.enabled =
20418:           NumbersSizeLabel.enabled =
20419:           StartFrom.enabled =
20420:           StartFromLabel.enabled =
20421:           Stepping.enabled =
20422:           AlignGroup.enabled =
20423:           ShyTextLayers.enabled =
20424:           SteppingLabel.enabled =
20425:             true;
20426:         if (rulerCircle.value) {
20427:           AnchorGroupCheckBox.enabled = true;
20428:         }
20429:         if (PrefixCheckbox.value) {
20430:           Prefix.enabled = true;
20431:         }
20432:         if (SuffixCheckbox.value) {
20433:           Suffix.enabled = true;
20434:         }
20435:         PrefixCheckbox.enabled = SuffixCheckbox.enabled = true;
20436:         NumbersColor.fillBrush = NumbersColor.graphics.newBrush(
20437:           NumbersColor.graphics.BrushType.SOLID_COLOR,
20438:           [
20439:             NumbersColorRGB.red / 255,
20440:             NumbersColorRGB.green / 255,
20441:             NumbersColorRGB.blue / 255,
20442:             1,
20443:           ],
20444:         );
20445:       } else {
20446:         easyRulers_params.enableNumbers = 1;
20447:         NumbersColor.enabled =
20448:           NumbersColorLabel.enabled =
20449:           NumbersSize.enabled =
20450:           NumbersSizeLabel.enabled =
20451:           StartFrom.enabled =
20452:           StartFromLabel.enabled =
20453:           Stepping.enabled =
20454:           SteppingLabel.enabled =
20455:           Prefix.enabled =
20456:           Suffix.enabled =
20457:           AlignGroup.enabled =
20458:           PrefixCheckbox.enabled =
20459:           SuffixCheckbox.enabled =
20460:           ShyTextLayers.enabled =
20461:           AnchorGroupCheckBox.enabled =
20462:             false;
20463:         NumbersColor.fillBrush = NumbersColor.graphics.newBrush(
20464:           NumbersColor.graphics.BrushType.SOLID_COLOR,
20465:           [0.5, 0.5, 0.5, 1],
20466:         );
20467:       }
20468:       NumbersColor.onDraw = fillRect;
20469:       InfoFunction();
20470:     };
20471:     PrefixCheckbox.onClick = function () {
20472:       Prefix.enabled = this.value ? true : false;
20473:       InfoFunction();
20474:     };
20475:     SuffixCheckbox.onClick = function () {
20476:       Suffix.enabled = this.value ? true : false;
20477:       InfoFunction();
20478:     };
20479:     NumbersColor.onClick = function () {
20480:       setColor(this, NumbersColorRGB);
20481:     };
20482:     mainPalette.layout.layout(true);
20483:     mainPalette.layout.resize();
20484:     mainPalette.onResizing = mainPalette.onResize = function () {
20485:       mainPalette.layout.resize();
20486:     };
20487:     if (checkIfInstalled() == false) {
20488:       alert(
20489:         "The " + $.os.indexOf("Windows") == 0
20490:           ? "easyRulers.aex"
20491:           : "easyRulers.plugin" +
20492:                 " file could not be detected in your After Effects Plug-ins folder. Please, copy the " +
20493:                 $.os.indexOf("Windows") ==
20494:               0
20495:             ? "easyRulers.aex"
20496:             : "easyRulers.plugin" +
20497:               " file (that is included in the .ZIP file you\'ve downloaded), into your After Effects Plug-ins directory and then restart After Effects.",
20498:         "easyRulers",
20499:       );
20500:     } else {
20501:       if (!(mainPalette instanceof Panel)) {
20502:         mainPalette.show();
20503:       }
20504:     }
20505:   }
20506: }
20507: easyRulers(this);
```

## File: Aescripts-Faux Parent 1.1/Faux Parent.jsx
```javascript
   1: /*
   2:  * Decompiled with Jsxer
   3:  * Version: 1.7.4
   4:  * JSXBIN 2.0
   5:  */
   6: 
   7: var ab_settings = {
   8:   doUpdateCheck: false,
   9:   helpText:
  10:     "Faux Parent allows you to choose which transformed property is parented. You can also control the level of influence and/or delay the child.\n\nTo apply Faux Parent, select a layer that you want to make the child. Select the property of interest and click Apply. Choose your parent layer using the drop-down menu in the Effects Control Panel. Using the drop-down menu, choose the Parent Type. Be aware, your child layer\'s transform values may change during this step. Click the Sync button to finish the parenting process. Any transform values changed while selecting your Parent Type will be restored to the orignal values.\n\nYou can choose your parent layer while applying Faux Parent. Selecting your parent prior to applying Faux Parent will turn on Auto Sync and the Sycing step can be skipped. To select your parent layer, type in the layer index value of the parent in the Parent Index field. For example, if the parent layer is layer five, type the value 5 in the box.\n\n For more informatino, view the video overview at https://vimeo.com/767531610",
  11:   offerTrial: true,
  12:   privateNumber: 67889221,
  13:   productSKU: "FMFP-SUL",
  14:   scriptAuthor: "Kevin Snyder",
  15:   scriptName: "Faux Parent",
  16:   scriptURL: "https://aescripts.com/faux-parent",
  17:   scriptVersion: "1.1",
  18: };
  19: function b(vars) {
  20:   function licUI() {
  21:     var licPal = new Window(
  22:       "dialog",
  23:       strTrialWelcomeHeader + " - " + strVersion + " " + strScriptVersion,
  24:       undefined,
  25:       { resizeable: true },
  26:     );
  27:     if (licPal != null) {
  28:       var res =
  29:         "group { \n\t\t\t\torientation: \'column\', \n\t\t\t\talignment: [\'fill\',\'fill\'], \n\t\t\t\talignChildren: [\'fill\',\'fill\'], \n\t\t\t\t\tinfoGrp: Group { \n\t\t\t\t\talignment: [\'fill\',\'top\'], \n\t\t\t\t\talignChildren: [\'fill\',\'fill\'], \n\t\t\t\t\torientation: \'column\', \n\t\t\t\t\t\thdrGrp: Group {\n\t\t\t\t\t\t\ttxt: StaticText {}, \n\t\t\t\t\t\t\tpaste: StaticText {}, \n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrial: StaticText {}, \n\t\t\t\t\t} \n\t\t\t\t\tlicGrp: Group { \n\t\t\t\t\t\ttxt: EditText {alignment: [\'fill\',\'fill\'], properties:{multiline:false}}, \n\t\t\t\t\t} \n\t\t\t\t\tokGrp: Group { \n\t\t\t\t\talignment: [\'fill\',\'bottom\'], \n\t\t\t\t\talignChildren: [\'fill\',\'fill\'], \n                            buyGrp: Group { \n                            alignment: [\'left\',\'fill\'], \n                            alignChildren: [\'left\',\'fill\'], \n                            orientation: \'column\', \n                            spacing:5,\n                                retrieveReg: Button {text:\'" +
  30:         strRetrieveLic.replace(/%t/, strLicense) +
  31:         "\', name:\'retrieve\',preferredSize:[130,25]}\n                                buyLic: Button {text:\'" +
  32:         strBuyLic.replace(/%t/, strLicense) +
  33:         "\', name:\'buy\',preferredSize:[130,25]}\n                                }\n\t\t\t\t\t\tcancelBtn: Button {text:\'" +
  34:         strCancel +
  35:         "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \n\t\t\t\t\t\tokBtn: Button {text:\'" +
  36:         strOK +
  37:         "\', name: \'ok\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \n\t\t\t\t\t} \n\t\t\t\t}";
  38:       licPal.grp = licPal.add(res);
  39:       var boldFont = ScriptUI.newFont(
  40:         "dialog || palette",
  41:         ScriptUI.FontStyle.BOLD,
  42:         12,
  43:       );
  44:       var smallFont = ScriptUI.newFont(
  45:         "dialog || palette",
  46:         ScriptUI.FontStyle.REGULAR,
  47:         9,
  48:       );
  49:       licPal.grp.licGrp.txt.preferredSize = [600, 30];
  50:       licPal.grp.infoGrp.hdrGrp.txt.text = strEnterLicenseCode;
  51:       licPal.grp.infoGrp.hdrGrp.txt.graphics.font = boldFont;
  52:       licPal.grp.infoGrp.hdrGrp.paste.text = "";
  53:       licPal.grp.infoGrp.hdrGrp.paste.graphics.font = smallFont;
  54:       licPal.grp.infoGrp.trial.text =
  55:         betaMode || !offerTrial ? "" : strTrialInstructMsg;
  56:       if (isServerConfigured(licenseValidity)) {
  57:         if (isServerRunning(licenseValidity)) {
  58:           licPal.grp.infoGrp.hdrGrp.txt.text = strServerInstructMsg;
  59:           licPal.grp.infoGrp.trial.text = strTrialInstructMsg;
  60:         } else {
  61:           licPal.grp.infoGrp.hdrGrp.txt.text =
  62:             strEnterLicenseCode + " " + strServerNotRunning;
  63:           licPal.grp.infoGrp.trial.text =
  64:             betaMode || !offerTrial ? "" : strTrialInstructMsg;
  65:         }
  66:       }
  67:       licPal.grp.licGrp.txt.text = betaMode || !offerTrial ? "" : "trial";
  68:       if (
  69:         isServerConfigured(licenseValidity) &&
  70:         isServerRunning(licenseValidity)
  71:       ) {
  72:         licPal.grp.licGrp.txt.text = "@REMOTE";
  73:       }
  74:       licPal.grp.okGrp.buyGrp.retrieveReg.visible =
  75:         licPal.grp.okGrp.buyGrp.buyLic.visible = !betaMode;
  76:       licPal.grp.okGrp.buyGrp.buyLic.onClick = function () {
  77:         openURL(strTrialUrl);
  78:         licPal.close(false);
  79:       };
  80:       licPal.grp.okGrp.buyGrp.retrieveReg.onClick = function () {
  81:         var title = strRetrieveLic.replace(/%t/, strLicense);
  82:         var txt = strLicenseDownloadOptions.replace(
  83:           /%t/,
  84:           strLicenses.toLowerCase(),
  85:         );
  86:         alertButtonsUI(
  87:           title,
  88:           txt,
  89:           { name: strMyDownloads, url: retrieveUrl },
  90:           { name: strDownloadManager, url: managerAppUrl },
  91:         );
  92:         licPal.close(false);
  93:       };
  94:       licPal.grp.okGrp.cancelBtn.onClick = function () {
  95:         licPal.close(false);
  96:       };
  97:       licPal.grp.okGrp.okBtn.onClick = function () {
  98:         license = licPal.grp.licGrp.txt.text
  99:           .replace(/^\s\s*/, "")
 100:           .replace(/\s\s*$/, "");
 101:         licPal.close(true);
 102:       };
 103:       licPal.layout.layout(true);
 104:       licPal.layout.resize();
 105:       licPal.onResizing = licPal.onResize = function () {
 106:         this.layout.resize();
 107:       };
 108:       return licPal;
 109:     }
 110:   }
 111:   function alertButtonsUI(title, txt, btn1, btn2) {
 112:     var updPal = new Window(
 113:       "dialog",
 114:       strScriptName + " v" + strScriptVersion,
 115:       undefined,
 116:       { resizeable: true },
 117:     );
 118:     if (updPal != null) {
 119:       var res =
 120:         "group { \n\t\t\t\torientation: \'column\', \n\t\t\t\talignment: [\'fill\',\'fill\'], \n\t\t\t\talignChildren: [\'fill\',\'fill\'], \n                    titleGrp: Group { \n                        orientation: \'column\', \n                        alignment: [\'fill\',\'fill\'], \n                        alignChildren: [\'fill\',\'fill\'], \n                        margins: 1, \n                        titleInnerGrp: Group { \n                            orientation: \'column\', \n                            alignment: [\'fill\',\'fill\'], \n                            alignChildren: [\'fill\',\'fill\'], \n                            margins: 5, \n                                title: StaticText {alignment: [\'fill\',\'top\'], minimumSize:[400,-1], properties:{multiline:false}},\n                                }, \n                            }, \n                    detailGrp: Group { \n                        orientation: \'column\', \n                        alignment: [\'fill\',\'fill\'], \n                        alignChildren: [\'fill\',\'fill\'], \n                                detail: StaticText {alignment: [\'fill\',\'top\'], properties:{multiline:true} },\n                                }, \n                    buttonsGrp: Group { \n                        alignment: [\'fill\',\'bottom\'], \n                        alignChildren: [\'fill\',\'fill\'], \n                            btn1: Button {text:\'" +
 121:         btn1.name +
 122:         "\', minimumSize:[-1,30], alignment: [\'right\',\'center\']}, \n                            btn2: Button {text:\'" +
 123:         btn2.name +
 124:         "\', name: \'ok\', minimumSize:[-1,30], alignment: [\'right\',\'center\']}, \n                        }, \n\t\t\t\t}";
 125:       updPal.grp = updPal.add(res);
 126:       updPal.grp.titleGrp.graphics.backgroundColor = updPal.graphics.newBrush(
 127:         updPal.graphics.BrushType.THEME_COLOR,
 128:         "focusRing",
 129:         1,
 130:       );
 131:       updPal.grp.titleGrp.titleInnerGrp.graphics.backgroundColor =
 132:         updPal.graphics.newBrush(
 133:           updPal.graphics.BrushType.THEME_COLOR,
 134:           "background",
 135:           1,
 136:         );
 137:       updPal.grp.titleGrp.titleInnerGrp.title.text = title;
 138:       updPal.grp.detailGrp.detail.text = txt;
 139:       if (
 140:         (btn1.name == strGetHelp && btn1.url == undefined) ||
 141:         btn1.url == ""
 142:       ) {
 143:         updPal.grp.buttonsGrp.btn1.visible = false;
 144:       }
 145:       updPal.grp.buttonsGrp.btn1.onClick = function () {
 146:         if (
 147:           btn1.hasOwnProperty("url") &&
 148:           btn1.url != undefined &&
 149:           btn1.url != ""
 150:         ) {
 151:           openURL(btn1.url);
 152:         }
 153:         updPal.close(false);
 154:       };
 155:       if (
 156:         (btn2.name == strGetHelp && btn2.url == undefined) ||
 157:         btn2.url == ""
 158:       ) {
 159:         updPal.grp.buttonsGrp.btn2.visible = false;
 160:       }
 161:       updPal.grp.buttonsGrp.btn2.onClick = function () {
 162:         if (
 163:           btn2.hasOwnProperty("url") &&
 164:           btn2.url != undefined &&
 165:           btn2.url != ""
 166:         ) {
 167:           openURL(btn2.url);
 168:         }
 169:         updPal.close(false);
 170:       };
 171:       updPal.layout.layout(true);
 172:       updPal.layout.resize();
 173:       updPal.onResizing = updPal.onResize = function () {
 174:         this.layout.resize();
 175:       };
 176:       updPal.show();
 177:     }
 178:   }
 179:   function checkBeta(betaExpiration, betaStart) {
 180:     return new Date() < betaStart || new Date() > betaExpiration;
 181:   }
 182:   function helpUI() {
 183:     var helpPal = new Window(
 184:       "dialog",
 185:       strScriptName + " - " + strVersion + " " + strScriptVersion,
 186:       undefined,
 187:       { resizeable: true },
 188:     );
 189:     if (helpPal != null) {
 190:       var panel_alignment =
 191:         $.os.indexOf("Windows") != -1 &&
 192:         parseFloat(app.version) >= 12 &&
 193:         parseFloat(app.version) < 14
 194:           ? ["left", "top"]
 195:           : ["fill", "fill"];
 196:       var res =
 197:         "group { \n\t\torientation: \'column\', \n\t\talignment: [\'" +
 198:         panel_alignment[0] +
 199:         "\',\'" +
 200:         panel_alignment[1] +
 201:         "\'], \n\t\talignChildren: [\'fill\',\'fill\'], \n                   infoGrp: Group { \n                   alignment: [\'fill\',\'top\'], \n                   alignChildren: [\'fill\',\'top\'], \n\t\t\t\t\ttxt: StaticText {properties:{multiline:true}, preferredSize:[150,50]}, \n                      hdr: StaticText {properties:{multiline:true}}, \n                      removeLic: Button {text:\'" +
 202:         strDeactivate +
 203:         "\', preferredSize:[40,30]} \n\t\t\t\t} \n\t\t\t\thelpGrp: Group { \n                   alignment: [\'" +
 204:         panel_alignment[0] +
 205:         "\',\'" +
 206:         panel_alignment[1] +
 207:         "\'], \n                   alignChildren: [\'fill\',\'fill\'], \n                    txt: EditText {properties:{multiline:true, readonly:true}}, \n\t\t\t\t} \n                prefsGrp: Group {\n                       alignment: [\'fill\',\'bottom\'], \n                       alignChildren: [\'left\',\'center\'], \n                       orientation: \'row\', \n                       checkNow: Button {text:\'" +
 208:         strCheckNow +
 209:         "\', preferredSize:[150,25]} \n                       doUpdateCheck: Checkbox {text:\'" +
 210:         strVersionCheck +
 211:         "\', preferredSize:[-1,25]} \n                       }\n\t\t\tokGrp: Group { \n                alignment: [\'fill\',\'bottom\'], \n                alignChildren: [\'fill\',\'center\'], \n                supportBtn: Button {text:\'" +
 212:         strGetSupport +
 213:         "\', preferredSize:[150,30], alignment: [\'left\',\'center\']} \n                ";
 214:       for (
 215:         var i = 0;
 216:         i < Math.min(maxUIButtons, vars.helpButtons.length);
 217:         i += 1
 218:       ) {
 219:         if (vars.helpButtons[i].hasOwnProperty("name")) {
 220:           var btnType =
 221:             vars.helpButtons[i].hasOwnProperty("type") &&
 222:             validateButtonType(vars.helpButtons[i].type)
 223:               ? vars.helpButtons[i].type
 224:               : "Button";
 225:           res +=
 226:             "btn" +
 227:             i +
 228:             ": " +
 229:             btnType +
 230:             " {id: \'" +
 231:             i +
 232:             "\', alignment: [\'left\',\'center\']}";
 233:         }
 234:       }
 235:       res +=
 236:         "\n\t\t\t\t\tokBtn: Button {text:\'" +
 237:         strOK +
 238:         "\', preferredSize:[150,30], alignment: [\'right\',\'center\']} \n\t\t\t\t} \n\t\t}";
 239:       helpPal.grp = helpPal.add(res);
 240:       helpPal.grp.helpGrp.txt.preferredSize = [800, 500];
 241:       var currentYear = "\xa9" + (new Date().getYear() + 1900).toString();
 242:       helpPal.grp.infoGrp.txt.text =
 243:         strScriptName +
 244:         " - " +
 245:         strVersion +
 246:         " " +
 247:         strScriptVersion +
 248:         "\n" +
 249:         currentYear +
 250:         " " +
 251:         vars.scriptAuthor +
 252:         "\n\n";
 253:       helpPal.grp.infoGrp.hdr.text = getRegistration();
 254:       helpPal.grp.helpGrp.txt.text = vars.helpText;
 255:       if (haveSettings(prefsSectionName, prefsDoUpdateCheck)) {
 256:         doUpdateCheck = !(
 257:           getSettings(prefsSectionName, prefsDoUpdateCheck) == "false"
 258:         );
 259:       }
 260:       helpPal.grp.prefsGrp.doUpdateCheck.value = doUpdateCheck;
 261:       helpPal.grp.prefsGrp.doUpdateCheck.onClick = function () {
 262:         setUpdateCheck(this.value);
 263:       };
 264:       helpPal.grp.prefsGrp.checkNow.onClick = function () {
 265:         if (ScriptUI.environment.keyboardState.altKey) {
 266:           alert("aescripts licensing framework version\n" + licensingVersion);
 267:           return;
 268:         }
 269:         doUpdateCheckNow();
 270:       };
 271:       for (
 272:         var i = 0;
 273:         i < Math.min(maxUIButtons, vars.helpButtons.length);
 274:         i += 1
 275:       ) {
 276:         if (vars.helpButtons[i].hasOwnProperty("name")) {
 277:           helpPal.grp.okGrp["btn" + i].text = vars.helpButtons[i].name;
 278:           if (vars.helpButtons[i].hasOwnProperty("helpTip")) {
 279:             helpPal.grp.okGrp["btn" + i].helpTip = vars.helpButtons[i].helpTip;
 280:           }
 281:           if (vars.helpButtons[i].hasOwnProperty("url")) {
 282:             helpPal.grp.okGrp["btn" + i].onClick = function () {
 283:               openURL(vars.helpButtons[this.id].url);
 284:             };
 285:           } else {
 286:             if (vars.helpButtons[i].hasOwnProperty("onClickFunction")) {
 287:               helpPal.grp.okGrp["btn" + i].onClick =
 288:                 vars.helpButtons[i].onClickFunction;
 289:             }
 290:             if (vars.helpButtons[i].hasOwnProperty("btnValue")) {
 291:               helpPal.grp.okGrp["btn" + i].value = vars.helpButtons[i].btnValue;
 292:             }
 293:           }
 294:         }
 295:       }
 296:       helpPal.grp.infoGrp.removeLic.visible = !isResultTrial(
 297:         licenseValidity.result,
 298:       );
 299:       helpPal.grp.infoGrp.removeLic.onClick = function () {
 300:         if (removeLic()) {
 301:           helpPal.grp.infoGrp.hdr.text = getRegistration();
 302:           this.visible = false;
 303:         }
 304:       };
 305:       helpPal.grp.okGrp.supportBtn.onClick = function () {
 306:         if (
 307:           ScriptUI.environment.keyboardState.shiftKey &&
 308:           ScriptUI.environment.keyboardState.altKey
 309:         ) {
 310:           alert(
 311:             "aescripts + aeplugins\nFramework version: " +
 312:               licensingVersion +
 313:               "\n" +
 314:               strScriptName +
 315:               " - " +
 316:               strVersion +
 317:               " " +
 318:               strScriptVersion,
 319:           );
 320:         } else {
 321:           createSupportTicket({});
 322:           helpPal.close();
 323:         }
 324:       };
 325:       helpPal.grp.okGrp.okBtn.onClick = function () {
 326:         helpPal.close();
 327:       };
 328:       if (
 329:         $.os.indexOf("Windows") != -1 &&
 330:         parseFloat(app.version) >= 12 &&
 331:         parseFloat(app.version) < 14
 332:       ) {
 333:         helpPal.maximumSize = [840, 670];
 334:       }
 335:       helpPal.layout.layout(true);
 336:       helpPal.layout.resize();
 337:       helpPal.onResizing = helpPal.onResize = function () {
 338:         this.layout.resize();
 339:       };
 340:       helpPal.show();
 341:     }
 342:   }
 343:   function validateButtonType(type) {
 344:     return type === "Button" || type === "Checkbox";
 345:   }
 346:   function createSupportTicket(options, open) {
 347:     if (open == undefined) {
 348:       open = true;
 349:     }
 350:     message = diagnostic = "";
 351:     subject = "&subject=";
 352:     if (options != undefined && typeof options != "undefined") {
 353:       if (options.hasOwnProperty("subject")) {
 354:         subject += File.encode(options.subject);
 355:       }
 356:       if (options.hasOwnProperty("message")) {
 357:         message = File.encode(options.message);
 358:       }
 359:       if (options.hasOwnProperty("diagnostic")) {
 360:         diagnostic = File.encode(options.diagnostic + "\n--\n");
 361:       }
 362:     }
 363:     var middle =
 364:       isAescriptsSupportUrl === true
 365:         ? supportTicketSKU == ""
 366:           ? strSKU
 367:           : supportTicketSKU + subject + "&message="
 368:         : subject.replace(/\&/, "?") + "&body=";
 369:     var end =
 370:       middle != ""
 371:         ? message +
 372:           "%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A-------%0D%0A" +
 373:           diagnostic +
 374:           getDiagnosticData(true)
 375:         : "";
 376:     if (
 377:       supportUrl.toString().match(/@/) &&
 378:       !supportUrl.toString().match(/^mailto:/)
 379:     ) {
 380:       supportUrl = "mailto:" + supportUrl;
 381:     }
 382:     var sendUrl = supportUrl + middle + end;
 383:     if (open) {
 384:       openURL(sendUrl);
 385:     } else {
 386:       return sendUrl;
 387:     }
 388:   }
 389:   function getDiagnosticData(encode) {
 390:     var os =
 391:       $.os.indexOf("Windows") != -1
 392:         ? $.os.toString()
 393:         : "macOS " + systemCall("sw_vers -productVersion").replace(/\n$/, "");
 394:     var currentApp =
 395:       BridgeTalk.getDisplayName(BridgeTalk.appName) +
 396:       " (" +
 397:       app.version +
 398:       ") - " +
 399:       $.locale.toString();
 400:     var scriptVersion =
 401:       strScriptName.replace(/&/, "and") + " - v" + strScriptVersion;
 402:     var lastServerVersionChecked =
 403:       "Last checked server version: " +
 404:       haveSettings(prefsSectionName, prefsLastServerVersionChecked)
 405:         ? getSettings(prefsSectionName, prefsLastServerVersionChecked)
 406:         : "n/a";
 407:     var licensingFrameworkVersion =
 408:       "Lic. fw v" + licensingVersion + isVT() ? " (Trial)" : "";
 409:     return encode
 410:       ? File.encode(scriptVersion) +
 411:           "%0D%0A" +
 412:           File.encode(os) +
 413:           "%0D%0A" +
 414:           File.encode(currentApp) +
 415:           "%0D%0A" +
 416:           File.encode(licensingFrameworkVersion) +
 417:           "%0D%0A" +
 418:           File.encode(lastServerVersionChecked)
 419:       : scriptVersion +
 420:           "\n" +
 421:           os +
 422:           "\n" +
 423:           currentApp +
 424:           "\n" +
 425:           licensingFrameworkVersion +
 426:           "\n" +
 427:           lastServerVersionChecked;
 428:   }
 429:   function setUpdateCheck(val) {
 430:     doUpdateCheck = val;
 431:     saveSettings(prefsSectionName, prefsDoUpdateCheck, val);
 432:   }
 433:   function doUpdateCheckNow() {
 434:     doUpdateCheck = true;
 435:     checkForNewVersion(true);
 436:   }
 437:   function newVersionUI(newVersion) {
 438:     var updPal = new Window("dialog", strNewVersionAvailableHdr, undefined, {
 439:       resizeable: true,
 440:     });
 441:     if (updPal != null) {
 442:       var res =
 443:         "group { \n\t\t\t\torientation: \'column\', \n\t\t\t\talignment: [\'fill\',\'fill\'], \n\t\t\t\talignChildren: [\'fill\',\'fill\'], \n\t\t\t\t   hdrGrp: Group { \n\t\t\t\t   alignment: [\'fill\',\'fill\'], \n\t\t\t\t   alignChildren: [\'fill\',\'fill\'], \n\t\t\t\t   orientation: \'column\', \n                        hdr: StaticText {alignment: [\'fill\',\'top\'], properties:{multiline:true}}, ";
 444:       if (newVersion.hasOwnProperty("header")) {
 445:         res +=
 446:           "   infoGrp: Panel { \n                           alignment: [\'fill\',\'fill\'], \n                           alignChildren: [\'fill\',\'fill\'], \n                           orientation: \'column\', \n                              info: StaticText {properties:{multiline:true}}, \n                              } ";
 447:       }
 448:       res +=
 449:         "} \n\t\t\t\t\tokGrp: Group { \n\t\t\t\t\talignment: [\'fill\',\'bottom\'], \n\t\t\t\t\talignChildren: [\'fill\',\'fill\'], \n\t\t\t\t\t\tskipVersionBtn: Button {text:\'" +
 450:         strSkipVersion +
 451:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \n                        remindMeLaterBtn: Button {text:\'" +
 452:         strRemindMeLater +
 453:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \n\t\t\t\t\t\tdownloadBtn: Button {text:\'" +
 454:         strDownload +
 455:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \n\t\t\t\t\t} \n\t\t\t\t}";
 456:       updPal.grp = updPal.add(res);
 457:       var boldFont = ScriptUI.newFont(
 458:         "dialog || palette",
 459:         ScriptUI.FontStyle.BOLD,
 460:         12,
 461:       );
 462:       var boldFontSm = ScriptUI.newFont(
 463:         "dialog || palette",
 464:         ScriptUI.FontStyle.BOLD,
 465:         11,
 466:       );
 467:       var smallFont = ScriptUI.newFont(
 468:         "dialog || palette",
 469:         ScriptUI.FontStyle.REGULAR,
 470:         9,
 471:       );
 472:       updPal.grp.hdrGrp.hdr.graphics.font = boldFont;
 473:       updPal.grp.hdrGrp.hdr.text =
 474:         strNewVersionAvailable.replace(/%v/, newVersion.version) +
 475:         "\n" +
 476:         strCurrentVersion.replace(/%v/, strScriptVersion);
 477:       if (newVersion.hasOwnProperty("header")) {
 478:         updPal.grp.hdrGrp.infoGrp.info.text =
 479:           newVersion.header + "\n\n" + newVersion.detail;
 480:       }
 481:       saveSettings(
 482:         prefsSectionName,
 483:         prefsLastServerVersionChecked,
 484:         newVersion.version,
 485:       );
 486:       updPal.grp.okGrp.skipVersionBtn.onClick = function () {
 487:         saveSettings(
 488:           prefsSectionName,
 489:           prefsLastVersionChecked,
 490:           strScriptVersion,
 491:         );
 492:         saveSettings(
 493:           prefsSectionName,
 494:           prefsLastTimeVersionChecked,
 495:           new Date().toString(),
 496:         );
 497:         saveSettings(
 498:           prefsSectionName,
 499:           prefsNextTimeVersionCheckedSkipVersion,
 500:           newVersion.version,
 501:         );
 502:         saveSettings(
 503:           prefsSectionName,
 504:           prefsLastServerVersionChecked,
 505:           newVersion.version,
 506:         );
 507:         updPal.close(false);
 508:       };
 509:       updPal.grp.okGrp.remindMeLaterBtn.onClick = function () {
 510:         try {
 511:           var newDate = new Date();
 512:           newDate = dateAddDays(remindMeLaterDays);
 513:           saveSettings(
 514:             prefsSectionName,
 515:             prefsLastVersionChecked,
 516:             strScriptVersion,
 517:           );
 518:           saveSettings(
 519:             prefsSectionName,
 520:             prefsLastTimeVersionChecked,
 521:             new Date().toString(),
 522:           );
 523:           saveSettings(
 524:             prefsSectionName,
 525:             prefsNextTimeVersionChecked,
 526:             newDate.toString(),
 527:           );
 528:           saveSettings(
 529:             prefsSectionName,
 530:             prefsLastServerVersionChecked,
 531:             newVersion.version,
 532:           );
 533:           updPal.close(false);
 534:         } catch (e) {
 535:           alert(e.toString());
 536:         }
 537:       };
 538:       updPal.grp.okGrp.downloadBtn.onClick = function () {
 539:         var title = strRetrieveLic.replace(/%t/, strLicense);
 540:         var txt = strLicenseDownloadOptions.replace(
 541:           /%t/,
 542:           strDownloads.toLowerCase(),
 543:         );
 544:         alertButtonsUI(
 545:           title,
 546:           txt,
 547:           { name: strMyDownloads, url: retrieveUrl },
 548:           { name: strDownloadManager, url: managerAppUrl },
 549:         );
 550:         updPal.close(true);
 551:       };
 552:       updPal.layout.layout(true);
 553:       updPal.layout.resize();
 554:       updPal.onResizing = updPal.onResize = function () {
 555:         this.layout.resize();
 556:       };
 557:       if (newVersion.hasOwnProperty("header")) {
 558:         updPal.grp.hdrGrp.infoGrp.size.height = Math.min(
 559:           updPal.grp.hdrGrp.infoGrp.size.height,
 560:           300,
 561:         );
 562:         updPal.layout.layout(true);
 563:         updPal.layout.resize();
 564:       }
 565:       updPal.show();
 566:     }
 567:   }
 568:   function dateAddDays(days) {
 569:     var ms = new Date().getTime() + 86400000 * days;
 570:     var added = new Date(ms);
 571:     return added;
 572:   }
 573:   function checkForNewVersion(checkNow) {
 574:     function showNewVersionUI(versionDifference) {
 575:       return (
 576:         (versionDifference > 0 && lastVersionChecked == undefined) ||
 577:         lastTimeVersionChecked == undefined ||
 578:         nextTimeVersionChecked == undefined ||
 579:         checkNow ||
 580:         currentTime >= nextTimeVersionChecked
 581:       );
 582:     }
 583:     return;
 584:     checkNow = false;
 585:     if (!doUpdateCheck) {
 586:       return;
 587:     }
 588:     if (haveSettings(prefsSectionName, prefsLastVersionChecked)) {
 589:       return;
 590:     }
 591:     if (haveSettings(prefsSectionName, prefsLastServerVersionChecked)) {
 592:       return;
 593:     }
 594:     if (haveSettings(prefsSectionName, prefsLastTimeVersionChecked)) {
 595:       return;
 596:     }
 597:     if (
 598:       haveSettings(prefsSectionName, prefsNextTimeVersionCheckedSkipVersion)
 599:     ) {
 600:       return;
 601:     }
 602:     if (haveSettings(prefsSectionName, prefsNextTimeVersionChecked)) {
 603:       return;
 604:     }
 605:     if (haveSettings(prefsSectionName, prefsVersionCheckInit)) {
 606:       return;
 607:     }
 608:     var currentTime = new Date();
 609:     if (
 610:       !checkNow &&
 611:       versionCheckInit != undefined &&
 612:       nextTimeVersionChecked != undefined &&
 613:       currentTime < nextTimeVersionChecked
 614:     ) {
 615:       return;
 616:     }
 617:     var serverVersionCheck = versionCheck(strSKU, true, checkNow);
 618:     if (serverVersionCheck == null) {
 619:       doUpdateCheck = false;
 620:       saveSettings(prefsSectionName, prefsDoUpdateCheck, false);
 621:       return;
 622:     }
 623:     var serverVersion =
 624:       serverVersionCheck != null && serverVersionCheck.hasOwnProperty("version")
 625:         ? serverVersionCheck.version
 626:         : strScriptVersion;
 627:     if (
 628:       !checkNow &&
 629:       lastServerVersionChecked != undefined &&
 630:       lastServerVersionChecked == serverVersion
 631:     ) {
 632:       return;
 633:     }
 634:     if (
 635:       !checkNow &&
 636:       nextTimeVersionCheckedSkipVersion != undefined &&
 637:       nextTimeVersionCheckedSkipVersion == lastServerVersionChecked
 638:     ) {
 639:       return;
 640:     }
 641:     saveSettings(prefsSectionName, prefsVersionCheckInit, 1);
 642:     try {
 643:       var newDate = new Date();
 644:       newDate = dateAddDays(updateCheckInterval);
 645:       saveSettings(prefsSectionName, prefsLastVersionChecked, strScriptVersion);
 646:       saveSettings(
 647:         prefsSectionName,
 648:         prefsLastTimeVersionChecked,
 649:         new Date().toString(),
 650:       );
 651:       saveSettings(
 652:         prefsSectionName,
 653:         prefsNextTimeVersionChecked,
 654:         newDate.toString(),
 655:       );
 656:     } catch (e) {
 657:       alert(e.toString());
 658:     }
 659:     var versionDifference = compareVersions(serverVersion, strScriptVersion);
 660:     var showNewVersion = showNewVersionUI(versionDifference);
 661:     if (showNewVersion) {
 662:       newVersionUI(serverVersionCheck);
 663:     } else {
 664:       if (versionDifference <= 0 && checkNow) {
 665:         alert(strUpToDate);
 666:       }
 667:     }
 668:   }
 669:   function versionCheck(scriptSKU, latest, isCheckNow) {
 670:     var checkLatest = latest ? "&latest=1" : "";
 671:     var url =
 672:       "https://notify.aescripts.com/versioncheck2.php?json=1&sku=" +
 673:       scriptSKU +
 674:       checkLatest;
 675:     var resp = extComms(url, isCheckNow);
 676:     if (resp == null || resp == "" || validateJSON(resp) == false) {
 677:       if (isCheckNow) {
 678:         alert(strUpdateCheckError);
 679:         return null;
 680:       } else {
 681:         return null;
 682:       }
 683:     }
 684:     try {
 685:       resp = JSONify(resp.replace(/\\u2022/g, "-"), "parse");
 686:       if (resp == null) {
 687:         return null;
 688:       }
 689:     } catch (e) {
 690:       return null;
 691:     }
 692:     if (resp.status != "ok") {
 693:       return null;
 694:     }
 695:     if (latest) {
 696:       version = {
 697:         date: resp.latest.release_date,
 698:         detail: resp.latest.detail,
 699:         header: strVersionRev
 700:           .replace(/%a/, resp.version)
 701:           .replace(/%b/, "")
 702:           .replace(/%c/, resp.latest.release_date),
 703:         version: resp.version,
 704:       };
 705:     } else {
 706:       version = { version: resp.version };
 707:     }
 708:     return version;
 709:   }
 710:   function extComms(url, isCheckNow) {
 711:     try {
 712:       var newExe = create_altool();
 713:       if (!newExe.exists) {
 714:         var title = "extComms error. alttool does not exists";
 715:         var detail =
 716:           "alttool does not exists. Please click on \'Open Support Ticket\' button for assistance.";
 717:         var errDetail = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
 718:         var licError =
 719:           "title" in licenseValidity ? " - " + licenseValidity.title : "";
 720:         var url = createSupportTicket({
 721:           message: errDetail,
 722:           subject: title + licError,
 723:         });
 724:         alertButtonsUI(
 725:           title,
 726:           detail,
 727:           { name: "Open Support Ticket", url: url },
 728:           { name: strCancel },
 729:         );
 730:         return null;
 731:       }
 732:       var newExePath = newExe.fsName;
 733:       var cmd = '"' + newExePath + '" -web "' + url + '"';
 734:       var res = systemCall(cmd);
 735:       newExe.remove();
 736:       var lines = res.match(/[^\r\n]+/g);
 737:       if (lines.length > 0 && lines[0] == "200") {
 738:         if (lines.length >= 1) {
 739:           return lines[1];
 740:         } else {
 741:           alertButtonsUI(
 742:             "extComms error",
 743:             "Empty Payload. Please click on \'Open Support Ticket\' button for assistance.",
 744:             { name: "Open Support Ticket", url: url },
 745:             { name: strCancel },
 746:           );
 747:           return null;
 748:         }
 749:       } else {
 750:         if (isCheckNow) {
 751:           alertButtonsUI(
 752:             "extComms error",
 753:             res.toString() +
 754:               "\n\nPlease click on \'Open Support Ticket\' button for assistance.",
 755:             { name: "Open Support Ticket", url: url },
 756:             { name: strCancel },
 757:           );
 758:         }
 759:         return null;
 760:       }
 761:     } catch (e) {
 762:       alert("extComms error\n" + e.toString());
 763:       return null;
 764:     }
 765:   }
 766:   function createVbsHelper() {
 767:     var vbsFile = new File(
 768:       globalPrefsFolder.fullName + "/Aescripts/aescripts_helper.vbs",
 769:     );
 770:     vbsFile.open("w");
 771:     vbsFile.write(
 772:       'dim o: Set o = createobject("MSXML2.XMLHTTP.6.0")\no.Open "GET", WScript.Arguments(0), False\no.Send\nIf o.Status >= 200 And o.Status <= 202 Then\nWScript.Echo o.responseText\nElse\nWScript.Echo "Error"\nEnd If',
 773:     );
 774:     vbsFile.close();
 775:     return vbsFile.exists ? vbsFile : null;
 776:   }
 777:   function socketConnect(url, get) {
 778:     var conn = new Socket();
 779:     conn.encoding = "binary";
 780:     conn.timeout = 2;
 781:     if (conn.open(url + ":80", "UTF-8")) {
 782:       conn.write(
 783:         "GET /" + get + " HTTP/1.1\nHost: " + url + "\n\nConnection: close\n\n",
 784:       );
 785:       var resp = conn.read(2000);
 786:       conn.close();
 787:       if (resp != undefined) {
 788:         resp = resp.toString();
 789:         return resp;
 790:       } else {
 791:         return null;
 792:       }
 793:     } else {
 794:       return null;
 795:     }
 796:   }
 797:   function curvaIsNotRunning() {
 798:     var curvaObject = {};
 799:     if (
 800:       curvaObject.toSource().indexOf("isStaticText") != -1 &&
 801:       curvaObject.toSource().indexOf("drawHoverBox") != -1
 802:     ) {
 803:       alertButtonsUI(
 804:         "Curva script conflict",
 805:         "Please close the \'Curva\' script and restart After Effects.\n\nUnfortunately this script interferes with other scripts and needs to remain closed\n\nPlease click on \'Open Support Ticket\' button for assistance.",
 806:         { name: "Open Support Ticket", url: url },
 807:         { name: strCancel },
 808:       );
 809:       return false;
 810:     }
 811:     return true;
 812:   }
 813:   function formatHistory(notes, clientVersion) {
 814:     var data = notes.data;
 815:     var releaseNotesFormatted = [];
 816:     for (var m1 in data) {
 817:       if (!data.hasOwnProperty(m1)) {
 818:         continue;
 819:       }
 820:       var history = data[m1].history;
 821:       for (var i = history.length - 1; i >= 0; i--) {
 822:         var rel = history[i];
 823:         var isCurrentVersionNote = "";
 824:         var detail = rel.detail;
 825:         if (i == history.length - 1) {
 826:           isCurrentVersionNote = " (" + strNewestVersionAvailable + ")";
 827:         }
 828:         var myVersionFormatted = strVersionRev
 829:           .replace(/%0/, rel.version_number)
 830:           .replace(/%1/, isCurrentVersionNote)
 831:           .replace(/%2/, rel.release_date)
 832:           .replace(/%3/, detail);
 833:         if (
 834:           !options.summaryOnlyNewChanges ||
 835:           compareVersions(clientVersion, rel.version_number) < 0
 836:         ) {
 837:           releaseNotesFormatted.push(myVersionFormatted);
 838:         }
 839:       }
 840:     }
 841:     var result = releaseNotesFormatted.join("\n\n");
 842:     return result;
 843:   }
 844:   function create_altool() {
 845:     var tempFolder = checkTempFolderAvailability();
 846:     var tempLocation =
 847:       tempFolder != null ? tempFolder : globalPrefsFolder.fullName;
 848:     var tempExeFileName =
 849:       tempLocation +
 850:       "/" +
 851:       Math.round(Math.random() * new Date().getTime() * 42132);
 852:     if ($.os.indexOf("Win") != -1) {
 853:       binStr = wx;
 854:       base64IconStr = binStr;
 855:       tempExeFileName += ".exe";
 856:     } else {
 857:       var getMacProcessor = systemCall("arch");
 858:       if (getMacProcessor.toLowerCase().match(/ppc/)) {
 859:         alert(strPpcNotSupported);
 860:         return false;
 861:       }
 862:       binStr = mx;
 863:       base64IconStr = binStr;
 864:     }
 865:     var newExe = createFile(File(tempExeFileName), base64IconStr, "BINARY");
 866:     if ($.os.indexOf("Mac") != -1) {
 867:       systemCall('chmod +x "' + newExe.fsName + '"');
 868:     }
 869:     newExe.hidden = true;
 870:     return newExe;
 871:   }
 872:   function getVerifCode(lic) {
 873:     return "1";
 874:     if (lic.toLowerCase() == "trial") {
 875:       lic = "";
 876:     }
 877:     var newExe = create_altool();
 878:     if (!newExe.exists) {
 879:       licenseData = {};
 880:       licenseData.result = -108;
 881:       return licenseData;
 882:     }
 883:     var newExePath = newExe.fsName;
 884:     var thelic = lic == "-" ? " " + lic : ' "' + lic + '"';
 885:     var verifCmd =
 886:       '"' + newExePath + '" "' + strHeader + '" ' + privateNum + thelic;
 887:     var verifCode = systemCall(verifCmd);
 888:     newExe.remove();
 889:     return parseResult(verifCode);
 890:   }
 891:   function parseResult(code) {
 892:     try {
 893:       licenseData = parseVerifCode(code.toString());
 894:     } catch (e) {
 895:       licenseData = {};
 896:       licenseData.result = -101;
 897:       licenseData.e = e.toString() + "\nresult:\n\n" + code.toString();
 898:     }
 899:     return licenseData;
 900:   }
 901:   function parseVerifCode(stdout) {
 902:     var lines = stdout.match(/[^\r\n]+/g);
 903:     var licenseData = {};
 904:     for (var i = 0; i < lines.length; i += 1) {
 905:       var parts = lines[i].split(":");
 906:       if (parts.length >= 2) {
 907:         var key = parts[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
 908:         var value = trimQuotes(parts[1]);
 909:         if (key == "LS" && value == "UP") {
 910:           key = "LSS";
 911:         }
 912:         if (!isNaN(value)) {
 913:           value = parseFloat(value);
 914:         }
 915:         licenseData[key] = value;
 916:       }
 917:     }
 918:     if (licenseData.result === undefined) {
 919:       licenseData.result = -102;
 920:       licenseData.e = stdout;
 921:     }
 922:     checkTrialDetails(licenseData);
 923:     checkBetaDetails(licenseData);
 924:     isTimeLimited = checkTimeLimited(licenseData);
 925:     return licenseData;
 926:   }
 927:   function checkTimeLimited(licenseData) {
 928:     var start = retProp("art$", licenseData);
 929:     var end = retProp("end$", licenseData);
 930:     validateTimeLimited(licenseData, start, end);
 931:     return start != "" && end != "";
 932:   }
 933:   function validateTimeLimited(licenseData, start, end) {
 934:     var resultCode = licenseData.result;
 935:     switch (resultCode) {
 936:       case -20:
 937:         licenseData.e = parseDateString(start);
 938:         break;
 939:       case -21:
 940:         licenseData.e = parseDateString(end);
 941:         break;
 942:     }
 943:   }
 944:   function checkOnlineActivationServerConnection(licenseData) {
 945:     var a_try = parseInt(retProp("try$", licenseData), 10);
 946:     var a_succ = parseInt(retProp("ucc$", licenseData), 10);
 947:     var isBetaLicense = retProp("pe$", licenseData).match(/^B/);
 948:     if (!isBetaLicense && a_try > 0 && a_succ == 0) {
 949:       licenseData.result = -33;
 950:     }
 951:   }
 952:   function checkOnlineDeactivation(licenseData) {
 953:     var a_try = retProp("try$", licenseData);
 954:     var a_succ = retProp("ucc$", licenseData);
 955:     if (a_succ == 0) {
 956:       licenseData.result = -38;
 957:     }
 958:   }
 959:   function checkFloatingLicense(licenseData) {
 960:     var license = retProp("ype$", licenseData);
 961:     if (license == bD("RkxU") && !isServerRunning(licenseData)) {
 962:       licenseData.result = -109;
 963:     }
 964:   }
 965:   function checkTrialDetails(licenseData) {
 966:     var resultCode = licenseData.result;
 967:     if (resultCode !== -7) {
 968:     } else if (tLD == 0) {
 969:       licenseData.result = -106;
 970:     } else {
 971:       var tLDSoFar = retProp("^d", licenseData);
 972:       if (tLDSoFar === undefined) {
 973:         licenseData.result = -103;
 974:         return;
 975:       }
 976:       var tDLeft = tLD - tLDSoFar;
 977:       if (tDLeft > 0) {
 978:         licenseData.result = 100;
 979:         licenseData.tdl = tDLeft;
 980:         licenseData.license = bD("VFJJQUw=");
 981:       } else {
 982:         licenseData.result = -100;
 983:         licenseData.tdl = 0;
 984:       }
 985:     }
 986:   }
 987:   function checkBetaDetails(licenseData) {
 988:     var result = licenseData.result;
 989:     var isBetaLicense = retProp("pe$", licenseData).match(/^B/);
 990:     if ((betaMode && isResultTrial(result)) || result == -106 || result == -7) {
 991:       licenseData.result = -107;
 992:     } else {
 993:       if (!betaMode && isBetaLicense) {
 994:         licenseData.result = -105;
 995:       }
 996:     }
 997:   }
 998:   function isResultValidLicense(licenseData) {
 999:     return true;
1000:   }
1001:   function isResultTrial(resultCode) {
1002:     return false;
1003:   }
1004:   function isServerConfigured(licenseData) {
1005:     try {
1006:       var licenseServerIsConfigured = retProp("^L", licenseData).match(/^O/);
1007:       return licenseServerIsConfigured;
1008:     } catch (e) {}
1009:   }
1010:   function isServerRunning(licenseData) {
1011:     try {
1012:       var licenseServerIsConfigured = retProp("SS$", licenseData).match(/^U/);
1013:       return licenseServerIsConfigured;
1014:     } catch (e) {}
1015:   }
1016:   function trimQuotes(string) {
1017:     string = string.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
1018:     if (string[0] == "\'" && string[string.length - 1] == "\'") {
1019:       string = string.substring(1, string.length - 1);
1020:     }
1021:     return string;
1022:   }
1023:   function sanitizeProductName(name) {
1024:     return name.toString().replace(/[^a-z0-9]/gi, "");
1025:   }
1026:   function checkErrorCode(code) {
1027:     if (licErrors.hasOwnProperty(code.toString())) {
1028:       return code;
1029:     } else {
1030:       return "unknown";
1031:     }
1032:   }
1033:   function string_encode3(str) {
1034:     var encStr = 0;
1035:     for (var i = 0; i < str.length; i += 1) {
1036:       encStr = encStr + str.charCodeAt(i);
1037:     }
1038:     return encStr;
1039:   }
1040:   function getVerifCode3(lic) {
1041:     var myRegArray = lic.split("*");
1042:     if (myRegArray.length == 4) {
1043:       var myLcns = myRegArray[3].replace(/^[0-9]+/, "");
1044:       var code = myRegArray[3].match(/^[0-9]+/, "");
1045:       var ranFront = code[0].substr(0, 2);
1046:       var ranBack = code[0].substr(code[0].length - 2);
1047:       var name =
1048:         ranFront[0] +
1049:         myRegArray[0] +
1050:         ranFront[1] +
1051:         myRegArray[1] +
1052:         ranBack[0] +
1053:         myRegArray[2] +
1054:         ranBack[1] +
1055:         myLcns;
1056:       var tempKey = code[0].substring(2, code[0].length - 2);
1057:       var nameEncode = string_encode3(name);
1058:       var key = nameEncode * privateNum;
1059:       if (key == tempKey) {
1060:         return "1";
1061:       } else {
1062:         return "0";
1063:       }
1064:     } else {
1065:       if (lic != bE("bad")) {
1066:         alertButtonsUI(
1067:           licErrors["-1"].title,
1068:           strNewLicenseFormat,
1069:           { name: strGetHelp, url: getHelpUrls.license_faq },
1070:           { name: strOK },
1071:         );
1072:       }
1073:       return "0";
1074:     }
1075:   }
1076:   function string_encode(str) {
1077:     return (
1078:       str.length * str.charCodeAt(0) +
1079:       str.charCodeAt(Math.floor((str.length - 1) * 0.1)) +
1080:       str.charCodeAt(Math.floor((str.length - 1) * 0.2)) +
1081:       str.charCodeAt(Math.floor((str.length - 1) * 0.3)) +
1082:       str.charCodeAt(Math.floor((str.length - 1) * 0.4)) +
1083:       str.charCodeAt(Math.floor((str.length - 1) * 0.5)) +
1084:       str.charCodeAt(Math.floor((str.length - 1) * 0.7)) +
1085:       str.charCodeAt(Math.floor((str.length - 1) * 0.8)) +
1086:       str.charCodeAt(Math.floor((str.length - 1) * 0.9)) +
1087:       str.charCodeAt(str.length - 1)
1088:     );
1089:   }
1090:   function check_v1_License(myReg) {
1091:     var myRegArray = myReg.split("**");
1092:     if (
1093:       myReg.replace(/^ +|| +$/g, "").match(/^.+\*\*.+\*\*[0-9]+[A-Za-z]{3}$/) &&
1094:       myRegArray.length == 3
1095:     ) {
1096:       return true;
1097:     } else {
1098:       alertButtonsUI(
1099:         licErrors["-1"].title,
1100:         strOldLicenseFormat,
1101:         { name: strGetHelp, url: getHelpUrls.license_faq },
1102:         { name: strOK },
1103:       );
1104:       return false;
1105:     }
1106:   }
1107:   function check_v2_License(myReg) {
1108:     var myRegArray = myReg.split("*");
1109:     return (
1110:       myReg.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[0-9]+[A-Za-z]{3}[0-9]+$/) &&
1111:       myRegArray.length == 4
1112:     );
1113:   }
1114:   function check_timed_License(myReg) {
1115:     var myRegArray = myReg.split("*");
1116:     return (
1117:       myReg.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[A-Z0-9#]+[A-Za-z]{3}[0-9]+$/) &&
1118:       myRegArray.length == 4
1119:     );
1120:   }
1121:   function checkCode(doPrompt, myReg, privateNum) {
1122:     if (myReg == undefined) {
1123:       myReg = "";
1124:     } else {
1125:       myReg = myReg.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
1126:     }
1127:     myLcns = false;
1128:     if (doPrompt) {
1129:       regUI = licUI();
1130:       myRegPrompt = regUI.show();
1131:       if (!myRegPrompt) {
1132:         return false;
1133:       }
1134:     }
1135:     myReg = license == undefined ? myReg : license;
1136:     var isLicServer = false;
1137:     if (myReg.toLowerCase() == "@remote") {
1138:       myReg = strHeader + myReg;
1139:       isLicServer = true;
1140:     }
1141:     var myRegArray = myReg.split("*");
1142:     var isTimeLimited = myReg.match(/#/);
1143:     var isValidTimeLimited = isTimeLimited && check_timed_License(myReg);
1144:     var isValidV2License = check_v2_License(myReg);
1145:     var isValidTrialInitial = offerTrial && myReg.toLowerCase() == "trial";
1146:     var goAhead =
1147:       isValidTrialInitial ||
1148:       isLicServer ||
1149:       isValidV2License ||
1150:       isValidTimeLimited;
1151:     if (goAhead) {
1152:       if (myReg.toLowerCase() != "trial" || isLicServer) {
1153:         if (!isLicServer) {
1154:           if (myRegArray[0] != null && myRegArray[0] != strHeader) {
1155:             alertButtonsUI(
1156:               strWrongProduct,
1157:               "",
1158:               { name: strGetHelp, url: getHelpUrls.license_faq },
1159:               { name: strOK },
1160:             );
1161:             checkCode(doPrompt);
1162:             return false;
1163:           }
1164:           var myLicenseMatch = myRegArray[3].match(/[A-Z]{3}[0-9]+$/);
1165:           if (myLicenseMatch != null) {
1166:             if (myLicenseMatch[0].match(bD("QlRB")) && !betaMode) {
1167:               alertButtonsUI(
1168:                 strBetaCodeAlert.title,
1169:                 strBetaCodeAlert.detail,
1170:                 { name: strGetHelp, url: getHelpUrls.license_faq },
1171:                 { name: strOK },
1172:               );
1173:               saveSettings(prefsSectionName, prefsName, bE("bad"));
1174:               checkCode(true);
1175:               return false;
1176:             }
1177:             myLcns = true;
1178:           }
1179:         }
1180:       }
1181:       licenseValidity = licV == 2 ? getVerifCode(myReg) : getVerifCode3(myReg);
1182:       if (isResultValidLicense(licenseValidity)) {
1183:         isValidTrial =
1184:           !isTimeLimited &&
1185:           offerTrial &&
1186:           myReg.toLowerCase() == "trial" &&
1187:           isResultTrial(licenseValidity.result);
1188:         if (doPrompt) {
1189:           if (!isValidTrial) {
1190:             var numUsers = parseInt(retProp("^n", licenseValidity), 10);
1191:             var multiLicense =
1192:               strFor + " " + numUsers + " " + numUsers > 1 ? strUsers : strUser;
1193:             var successAlert = betaMode
1194:               ? strBTA + " "
1195:               : "" + strRegSuccess + multiLicense + !betaMode && !isTimeLimited
1196:                 ? "\n" + strRegSuccess1
1197:                 : "\n" + strScriptName;
1198:             if (isTimeLimited) {
1199:               var licenseEnd = parseDateString(retProp("nd$", licenseValidity));
1200:               successAlert += "\n\n" + strLicenseEnds + licenseEnd;
1201:             }
1202:             if (!myReg.match(/@remote/i)) {
1203:               alert(successAlert);
1204:             }
1205:           }
1206:         }
1207:         myLcns = true;
1208:       } else {
1209:         if (!doPrompt) {
1210:           doPrompt = true;
1211:         }
1212:         var errDetail = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
1213:         var url = licErrors[checkErrorCode(licenseValidity.result)].url;
1214:         if (url == getHelpUrls.open_ticket) {
1215:           url = createSupportTicket({
1216:             message:
1217:               licErrors[checkErrorCode(licenseValidity.result)].detail +
1218:               errDetail,
1219:             subject:
1220:               "License Error " +
1221:               licenseValidity.result +
1222:               " - " +
1223:               licErrors[checkErrorCode(licenseValidity.result)].title,
1224:           });
1225:         }
1226:         alertButtonsUI(
1227:           licErrors[checkErrorCode(licenseValidity.result)].title +
1228:             " (" +
1229:             licenseValidity.result +
1230:             ")",
1231:           licErrors[checkErrorCode(licenseValidity.result)].detail + errDetail,
1232:           { name: strGetHelp, url: url },
1233:           { name: strOK },
1234:         );
1235:         if (licenseValidity.result == -9) {
1236:           if (confirm(strReset + "?")) {
1237:             getVerifCode("-");
1238:           }
1239:         }
1240:         checkCode(doPrompt);
1241:         return myLcns;
1242:       }
1243:     } else {
1244:       if (myReg.match(/^[A-Z]{2}[A-Z0-9]{30}$/)) {
1245:         var goToUrl = confirm(strTempCode);
1246:         if (isSecurityPrefSet() && goToUrl) {
1247:           openURL(exchangeUrl + "?serial=" + myReg);
1248:         }
1249:         return myLcns;
1250:       } else {
1251:         alertButtonsUI(
1252:           strInvalidCode,
1253:           !betaMode
1254:             ? strNewLicenseFormat
1255:             : strNewLicenseFormat.replace(
1256:                 new RegExp(bD("U1VM"), "g"),
1257:                 bD("QlRB"),
1258:               ),
1259:           { name: strGetHelp, url: getHelpUrls.license_faq },
1260:           { name: strOK },
1261:         );
1262:         saveSettings(prefsSectionName, prefsName, bE("bad"));
1263:         saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
1264:         saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
1265:         checkCode(true);
1266:         return myLcns;
1267:       }
1268:     }
1269:     return myLcns;
1270:   }
1271:   function checkForLegacyLic() {
1272:     var myReg = haveSettings(prefsSectionName, prefsName)
1273:       ? bD(getSettings(prefsSectionName, prefsName))
1274:       : "";
1275:     var license = check_v2_License(myReg) ? myReg : "";
1276:     return license;
1277:   }
1278:   function trial_expired() {
1279:     var goToUrl = confirm(strExpiredAlert);
1280:     if (isSecurityPrefSet() && goToUrl) {
1281:       openURL(strTrialUrl);
1282:     } else {
1283:       if (goToUrl && isAE()) {
1284:         alert(strErrScriptAccess);
1285:       }
1286:     }
1287:   }
1288:   function bD(input) {
1289:     var output = "";
1290:     var i = 0;
1291:     input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
1292:     var key =
1293:       "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
1294:     while (i < input.length) {
1295:       enc1 = key.indexOf(input.charAt(i++));
1296:       enc2 = key.indexOf(input.charAt(i++));
1297:       enc3 = key.indexOf(input.charAt(i++));
1298:       enc4 = key.indexOf(input.charAt(i++));
1299:       chr1 = (enc1 << 2) | (enc2 >> 4);
1300:       chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
1301:       chr3 = ((enc3 & 3) << 6) | enc4;
1302:       output = output + String.fromCharCode(chr1);
1303:       if (enc3 != 64) {
1304:         output = output + String.fromCharCode(chr2);
1305:       }
1306:       if (enc4 != 64) {
1307:         output = output + String.fromCharCode(chr3);
1308:       }
1309:     }
1310:     return output;
1311:   }
1312:   function bE(input) {
1313:     var output = "";
1314:     var i = 0;
1315:     var key =
1316:       "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
1317:     while (i < input.length) {
1318:       chr1 = input.charCodeAt(i++);
1319:       chr2 = input.charCodeAt(i++);
1320:       chr3 = input.charCodeAt(i++);
1321:       enc1 = chr1 >> 2;
1322:       enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
1323:       enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
1324:       enc4 = chr3 & 63;
1325:       if (isNaN(chr2)) {
1326:         enc3 = enc4 = 64;
1327:       } else {
1328:         if (isNaN(chr3)) {
1329:           enc4 = 64;
1330:         }
1331:       }
1332:       output =
1333:         output +
1334:         key.charAt(enc1) +
1335:         key.charAt(enc2) +
1336:         key.charAt(enc3) +
1337:         key.charAt(enc4);
1338:     }
1339:     return output;
1340:   }
1341:   function isSecurityPrefSet() {
1342:     var prefSection =
1343:       parseFloat(app.version) < 12
1344:         ? "Main Pref Section"
1345:         : "Main Pref Section v2";
1346:     var securitySetting = app.preferences.getPrefAsLong(
1347:       prefSection,
1348:       "Pref_SCRIPTING_FILE_NETWORK_SECURITY",
1349:     );
1350:     return securitySetting == 1;
1351:   }
1352:   function openURL(url) {
1353:     url = url.toString();
1354:     if (!url.match(/@/) && !url.match(/^https?:\/\//)) {
1355:       url = "http://" + url.replace(/^(http)?s?:?\/?\/?/, "");
1356:     }
1357:     if (isAE() || isPS()) {
1358:       var winBrowserCmd = "start ";
1359:       var macBrowserCmdStart = 'open "';
1360:       var macBrowserCmdEnd = '"';
1361:       if ($.os.indexOf("Windows") != -1) {
1362:         url = url.replace(/&/g, "^&");
1363:         command = 'cmd /c "' + winBrowserCmd + url + '"';
1364:         systemCall(command);
1365:       } else {
1366:         command = macBrowserCmdStart + url + macBrowserCmdEnd;
1367:         systemCall(command);
1368:       }
1369:     } else {
1370:       var tempOutputFile = File(Folder.temp.fullName + "/openUrl.url");
1371:       var f = createFile(
1372:         tempOutputFile,
1373:         "[InternetShortcut]\rURL=" + url + "\r",
1374:         "UTF-8",
1375:         true,
1376:       );
1377:       f.execute();
1378:     }
1379:   }
1380:   function parseRegistration(s) {
1381:     result = retProp("^r", licenseValidity);
1382:     if (result == 0) {
1383:       regFirstName = retProp("^f", licenseValidity);
1384:       regLastName = retProp("^la", licenseValidity);
1385:       numUsers = retProp("^n", licenseValidity);
1386:       license = retProp("pe$", licenseValidity);
1387:       if (isTimeLimited) {
1388:         licenseStart = parseDateString(retProp("rt$", licenseValidity));
1389:         licenseEnd = parseDateString(retProp("nd$", licenseValidity));
1390:       }
1391:       if (s > 0) {
1392:         return (
1393:           regFirstName +
1394:           "\'" +
1395:           regLastName +
1396:           "\'" +
1397:           retProp("^s", licenseValidity) +
1398:           license +
1399:           numUsers
1400:         );
1401:       }
1402:       regName =
1403:         regFirstName + regLastName.toString().match(/^@/)
1404:           ? ""
1405:           : " " + regLastName + " ";
1406:       regLicense = license;
1407:     } else {
1408:       regName = "";
1409:     }
1410:     var multiLicense =
1411:       strFor + " " + numUsers + " " + numUsers > 1 ? strUsers : strUser;
1412:     switch (regLicense) {
1413:       case bD("U1VM"):
1414:         myLcns = " - " + strLicense + " " + multiLicense;
1415:         break;
1416:       case bD("QlRB"):
1417:         myLcns = " - " + strBTA + " " + multiLicense;
1418:         break;
1419:       case bD("RURV"):
1420:         myLcns = " - " + strEDU + " " + multiLicense;
1421:         break;
1422:       case bD("RkxU"):
1423:         myLcns = " - " + strFLT + " " + multiLicense;
1424:         break;
1425:       default:
1426:         tdl = retProp("^t", licenseValidity);
1427:         if (!isTimeLimited) {
1428:           if (tdl < 1) {
1429:             myLcns = strTrialExpired;
1430:           } else {
1431:             myLcns = strTrialTxt.replace(/%E/, tdl);
1432:           }
1433:         }
1434:         break;
1435:     }
1436:     regHeader = regName != "" ? strRegistration + regName + myLcns : myLcns;
1437:     if (isTimeLimited) {
1438:       regHeader += "\n" + strLicenseEnds + licenseEnd;
1439:     }
1440:     return regHeader;
1441:   }
1442:   function parseDateString(str) {
1443:     var parts = str.toString().split("-");
1444:     return new Date(
1445:       parseInt(parts[0]),
1446:       parseInt(parts[1] - 1),
1447:       parseInt(parts[2]),
1448:     ).toDateString();
1449:   }
1450:   function retProp(s, o) {
1451:     for (var i in o) {
1452:       if (o.hasOwnProperty(i)) {
1453:         if (i.toString().match(new RegExp(s))) {
1454:           return o[i];
1455:         }
1456:       }
1457:     }
1458:     return "";
1459:   }
1460:   function isAE() {
1461:     return BridgeTalk.appName.match(new RegExp(bD("YWZ0ZXJlZmZlY3Rz")));
1462:   }
1463:   function isPS() {
1464:     return BridgeTalk.appName.match(new RegExp(bD("cGhvdG9zaG9w")));
1465:   }
1466:   function readFile(file) {
1467:     if (file != undefined && file != null && file.exists && file.open("r")) {
1468:       var string = file.read();
1469:       file.close();
1470:       return string;
1471:     } else {
1472:       return null;
1473:     }
1474:   }
1475:   function createFile(file, encodedStr, encoding, overwrite, isVisible) {
1476:     if ((file != undefined && file != null && !file.exists) || overwrite) {
1477:       if (file.exists) {
1478:         file.remove();
1479:       }
1480:       file =
1481:         $.os.indexOf("Win") != -1
1482:           ? new File(file.fullName)
1483:           : new File(file.absoluteURI);
1484:       file.encoding = encoding;
1485:       file.open("w");
1486:       file.write(encodedStr);
1487:       file.close();
1488:       if (isVisible == undefined || !isVisible) {
1489:         file.hidden = true;
1490:       }
1491:       if ($.os.indexOf("Mac") != -1) {
1492:         systemCall(bD("Y2htb2QgK3gg") + file.absoluteURI);
1493:       }
1494:     }
1495:     return file;
1496:   }
1497:   function systemCall(command) {
1498:     if (isAE()) {
1499:       return system.callSystem(command);
1500:     }
1501:     if (isPS()) {
1502:       var tempOutputFileName =
1503:         $.os.indexOf("Win") != -1
1504:           ? Folder.temp.fsName
1505:           : Folder.temp.absoluteURI +
1506:             "/" +
1507:             Math.round(Math.random() * new Date().getTime() * 71827);
1508:       app.system(command + " > " + tempOutputFileName);
1509:       return readFile(File(tempOutputFileName));
1510:     }
1511:     return "";
1512:   }
1513:   function parseSettings(needle, obj) {
1514:     for (var property in obj) {
1515:       if (obj.hasOwnProperty(property)) {
1516:         if (typeof obj[property] == "object") {
1517:           return parseSettings(needle, obj[property]);
1518:         } else {
1519:           if (property === needle) {
1520:             return obj[property];
1521:           }
1522:         }
1523:       }
1524:     }
1525:   }
1526:   function readJSON(json) {
1527:     if (json == undefined || json == null) {
1528:       return false;
1529:     }
1530:     if (!(json instanceof File)) {
1531:       File(json);
1532:     }
1533:     var string = readFile(json);
1534:     return JSONify(string, "parse");
1535:   }
1536:   function writeJSON(obj, file) {
1537:     if (obj == undefined || obj == null || file == undefined || file == null) {
1538:       return false;
1539:     }
1540:     if (!(file instanceof File)) {
1541:       File(file);
1542:     }
1543:     var prettyJSON = "\t";
1544:     createFile(
1545:       file,
1546:       JSONify(obj, "stringify", prettyJSON),
1547:       "UTF-8",
1548:       true,
1549:       true,
1550:     );
1551:     return file.exists;
1552:   }
1553:   function getSettings(header, name, type) {
1554:     if (isAE() && type != "settings") {
1555:       return app.settings.getSetting(header, name);
1556:     } else {
1557:       var prefFile = File(prefsLocation + prefsPrefix + File.encode(header));
1558:       var prefString = readFile(prefFile);
1559:       var pref = JSONify(prefString, "parse");
1560:       if (pref instanceof Array) {
1561:         pref = fixSettingsFile(pref);
1562:         prefFile.remove();
1563:         for (var i in pref) {
1564:           saveSettings(header, i, pref[i]);
1565:         }
1566:       }
1567:       return pref[name];
1568:     }
1569:   }
1570:   function haveSettings(header, name, type) {
1571:     if (isAE() && type != "settings") {
1572:       return app.settings.haveSetting(header, name);
1573:     } else {
1574:       var prefFile = File(prefsLocation + prefsPrefix + File.encode(header));
1575:       var prefString = readFile(prefFile);
1576:       if (prefString != null) {
1577:         var pref = JSONify(prefString.toString(), "parse");
1578:         if (pref instanceof Array) {
1579:           pref = fixSettingsFile(pref);
1580:         }
1581:         return name in pref;
1582:       } else {
1583:         return false;
1584:       }
1585:     }
1586:   }
1587:   function fixSettingsFile(a) {
1588:     var newObj = {};
1589:     for (var i = 0; i < a.length - 1; i += 1) {
1590:       newObj[a[i]] = a[i + 1];
1591:       i++;
1592:     }
1593:     return newObj;
1594:   }
1595:   function saveSettings(header, name, value, type) {
1596:     if (isAE() && type != "settings") {
1597:       app.settings.saveSetting(header, name, value);
1598:       app.preferences.saveToDisk();
1599:     } else {
1600:       var pref = {};
1601:       var prefFile = File(prefsLocation + prefsPrefix + File.encode(header));
1602:       if (prefFile.exists) {
1603:         var prefString = readFile(prefFile);
1604:         if (prefString != null) {
1605:           pref = JSONify(prefString.toString(), "parse");
1606:         }
1607:       }
1608:       if (pref instanceof Array) {
1609:         pref = fixSettingsFile(pref);
1610:       }
1611:       pref[name] = value;
1612:       var prettyJSON = "\t";
1613:       createFile(
1614:         File(prefsLocation + prefsPrefix + File.encode(header)),
1615:         JSONify(pref, "stringify", prettyJSON),
1616:         "UTF-8",
1617:         true,
1618:       );
1619:     }
1620:   }
1621:   function saveVersionsToPrefs() {
1622:     saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
1623:     saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
1624:   }
1625:   function isVT() {
1626:     saveVersionsToPrefs;
1627:     if (
1628:       typeof licenseValidity == "undefined" ||
1629:       !licenseValidity.hasOwnProperty("result")
1630:     ) {
1631:       licenseValidity = getVerifCode("");
1632:     }
1633:     return (
1634:       isResultValidLicense(licenseValidity) &&
1635:       isResultTrial(licenseValidity.result)
1636:     );
1637:   }
1638:   function getRegistration(val) {
1639:     saveVersionsToPrefs;
1640:     if (
1641:       typeof licenseValidity == "undefined" ||
1642:       !licenseValidity.hasOwnProperty("result")
1643:     ) {
1644:       licenseValidity = getVerifCode("");
1645:     }
1646:     return parseRegistration(val);
1647:   }
1648:   function removeLic() {
1649:     saveVersionsToPrefs;
1650:     if (
1651:       typeof licenseValidity == "undefined" ||
1652:       !licenseValidity.hasOwnProperty("result")
1653:     ) {
1654:       licenseValidity = getVerifCode("");
1655:     }
1656:     var command =
1657:       isServerConfigured(licenseValidity) && isServerRunning(licenseValidity)
1658:         ? strHeader + "@REMOTE"
1659:         : "";
1660:     var isBetaLicense = retProp("ype$", licenseValidity).match(/^B/) != null;
1661:     theLcs = false;
1662:     licenseValidity = getVerifCode("-" + command);
1663:     if (!isBetaLicense) {
1664:       checkOnlineDeactivation(licenseValidity);
1665:       if (licenseValidity.result != "-100") {
1666:         alertButtonsUI(
1667:           licErrors[checkErrorCode(licenseValidity.result)].title +
1668:             " (" +
1669:             licenseValidity.result +
1670:             ")",
1671:           licErrors[checkErrorCode(licenseValidity.result)].detail,
1672:           {
1673:             name: strGetHelp,
1674:             url: licErrors[checkErrorCode(licenseValidity.result)].url,
1675:           },
1676:           { name: strOK },
1677:         );
1678:       } else {
1679:         alert(
1680:           strLicense + " " + strRemovedAndDeactivated + "\n" + strScriptName,
1681:         );
1682:       }
1683:     } else {
1684:       alert(strLicense + " " + strRemoved + "\n" + strScriptName);
1685:     }
1686:     if (!isServerConfigured(licenseValidity)) {
1687:       saveSettings(prefsSectionName, prefsName, bE("bad"));
1688:       saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
1689:       saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
1690:     }
1691:     return !theLcs;
1692:   }
1693:   function checkTempFolderAvailability() {
1694:     var folderToUse = null;
1695:     try {
1696:       testFolder = Folder.temp.fullName;
1697:     } catch (e) {}
1698:     try {
1699:       testFolder = Folder.temp.fsName;
1700:     } catch (e) {}
1701:     return testFolder;
1702:   }
1703:   function checkFoldersAvailability() {
1704:     var folderToUse = null;
1705:     var testFolder = "";
1706:     try {
1707:       testFolder = Folder.appData.fullName;
1708:       folderToUse = Folder.appData;
1709:     } catch (e) {}
1710:     try {
1711:       testFolder = Folder.appPackage.fullName;
1712:       folderToUse = Folder.appPackage;
1713:     } catch (e) {}
1714:     try {
1715:       testFolder = Folder.commonFiles.fullName;
1716:       folderToUse = Folder.commonFiles;
1717:     } catch (e) {}
1718:     try {
1719:       testFolder = Folder.temp.fullName;
1720:       folderToUse = Folder.temp;
1721:     } catch (e) {}
1722:     try {
1723:       testFolder = Folder.myDocuments.fullName;
1724:       folderToUse = Folder.myDocuments;
1725:     } catch (e) {}
1726:     try {
1727:       testFolder = Folder.userData.fullName;
1728:       folderToUse = Folder.userData;
1729:     } catch (e) {}
1730:     return folderToUse;
1731:   }
1732:   function userDataAccessCheck() {
1733:     if (globalPrefsFolder == null) {
1734:       var title =
1735:         strScriptName +
1736:         " is unable to continue as it can\'t access the file system.\n";
1737:       var detail = "";
1738:       var url = "";
1739:       if ($.os.indexOf("Windows") == -1) {
1740:         detail +=
1741:           "A possible cause is Dropbox\'s \'Backup This Mac\' feature. If you\'re using this, try disabling Dropbox backup of your Desktop, then restart After Effects and try again\n\n";
1742:         detail += "Click on " + strGetHelp + " below for more assistance";
1743:         url =
1744:           "https://aescripts.com/knowledgebase/index/view/faq/dropbox-macos-warning/";
1745:       } else {
1746:         detail +=
1747:           "Please make sure you do not have any firewalls or virus software blocking access to the ~/AppData/Roaming folder";
1748:         url = createSupportTicket({ subject: title });
1749:       }
1750:       alertButtonsUI(
1751:         title,
1752:         detail,
1753:         { name: strGetHelp, url: url },
1754:         { name: strOK },
1755:       );
1756:       return false;
1757:     } else {
1758:       return true;
1759:     }
1760:   }
1761:   function mainFunc(cmd) {
1762:     if (isAE() && !isSecurityPrefSet()) {
1763:       alert(strErrScriptAccess);
1764:       if (parseFloat(app.version) < 16.1) {
1765:         app.executeCommand(2359);
1766:       } else {
1767:         app.executeCommand(3131);
1768:       }
1769:       if (!isSecurityPrefSet()) {
1770:         return;
1771:       }
1772:     }
1773:     if (!userDataAccessCheck()) {
1774:       return;
1775:     }
1776:     if (!curvaIsNotRunning()) {
1777:       return;
1778:     }
1779:     prefsLocation = globalPrefsFolder.fullName + "/Aescripts/";
1780:     if (!isAE() && !Folder(prefsLocation).exists) {
1781:       Folder(prefsLocation).create();
1782:     }
1783:     if (betaMode && checkBeta(betaExpirationDate, betaStartDate)) {
1784:       if (cmd == "l") {
1785:         alert(strBetaExpiredAlert);
1786:       }
1787:       return;
1788:     }
1789:     if (cmd == "l" || cmd == "c" || cmd == "r") {
1790:       var doPrompt = false;
1791:       if (cmd == "l" && doUpdateCheck) {
1792:         checkForNewVersion();
1793:       }
1794:       if (licV == 2) {
1795:         if (cmd == "r") {
1796:           theLcs = !removeLic();
1797:         } else {
1798:           licenseValidity = getVerifCode("");
1799:           if (licenseValidity.result == "-22") {
1800:             var errDetail =
1801:               "e" in licenseValidity ? "\n" + licenseValidity.e : "";
1802:             alertButtonsUI(
1803:               licErrors[checkErrorCode(licenseValidity.result)].title +
1804:                 " (" +
1805:                 licenseValidity.result +
1806:                 ")",
1807:               licErrors[checkErrorCode(licenseValidity.result)].detail +
1808:                 errDetail,
1809:               {
1810:                 name: strGetHelp,
1811:                 url: licErrors[checkErrorCode(licenseValidity.result)].url,
1812:               },
1813:               { name: strOK },
1814:             );
1815:             getVerifCode("-");
1816:             doPrompt = true;
1817:             myReg =
1818:               isServerConfigured(licenseValidity) &&
1819:               isServerRunning(licenseValidity)
1820:                 ? "@REMOTE"
1821:                 : "trial";
1822:           }
1823:           if (
1824:             isResultValidLicense(licenseValidity) &&
1825:             !isResultTrial(licenseValidity.result)
1826:           ) {
1827:             return true;
1828:           } else {
1829:             myReg = checkForLegacyLic();
1830:             if (myReg == "") {
1831:               doPrompt = true;
1832:               myReg =
1833:                 isServerConfigured(licenseValidity) &&
1834:                 isServerRunning(licenseValidity)
1835:                   ? "@REMOTE"
1836:                   : "trial";
1837:             }
1838:             theLcs = checkCode(doPrompt, myReg, privateNum);
1839:           }
1840:         }
1841:       } else {
1842:         if (haveSettings(prefsSectionName, prefsName)) {
1843:           myReg = getSettings(prefsSectionName, prefsName);
1844:           if (
1845:             ((cmd != "c" && myReg == "bad") ||
1846:               bD(myReg) == "bad" ||
1847:               offerTrial) &&
1848:             bD(myReg) == "trial"
1849:           ) {
1850:             doPrompt = true;
1851:           } else {
1852:             doPrompt = false;
1853:           }
1854:         } else {
1855:           if (cmd == "c") {
1856:             myReg = !isTimeLimited && offerTrial ? "trial" : "";
1857:             saveSettings(prefsSectionName, prefsName, bE(myReg));
1858:             saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
1859:             saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
1860:             doPrompt = false;
1861:           } else {
1862:             doPrompt = true;
1863:           }
1864:         }
1865:         theLcs = checkCode(doPrompt, myReg, privateNum);
1866:       }
1867:       return theLcs;
1868:     }
1869:   }
1870:   var mx = __BLOB__BLOB_000108__;
1871:   var wx = __BLOB__BLOB_000109__;
1872:   var strTempCode = localize({
1873:     de:
1874:       "Du hast eine tempor\xe4re Seriennummer eingegeben, die gegen eine permanente Lizenz eingetauscht werden muss.\n\nSobald Du eine permanente Lizenz erhalten hast, kannst Du sie verwenden um " +
1875:       strScriptName +
1876:       " zu registrieren.  Der Austausch ist schnell und unkompliziert, gehe einfach auf:\n\n" +
1877:       exchangeUrl +
1878:       "\n\nWillst Du jetzt dorthin gehen?",
1879:     en:
1880:       "You entered a temporary serial number that needs to be exchanged for a permanent license.\n\nOnce you obtain your permanent license you can use it to register " +
1881:       strScriptName +
1882:       ".  It is quick and easy to exchange it, simply go to:\n\n" +
1883:       exchangeUrl +
1884:       "\n\nWould you like to go there now?",
1885:     es:
1886:       "Ha introducido un n\xfamero de serie provisional que necesita ser sustituido por una licencia permanente.\n\nUna vez obtenga una licencia permamente puede usarla para registrar " +
1887:       strScriptName +
1888:       ". Reemplazarla es r\xe1pido y sencillo, simplemente vaya a:\n\n" +
1889:       exchangeUrl +
1890:       "\n\n\xbfQuiere ir all\xed ahora?",
1891:     fr:
1892:       "Vous avez entr\xe9 un num\xe9ro de s\xe9rie temporaire devant \xeatre \xe9chang\xe9 contre une licence permanente.\n\nQuand vous aurez obtenu votre licence permanente, vous pourrez l\'utiliser pour enregistrer " +
1893:       strScriptName +
1894:       ".  Faire cet \xe9change est rapide et facile! Allez simplement \xe0:\n\n" +
1895:       exchangeUrl +
1896:       "\n\nVoulez-vous y aller maintenant?",
1897:     it:
1898:       "Hai inserito un numero di serie temporaneo che deve essere sostituito con uno permanente.\nUna volta ottenuto il numero di serie permanente lo potrai utilizzare per registrare " +
1899:       strScriptName +
1900:       ". La sostituzione \xe8 facile e veloce, basta visitare:\n\n" +
1901:       exchangeUrl +
1902:       "\n\nVuoi farlo ora?",
1903:     ja:
1904:       "\u901a\u5e38\u30e9\u30a4\u30bb\u30f3\u30b9\u3068\u4ea4\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u4e00\u6642\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u5165\u529b\u3055\u308c\u307e\u3057\u305f.\n\n\u901a\u5e38\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u4e00\u65e6\u5165\u624b\u3059\u308c\u3070, " +
1905:       strScriptName +
1906:       "\u3092\u767b\u9332\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059.  \u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u4ea4\u63db\u306f\u6b21\u306eURL\u306b\u3066\u7c21\u5358\u306b\u884c\u3048\u307e\u3059:\n\n" +
1907:       exchangeUrl +
1908:       "\n\nURL\u3092\u958b\u304d\u307e\u3059\u304b?",
1909:     kr:
1910:       "\uc601\uad6c\uc801\uc778 \ub77c\uc774\uc13c\uc2a4\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \uc784\uc2dc\uc801\uc778 \uc2dc\ub9ac\uc5bc \ub118\ubc84\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub85c\uadf8\uc778\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\n\uc0ac\uc6a9\ub4f1\ub85d\uc744 \uc704\ud55c \uc601\uad6c\uc801\uc778 \ub77c\uc774\uc13c\uc2a4\ub97c \ubc1b\uc558\uc2b5\ub2c8\ub2e4. " +
1911:       strScriptName +
1912:       ". \uc27d\uace0 \ube60\ub978 \uad50\ud658\uc785\ub2c8\ub2e4. \uac04\ub2e8\ud558\uac8c:\n\n" +
1913:       exchangeUrl +
1914:       "\n\n\uc6d0\ud558\uc2dc\ub294 \ud398\uc774\uc9c0\ub85c \uc774\ub3d9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",
1915:     pt:
1916:       "Voc\xea colocou um n\xfamero de s\xe9rie tempor\xe1rio que precisa ser trocado por uma licen\xe7a permanente.\n\nAssim que tiver a licen\xe7a permanente, use-a para registrar " +
1917:       strScriptName +
1918:       ".  \xc9 f\xe1cil e r\xe1pido de mud\xe1-la, simplesmente acesse:\n\n" +
1919:       exchangeUrl +
1920:       "\n\nGostaria de acessar agora?",
1921:     zh_CN:
1922:       "\u60a8\u8f93\u5165\u7684\u4e34\u65f6\u5e8f\u5217\u53f7\u9700\u8981\u66ff\u6362\u4e3a\u6c38\u4e45\u5e8f\u5217\u53f7\u3002\n\n\u4e00\u65e6\u60a8\u83b7\u5f97\u4e86\u6c38\u4e45\u5e8f\u5217\u53f7\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u6ce8\u518c " +
1923:       strScriptName +
1924:       "\u3002\u5e8f\u5217\u53f7\u7684\u66f4\u6362\u662f\u65b9\u4fbf\u548c\u5feb\u6377\u7684\uff0c\u53ea\u9700\u8bbf\u95ee:\n\n" +
1925:       exchangeUrl +
1926:       "\n\n\u60a8\u73b0\u5728\u60f3\u8981\u524d\u5f80\u5417\uff1f",
1927:   });
1928:   var licensingVersion = "4.0.3";
1929:   if (vars.scriptName == undefined) {
1930:     alert("scriptName variable missing in settings object");
1931:   }
1932:   var strScriptName = vars.scriptName;
1933:   if (vars.scriptVersion == undefined) {
1934:     alert("scriptVersion variable missing in settings object");
1935:   }
1936:   var strScriptVersion = vars.scriptVersion;
1937:   if (vars.scriptURL == undefined) {
1938:     alert("scriptURL variable missing in settings object");
1939:   }
1940:   var strTrialUrl = vars.scriptURL;
1941:   if (vars.privateNumber == undefined) {
1942:     alert("privateNumber variable missing in settings object");
1943:   }
1944:   var privateNum = vars.privateNumber;
1945:   if (vars.productSKU == undefined) {
1946:     alert("productSKU variable missing in settings object");
1947:   }
1948:   var strSKU = vars.productSKU;
1949:   var strSKUArray = strSKU.toString().split("-");
1950:   if (strSKUArray == null || strSKUArray.length != 2) {
1951:     alert(
1952:       "Product SKU incorrectly entered in settings. Should looks like this: XXXX-SUL",
1953:     );
1954:     return false;
1955:   }
1956:   var supportTicketSKU = vars.hasOwnProperty("supportTicketSKU")
1957:     ? vars.supportTicketSKU
1958:     : "";
1959:   if (vars.helpText == undefined) {
1960:     vars.helpText = "";
1961:   }
1962:   var strExpiredAlert = localize({
1963:     de:
1964:       "Die Testversion ist leider abgelaufen.\nDu kannst unter " +
1965:       strTrialUrl +
1966:       " eine Lizenz erwerben.\n\nM\xf6chtest Du jetzt dorthin gehen?",
1967:     en:
1968:       "Sorry, this trial version has expired. \nYou can purchase a license at " +
1969:       strTrialUrl +
1970:       "\n\nWould you like to go there now?",
1971:     es:
1972:       "Lo siento, esta versi\xf3n de prueba ha expirado.\nPuede obtener una licencia en" +
1973:       strTrialUrl +
1974:       "\n\n\xbfQuiere ir all\xed ahora?",
1975:     fr:
1976:       "D\xe9sol\xe9, la p\xe9riode d\'essai est expir\xe9e.\nVous pouvez acheter une licence en visitant " +
1977:       strTrialUrl +
1978:       "\n\nVoulez-vous ouvrir cette page maintenant?",
1979:     it:
1980:       "Siamo spiacenti, questa versione di prova \xe8 scaduta. \nPuoi acquistare una licenza visitando " +
1981:       strTrialUrl +
1982:       "\n\nVuoi farlo ora?",
1983:     ja:
1984:       "\u3053\u306e\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u306e\u8a66\u7528\u671f\u9593\u306f\u7d42\u4e86\u3057\u307e\u3057\u305f. \n\u6b21\u306eURL\u306b\u3066\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u8cfc\u5165\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059 " +
1985:       strTrialUrl +
1986:       "\n\nURL\u3092\u958b\u304d\u307e\u3059\u304b?",
1987:     kr:
1988:       "kr: \uc8c4\uc1a1\ud569\ub2c8\ub2e4. \uc774 \uc2dc\ud5d8\ud310\uc740 \uae30\ud55c\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \n\ub77c\uc774\uc13c\uc2a4\ub97c \uc774\uacf3\uc5d0\uc11c \uad6c\uc785\ud558\uc2e4 \uc218 \uc788\uc2b5\ub2c8\ub2e4. " +
1989:       strTrialUrl +
1990:       "\n\n\uc6d0\ud558\uc2dc\ub294 \ud398\uc774\uc9c0\ub85c \uc774\ub3d9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",
1991:     pt:
1992:       "Desculpe, essa vers\xe3o de teste expirou. \nVoc\xea pode comprar a licen\xe7a em " +
1993:       strTrialUrl +
1994:       "\n\nGostaria de acessar agora?",
1995:     zh_CN:
1996:       "\u5bf9\u4e0d\u8d77\uff0c\u8bd5\u7528\u7248\u5df2\u7ecf\u8fc7\u671f\u3002\n\u60a8\u53ef\u4ee5\u5728 " +
1997:       strTrialUrl +
1998:       " \u8d2d\u4e70\u4e00\u4e2a\u8bb8\u53ef\u8bc1\u3002\n\n\u60a8\u73b0\u5728\u60f3\u8981\u524d\u5f80\u5417\uff1f",
1999:   });
2000:   if (vars.helpButtons == undefined) {
2001:     vars.helpButtons = [];
2002:   }
2003:   var isTimeLimited =
2004:     vars.hasOwnProperty("isTimeLimited") && vars.isTimeLimited;
2005:   var strHeader = strSKUArray[0];
2006:   var betaSupportEmail = vars.hasOwnProperty("betaSupportEmail")
2007:     ? vars.betaSupportEmail
2008:     : "";
2009:   var offerTrial = vars.hasOwnProperty("offerTrial") ? vars.offerTrial : true;
2010:   var tLD = vars.hasOwnProperty("tLDXX")
2011:     ? vars.tLDX
2012:     : Math.round(Math.sqrt(parseInt(bD("NTU3Ng==").substr(0, 2))));
2013:   var betaMode = vars.hasOwnProperty("offerBeta") ? vars.offerBeta : false;
2014:   if (betaMode) {
2015:     if (vars.betaStartDate == undefined) {
2016:       alert("betaStartDate variable missing in settings object");
2017:     }
2018:     var betaStartDate = vars.betaStartDate;
2019:     if (vars.betaExpirationDate == undefined) {
2020:       alert("betaExpirationDate variable missing in settings object");
2021:     }
2022:     var betaExpirationDate = vars.betaExpirationDate;
2023:   }
2024:   var strBetaExpiredAlert = localize({
2025:     de: "Die Betaversion ist leider abgelaufen",
2026:     en: "Sorry, this beta version has expired",
2027:     es: "Lo siento est\xe1 versi\xf3n beta ha expirado",
2028:     fr: "D\xe9sol\xe9, cette version beta est expir\xe9e",
2029:     it: "Siamo spiacenti, questa version beta \xe8 scaduta",
2030:     ja: "\u30d9\u30fc\u30bf\u7248\u306e\u671f\u9650\u306f\u7d42\u4e86\u3057\u307e\u3057\u305f",
2031:     kr: "\uc8c4\uc1a1\ud569\ub2c8\ub2e4. \uc774 \ubca0\ud0c0\ubc84\uc804\uc740 \uae30\ud55c\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",
2032:     pt: "Desculpe, essa vers\xe3o beta expirou",
2033:     zh_CN:
2034:       "\u5bf9\u4e0d\u8d77\uff0c\u6b64 Beta \u7248\u672c\u5df2\u7ecf\u8fc7\u671f",
2035:   });
2036:   var tLD = vars.hasOwnProperty("tLDXX")
2037:     ? vars.tLDX
2038:     : Math.round(Math.sqrt(parseInt(bD("MTAwMTA=").substr(0, 3))));
2039:   var supportEmail =
2040:     vars.hasOwnProperty("externalSupportURL") && vars.externalSupportURL != ""
2041:       ? vars.externalSupportURL
2042:       : "https://aescripts.com/contact";
2043:   if (betaMode && betaSupportEmail != "") {
2044:     supportEmail = betaSupportEmail;
2045:   }
2046:   var aescriptsSupportUrl = "https://aescripts.com/contact";
2047:   var supportUrl =
2048:     vars.hasOwnProperty("externalSupportURL") && vars.externalSupportURL != ""
2049:       ? vars.externalSupportURL
2050:       : aescriptsSupportUrl;
2051:   var isAescriptsSupportUrl = supportUrl === aescriptsSupportUrl ? true : false;
2052:   if (isAescriptsSupportUrl) {
2053:     supportUrl = supportUrl.replace(/\/*/, "") + "/?direct=1&sku=";
2054:   }
2055:   var aescriptsRetrieveUrl =
2056:     "https://aescripts.com/downloadable/customer/products";
2057:   var retrieveUrl =
2058:     vars.hasOwnProperty("retrieveLicenseURL") && vars.retrieveLicenseURL != ""
2059:       ? vars.retrieveLicenseURL
2060:       : aescriptsRetrieveUrl;
2061:   var strBetaCodeAlert = {
2062:     detail: localize({
2063:       de: "Beta Lizenzen k\xf6nnen nur f\xfcr Betaversionen verwendet werden. Bitte verwende eine normale Lizenz f\xfcr diese Version.",
2064:       en: "Beta license codes can only be used on beta versions, please obtain a normal license to use this version.",
2065:       es: "Las licencias beta s\xf3lo pueden ser usadas con versiones beta, por favor obtenga una licencia normal para usar esta versi\xf3n.",
2066:       fr: "Les codes pour licence beta ne peuvent \xeatre utilis\xe9s que pour les versions beta, merci de demander une licence r\xe9guli\xe8re pour utiliser cette version.",
2067:       it: "Le Licenze beta possono solo essere usate con versioni beta, si prega di ottenere una licenza regolare da utilizzare con questa versione.",
2068:       ja: "\u30d9\u30fc\u30bf\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u30d9\u30fc\u30bf\u7248\u306e\u307f\u306b\u4f7f\u3046\u3053\u3068\u304c\u51fa\u6765\u307e\u3059. \u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u306f, \u901a\u5e38\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5165\u624b\u3057\u3066\u304f\u3060\u3055\u3044.",
2069:       kr: "\ubca0\ud0c0\ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc\ub294 \ubca0\ud0c0\ubc84\uc804\uc5d0\ub9cc \uc0ac\uc6a9\uc774 \uac00\ub2a5\ud558\uba70, \uc774 \ubc84\uc804\uc758 \uc0ac\uc6a9\uc744 \uc6d0\ud558\uc2dc\uba74 \uc77c\ubc18\uc801\uc778 \ub77c\uc774\uc13c\uc2a4\ub97c \ub2e4\uc6b4\ub85c\ub4dc \ud558\uc2ed\uc2dc\uc624.",
2070:       pt: "Licen\xe7a beta s\xf3 pode ser usada para vers\xf5es beta, por favor adquira uma licen\xe7a normal para usar com essa vers\xe3o.",
2071:       zh_CN:
2072:         "Beta \u8bb8\u53ef\u8bc1\u53ea\u80fd\u7528\u4e8e Beta \u7248\u672c\uff0c\u8bf7\u8d2d\u4e70\u4e00\u4e2a\u6b63\u5f0f\u8bb8\u53ef\u8bc1\u6765\u4f7f\u7528\u6b64\u7248\u672c\u3002",
2073:     }),
2074:     title: localize({
2075:       de: "Beta Lizenz erkannt f\xfcr " + strScriptName,
2076:       en: "Beta license code detected for " + strScriptName,
2077:       es: "Licencia beta detectada para " + strScriptName,
2078:       fr: "Licence beta d\xe9tect\xe9e pour " + strScriptName,
2079:       it: "Licenza beta rilevata per " + strScriptName,
2080:       ja:
2081:         strScriptName +
2082:         "\u306e\u30d9\u30fc\u30bf\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u691c\u51fa\u3055\u308c\u307e\u3057\u305f",
2083:       kr:
2084:         "\ubca0\ud0c0 \ub77c\uc774\uc13c\uc2a4\ub294 \uc9c4\ub2e8\ucc98\ub9ac\ub85c \ucc98\ub9ac\ud569\ub2c8\ub2e4. " +
2085:         strScriptName,
2086:       pt: "Licen\xe7a beta detectada para " + strScriptName,
2087:       zh_CN:
2088:         "\u68c0\u6d4b\u5230 " +
2089:         strScriptName +
2090:         " \u7684 Beta \u7248\u672c\u8bb8\u53ef\u8bc1",
2091:     }),
2092:   };
2093:   var exchangeUrl = "https://license.aescripts.com/exchange";
2094:   var useLegacyPrefsHeader = vars.hasOwnProperty("useLegacyPrefsHeader")
2095:     ? vars.useLegacyPrefsHeader
2096:     : false;
2097:   var managerAppUrl =
2098:     "https://aescripts.com/learn/aescripts-aeplugins-manager-app/";
2099:   var remindMeLaterDays = 7;
2100:   var doUpdateCheck = vars.hasOwnProperty("doUpdateCheck")
2101:     ? vars.doUpdateCheck
2102:     : true;
2103:   var updateCheckInterval = 5;
2104:   var maxUIButtons = 3;
2105:   var licV = 2;
2106:   $.locale = isAE() ? app.isoLanguage : $.locale;
2107:   var locale = $.locale.split("_")[0];
2108:   if (locale != "fr" || locale != "de" || locale != "es") {
2109:     locale = "en";
2110:   }
2111:   var prefsSectionName = vars.hasOwnProperty("legacyPrefsGroup")
2112:     ? vars.legacyPrefsGroup
2113:     : "aescripts";
2114:   var strBetaLicReq = localize({
2115:     de: "F\xfcr diese Betaversion wird eine Lizenz ben\xf6tigt.\nBitte kontaktiere den Autor f\xfcr eine Betatester-Lizenz.",
2116:     en: "A license is required to run this beta version\nPlease contact the author for a beta testing license.",
2117:     es: "Es necesaria una licencia para utilizar esta versi\xf3n beta.\nPor favor, p\xf3ngase en contacto con el autor para obtener una licencia beta.",
2118:     fr: "Une licence est requise pour ex\xe9cuter cette version beta\nMerci de contacter l\'auteur pour une licence beta.",
2119:     it: "Una licenza \xe8 necessaria per utilizzare questa versione beta\nSi prega di contattare l\'autore per una licenza beta.",
2120:     ja: "\u3053\u306e\u30d9\u30fc\u30bf\u7248\u3092\u4f7f\u3046\u305f\u3081\u306b\u306f\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u5fc5\u8981\u3067\u3059.\n\u30d9\u30fc\u30bf\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u88fd\u4f5c\u8005\u306b\u554f\u3044\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044.",
2121:     kr: "\ub77c\uc774\uc13c\uc2a4\ub294 \ubca0\ud0c0\ubc84\uc804 \uc774\uc6a9\uc2dc\uc5d0 \ud544\uc694\ud569\ub2c8\ub2e4.\n\ub77c\uc774\uc13c\uc2a4 \ud14c\uc2a4\ud2b8\ub97c \uc6d0\ud558\uc2dc\uba74 \uc800\uc790\uc5d0\uac8c \uc5f0\ub77d \ubd80\ud0c1\ub4dc\ub9bd\ub2c8\ub2e4.",
2122:     pt: "\xc9 necess\xe1ria uma licen\xe7a para utilizar essa vers\xe3o beta.\nPor favor entre em contato com o autor para receber uma licen\xe7a beta.",
2123:     zh_CN:
2124:       "\u6b64 Beta \u7248\u672c\u9700\u8981\u8bb8\u53ef\u8bc1\u624d\u80fd\u8fd0\u884c\u3002\n\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u53d6 Beta \u7248\u672c\u7684\u6d4b\u8bd5\u8bb8\u53ef\u8bc1\u3002",
2125:   });
2126:   var prefsName = useLegacyPrefsHeader
2127:     ? strScriptName
2128:     : strHeader + "_Registration";
2129:   var prefsVersionName = strHeader + "_Version";
2130:   var prefsLicVersion = strHeader + "_LicVersion";
2131:   var prefsVersionCheckInit = strHeader + "_VersionCheckInit";
2132:   var prefsLastVersionChecked = strHeader + "_LastVersionChecked";
2133:   var prefsLastServerVersionChecked = strHeader + "_LastServerVersionChecked";
2134:   var prefsLastTimeVersionChecked = strHeader + "_LastTimeVersionChecked";
2135:   var prefsNextTimeVersionChecked = strHeader + "_NextTimeVersionChecked";
2136:   var prefsNextTimeVersionCheckedSkipVersion =
2137:     strHeader + "_NextTimeVersionCheckedSkipVersion";
2138:   var prefsDoUpdateCheck = strHeader + "_doUpdateCheck";
2139:   var prefsDoUpdateCheckDisabledAlert =
2140:     strHeader + "_doUpdateCheckDisabledAlert";
2141:   var strFor = localize({
2142:     de: "f\xfcr",
2143:     en: "for",
2144:     es: "para",
2145:     fr: "pour",
2146:     it: "per",
2147:     ja: "\u3078",
2148:     kr: "\uc704\ud55c",
2149:     pt: "para",
2150:     zh_CN: "\u4e3a",
2151:   });
2152:   var doUpdateCheckDisabledAlertAlreadyIssued = false;
2153:   if (haveSettings(prefsSectionName, prefsDoUpdateCheck)) {
2154:     doUpdateCheckDisabledAlertAlreadyIssued = !(
2155:       getSettings(prefsSectionName, prefsDoUpdateCheck) == "false"
2156:     );
2157:   }
2158:   var globalPrefsFolder = checkFoldersAvailability();
2159:   var strUser = localize({
2160:     de: "Nutzer",
2161:     en: "user",
2162:     es: "usuario",
2163:     fr: "utilisateur",
2164:     it: "utente",
2165:     ja: "\u30e6\u30fc\u30b6\u30fc",
2166:     kr: "\uc0ac\uc6a9\uc790",
2167:     pt: "usu\xe1rio",
2168:     zh_CN: "\u7528\u6237",
2169:   });
2170:   var strUsers = localize({
2171:     de: "Nutzer",
2172:     en: "users",
2173:     es: "usuarios",
2174:     fr: "utilisateurs",
2175:     it: "utenti",
2176:     ja: "\u30e6\u30fc\u30b6\u30fc",
2177:     kr: "\uc0ac\uc6a9\uc790\ub4e4",
2178:     pt: "usu\xe1rios",
2179:     zh_CN: "\u7528\u6237",
2180:   });
2181:   saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
2182:   saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
2183:   if ($.os.indexOf("Mac") != -1) {
2184:     cmdKey = "cmd";
2185:   } else {
2186:     cmdKey = "Ctrl";
2187:   }
2188:   var strRegSuccess = localize({
2189:     de: "Registrierung erfolgreich ",
2190:     en: "Registration successful ",
2191:     es: "Registro completado ",
2192:     fr: "Enregistrement r\xe9ussi ",
2193:     it: "Registrazione complatata con successo ",
2194:     ja: "\u767b\u9332\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f",
2195:     kr: "\ub4f1\ub85d \uc644\ub8cc ",
2196:     pt: "Registro completado ",
2197:     zh_CN: "\u6ce8\u518c\u6210\u529f ",
2198:   });
2199:   var prefHeader = "Initialization Fragments";
2200:   var prefSection1 = (
2201:     string_encode(
2202:       Math.floor(parseFloat(app.version))
2203:         .toString()
2204:         .charAt(
2205:           Math.max(
2206:             0,
2207:             Math.floor(parseFloat(app.version)).toString().length - 1,
2208:           ),
2209:         ) +
2210:         strScriptName.substring(
2211:           Math.max(0, strScriptName.length - 15),
2212:           strScriptName.length,
2213:         ) +
2214:         strScriptVersion,
2215:     ) *
2216:     privateNum *
2217:     0.457
2218:   ).toString(36);
2219:   var prefSection2 = (
2220:     string_encode(
2221:       Math.floor(parseFloat(app.version))
2222:         .toString()
2223:         .charAt(
2224:           Math.max(
2225:             0,
2226:             Math.floor(parseFloat(app.version)).toString().length - 1,
2227:           ),
2228:         ) +
2229:         strScriptName.substring(
2230:           Math.max(0, strScriptName.length - 15),
2231:           strScriptName.length,
2232:         ) +
2233:         strScriptVersion,
2234:     ) *
2235:     (privateNum / 3.981)
2236:   ).toString(36);
2237:   var prefsPrefix = "pref_";
2238:   var sanitizedName = sanitizeProductName(strScriptName);
2239:   var strRegSuccess1 = localize({
2240:     de: "Danke f\xfcr den Kauf von " + strScriptName,
2241:     en: "Thank you for purchasing " + strScriptName,
2242:     es: "Gracias por comprar " + strScriptName,
2243:     fr: "Merci d\'avoir achet\xe9 " + strScriptName,
2244:     it: "Grazie per aver acquistato " + strScriptName,
2245:     ja:
2246:       strScriptName +
2247:       "\u3092\u3054\u8cfc\u5165\u3044\u305f\u3060\u304d, \u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059",
2248:     kr:
2249:       "\uad6c\uc785\ud574\uc8fc\uc154\uc11c \uac10\uc0ac\ud569\ub2c8\ub2e4. " +
2250:       strScriptName,
2251:     pt: "Obrigado por comprar " + strScriptName,
2252:     zh_CN: "\u611f\u8c22\u60a8\u8d2d\u4e70 " + strScriptName,
2253:   });
2254:   var strInvalidCode = localize({
2255:     de: "Entschuldigung, der Lizenzcode ist nicht g\xfcltig.",
2256:     en: "Sorry, the license code is not valid",
2257:     es: "Lo siento, la licencia no es v\xe1lida",
2258:     fr: "D\xe9sol\xe9, cette licence n\'est pas valide.",
2259:     it: "Siamo spiacenti, questa licenza non \xe8 valida",
2260:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u6709\u52b9\u3067\u306f\u3042\u308a\u307e\u305b\u3093",
2261:     kr: "\uc8c4\uc1a1\ud569\ub2c8\ub2e4. \ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",
2262:     pt: "Desculpe, essa licen\xe7a \xe9 inv\xe1lida",
2263:     zh_CN: "\u5bf9\u4e0d\u8d77\uff0c\u8bb8\u53ef\u8bc1\u65e0\u6548",
2264:   });
2265:   var strFirewall = localize({
2266:     de: "Eine Firewall oder ein Antivirus-Programm blockiert den Lizenz-Prozess. Bitte deaktiviere das Antivirus-Programm oder konfiguriere das System so, dass die Lizenz verifiziert werden kann.",
2267:     en: "A firewall or virus protection software is blocking the licensing process.  Please disable this or configure it to allow this process so that the license can be verified.",
2268:     es: 'Un software de "firewall" o de protecci\xf3n antivirus est\xe1 bloqueando el proceso de concesi\xf3n de licencias. Desactivela o configurela para permitir este proceso para que la licencia puede ser verificada.',
2269:     fr: "Un logiciel pare-feu ou un logiciel antivirus bloque le processus de v\xe9rification de licence. Veuillez le d\xe9sactiver ou le configurer pour permettre \xe0 ce processus de v\xe9rifier la licence.",
2270:     it: "Un firewall, o un antivirus, sta blocando il processo di verifica della licenza. Si suggerisce di disattivare o configurare tale software per permettere il processo di verifica.",
2271:     ja: "\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb, \u3082\u3057\u304f\u306f\u30a6\u30a3\u30eb\u30b9\u5bfe\u7b56\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u304c\u30e9\u30a4\u30bb\u30f3\u30b9\u8a8d\u8a3c\u3092\u59a8\u3052\u3066\u3044\u307e\u3059. \u30e9\u30a4\u30bb\u30f3\u30b9\u691c\u8a3c\u306e\u305f\u3081, \u3053\u308c\u3089\u3092\u7121\u52b9\u5316\u3059\u308b\u304b, \u3053\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044.",
2272:     kr: "\ubc15\ud654\ubcbd \ub610\ub294 \ubc14\uc774\ub7ec\uc2a4 \ubcf4\ud638 \uc18c\ud504\ud2b8\uc6e8\uc5b4\ub294 \uc778\ud5c8\uac00 \uc808\ucc28\ub97c \uc800\uc9c0\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4. \ub77c\uc774\uc13c\uc2a4\ub97c \uc785\uc99d\ud558\uae30 \uc704\ud574 \uacfc\uc815\uc744 \ud5c8\ub77d\ud558\ub294 \ud658\uacbd\uc124\uc815\uc73c\ub85c \ubcc0\uacbd\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",
2273:     pt: "Um firewall ou antiv\xedrus est\xe1 bloqueando o processo de licenciamento. Por favor desabilite-o ou configure para permitir este processo, para que a licen\xe7a possa ser verificada.",
2274:     zh_CN:
2275:       "\u9632\u706b\u5899\u6216\u75c5\u6bd2\u4fdd\u62a4\u8f6f\u4ef6\u6b63\u5728\u963b\u6b62\u8bb8\u53ef\u8bc1\u8fdb\u7a0b\u3002\u8bf7\u7981\u7528\u8be5\u8f6f\u4ef6\u6216\u914d\u7f6e\u5b83\u4ee5\u5141\u8bb8\u8fd9\u4e2a\u8fdb\u7a0b\uff0c\u4ee5\u4fbf\u8bb8\u53ef\u8bc1\u53ef\u4ee5\u88ab\u9a8c\u8bc1\u3002",
2276:   });
2277:   var strContactSupport = localize({
2278:     de: "Wenn Du Hilfe ben\xf6tigst, kontaktiere bitte " + supportEmail,
2279:     en: "If you require assistance please contact " + supportEmail,
2280:     es: "Si necesita ayuda, por favor contacte " + supportEmail,
2281:     fr: "Si vous avez besoin d\'aide, merci de contacter " + supportEmail,
2282:     it: "Per l\'assistenza si prega di contattare " + supportEmail,
2283:     ja:
2284:       "\u30b5\u30dd\u30fc\u30c8\u304c\u5fc5\u8981\u3067\u3042\u308b\u5834\u5408\u306f, " +
2285:       supportEmail +
2286:       " \u307e\u3067\u3054\u9023\u7d61\u304f\u3060\u3055\u3044.",
2287:     kr:
2288:       "\ub3c4\uc6c0\uc774 \ud544\uc694\ud558\uc2dc\uba74 \uc5f0\ub77d \uc8fc\uc2ed\uc2dc\uc624 " +
2289:       supportEmail,
2290:     pt: "Se precisar de ajuda, por favor contate " + supportEmail,
2291:     zh_CN:
2292:       "\u5982\u679c\u9700\u8981\u5e2e\u52a9\uff0c\u8bf7\u8054\u7cfb " +
2293:       supportEmail,
2294:   });
2295:   var strCorruptedCode = localize({
2296:     de:
2297:       "Entschuldigung, irgendetwas ist mit dem " +
2298:       strScriptName +
2299:       " Lizenzcode passiert. Bitte gebe ihn erneut ein.\n\n" +
2300:       strContactSupport,
2301:     en:
2302:       "Sorry, something must have happened to the " +
2303:       strScriptName +
2304:       " license code.  Please re-enter it at the prompt.\n" +
2305:       strContactSupport,
2306:     es:
2307:       "Lo siento, algo ha ocurrido con la licencia de " +
2308:       strScriptName +
2309:       ". Por favor, vuelva a introducirla en la casilla.\n" +
2310:       strContactSupport,
2311:     fr:
2312:       "D\xe9sol\xe9, il y a eu un probl\xe8me avec le num\xe9ro de licence pour " +
2313:       strScriptName +
2314:       ". Merci de bien vouloir le saisir \xe0 nouveau.\n" +
2315:       strContactSupport,
2316:     it:
2317:       "Spiacente, \xe8 stato riscontrato un problema alla licenza per " +
2318:       strScriptName +
2319:       ". Si prega di reinserirla.\n" +
2320:       strContactSupport,
2321:     ja:
2322:       strScriptName +
2323:       " \u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f. \u518d\u5ea6\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044.\n" +
2324:       strContactSupport,
2325:     kr:
2326:       "\uc8c4\uc1a1\ud569\ub2c8\ub2e4. \uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4.  " +
2327:       strScriptName +
2328:       " \ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc, \uc989\uac01\uc801\uc73c\ub85c \ub2e4\uc2dc \ub4e4\uc5b4\uac00\uae30 \ubc14\ub78d\ub2c8\ub2e4. \n" +
2329:       strContactSupport,
2330:     pt:
2331:       "Desculpe, aconteceu algum problema com o c\xf3digo de licen\xe7a para " +
2332:       strScriptName +
2333:       ".  Por favor, digite novamente.\n" +
2334:       strContactSupport,
2335:     zh_CN:
2336:       "\u5bf9\u4e0d\u8d77\uff0c" +
2337:       strScriptName +
2338:       " \u7684\u8bb8\u53ef\u8bc1\u53d1\u751f\u4e86\u4e00\u4e9b\u95ee\u9898\u3002\u8bf7\u91cd\u65b0\u8f93\u5165\u3002\n" +
2339:       strContactSupport,
2340:   });
2341:   function compareVersions(a, b) {
2342:     if (a === b) {
2343:       return 0;
2344:     }
2345:     var a_components = a.toString().split(".");
2346:     var b_components = b.toString().split(".");
2347:     if (a_components.length <= 2 && b_components.length <= 2) {
2348:       if (a > b) {
2349:         return 1;
2350:       }
2351:       if (a < b) {
2352:         return -1;
2353:       }
2354:     } else {
2355:       var len = Math.min(a_components.length, b_components.length);
2356:       for (var i = 0; i < len; i += 1) {
2357:         if (parseInt(a_components[i]) > parseInt(b_components[i])) {
2358:           return 1;
2359:         }
2360:         if (parseInt(a_components[i]) < parseInt(b_components[i])) {
2361:           return -1;
2362:         }
2363:       }
2364:       if (a_components.length > b_components.length) {
2365:         return 1;
2366:       }
2367:       if (a_components.length < b_components.length) {
2368:         return -1;
2369:       }
2370:       return 0;
2371:     }
2372:   }
2373:   var strTrialThanks = localize({
2374:     de: "Danke, dass Du " + strScriptName + " ausprobierst!",
2375:     en: "Thanks for trying " + strScriptName + "!",
2376:     es: "\xa1Gracias por probar " + strScriptName + "!",
2377:     fr: "Merci d\'avoir essay\xe9 " + strScriptName + "!",
2378:     it: "Grazie per aver scelto di provare" + strScriptName + "!",
2379:     ja:
2380:       strScriptName +
2381:       " \u3092\u3054\u8a66\u7528\u3044\u305f\u3060\u304d\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059!",
2382:     kr:
2383:       "\uc2dc\ub3c4\ud574\uc8fc\uc154\uc11c \uac10\uc0ac\ud569\ub2c8\ub2e4 " +
2384:       strScriptName +
2385:       "!",
2386:     pt: "Obrigado por testar " + strScriptName + "!",
2387:     zh_CN: "\u611f\u8c22\u60a8\u8bd5\u7528 " + strScriptName + "!",
2388:   });
2389:   var strTrialTxt = localize({
2390:     de: "Testversion - noch %E Tage g\xfcltig",
2391:     en: "Trial version - %E days left",
2392:     es: "Versi\xf3n de prueba - faltan %E d\xedas",
2393:     fr: "Version d\'\xe9valuation - %E jour(s) restant(s)",
2394:     it: "Versione di prova - %E giorni alla scadenza",
2395:     ja: "\u30c8\u30e9\u30a4\u30a2\u30eb\u7248 - \u6b8b\u308a %E \u65e5",
2396:     kr: "\uc2dc\ud5d8\ud310 - %E \ub0a8\uc558\uc2b5\ub2c8\ub2e4",
2397:     pt: "Vers\xe3o de teste - faltam %E dias",
2398:     zh_CN: "\u8bd5\u7528\u7248 - \u5269\u4f59 %E \u5929",
2399:   });
2400:   var strTrialTxt2 = localize({
2401:     de: "%E Programmstarts \xfcbrig f\xfcr die Testversion",
2402:     en: "%E launches left in the trial",
2403:     es: "%E usos restantes de la versi\xf3n de prueba",
2404:     fr: "Il vous reste %E essais",
2405:     it: "%E avvii rimanenti per la versione di prova",
2406:     ja: "\u6b8b\u308a %E \u56de \u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u3092\u8d77\u52d5\u3067\u304d\u307e\u3059",
2407:     kr: "%E \ud68c \uc2dc\ud5d8\uc5d0 \ub0a8\uc558\uc2b5\ub2c8\ub2e4",
2408:     pt: "%E usos restantes da vers\xe3o de teste",
2409:     zh_CN: "\u8bd5\u7528\u7248\u5269\u4f59 %E \u6b21\u4f7f\u7528\u6b21\u6570",
2410:   });
2411:   function JSONify(string, mode, prettyJSON) {
2412:     if (typeof JSON !== "object") {
2413:       JSON = {};
2414:     }
2415:     (function () {
2416:       function f(n) {
2417:         return n < 10 ? "0" + n : n;
2418:       }
2419:       function this_value() {
2420:         return this.valueOf();
2421:       }
2422:       function quote(string) {
2423:         rx_escapable.lastIndex = 0;
2424:         return rx_escapable.test(string)
2425:           ? '"' +
2426:               string.replace(rx_escapable, function (a) {
2427:                 var c = meta[a];
2428:                 return typeof c === "string"
2429:                   ? c
2430:                   : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
2431:               }) +
2432:               '"'
2433:           : '"' + string + '"';
2434:       }
2435:       function str(key, holder) {
2436:         var mind = gap;
2437:         var value = holder[key];
2438:         if (
2439:           value &&
2440:           typeof value === "object" &&
2441:           typeof value.toJSON === "function"
2442:         ) {
2443:           value = value.toJSON(key);
2444:         }
2445:         if (typeof rep === "function") {
2446:           value = rep.call(holder, key, value);
2447:         }
2448:         switch (typeof value) {
2449:           case "string":
2450:             return quote(value);
2451:           case "number":
2452:             return isFinite(value) ? String(value) : "null";
2453:           case "boolean":
2454:           case "null":
2455:             return String(value);
2456:           case "object":
2457:             if (!value) {
2458:               return "null";
2459:             }
2460:             gap += indent;
2461:             partial = [];
2462:             if (Object.prototype.toString.apply(value) === "[object Array]") {
2463:               length = value.length;
2464:               for (var i = 0; i < length; i += 1) {
2465:                 partial[i] = str(i, value) || "null";
2466:               }
2467:               v =
2468:                 partial.length === 0
2469:                   ? "[]"
2470:                   : gap
2471:                     ? "[\n" +
2472:                       gap +
2473:                       partial.join(",\n" + gap) +
2474:                       "\n" +
2475:                       mind +
2476:                       "]"
2477:                     : "[" + partial.join(",") + "]";
2478:               gap = mind;
2479:               return v;
2480:             }
2481:             if (rep && typeof rep === "object") {
2482:               length = rep.length;
2483:               for (var i = 0; i < length; i += 1) {
2484:                 if (typeof rep[i] === "string") {
2485:                   k = rep[i];
2486:                   v = str(k, value);
2487:                   if (v) {
2488:                     partial.push(quote(k) + gap ? ": " : ":" + v);
2489:                   }
2490:                 }
2491:               }
2492:             } else {
2493:               for (var k in value) {
2494:                 if (Object.prototype.hasOwnProperty.call(value, k)) {
2495:                   v = str(k, value);
2496:                   if (v) {
2497:                     partial.push(quote(k) + gap ? ": " : ":" + v);
2498:                   }
2499:                 }
2500:               }
2501:             }
2502:             v =
2503:               partial.length === 0
2504:                 ? "{}"
2505:                 : gap
2506:                   ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}"
2507:                   : "{" + partial.join(",") + "}";
2508:             gap = mind;
2509:             return v;
2510:         }
2511:       }
2512:       ("use strict");
2513:       var rx_one = /^[\],:{}\s]*$/;
2514:       var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
2515:       var rx_three =
2516:         /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
2517:       var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
2518:       var rx_escapable =
2519:         /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
2520:       var rx_dangerous =
2521:         /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
2522:       if (typeof Date.prototype.toJSON !== "function") {
2523:         Date.prototype.toJSON = function () {
2524:           return isFinite(this.valueOf())
2525:             ? this.getUTCFullYear() +
2526:                 "-" +
2527:                 f(this.getUTCMonth() + 1) +
2528:                 "-" +
2529:                 f(this.getUTCDate()) +
2530:                 "T" +
2531:                 f(this.getUTCHours()) +
2532:                 ":" +
2533:                 f(this.getUTCMinutes()) +
2534:                 ":" +
2535:                 f(this.getUTCSeconds()) +
2536:                 "Z"
2537:             : null;
2538:         };
2539:         Boolean.prototype.toJSON = this_value;
2540:         Number.prototype.toJSON = this_value;
2541:         String.prototype.toJSON = this_value;
2542:       }
2543:       if (typeof JSON.stringify !== "function") {
2544:         meta = {
2545:           "\b": "\\b",
2546:           "\t": "\\t",
2547:           "\n": "\\n",
2548:           "\f": "\\f",
2549:           "\r": "\\r",
2550:           '"': '\\"',
2551:           "\\": "\\\\",
2552:         };
2553:         JSON.stringify = function (value, replacer, space) {
2554:           gap = "";
2555:           indent = "";
2556:           if (typeof space === "number") {
2557:             for (var i = 0; i < space; i += 1) {
2558:               indent += " ";
2559:             }
2560:           } else {
2561:             if (typeof space === "string") {
2562:               indent = space;
2563:             }
2564:           }
2565:           rep = replacer;
2566:           if (
2567:             replacer &&
2568:             typeof replacer !== "function" &&
2569:             (typeof replacer !== "object" ||
2570:               typeof replacer.length !== "number")
2571:           ) {
2572:             throw new Error("JSON.stringify");
2573:           }
2574:           return str("", { "": value });
2575:         };
2576:       }
2577:     })();
2578:     var jsonParse = (function () {
2579:       function v(h, j, e) {
2580:         return j ? u[j] : String.fromCharCode(parseInt(e, 16));
2581:       }
2582:       var r = "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
2583:       var k =
2584:         '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
2585:       k = '(?:"' + k + '*")';
2586:       var s = new RegExp(
2587:         "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
2588:         "g",
2589:       );
2590:       var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
2591:       var u = {
2592:         '"': '"',
2593:         "/": "/",
2594:         "\\": "\\",
2595:         b: "\b",
2596:         f: "\f",
2597:         n: "\n",
2598:         r: "\r",
2599:         t: "\t",
2600:       };
2601:       var w = new String("");
2602:       var x = Object.hasOwnProperty;
2603:       return function (h, j) {
2604:         h = h.match(s);
2605:         var c = h[0];
2606:         var l = false;
2607:         if ("{" === c) {
2608:           e = {};
2609:         } else if ("[" === c) {
2610:           e = [];
2611:         } else {
2612:           e = [];
2613:           l = true;
2614:         }
2615:         for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
2616:           c = h[m];
2617:           switch (c.charCodeAt(0)) {
2618:             default:
2619:               a = d[0];
2620:               a[b || a.length] = c;
2621:               b = void 0;
2622:               break;
2623:             case 34:
2624:               c = c.substring(1, c.length - 1);
2625:               if (c.indexOf("\\") !== -1) {
2626:                 c = c.replace(t, v);
2627:               }
2628:               a = d[0];
2629:               if (!b) {
2630:                 if (a instanceof Array) {
2631:                   b = a.length;
2632:                 } else {
2633:                   b = c || w;
2634:                   break;
2635:                 }
2636:               }
2637:               a[b] = c;
2638:               b = void 0;
2639:               break;
2640:             case 91:
2641:               a = d[0];
2642:               d.unshift((a[b || a.length] = []));
2643:               b = void 0;
2644:               break;
2645:             case 93:
2646:               d.shift();
2647:               break;
2648:             case 102:
2649:               a = d[0];
2650:               a[b || a.length] = false;
2651:               b = void 0;
2652:               break;
2653:             case 110:
2654:               a = d[0];
2655:               a[b || a.length] = null;
2656:               b = void 0;
2657:               break;
2658:             case 116:
2659:               a = d[0];
2660:               a[b || a.length] = true;
2661:               b = void 0;
2662:               break;
2663:             case 123:
2664:               a = d[0];
2665:               d.unshift((a[b || a.length] = {}));
2666:               b = void 0;
2667:               break;
2668:             case 125:
2669:               d.shift();
2670:               break;
2671:           }
2672:         }
2673:         if (l) {
2674:           if (d.length !== 1) {
2675:             throw new Error();
2676:           }
2677:           e = e[0];
2678:         } else {
2679:           if (d.length) {
2680:             throw new Error();
2681:           }
2682:         }
2683:         if (j) {
2684:           var p = function (n, o) {
2685:             var f = n[o];
2686:             if (f && typeof f === "object") {
2687:               var i = null;
2688:               for (var g in f) {
2689:                 if (x.call(f, g) && f !== n) {
2690:                   var q = p(f, g);
2691:                   if (q !== void 0) {
2692:                     f[g] = q;
2693:                   } else {
2694:                     i || (i = []);
2695:                     i.push(g);
2696:                   }
2697:                 }
2698:               }
2699:               if (i) {
2700:                 for (g = i.length; --g >= 0; ) {
2701:                   delete f[i[g]];
2702:                 }
2703:               }
2704:             }
2705:             return j.call(n, o, f);
2706:           };
2707:           e = p({ "": e }, "");
2708:         }
2709:         return e;
2710:       };
2711:     })();
2712:     try {
2713:       switch (mode) {
2714:         case "parse":
2715:           if (validateJSON(string)) {
2716:             return jsonParse(string);
2717:           } else {
2718:             alert("JSON validation error\n" + string.substring(0, 1000));
2719:             return null;
2720:           }
2721:           break;
2722:         case "stringify":
2723:           return JSON.stringify(string, undefined, prettyJSON);
2724:           break;
2725:       }
2726:     } catch (e) {
2727:       alert(e.toString());
2728:     }
2729:   }
2730:   function validateJSON(string) {
2731:     return /^[\],:{}\s]*$/.test(
2732:       string
2733:         .replace(/\\["\\\/bfnrtu]/g, "@")
2734:         .replace(
2735:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
2736:           "]",
2737:         )
2738:         .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
2739:     );
2740:   }
2741:   var strTrialWelcomeHeader = localize({
2742:     de: "Willkommen bei " + strScriptName,
2743:     en: "Welcome to " + strScriptName,
2744:     es: "Bienvenido a " + strScriptName,
2745:     fr: "Bienvenue sur " + strScriptName,
2746:     it: "Benvenuto a " + strScriptName,
2747:     ja: strScriptName + "\u3078\u3088\u3046\u3053\u305d",
2748:     kr: "\ud658\uc601\ud569\ub2c8\ub2e4 " + strScriptName,
2749:     pt: "Bem-vindo ao " + strScriptName,
2750:     zh_CN: "\u6b22\u8fce\u4f7f\u7528 " + strScriptName,
2751:   });
2752:   var strOK = localize({
2753:     de: "OK",
2754:     en: "OK",
2755:     es: "OK",
2756:     fr: "OK",
2757:     it: "OK",
2758:     ja: "OK",
2759:     kr: "\ub124",
2760:     pt: "OK",
2761:     zh_CN: "\u597d\u7684",
2762:   });
2763:   var strCancel = localize({
2764:     de: "Abbrechen",
2765:     en: "Cancel",
2766:     es: "Cancelar",
2767:     fr: "Annuler",
2768:     it: "Annulla",
2769:     ja: "\u30ad\u30e3\u30f3\u30bb\u30eb",
2770:     kr: "\ucde8\uc18c",
2771:     pt: "Cancelar",
2772:     zh_CN: "\u53d6\u6d88",
2773:   });
2774:   var strGetSupport = localize({
2775:     de: "Support erhalten",
2776:     en: "Get support",
2777:     es: "Obtener apoyo",
2778:     fr: "Contacter le support client",
2779:     it: "Chiedi assistenza",
2780:     ja: "\u30b5\u30dd\u30fc\u30c8\u3078",
2781:     kr: "\ub3c4\uc6c0\ubc1b\uae30",
2782:     pt: "Ajuda",
2783:     zh_CN: "\u83b7\u53d6\u652f\u6301",
2784:   });
2785:   var strRetrieveLic = localize({
2786:     de: "%t vergessen?",
2787:     en: "Retrieve %t",
2788:     es: "Recuperar %t",
2789:     fr: "Retrouver votre %t",
2790:     it: "Recupera %t",
2791:     ja: "%t \u3092\u53d6\u5f97\u3059\u308b",
2792:     kr: "\uac80\uc0c9\ud558\uae30 %t",
2793:     pt: "Recuperar %t",
2794:     zh_CN: "\u6062\u590d %t",
2795:   });
2796:   var strBuyLic = localize({
2797:     de: "%t Kaufen",
2798:     en: "Buy %t",
2799:     es: "Compra %t",
2800:     fr: "Acheter une %t",
2801:     it: "Acquista %t",
2802:     ja: "%t \u3092\u8cfc\u5165\u3059\u308b",
2803:     kr: "\uad6c\uc785\ud558\uae30 %t",
2804:     pt: "Comprar %t",
2805:     zh_CN: "\u8d2d\u4e70 %t",
2806:   });
2807:   var strLicense = localize({
2808:     de: "Lizenz",
2809:     en: "License",
2810:     es: "licencia",
2811:     fr: "Licence",
2812:     it: "Licenza",
2813:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9",
2814:     kr: "\ub77c\uc774\uc13c\uc2a4",
2815:     pt: "Licen\xe7a",
2816:     zh_CN: "\u8bb8\u53ef\u8bc1",
2817:   });
2818:   var strPpcNotSupported = localize({
2819:     de: "PowerPC (PPC) Prozessoren werden leider nicht unterst\xfctzt. Bitte kontaktiere den Support f\xfcr weitere Informationen.",
2820:     en: "Sorry, PowerPC (PPC) processors are not supported, please contact support for further assistance.",
2821:     es: "Lo siendto, los procesadores PowerPC (PPC) no est\xe1n soportados, por favor contacte con soporte para m\xe1s informaci\xf3n.",
2822:     fr: "D\xe9sol\xe9, les processeurs PowerPC (PPC) ne sont pas support\xe9s, veuillez contacter le support client pour plus de d\xe9tails.",
2823:     it: "Spiacente, i processori PowerPC (PPC) non sono supportati, contattare l\'assistenza per ulteriori dettagli.",
2824:     ja: "PowerPC (PPC)\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093. \u8a73\u7d30\u306b\u3064\u304d\u307e\u3057\u3066\u306f\u30b5\u30dd\u30fc\u30c8\u307e\u3067\u304a\u554f\u3044\u5408\u308f\u305b\u304f\u3060\u3055\u3044.",
2825:     kr: "\uc8c4\uc1a1\ud569\ub2c8\ub2e4. PowerPC (PPC) processors\ub294 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uacc4\uc18d\uc801\uc778 \ub3c4\uc6c0\ubc1b\uae30\ub97c \uc6d0\ud558\uc2dc\uba74 \uc11c\ube44\uc2a4\uc13c\ud130 \uc73c\ub85c \uc5f0\ub77d \uc8fc\uc2ed\uc2dc\uc624.",
2826:     pt: "Desculpe, os processadores PowerPC (PPC) n\xe3o s\xe3o suportados, por favor entre em contato com o suporte para assist\xeancia.",
2827:     zh_CN:
2828:       "\u5bf9\u4e0d\u8d77\uff0c\u4e0d\u652f\u6301 PowerPC (PPC) \u5904\u7406\u5668\uff0c\u8bf7\u8054\u7cfb\u5ba2\u6237\u652f\u6301\u83b7\u53d6\u66f4\u591a\u5e2e\u52a9\u3002",
2829:   });
2830:   var strAllowScriptsPrefsSection =
2831:     parseFloat(app.version) < 16.1
2832:       ? localize({
2833:           de: "Allgemein",
2834:           en: "General",
2835:           es: "General",
2836:           fr: "G\xe9n\xe9ral",
2837:           it: "Generale",
2838:           ja: "\u4e00\u822c\u8a2d\u5b9a",
2839:           kr: "\uc77c\ubc18",
2840:           pt: "Geral",
2841:           zh_CN: "\u5e38\u89c4",
2842:         })
2843:       : localize({
2844:           de: "Skripterstellung und Expressions",
2845:           en: "Scripting & Expressions",
2846:           es: "Scripts y expresi\xf3nes",
2847:           fr: "Scripts et expressions",
2848:           it: "Scripting ed Espressioni",
2849:           ja: "\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u30a8\u30af\u30b9\u30d7\u30ec\u30c3\u30b7\u30e7\u30f3",
2850:           kr: "\uc2a4\ud06c\ub9bd\ud2b8 & \uc775\uc2a4\ud504\ub808\uc158 ",
2851:           pt: "Scripts e express\xf5es",
2852:           zh_CN: "\u811a\u672c\u548c\u8868\u8fbe\u5f0f",
2853:         });
2854:   var strErrScriptAccess = localize({
2855:     de:
2856:       strScriptName +
2857:       " ben\xf6tigt die Erlaubnis, Dateien zu schreiben\n " +
2858:       'Gehe in den Voreinstellungen von After Effects in die Rubrik "' +
2859:       strAllowScriptsPrefsSection +
2860:       '" und aktiviere die ' +
2861:       'Option "Skripte k\xf6nnen Dateien schreiben und haben Netzwerkzugriff".',
2862:     en:
2863:       strScriptName +
2864:       " requires access to write files\n" +
2865:       'Go to the "' +
2866:       strAllowScriptsPrefsSection +
2867:       '" panel of the application preferences and make sure ' +
2868:       '"Allow Scripts to Write Files and Access Network" is checked.',
2869:     es:
2870:       strScriptName +
2871:       " necesita poder escribir archivos\n" +
2872:       'Vaya al panel "' +
2873:       strAllowScriptsPrefsSection +
2874:       '" de las Preferencias y aseg\xfarese de que ' +
2875:       '"Permitir que los scripts puedan escribir archivos y acceder a la red" est\xe1 marcado.\n',
2876:     fr:
2877:       strScriptName +
2878:       " n\xe9cessite les droits d\'\xe9criture de fichiers\n" +
2879:       'Allez dans le panneau "' +
2880:       strAllowScriptsPrefsSection +
2881:       "\" des pr\xe9f\xe9rences de l\'application et cochez \n" +
2882:       '"Autoriser les scripts \xe0 \xe9crire des fichiers et \xe0 acc\xe9der au r\xe9seau"',
2883:     it:
2884:       strScriptName +
2885:       " ha bisogno di scrivere file\n" +
2886:       "Vai nel pannello delle preferenze dell\'applicazione \"" +
2887:       strAllowScriptsPrefsSection +
2888:       '" e assicurati che ' +
2889:       '"Consenti agli script di scrivere i file e accedere alla rete" sia spuntato.',
2890:     ja:
2891:       strScriptName +
2892:       " \u304c\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u66f8\u304d\u8fbc\u307f\u30a2\u30af\u30bb\u30b9\u3092\u8981\u6c42\u3057\u3066\u3044\u307e\u3059.\n" +
2893:       '\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u74b0\u5883\u8a2d\u5b9a\u304b\u3089 "' +
2894:       strAllowScriptsPrefsSection +
2895:       '" \u3092\u958b\u304d' +
2896:       '"\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3088\u308b\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u66f8\u304d\u8fbc\u307f\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef" \u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044.',
2897:     kr:
2898:       strScriptName +
2899:       " \ud30c\uc77c\uc744 \uc4f0\uae30\uc704\ud574 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. \n" +
2900:       '\ub85c \uac00\uc2ed\uc2dc\uc624"' +
2901:       strAllowScriptsPrefsSection +
2902:       '" \uc5b4\ud50c\ub9ac\ucf00\uc774\uc158 \uc138\ud305\uc758 \ud310\ub12c\uacfc \uc2a4\ud06c\ub9bd\ud2b8 \uc0ac\uc6a9, \ub124\ud2b8\uc6cc\ud06c\uc811\uadfc \ud5c8\uc6a9\ud558\uc2ed\uc2dc\uc624.',
2903:     pt:
2904:       strScriptName +
2905:       " precisa de acesso para gravar arquivos\n" +
2906:       'Acesse a op\xe7\xe3o "' +
2907:       strAllowScriptsPrefsSection +
2908:       '" nas Prefer\xeancias e certifique-se que ' +
2909:       '"Permitir que scripts gravem arquivos e acessem as redes" esteja selecionado.',
2910:     zh_CN:
2911:       strScriptName +
2912:       " \u9700\u8981\u5199\u6587\u4ef6\u7684\u6743\u9650\n" +
2913:       '\u8bf7\u5230 After Effects \u5e94\u7528\u7a0b\u5e8f\u7684 \n"' +
2914:       strAllowScriptsPrefsSection +
2915:       '" \u9762\u677f\u4e2d\uff0c\u5e76\u786e\u8ba4"\u5141\u8bb8\u811a\u672c\u5199\u5165\u6587\u4ef6\u548c\u8bbf\u95ee\u7f51\u7edc"\u5df2\u9009\u4e2d\u3002',
2916:   });
2917:   var strUpdateLicenseHeader = localize({
2918:     de: strScriptName + " Lizenz-Update ben\xf6tigt",
2919:     en: strScriptName + " License Update Required",
2920:     es: strScriptName + " necesita actualizar la licencia",
2921:     fr: "La licence de " + strScriptName + " doit \xeatre mise \xe0 jour",
2922:     it: "\xc8 necessario aggiornare la licenza di " + strScriptName,
2923:     ja:
2924:       strScriptName +
2925:       "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u66f4\u65b0\u304c\u5fc5\u8981\u3067\u3059",
2926:     kr:
2927:       strScriptName +
2928:       " \ub77c\uc774\uc13c\uc2a4\uc758 \uc5c5\ub370\uc774\ud2b8\uac00 \ud544\uc694\ud568",
2929:     pt: "A licen\xe7a do " + strScriptName + " precisa ser atualizada",
2930:     zh_CN: strScriptName + " \u7684\u8bb8\u53ef\u8bc1\u9700\u8981\u66f4\u65b0",
2931:   });
2932:   var strLicenseDownloadOptions = localize({
2933:     de: 'Alle Deine %t findest Du unter "My Downloads & Licenses" in Deinem aescripts.com Benutzer-Account, oder \xfcber unsere Manager-App.',
2934:     en: 'All your %t are in the "My Downloads & Licenses" section of your aescripts.com user account, or via our Manager App.',
2935:     es: 'Todas sus %t est\xe1n en la secci\xf3n "My Downloads & Licenses" de su cuenta de usuario en aescripts.com, o a trav\xe9s de nuestra App Manager.',
2936:     fr: 'Toutes vos %t se trouvent dans la section "My Downloads & Licenses" de votre compte utilisateur sur aescripts.com, ou via notre App Manager.',
2937:     it: 'Tutti i tuoi %t sono nella sezione "My Downloads & Licenses" del tuo account utente su aescripts.com, o sulla nostra Manager App.',
2938:     ja: '\u3059\u3079\u3066\u306e\u3042\u306a\u305f\u306e %t \u306f, aescripts.com\u306e\u30a2\u30ab\u30a6\u30f3\u30c8, \u3082\u3057\u304f\u306f\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e"My Downloads & Licenses"\u30bb\u30af\u30b7\u30e7\u30f3\u306b\u3042\u308a\u307e\u3059.',
2939:     kr: "\ubaa8\ub4e0 \uac83\ub4e4\uc740 My Downloads & Licenses \uc5d0 \uc788\uc2b5\ub2c8\ub2e4.  \ubd80\ubd84\uc740 \uadc0\ud558\uc758 aescripts.com \ub610\ub294 \ub2f9\uc0ac\uc758 \ub9e4\ub2c8\uc838 \uc571\uc5d0 \uc704\uce58",
2940:     pt: 'Todos os seus %t est\xe3o na se\xe7\xe3o "My Downloads & Licenses" da sua conta no aescripts.com, ou pelo nosso App de gerenciamento.',
2941:     zh_CN:
2942:       '\u6240\u6709\u7684 %t \u5728\u60a8\u7684 aescripts.com \u7528\u6237\u8d26\u6237\u7684"My Downloads & Licenses"\u90e8\u5206\uff0c\u6216\u901a\u8fc7\u6211\u4eec\u7684 Manager App\u3002',
2943:   });
2944:   var strMyDownloads = localize({
2945:     de: "Gehe zu My Downloads & Licenses",
2946:     en: "Go to My Downloads & Licenses",
2947:     es: "Ir a My Downloads & Licenses",
2948:     fr: "Aller \xe0 My Downloads & Licenses",
2949:     it: "Vai a My Downloads & Licenses",
2950:     ja: "My Downloads & Licenses \u3092\u958b\u304f",
2951:     kr: "\ub098\uc758 \ub2e4\uc6b4\ub85c\ub4dc & \ub77c\uc774\uc13c\uc2a4 \ud398\uc774\uc9c0\ub85c \uc774\ub3d9",
2952:     pt: "Ir para meus Downloads e Licen\xe7as",
2953:     zh_CN: "\u524d\u5f80 My Downloads & Licenses",
2954:   });
2955:   var strDownloadManager = localize({
2956:     de: "Lade die Manager-App herunter",
2957:     en: "Download Manager App",
2958:     es: "Descargar App Manager",
2959:     fr: "T\xe9l\xe9charger App Manager",
2960:     it: "Scarica Manager App",
2961:     ja: "\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3",
2962:     kr: "\ub2e4\uc6b4\ub85c\ub4dc \ub9e4\ub2c8\uc838 \uc571",
2963:     pt: "Baixar o App de gerenciamento",
2964:     zh_CN: "\u4e0b\u8f7d Manager App",
2965:   });
2966:   var strOldLicenseFormat = localize({
2967:     de: "Die Lizenz sollte so aussehen:\n\nVorname**Nachname**111111111SUL",
2968:     en: "License should look like this:\n\nFirstname**Lastname**111111111SUL",
2969:     es: "La licencia debe tener este aspecto:\n\nNombre**Apellido**111111111SUL",
2970:     fr: "Votre licence doit ressembler \xe0 : \n\nPr\xe9nom**Nom**111111111SUL",
2971:     it: "La licenza dovrebbe avere il seguente formato:\n\nNome**Cognome**111111111SUL",
2972:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u5f0f\u3092\u3057\u3066\u3044\u307e\u3059:\n\nNamae**Myouji**111111111SUL",
2973:     kr: "\ub77c\uc774\uc13c\uc2a4\ub294 \uc774\ub984 \uc131 \uc73c\ub85c \ub4f1\ub85d\ud558\uc154\uc57c\ud569\ub2c8\ub2e4:\n\nFirstname**Lastname**111111111SUL",
2974:     pt: "A licen\xe7a deve estar nesse formato:\n\nNome**Apelido**111111111SUL",
2975:     zh_CN:
2976:       "\u8bb8\u53ef\u8bc1\u5e94\u8be5\u50cf\u8fd9\u6837:\n\n\u540d\u5b57**\u59d3**111111111SUL",
2977:   });
2978:   var strNewLicenseFormat = localize({
2979:     de: "Die Lizenz sollte so aussehen:\n\nPRODUCTID*VORNAME*NACHNAME*1111111SUL1",
2980:     en: "License should look like this:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
2981:     es: "La licencia debe tener este aspecto:\n\nPRODUCTID*NOMBRE*APELLIDO*1111111SUL1",
2982:     fr: "Votre licence doit ressembler \xe0 : \n\nPRODUCTID*PRENOM*NOM*1111111SUL1",
2983:     it: "La licenza dovrebbe avere il seguente formato:\n\nPRODUCTID*NOME*COGNOME*1111111SUL1",
2984:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u5f0f\u3092\u3057\u3066\u3044\u307e\u3059:\n\nPRODUCTID*NAMAE*MYOUJI*1111111SUL1",
2985:     kr: "\ub77c\uc774\uc13c\uc2a4\ub294 \uc0c1\ud488\uba85, \uc774\ub984, \uc131:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
2986:     pt: "A licen\xe7a deve ter esse formato:\n\nPRODUCTID*NOME*SOBRENOME*1111111SUL1",
2987:     zh_CN:
2988:       "\u8bb8\u53ef\u8bc1\u5e94\u8be5\u50cf\u8fd9\u6837:\n\n\u4ea7\u54c1ID*\u540d\u5b57*\u59d3*1111111SUL1",
2989:   });
2990:   var strRegistration = localize({
2991:     de: "Registriert f\xfcr: ",
2992:     en: "Registered to: ",
2993:     es: "Registrado a: ",
2994:     fr: "Enregistr\xe9 pour: ",
2995:     it: "Registrato a: ",
2996:     ja: "\u767b\u9332\u5bfe\u8c61: ",
2997:     kr: "\uc791\uc131\ud569\ub2c8\ub2e4: ",
2998:     pt: "Registrado para: ",
2999:     zh_CN: "\u5df2\u6ce8\u518c\u5230: ",
3000:   });
3001:   var strUnknownError = localize({
3002:     de:
3003:       "Es gab einen unerwarteten Fehler\nBitte er\xf6ffne hier ein Support-Ticket:\n" +
3004:       supportEmail +
3005:       "\n\nund f\xfcge einen Screenshot der Fehlermeldung bei\n\n",
3006:     en:
3007:       "There was an unexpected error\nPlease please open a support ticket here:\n" +
3008:       supportEmail +
3009:       "\n\nand submit screenshot of this error message\n\n",
3010:     es:
3011:       "Se ha producido un error desconocido\nPor favor habra un ticket de soporte aqui:\n" +
3012:       supportEmail +
3013:       "\n\ny presente una captura de pantalla con este mensaje de error\n\n",
3014:     fr:
3015:       "Une erreur vient de se produire \nVeuillez ouvrir un ticket de service \xe0 cette adresse:\n" +
3016:       supportEmail +
3017:       "\n\net n\'oubliez pas d\'y joindre une capture d\'\xe9cran de ce message\n\n",
3018:     it:
3019:       "Si sono riscontrati errori inaspettati\nSi prega di aprire un ticket di supporto qui:\n" +
3020:       supportEmail +
3021:       "\n\ne inserire uno screenshot di questo messaggio di errore\n\n",
3022:     ja:
3023:       "\u4e88\u671f\u3057\u306a\u3044\u30a8\u30e9\u30fc\u304c\u8d77\u3053\u308a\u307e\u3057\u305f.\n\u3053\u3061\u3089\u304b\u3089\u30b5\u30dd\u30fc\u30c8\u30c1\u30b1\u30c3\u30c8\u3092\u958b\u3044\u3066\u304f\u3060\u3055\u3044:\n" +
3024:       supportEmail +
3025:       "\n\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u63d0\u793a\u3057\u3066\u304f\u3060\u3055\u3044.\n\n",
3026:     kr:
3027:       "\uc608\uae30\uce58 \uc54a\uc740 \uc5d0\ub7ec\uc785\ub2c8\ub2e4. \n\uc11c\ud3ec\ud2b8 \ud2f0\ucf13\uc744 \uc5ec\uc2ed\uc2dc\uc624.:\n" +
3028:       supportEmail +
3029:       "\n\n\uc5d0\ub7ec \uba54\uc138\uc9c0\ub97c \uc81c\ucd9c \ud558\uc138\uc694.\n\n",
3030:     pt:
3031:       "Ocorreu um erro inesperado.\nPor favor abra um ticket de atendimento aqui:\n" +
3032:       supportEmail +
3033:       "\n\ne envie uma imagem da mensagem de erro\n\n",
3034:     zh_CN:
3035:       "\u53d1\u751f\u4e86\u4e00\u4e2a\u610f\u5916\u9519\u8bef\n\u8bf7\u5728\u8fd9\u91cc\u6253\u5f00\u4e00\u4e2a\u652f\u6301\u5de5\u5355:\n" +
3036:       supportEmail +
3037:       "\n\n\u5e76\u5c06\u8fd9\u4e2a\u9519\u8bef\u6d88\u606f\u7684\u622a\u56fe\u53d1\u9001\u7ed9\u6211\u4eec\n\n",
3038:   });
3039:   var strWrongProduct = localize({
3040:     de: "Dieser Lizenz-Code ist f\xfcr ein anderes Produkt. Bitte stelle sicher, dass du den richtigen Lizenzcode eingibst\n\n",
3041:     en: "This license code is for a different product, please double check that you are entering the correct license\n\n",
3042:     es: "Este c\xf3digo de licencia es para un producto diferente, por favor, comprobar que esta introduciendo la licencia correcta\n\n",
3043:     fr: "Vous venez d\'entrer la cl\xe9 de licence d\'un autre produit, assurez-vous d\'utiliser la bonne cl\xe9 de licence\n\n",
3044:     it: "Questo codice di licenza \xe8 valido per un prodotto differente, si prega di controllare che si stia inserendo la licenza corretta\n\n",
3045:     ja: "\u3053\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u4ed6\u306e\u88fd\u54c1\u306e\u3082\u306e\u3067\u3059. \u6b63\u3057\u3044\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5165\u529b\u3057\u3066\u3044\u308b\u304b\u518d\u5ea6\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\n\n",
3046:     kr: "\uc774 \ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc\ub294 \ub2e4\ub978 \uc0c1\ud488\uc758 \ucf54\ub4dc\uc785\ub2c8\ub2e4. \ub2e4\uc2dc\ud55c\ubc88 \ud655\uc778\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.\n\n",
3047:     pt: "Esta licen\xe7a \xe9 de outro produto, por favor verifique se voc\xea est\xe1 digitando a licen\xe7a correta\n\n",
3048:     zh_CN:
3049:       "\u6b64\u8bb8\u53ef\u8bc1\u7528\u4e8e\u4e0d\u540c\u7684\u4ea7\u54c1\uff0c\u8bf7\u518d\u6b21\u786e\u8ba4\u4f60\u6240\u8f93\u5165\u7684\u8bb8\u53ef\u8bc1\u662f\u5426\u6b63\u786e\n\n",
3050:   });
3051:   var strNewVersionAvailableHdr = localize({
3052:     de: strScriptName + " Update verf\xfcgbar",
3053:     en: strScriptName + " Update Available",
3054:     es: strScriptName + " Actualizaci\xf3n disponible",
3055:     fr: strScriptName + " Mise \xe0 jour disponible",
3056:     it: strScriptName + " Aggiornamento Disponibile",
3057:     ja:
3058:       strScriptName +
3059:       " \u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u304c\u5229\u7528\u53ef\u80fd\u3067\u3059",
3060:     kr: strScriptName + " \uc5c5\ub370\uc774\ud2b8 \uac00\ub2a5",
3061:     pt: strScriptName + " Atualiza\xe7\xe3o dispon\xedvel",
3062:     zh_Cn: strScriptName + " \u6709\u53ef\u7528\u7684\u66f4\u65b0",
3063:   });
3064:   var strNewVersionAvailable = localize({
3065:     de: "Eine neuere Version von " + strScriptName + " ist verf\xfcgbar: %v\n",
3066:     en: "A newer version of " + strScriptName + " is available: %v\n",
3067:     es:
3068:       "Una versi\xf3n nueva de " + strScriptName + " est\xe1 disponible: %v\n",
3069:     fr:
3070:       "Une version plus r\xe9cente de " +
3071:       strScriptName +
3072:       " est disponible: %v\n",
3073:     it: "\xc8 disponibile una nuova versione di" + strScriptName + ": %v\n",
3074:     ja:
3075:       strScriptName +
3076:       " \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3: %v \u304c\u5229\u7528\u53ef\u80fd\u3067\u3059\n",
3077:     kr:
3078:       " \uc758 \uc0c8\ub85c\uc6b4 \ubc84\uc804 " +
3079:       strScriptName +
3080:       " \uc740 \uc0ac\uc6a9\uac00\ub2a5: %v\n",
3081:     pt:
3082:       "Uma nova vers\xe3o do " + strScriptName + " est\xe1 dispon\xedvel: %v\n",
3083:     zh_Cn: strScriptName + " \u6709\u65b0\u7248\u672c\u53ef\u7528: %v\n",
3084:   });
3085:   var strCurrentVersion = localize({
3086:     de: "Deine installierte Version ist: %v",
3087:     en: "Your installed version is: %v",
3088:     es: "Su versi\xf3n instalada es: %v",
3089:     fr: "Votre version install\xe9e est: %v",
3090:     it: "La versione installata \xe8: %v",
3091:     ja: "\u30d0\u30fc\u30b8\u30e7\u30f3 : %v \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u3059",
3092:     kr: "\uc124\uce58 \ubc84\uc804\uc740 : %v",
3093:     pt: "A vers\xe3o instalada \xe9: %v",
3094:     zh_Cn: "\u60a8\u5b89\u88c5\u7684\u7248\u672c\u662f: %v",
3095:   });
3096:   var strDownload = localize({
3097:     de: "Download",
3098:     en: "Download",
3099:     es: "Descargar",
3100:     fr: "T\xe9l\xe9charger",
3101:     it: "Scarica",
3102:     ja: "\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",
3103:     kr: "\ub2e4\uc6b4\ub85c\ub4dc",
3104:     pt: "Baixar",
3105:     zh_CN: "\u4e0b\u8f7d",
3106:   });
3107:   var strDownloads = localize({
3108:     de: "Downloads",
3109:     en: "Downloads",
3110:     es: "Descargas",
3111:     fr: "T\xe9l\xe9chargements",
3112:     it: "Scarica",
3113:     ja: "\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",
3114:     kr: "\ub2e4\uc6b4\ub85c\ub4dc",
3115:     ps: "Transfer\xeancias",
3116:     zh_CN: "\u4e0b\u8f7d",
3117:   });
3118:   var strVersion = localize({
3119:     de: "Version",
3120:     en: "version",
3121:     es: "versi\xf3n",
3122:     fr: "version",
3123:     it: "versione",
3124:     ja: "\u30d0\u30fc\u30b8\u30e7\u30f3",
3125:     kr: "\ubc84\uc804",
3126:     pt: "vers\xe3o",
3127:     zh_CN: "\u7248\u672c",
3128:   });
3129:   var strSkipVersion = localize({
3130:     de: "Diese Version \xdcberspringen",
3131:     en: "Skip this Version",
3132:     es: "Salta esta versi\xf3n",
3133:     fr: "Ignorer cette version",
3134:     it: "Salta questa Versione",
3135:     ja: "\u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30b9\u30ad\u30c3\u30d7\u3059\u308b",
3136:     kr: "\uc774 \ubc84\uc804\uc740 \uc0dd\ub7b5",
3137:     pt: "Pular essa vers\xe3o",
3138:     zh_CN: "\u8df3\u8fc7\u6b64\u7248\u672c",
3139:   });
3140:   var strRemindMeLater = localize({
3141:     de: "Sp\xe4ter erinnern",
3142:     en: "Remind Me Later",
3143:     es: "Recu\xe9rdame m\xe1s tarde",
3144:     fr: "Me le rappeller plus tard",
3145:     it: "Ricordamelo pi\xf9 tardi",
3146:     ja: "\u5f8c\u3067\u77e5\u3089\u305b\u308b",
3147:     kr: "\ub098\uc911\uc5d0 \uc0c1\uae30\uc2dc\ud0a4\uae30 ",
3148:     pt: "Lembre mais tarde",
3149:     zh_CN: "\u7a0d\u540e\u63d0\u9192\u6211",
3150:   });
3151:   var strNewestVersionAvailable = localize({
3152:     de: "Neueste verf\xfcgbare Version",
3153:     en: "Newest available version",
3154:     es: "Versi\xf3n mas nueva disponible",
3155:     fr: "Nouvelle version disponible",
3156:     it: "Nuova versione disponibile",
3157:     ja: "\u5229\u7528\u53ef\u80fd\u306a\u6700\u65b0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059",
3158:     kr: "\ucd5c\uc2e0 \uac00\ub2a5 \ubc84\uc804 ",
3159:     pt: "\xdaltima vers\xe3o dispon\xedvel",
3160:     zh_CN: "\u6700\u65b0\u53ef\u7528\u7248\u672c",
3161:   });
3162:   var strVersionRev = "v%a%b - %c";
3163:   var strDeactivate = localize({
3164:     de: "Lizenz deaktivieren",
3165:     en: "Deactivate License",
3166:     es: "Desactivar Licencia",
3167:     fr: "D\xe9sactiver la licence",
3168:     it: "Disattiva la Licenza",
3169:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u7121\u52b9\u5316\u3059\u308b",
3170:     kr: "\ub77c\uc774\uc13c\uc2a4 \ube44\ud65c\uc131\ud654",
3171:     pt: "Desativar Licen\xe7a",
3172:     zh_CN: "\u505c\u7528\u8bb8\u53ef\u8bc1",
3173:   });
3174:   var strReset = localize({
3175:     de: "Lizenz zur\xfccksetzen",
3176:     en: "Reset License",
3177:     es: "Restablecer licencia",
3178:     fr: "R\xe9initialiser la licence",
3179:     it: "Resetta la Licenza",
3180:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u30ea\u30bb\u30c3\u30c8\u3059\u308b",
3181:     kr: "\ub9ac\uc14b \ub77c\uc774\uc13c\uc2a4",
3182:     pt: "Reiniciar a licen\xe7a",
3183:     zh_CN: "\u91cd\u7f6e\u8bb8\u53ef\u8bc1",
3184:   });
3185:   var strVersionCheck = localize({
3186:     de: "Automatisch nach Aktualisierungen suchen",
3187:     en: "Check for updates automatically",
3188:     es: "Revisar actualizaciones automaticamente",
3189:     fr: "V\xe9rifier les mises \xe0 jour automatiquement",
3190:     it: "Controlla automaticamente la presenza di aggiornamenti",
3191:     ja: "\u81ea\u52d5\u3067\u66f4\u65b0\u3092\u78ba\u8a8d\u3059\u308b",
3192:     kr: "\uc790\ub3d9\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8 \ud655\uc778",
3193:     pt: "Verificar atualiza\xe7\xf5es automaticamente",
3194:     zh_CN: "\u81ea\u52a8\u68c0\u67e5\u66f4\u65b0",
3195:   });
3196:   var strCheckNow = localize({
3197:     de: "Jetzt nach Updates suchen",
3198:     en: "Check for update now",
3199:     es: "Buscar actualizaci\xf3n ahora",
3200:     fr: "V\xe9rifier les mise \xe0 jour maintenant",
3201:     it: "Controllo aggiornamenti",
3202:     ja: "\u4eca\u3059\u3050\u66f4\u65b0\u3092\u78ba\u8a8d\u3059\u308b",
3203:     kr: "\uc9c0\uae08 \uc5c5\ub370\uc774\ud2b8 \ud655\uc778\ud558\uae30",
3204:     pt: "Checar atualiza\xe7\xf5es agora",
3205:     zh_CN: "\u7acb\u5373\u68c0\u67e5\u66f4\u65b0",
3206:   });
3207:   var strUpdateCheckError = localize({
3208:     de: "Bei der Suche nach Updates ist ein Fehler aufgetreten.\nBitte vergewissere dich, dass Du \xfcber eine funktionierende Internetverbindung verf\xfcgst und diese nicht durch Firewalls blockiert wird.",
3209:     en: "There was an error when checking for updates.\nPlease verify that you have a valid internet connection and that it is not blocked by any firewalls.",
3210:     es: "Hubo un error en la comprobaci\xf3n de actualizaciones.\nPor favor compruebe que tiene una conexi\xf3n a Internet v\xe1lida y que no est\xe9 bloqueada por un cortafuegos.",
3211:     fr: "Une erreur s\'est produite lors de la recherche de mises \xe0 jour.\nV\xe9rifiez que votre connexion internet est valide et qu\'elle n\'est bloqu\xe9e par un pare-feu.",
3212:     it: "Si \xe8 riscontrato un errore durante la fase di controllo degli aggiornamenti. \nSi prega di verificare il funzionamento della connessione internet e che questa non sia blocchata da un firewall",
3213:     ja: "\u66f4\u65b0\u3092\u78ba\u8a8d\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u8d77\u3053\u308a\u307e\u3057\u305f.\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u304c\u6709\u52b9\u3067\u3042\u308a, \u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306b\u30d6\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044.",
3214:     kr: "\uc5c5\ub370\uc774\ud2b8 \ud655\uc778 \ud560 \ub54c \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4. \uc778\ud130\ub137\uc774 \uc5f0\uacb0\uc0c1\ud0dc\uc640 \ubc29\ud654\ubcbd \ud65c\uc131\uc774 \ub418\uc5b4\uc788\ub294\uc9c0 \ud655\uc778\ud558\uc2ed\uc2dc\uc624.",
3215:     pt: "Ocorreu um erro ao checar a atualiza\xe7\xe3o.\nPor favor verifique a conex\xe3o de internet ou se h\xe1 algum bloqueio do firewall.",
3216:     zh_CN:
3217:       "\u68c0\u67e5\u66f4\u65b0\u65f6\u53d1\u751f\u9519\u8bef\u3002\n\u8bf7\u786e\u4fdd\u60a8\u6709\u4e00\u4e2a\u6709\u6548\u7684\u4e92\u8054\u7f51\u8fde\u63a5\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u9632\u706b\u5899\u963b\u6b62\u3002",
3218:   });
3219:   var strUpToDate = localize({
3220:     de:
3221:       "Du bist auf dem neuesten Stand! \n" +
3222:       strScriptName +
3223:       " " +
3224:       strVersion +
3225:       " " +
3226:       strScriptVersion +
3227:       " ist derzeit die neueste verf\xfcgbare Version.",
3228:     en:
3229:       "You are up to date!\n" +
3230:       strScriptName +
3231:       " " +
3232:       strVersion +
3233:       " " +
3234:       strScriptVersion +
3235:       " is currently the latest version available.",
3236:     es:
3237:       "\xa1Est\xe1 actualizado! \n" +
3238:       strScriptName +
3239:       " " +
3240:       strVersion +
3241:       " " +
3242:       strScriptVersion +
3243:       " es actualmente la \xfaltima versi\xf3n disponible.",
3244:     fr:
3245:       "Vous \xeates \xe0 jour!\n" +
3246:       strScriptName +
3247:       " " +
3248:       strVersion +
3249:       " " +
3250:       strScriptVersion +
3251:       " est actuellement la derni\xe8re version disponible.",
3252:     it:
3253:       "Hai gi\xe0 aggiornato!\n" +
3254:       strScriptName +
3255:       " " +
3256:       strVersion +
3257:       " " +
3258:       strScriptVersion +
3259:       " \xe8 attualmente l\'ultima versione disponibile.",
3260:     ja:
3261:       "\u6700\u65b0\u7248\u3067\u3059!\n" +
3262:       strScriptName +
3263:       " " +
3264:       strVersion +
3265:       " " +
3266:       strScriptVersion +
3267:       " \u306f\u73fe\u5728\u5229\u7528\u53ef\u80fd\u306a\u6700\u65b0\u7248\u3067\u3059.",
3268:     kr:
3269:       "\ucd5c\uc2e0\ubc84\uc804\uc785\ub2c8\ub2e4!\n" +
3270:       strScriptName +
3271:       " " +
3272:       strVersion +
3273:       " " +
3274:       strScriptVersion +
3275:       " \ud604\uc7ac \ucd5c\uc2e0 \ubc84\uc804 \uc774\uc6a9\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4.",
3276:     pt:
3277:       "Voc\xea est\xe1 atualizado!\n" +
3278:       strScriptName +
3279:       " " +
3280:       strVersion +
3281:       " " +
3282:       strScriptVersion +
3283:       " \xe9 a \xfaltima vers\xe3o dispon\xedvel.",
3284:     zh_CN:
3285:       "\u60a8\u5df2\u7ecf\u662f\u6700\u65b0\u7248\u672c!\n" +
3286:       strScriptName +
3287:       " " +
3288:       strVersion +
3289:       " " +
3290:       strScriptVersion +
3291:       " \u662f\u5f53\u524d\u6700\u65b0\u7248\u672c\u3002",
3292:   });
3293:   var strInvalidLicense = localize({
3294:     de: "Ung\xfcltige Lizenz",
3295:     en: "Invalid license",
3296:     es: "La licencia no es v\xe1lida",
3297:     fr: "Licence non valide",
3298:     it: "Licenza non valida",
3299:     ja: "\u7121\u52b9\u306a\u30e9\u30a4\u30bb\u30f3\u30b9",
3300:     kr: "\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \ub77c\uc774\uc13c\uc2a4",
3301:     pt: "Licen\xe7a inv\xe1lida",
3302:     zh_CN: "\u65e0\u6548\u7684\u8bb8\u53ef\u8bc1",
3303:   });
3304:   var strRemoved = localize({
3305:     de: "entfernt",
3306:     en: "removed",
3307:     es: "eliminada",
3308:     fr: "supprim\xe9e",
3309:     it: "rimossa",
3310:     ja: "\u524a\u9664\u3057\u307e\u3057\u305f",
3311:     kr: "\uc0ad\uc81c\ub428",
3312:     pt: "removida",
3313:     zh_CN: "\u5df2\u5220\u9664",
3314:   });
3315:   var strDeactivated = localize({
3316:     en: "deactivated",
3317:     es: "desactivada",
3318:     fr: "d\xe9sactiv\xe9",
3319:     it: "disattivata",
3320:     ja: "\u7121\u52b9\u5316\u3055\u308c\u307e\u3057\u305f",
3321:     kr: "\ube44\ud65c\uc131\ud654",
3322:     pt: "desativada",
3323:     zh_CN: "\u5df2\u505c\u7528",
3324:   });
3325:   var strRemovedAndDeactivated = localize({
3326:     de: "entfernt und deaktiviert",
3327:     en: "removed and deactivated",
3328:     es: "eliminada y desactivada",
3329:     fr: "supprim\xe9e et d\xe9sactiv\xe9",
3330:     it: "rimossa e disattivata",
3331:     ja: "\u7121\u52b9\u306a\u30e9\u30a4\u30bb\u30f3\u30b9",
3332:     kr: "\uc0ad\uc81c \uadf8\ub9ac\uace0 \ube44\ud65c\uc131\ud654",
3333:     zh_CN: "\u5df2\u5220\u9664\u5e76\u505c\u7528",
3334:   });
3335:   var strLicenseRemoved = localize({
3336:     de: "Lizenz entfernt",
3337:     en: "License removed",
3338:     es: "Licencia eliminada",
3339:     fr: "Licence supprim\xe9e",
3340:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u524a\u9664\u3057\u307e\u3057\u305f",
3341:     kr: "\ub77c\uc774\uc13c\uc2a4\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4",
3342:     pt: "Licen\xe7a removida",
3343:     zh_CN: "\u8bb8\u53ef\u8bc1\u5df2\u5220\u9664",
3344:   });
3345:   var strLicense = localize({
3346:     de: "Lizenz",
3347:     en: "License",
3348:     es: "Licencia",
3349:     fr: "Licence",
3350:     it: "Licenza",
3351:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9",
3352:     kr: "\ub77c\uc774\uc13c\uc2a4",
3353:     pt: "Licen\xe7a",
3354:     zh_CN: "\u8bb8\u53ef\u8bc1",
3355:   });
3356:   var strLicenses = localize({
3357:     de: "Lizenzen",
3358:     en: "Licenses",
3359:     es: "Licencias",
3360:     fr: "Licences",
3361:     it: "Licenze",
3362:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9",
3363:     kr: "\ub77c\uc774\uc13c\uc2a4\ub4e4",
3364:     zh_CN: "\u8bb8\u53ef\u8bc1",
3365:   });
3366:   var strLicenseEnds = localize({
3367:     de: "Lizenzlaufzeit endet: ",
3368:     en: "License expires: ",
3369:     es: "Licencia expira: ",
3370:     fr: "Licence expir\xe9e: ",
3371:     it: "Licenza scaduta: ",
3372:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u671f\u9650\u304c\u5207\u308c\u307e\u3057\u305f: ",
3373:     kr: "\ub77c\uc774\uc13c\uc2a4 \ub9cc\uae30: ",
3374:     pt: "Licen\xe7a expira em: ",
3375:     zh_CN: "\u8bb8\u53ef\u8bc1\u5230\u671f\u65e5: ",
3376:   });
3377:   var strBTA = localize({
3378:     de: "Beta-Lizenz",
3379:     en: "Beta License",
3380:     es: "Licencia Beta",
3381:     fr: "Licence Beta",
3382:     it: "Licenza Beta",
3383:     ja: "\u30d9\u30fc\u30bf\u30e9\u30a4\u30bb\u30f3\u30b9",
3384:     kr: "\ubca0\ud0c0 \ub77c\uc774\uc13c\uc2a4",
3385:     pt: "Licen\xe7a Beta",
3386:     zh_CN: "Beta \u8bb8\u53ef\u8bc1",
3387:   });
3388:   var strEDU = localize({
3389:     de: "EDU-Lizenz",
3390:     en: "Educational License",
3391:     es: "Licencia Educacional",
3392:     fr: "Licence \xe9ducative",
3393:     it: "Licenza Educational",
3394:     ja: "\u6559\u80b2\u6a5f\u95a2\u7528\u30e9\u30a4\u30bb\u30f3\u30b9",
3395:     kr: "\uad50\uc721\uc801\uc778 \ub77c\uc774\uc13c\uc2a4",
3396:     pt: "Licen\xe7a Educacional",
3397:     zh_CN: "\u6559\u80b2\u8bb8\u53ef\u8bc1",
3398:   });
3399:   var strFLT = localize({
3400:     de: "Floating-Lizenz",
3401:     en: "Floating License",
3402:     es: "Licencia flotante",
3403:     fr: "Licence flottante",
3404:     it: "Licenza Floating",
3405:     ja: "\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9",
3406:     kr: "\uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4",
3407:     pt: "Licen\xe7a flutuante",
3408:     zh_CN: "\u6d6e\u52a8\u8bb8\u53ef\u8bc1",
3409:   });
3410:   var strUNKNOWN = localize({
3411:     de: "Lizenz mit unbekanntem Typ",
3412:     en: "License of unknown type",
3413:     es: "Licencia de tipo desconocido",
3414:     fr: "Licence inconnue",
3415:     it: "Licenza di tipo sconosciuto",
3416:     ja: "\u4e0d\u660e\u306a\u7a2e\u985e\u306e\u30e9\u30a4\u30bb\u30f3\u30b9",
3417:     kr: "\uc0c8\ub85c\uc6b4 \uc885\ub958\uc758 \ub77c\uc774\uc13c\uc2a4",
3418:     pt: "Licen\xe7a de tipo desconhecido",
3419:     zh_CN: "\u672a\u77e5\u7c7b\u578b\u7684\u8bb8\u53ef\u8bc1",
3420:   });
3421:   var strTrialExpired = localize({
3422:     de: "Testversion abgelaufen",
3423:     en: "Cgpersia Forum",
3424:     es: "Termino de prueba expirado",
3425:     fr: "P\xe9riode d\'\xe9valuation termin\xe9e",
3426:     it: "Periodo di valutazione scaduto",
3427:     ja: "\u30c8\u30e9\u30a4\u30a2\u30eb\u7248\u306e\u8a66\u7528\u671f\u9650\u304c\u5207\u308c\u307e\u3057\u305f",
3428:     kr: "\uc528\uc9c0\ud398\ub974\uc2dc\uc544 \ud3ec\ub7fc",
3429:     pt: "Vers\xe3o de teste expirou",
3430:     zh_CN: "\u8bd5\u7528\u5df2\u8fc7\u671f",
3431:   });
3432:   var strEnterLicenseCode = localize({
3433:     de: "Bitte gib den Lizenzcode ein.",
3434:     en: "Please enter the license code.",
3435:     es: "Por favor, introduzca el c\xf3digo de licencia.",
3436:     fr: "Veuillez entrer votre num\xe9ro de licence.",
3437:     it: "Si prega di inserire il codice di licenza.",
3438:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",
3439:     kr: "\ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624",
3440:     pt: "Por favor, digite o c\xf3digo da licen\xe7a",
3441:     zh_CN: "\u8bf7\u8f93\u5165\u8bb8\u53ef\u8bc1\u3002",
3442:   });
3443:   var strPasteHelp = localize({
3444:     de:
3445:       "(Wenn das Einf\xfcgen mit " +
3446:         cmdKey +
3447:         "+V nicht funktioniert, versuche " +
3448:         parseFloat(app.version) >=
3449:       10
3450:         ? "Rechtsklick und Einf\xfcgen)"
3451:         : "Bearbeiten->Einf\xfcgen)",
3452:     en:
3453:       "(If pasting the code with " +
3454:         cmdKey +
3455:         "+V doesn\'t work try " +
3456:         parseFloat(app.version) >=
3457:       10
3458:         ? "Right-Click and Paste)"
3459:         : "Edit->Paste)",
3460:     es:
3461:       "(Si pegar la licencia usando " +
3462:         cmdKey +
3463:         "+V no funciona, pruebe " +
3464:         parseFloat(app.version) >=
3465:       10
3466:         ? "Clic derecho y pegar)"
3467:         : "Edici\xf3n->Pegar)",
3468:     fr:
3469:       "(Si vous ne parvenez pas \xe0 coller le code avec " +
3470:         cmdKey +
3471:         "+V, essayez " +
3472:         parseFloat(app.version) >=
3473:       10
3474:         ? "Clic droit et Coller)"
3475:         : "Edition->Coller)",
3476:     it:
3477:       "(Non \xe8 possibile incollare il codice con " +
3478:         cmdKey +
3479:         "+V, prova a " +
3480:         parseFloat(app.version) >=
3481:       10
3482:         ? "cliccare il tasto destro del mouse e scegliere Incolla)"
3483:         : "Modifica->Incolla)",
3484:     ja:
3485:       "(\u3082\u3057\u30da\u30fc\u30b9\u30c8\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8 " +
3486:         cmdKey +
3487:         "+V \u304c\u6a5f\u80fd\u3057\u306a\u3044\u5834\u5408, " +
3488:         parseFloat(app.version) >=
3489:       10
3490:         ? "\u53f3\u30af\u30ea\u30c3\u30af\u304b\u3089\u30da\u30fc\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044)"
3491:         : "\u7de8\u96c6->\u30da\u30fc\u30b9\u30c8\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044)",
3492:     kr:
3493:       "(\uc758 \ucf54\ub4dc\ub97c \ubcf5\uc0ac \ud588\uc744\ub54c \uc791\ub3d9 \ud558\uc9c0 \uc54a\ub294\ub2e4\uba74 \ub97c \uc2dc\ub3c4\ud558\uc2ed\uc2dc\uc624.  " +
3494:         cmdKey +
3495:         "+V \uc624\ub978\ucabd \ud074\ub9ad \uadf8\ub9ac\uace0 \ubcf5\uc0ac " +
3496:         parseFloat(app.version) >=
3497:       10
3498:         ? "\uace0\uce58\uae30)"
3499:         : "\ubcf5\uc0ac)",
3500:     pt:
3501:       "(Se colar o c\xf3digo com " +
3502:         cmdKey +
3503:         "+V n\xe3o funcionar, tente " +
3504:         parseFloat(app.version) >=
3505:       10
3506:         ? "Bot\xe3o direito do mouse e Colar)"
3507:         : "Editar->Colar)",
3508:     zh_CN:
3509:       "(\u5982\u679c\u65e0\u6cd5\u901a\u8fc7 " +
3510:         cmdKey +
3511:         "+V \u7c98\u8d34\u8bb8\u53ef\u8bc1\uff0c\u8bf7\u5c1d\u8bd5" +
3512:         parseFloat(app.version) >=
3513:       10
3514:         ? "\u53f3\u952e\u7c98\u8d34)"
3515:         : "\u7f16\u8f91->\u7c98\u8d34)",
3516:   });
3517:   var strTrialInstructMsg = localize({
3518:     de: 'Um die Testversion zu starten, gib "trial" ein.',
3519:     en: "To run in trial mode type: trial",
3520:     es: "Para ejecutar el modo Trial, escriba: trial",
3521:     fr: "Pour lancer la version de d\'\xe9valuation, tapez: trial",
3522:     it: 'Per avviare in modalit\xe0 prova, scrivere: "trial"',
3523:     ja: '\u30c8\u30e9\u30a4\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\u306b\u306f, "trial"\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044',
3524:     kr: "\uc2dc\ud5d8\ubaa8\ub4dc\ub97c \uc0ac\uc6a9\ud558\uace0 \uc2f6\uc73c\uba74 \uc2dc\ud5d8\ub97c \uc4f0\uc2ed\uc2dc\uc624",
3525:     pt: 'Para rodar na vers\xe3o teste, digite "trial"',
3526:     zh_CN:
3527:       "\u5728\u8bd5\u7528\u6a21\u5f0f\u4e0b\u8fd0\u884c\uff0c\u8f93\u5165: trial",
3528:   });
3529:   var strOr = localize({
3530:     de: "oder",
3531:     en: "or",
3532:     es: "o",
3533:     fr: "ou",
3534:     it: "o",
3535:     ja: "\u307e\u305f\u306f",
3536:     kr: "\ub610\ub294",
3537:     pt: "ou",
3538:     zh_CN: "\u6216",
3539:   });
3540:   var strServerInstructMsg = localize({
3541:     de: "Aktiviere eine Lizenz vom Server mit @REMOTE",
3542:     en: "Activate a license from the server with @REMOTE",
3543:     es: "Activar una licencia del servidor con @REMOTE",
3544:     fr: "Activer une licence depuis le serveur avec @REMOTE",
3545:     it: "Attiva una licenza dal server con @REMOTE",
3546:     ja: "@REMOTE \u30b5\u30fc\u30d0\u30fc\u304b\u3089\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u6709\u52b9\u5316\u3059\u308b",
3547:     kr: "\ub77c\uc774\uc13c\uc2a4\ub97c @REMOTE \uc11c\ubc84\uc5d0\uc11c \ud65c\uc131\ud654\ud558\uc2ed\uc2dc\uc624",
3548:     pt: "Ative uma licen\xe7a a partir do servidor com @REMOTE",
3549:     zh_CN:
3550:       "\u4f7f\u7528 @REMOTE \u4ece\u670d\u52a1\u5668\u6fc0\u6d3b\u8bb8\u53ef\u8bc1",
3551:   });
3552:   var strServerNotRunning = localize({
3553:     de: "Der Client ist konfiguriert, aber der Floating License Server l\xe4uft nicht oder ist nicht erreichbar.",
3554:     en: "Client configured but floating license server is either not running or not accessible.",
3555:     es: "Cliente configurado pero servidor de licencias flotantes o no est\xe1 ejecutado o no es accesible.",
3556:     fr: "Client configur\xe9 mais le serveur de licences flottantes est soit \xe9teint, soit il n\'est pas accessible.",
3557:     it: "Client configurato, ma la licenza Floating Server risulta non funzionante o non accessibile",
3558:     ja: "\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u304c, \u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u304c\u52d5\u4f5c\u3057\u3066\u3044\u306a\u3044\u304b, \u305d\u308c\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093.",
3559:     kr: "\uc0ac\uc6a9\uc790\uac00 \ud658\uacbd\uc744 \uc124\uc815 \ud558\uc600\uc9c0\ub9cc, \uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\ub294 \uc811\uadfc \ub610\ub294 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",
3560:     pt: "Cliente configurado, mas o servidor da licen\xe7a flutuante n\xe3o est\xe1 rodando ou est\xe1 inacess\xedvel.",
3561:     zh_CN:
3562:       "\u5ba2\u6237\u7aef\u5df2\u914d\u7f6e\uff0c\u4f46\u662f\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u65e0\u6cd5\u8fd0\u884c\u6216\u4e0d\u53ef\u8bbf\u95ee\u3002",
3563:   });
3564:   var strGetHelp = localize({
3565:     de: "Hilfe",
3566:     en: "Get Help",
3567:     es: "Ayuda",
3568:     fr: "Aide",
3569:     it: "Assistenza",
3570:     ja: "\u30d8\u30eb\u30d7",
3571:     kr: "\ub3c4\uc6c0\ubc1b\uae30",
3572:     pt: "Ajuda",
3573:     zh_CN: "\u83b7\u5f97\u5e2e\u52a9",
3574:   });
3575:   var strClickOnGetHelp = localize({
3576:     de:
3577:       "Bitte klicke auf " +
3578:       strGetHelp +
3579:       " und sende einen Screenshot von diesem Fehler.",
3580:     en:
3581:       "Please click on " + strGetHelp + " and send a screenshot of this error.",
3582:     fr:
3583:       "Veuillez cliquer sur " +
3584:       strGetHelp +
3585:       " et envoyer une capture d\'\xe9cran de cette erreur.",
3586:     it:
3587:       "Si prega di cliccare su " +
3588:       strGetHelp +
3589:       " e inviare uno screenshot di questo errore.",
3590:     ja:
3591:       strGetHelp +
3592:       "\u3092\u30af\u30ea\u30c3\u30af\u3057, \u3053\u306e\u30a8\u30e9\u30fc\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u9001\u4fe1\u3057\u3066\u304f\u3060\u3055\u3044.",
3593:     kr:
3594:       "\ub204\ub974\uc2ed\uc2dc\uc624" +
3595:       strGetHelp +
3596:       " \uc5d0\ub7ec\ub97c \ucea1\uccd0\ud558\uc5ec \ubcf4\ub0b4\uae30.",
3597:     pt:
3598:       "Por favor, clique em " + strGetHelp + " e mande uma imagem desse erro.",
3599:     zh_CN:
3600:       "\u8bf7\u70b9\u51fb" +
3601:       strGetHelp +
3602:       "\u5e76\u53d1\u9001\u6b64\u9519\u8bef\u7684\u622a\u56fe\u3002",
3603:   });
3604:   var strPleaseEnterALicense = localize({
3605:     de: "Bitte Lizenz installieren",
3606:     en: "Please enter a license",
3607:     es: "Por favor, instale una licencia",
3608:     fr: "Veuillez entrer une licence",
3609:     it: "Si prega di inserire la licenza",
3610:     ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",
3611:     kr: "\ub77c\uc774\uc13c\uc2a4\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624",
3612:     pt: "Digite a licen\xe7a",
3613:     zh_CN: "\u8bf7\u8f93\u5165\u8bb8\u53ef\u8bc1",
3614:   });
3615:   var getHelpUrls = {
3616:     activation_faq:
3617:       "https://aescripts.com/knowledgebase/index/view/faq/license-activation-management/",
3618:     floating_faq:
3619:       "https://aescripts.com/knowledgebase/index/view/faq/floating-license-faq/",
3620:     license_faq:
3621:       "https://aescripts.com/knowledgebase/index/view/faq/license-code-faq/",
3622:     open_ticket: "https://aescripts.com/contact/?direct=1",
3623:   };
3624:   var licErrors = {
3625:     "-1": {
3626:       detail: localize({ en: "" }),
3627:       title: strInvalidLicense,
3628:       url: getHelpUrls.license_faq,
3629:     },
3630:     "-10": {
3631:       detail: localize({
3632:         de: "Verifizierung des Lizenzformats fehlgeschlagen",
3633:         en: "License format verification failed",
3634:         es: "El formato de la licencia no verifica",
3635:         it: "Verifica del formato della licenza fallita",
3636:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u5f62\u5f0f\u306e\u78ba\u8a8d\u306b\u5931\u6557\u3057\u307e\u3057\u305f",
3637:         kr: "\ub77c\uc774\uc13c\uc2a4 \ud3ec\ub9f7 \ud655\uc778\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4",
3638:         zh_CN: "\u8bb8\u53ef\u8bc1\u683c\u5f0f\u9a8c\u8bc1\u5931\u8d25",
3639:       }),
3640:       title: strInvalidLicense,
3641:       url: getHelpUrls.license_faq,
3642:     },
3643:     "-100": {
3644:       detail: localize({
3645:         de: "Jetzt ist eine g\xfcltige Lizenz erforderlich. Du kannst eine Lizenz kaufen, indem du auf den Button \'Lizenz kaufen\' klickst",
3646:         en: "A valid license is now required. You can purchase a license by clicking the \'Buy License\' button",
3647:         fr: "Une licence valide est maintenant requise. Vous pouvez en acheter une en cliquant sur le bouton \'Acheter une licence\'",
3648:         it: "\xc8 necessaria una licenza valida. Puoi comprarne una cliccando sul pulsante \'Buy License\'",
3649:         ja: "\u6709\u52b9\u306a\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u5fc5\u8981\u3067\u3059. \'\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u8cfc\u5165\'\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30e9\u30a4\u30bb\u30f3\u30b9\u3092\u8cfc\u5165\u3057\u3066\u304f\u3060\u3055\u3044",
3650:         kr: "\uc720\ud6a8\ud55c \ub77c\uc774\uc13c\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.  \'\ub77c\uc774\uc13c\uc2a4 \uad6c\ub9e4 \ubc84\ud2bc\' \uc744 \ud074\ub9ad\ud558\uc5ec \ub77c\uc774\uc13c\uc2a4\ub97c \uad6c\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4",
3651:         pt: "\xc9 necess\xe1ria uma licen\xe7a v\xe1lida. Compre uma licen\xe7a clicando no bot\xe3o \'Buy License\'",
3652:         zh_CN:
3653:           '\u73b0\u9700\u8981\u4e00\u4e2a\u6709\u6548\u7684\u8bb8\u53ef\u8bc1\u3002\u60a8\u53ef\u4ee5\u70b9\u51fb"\u8d2d\u4e70\u8bb8\u53ef\u8bc1"\u6309\u94ae\u8d2d\u4e70',
3654:       }),
3655:       title: localize({
3656:         de: "Testversion abgelaufen",
3657:         en: "Cgpersia Forum",
3658:         es: "Esta versi\xf3n de prueba se ha expirado",
3659:         fr: "P\xe9riode d\'\xe9valuation expir\xe9e",
3660:         it: "Periodo di valutazione terminato",
3661:         ja: "\u8a66\u7528\u671f\u9650\u5207\u308c",
3662:         kr: "\uc528\uc9c0\ud398\ub974\uc2dc\uc544 \ud3ec\ub7fc",
3663:         pt: "Vers\xe3o teste expirada",
3664:         zh_CN: "\u8bd5\u7528\u5df2\u8fc7\u671f",
3665:       }),
3666:       url: "",
3667:     },
3668:     "-101": {
3669:       detail: localize({
3670:         de: "Bitte konfiguriere oder deaktiviere alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
3671:         en: "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
3672:         es: "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
3673:         fr: "Veuillez configurer ou d\xe9sactiver tous les parre-feux ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de l\'utilisateur. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
3674:         it: "Si prega di configurare o disabilitare tutti i firewall o il software antivirus che potrebbero bloccare l\'accesso alla cartella home. Se l\'accesso \xe8 bloccato, la licenza non pu\xf2 essere verificata.",
3675:         ja: "\u30db\u30fc\u30e0\u30d5\u30a9\u30eb\u30c0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30d6\u30ed\u30c3\u30af\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u307e\u305f\u306f\u30a6\u30a3\u30eb\u30b9\u5bfe\u7b56\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u7121\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044. \u3053\u306e\u30a2\u30af\u30bb\u30b9\u304c\u30d6\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u308b\u3068\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u6709\u52b9\u5316\u3055\u308c\u307e\u305b\u3093.",
3676:         kr: "\ud648 \ud3f4\ub354\uc5d0 \uc811\uadfc\ud558\uae30 \uc704\ud574 \ubc29\ud654\ubcbd\uacfc \ubc14\uc774\ub7ec\uc2a4 \uc18c\ud504\ud2b8 \uc6e8\uc5b4\uc758 \uc138\ud305\uc744 \ubcc0\uacbd \ud558\uc2ed\uc2dc\uc624. \ub9cc\uc57d \uc811\uadfc\uc774 \uc81c\ud55c\ub418\uba74 \uc774 \ub77c\uc774\uc13c\uc2a4\ub294 \uc811\uadfc\uc774 \ubd88\uac00\ud55c \ub77c\uc774\uc13c\uc2a4 \uc785\ub2c8\ub2e4.",
3677:         pt: "Configure ou desabilite qualquer firewall ou antivirus que possa estar bloqueando acesso \xe0 pasta do usu\xe1rio. Se esse acesso estiver bloqueado, a licen\xe7a n\xe3o poder\xe1 ser verificada.",
3678:         zh_CN:
3679:           "\u8bf7\u914d\u7f6e\u6216\u7981\u7528\u4efb\u4f55\u9632\u706b\u5899\u6216\u75c5\u6bd2\u8f6f\u4ef6\uff0c\u4ee5\u9632\u6b62\u8bbf\u95ee home \u76ee\u5f55\u65f6\u88ab\u963b\u6b62\u3002\u5982\u679c\u8bbf\u95ee\u88ab\u963b\u6b62\uff0c\u5219\u8bb8\u53ef\u8bc1\u65e0\u6cd5\u88ab\u9a8c\u8bc1\u3002",
3680:       }),
3681:       title: localize({
3682:         de: "Zugriff blockiert",
3683:         en: "Access Blocked",
3684:         es: "Acceso bloqueado",
3685:         fr: "Acc\xe8s bloqu\xe9",
3686:         it: "Accesso Bloccato",
3687:         ja: "\u30a2\u30af\u30bb\u30b9\u304c\u30d6\u30ed\u30c3\u30af\u3055\u308c\u307e\u3057\u305f",
3688:         kr: "\uc811\uadfc \uc81c\ud55c",
3689:         pt: "Acesso bloqueado",
3690:         zh_CN: "\u8bbf\u95ee\u88ab\u963b\u6b62",
3691:       }),
3692:       url: getHelpUrls.open_ticket,
3693:     },
3694:     "-102": {
3695:       detail: strClickOnGetHelp,
3696:       title: localize({
3697:         de: "Kein Ergebnis",
3698:         en: "No result code",
3699:         es: "No hay c\xf3digo de resultado",
3700:         fr: "Pas de code de r\xe9sultat",
3701:         it: "codice senza risultato",
3702:         ja: "\u7d50\u679c\u30b3\u30fc\u30c9\u304c\u3042\u308a\u307e\u305b\u3093",
3703:         kr: "\uacb0\uacfc \ubd80\ud638\uac00 \uc5c6\uc74c",
3704:         pt: "Nenhum c\xf3digo retornado",
3705:         zh_CN: "\u65e0\u7ed3\u679c\u7801",
3706:       }),
3707:       url: getHelpUrls.open_ticket,
3708:     },
3709:     "-103": {
3710:       detail: localize({
3711:         de: "Die Anzahl der Test-Tage konnte nicht gefunden werden",
3712:         en: "Could not find the number of trial days",
3713:         es: "No se pudo encontrar el n\xfamero de d\xedas de prueba",
3714:         fr: "Echec d\'identification du nombre de jour de p\xe9riode d\'essai disponibles",
3715:         it: "Non \xe8 possibile trovare il numero di giorni di prova",
3716:         ja: "\u8a66\u7528\u671f\u9593\u65e5\u6570\u304c\u898b\u3064\u3051\u3089\u308c\u307e\u305b\u3093\u3067\u3057\u305f",
3717:         kr: "\uc2dc\ud589\uc77c \ubc88\ud638\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3718:         pt: "N\xe3o foi poss\xedvel encontrar o n\xfamero de dias de teste",
3719:         zh_CN: "\u672a\u80fd\u627e\u5230\u8bd5\u7528\u7684\u5929\u6570",
3720:       }),
3721:       title: localize({
3722:         de: "Anzahl der Test-Tage nicht festgelegt",
3723:         en: "No trial days found",
3724:         es: "No se encontraron d\xedas de prueba",
3725:         fr: "Impossible de trouver des jours d\'essai",
3726:         it: "Nessun giorno di prova trovato",
3727:         ja: "\u8a66\u7528\u671f\u9593\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093",
3728:         kr: "\uc2dc\ud589\uc77c\uc774 \uc5c6\uc74c,",
3729:         pt: "N\xe3o foram encontrados os dias de teste",
3730:         zh_CN: "\u672a\u627e\u5230\u8bd5\u7528\u5929\u6570",
3731:       }),
3732:       url: getHelpUrls.open_ticket,
3733:     },
3734:     "-104": {
3735:       detail: localize({
3736:         de: "Die Lizenz ist nicht f\xfcr dieses Produkt",
3737:         en: "The license is not for this product",
3738:         es: "La licencia no es para este producto",
3739:         fr: "Cette licence n\'est pas valable pour ce produit",
3740:         it: "La licenza non \xe8 valida per questo prodotto",
3741:         ja: "\u3053\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u3053\u306e\u88fd\u54c1\u306e\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093",
3742:         kr: "\uc774 \uc0c1\ud488\uc744 \uc704\ud55c \ub77c\uc774\uc13c\uc2a4\uac00 \uc544\ub2d9\ub2c8\ub2e4",
3743:         pt: "A licen\xe7a n\xe3o \xe9 para esse produto",
3744:         zh_CN:
3745:           "\u6b64\u8bb8\u53ef\u8bc1\u5e76\u975e\u7528\u4e8e\u6b64\u4ea7\u54c1",
3746:       }),
3747:       title: localize({
3748:         de: "Ung\xfcltige Lizenz",
3749:         en: "License mismatch",
3750:         es: "La licencia no es la correcta",
3751:         fr: "Mauvaise licence",
3752:         it: "Mancata corrispondenza della licenza",
3753:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u4e0d\u4e00\u81f4",
3754:         kr: "\ubd80\ud569\ud55c \ub77c\uc774\uc13c\uc2a4",
3755:         pt: "Licen\xe7a incorreta",
3756:         zh_CN: "\u8bb8\u53ef\u8bc1\u4e0d\u5339\u914d",
3757:       }),
3758:       url: getHelpUrls.license_faq,
3759:     },
3760:     "-105": {
3761:       detail: localize({
3762:         de: "Eine Beta-Lizenz kann f\xfcr diese Vollversion nicht verwendet werden",
3763:         en: "A beta license cannot be used for the full version",
3764:         es: "No se puede utilizar una licencia \'beta\' con esta versi\xf3n",
3765:         fr: "Une licence de version beta ne peut \xeatre utilis\xe9e pour le produit final",
3766:         it: "La licenza beta non pu\xf2 essere usata per la versione completa",
3767:         ja: "\u30d9\u30fc\u30bf\u7248\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u88fd\u54c1\u7248\u306b\u306f\u4f7f\u3048\u307e\u305b\u3093.",
3768:         kr: "\ud480\ubc84\uc804\uc5d0\ub294 \ubca0\ud0c0 \ub77c\uc774\uc13c\uc2a4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3769:         pt: "N\xe3o \xe9 poss\xedvel usar uma licen\xe7a beta para essa vers\xe3o",
3770:         zh_CN:
3771:           "Beta \u8bb8\u53ef\u8bc1\u4e0d\u80fd\u7528\u4e8e\u5b8c\u6574\u7248",
3772:       }),
3773:       title: localize({
3774:         de: "Beta-Lizenz nicht verwendbar",
3775:         en: "Cannot use beta license",
3776:         es: "No se puede usar licencia beta",
3777:         fr: "Licence beta invalide",
3778:         it: "Impossibile usare la licenza beta",
3779:         ja: "\u30d9\u30fc\u30bf\u7248\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u4f7f\u3048\u307e\u305b\u3093",
3780:         kr: "\ubca0\ud0c0\ub77c\uc774\uc13c\uc2a4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3781:         pt: "N\xe3o \xe9 poss\xedvel usar a licen\xe7a beta",
3782:         zh_CN: "\u4e0d\u80fd\u4f7f\u7528 Beta \u8bb8\u53ef\u8bc1",
3783:       }),
3784:       url: getHelpUrls.license_faq,
3785:     },
3786:     "-106": {
3787:       detail: localize({
3788:         de: "Dieses Produkt beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
3789:         en: "This product does not offer a trial and requires a license",
3790:         es: "Este producto no ofrece una version de prueba y requiere una licencia",
3791:         fr: "Ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
3792:         it: "Questo prodotto non offre una versione di prova e richiede una licenza",
3793:         ja: "\u3053\u306e\u88fd\u54c1\u306f\u8a66\u7528\u7248\u3067\u306f\u306a\u304f, \u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u5fc5\u8981\u3067\u3059",
3794:         kr: "\uc774 \uc0c1\ud488\uc740 \uc2dc\ud5d8\uacfc \ub77c\uc774\uc13c\uc2a4\ub97c \uc81c\uacf5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4",
3795:         pt: "Esse produto n\xe3o oferece uma vers\xe3o de teste e precisa de uma licen\xe7a",
3796:         zh_CN:
3797:           "\u6b64\u4ea7\u54c1\u4e0d\u63d0\u4f9b\u8bd5\u7528\u5e76\u9700\u8981\u8bb8\u53ef",
3798:       }),
3799:       title: strPleaseEnterALicense,
3800:       url: getHelpUrls.license_faq,
3801:     },
3802:     "-107": {
3803:       detail: localize({
3804:         de: "Diese Beta-Version beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
3805:         en: "The beta version does not offer a trial and requires a license",
3806:         es: "La versi\xf3n beta no ofrece una versi\xf3n de prueba y requiere una licencia",
3807:         fr: "La version beta de ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
3808:         it: "La veriosne beta non offre una versione di prova e richiede una licenza",
3809:         ja: "\u30d9\u30fc\u30bf\u7248\u3067\u306f\u8a66\u7528\u7248\u306f\u63d0\u4f9b\u3055\u308c\u3066\u304a\u3089\u305a, \u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u5fc5\u8981\u3067\u3059",
3810:         kr: "\ubca0\ud0c0\ubc84\uc804\uc740 \uc2dc\ud5d8\uacfc \ub77c\uc774\uc13c\uc2a4\ub97c \uc81c\uacf5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4",
3811:         pt: "A vers\xe3o beta n\xe3o oferece vers\xe3o de teste, \xe9 necess\xe1rio uma licen\xe7a",
3812:         zh_CN:
3813:           "Beta \u7248\u4e0d\u63d0\u4f9b\u8bd5\u7528\u5e76\u9700\u8981\u8bb8\u53ef",
3814:       }),
3815:       title: strPleaseEnterALicense,
3816:       url: getHelpUrls.license_faq,
3817:     },
3818:     "-108": {
3819:       detail: localize({
3820:         de: "Bitte konfigurieren oder deaktiviere alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
3821:         en: "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
3822:         es: "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
3823:         fr: "Veuillez configurer ou d\xe9sactiver tous les parre-feux ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de l\'utilisateur. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
3824:         it: "Si prega di configurare o disabilitare tutti i firewall o il software antivirus che potrebbero bloccare l\'accesso alla cartella home. Se l\'accesso \xe8 bloccato, la licenza non pu\xf2 essere verificata.",
3825:         ja: "\u30db\u30fc\u30e0\u30d5\u30a9\u30eb\u30c0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30d6\u30ed\u30c3\u30af\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u307e\u305f\u306f\u30a6\u30a4\u30eb\u30b9\u5bfe\u7b56\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u7121\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044. \u3053\u306e\u30a2\u30af\u30bb\u30b9\u304c\u30d6\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u308b\u3068\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u6709\u52b9\u5316\u3055\u308c\u307e\u305b\u3093.",
3826:         kr: "\ud648 \ud3f4\ub354\uc5d0 \uc811\uadfc\ud558\uae30 \uc704\ud574 \ubc29\ud654\ubcbd\uacfc \ubc14\uc774\ub7ec\uc2a4 \uc18c\ud504\ud2b8 \uc6e8\uc5b4\uc758 \uc138\ud305\uc744 \ubcc0\uacbd \ud558\uc2ed\uc2dc\uc624. \ub9cc\uc57d \uc811\uadfc\uc774 \uc81c\ud55c\ub418\uba74 \uc774 \ub77c\uc774\uc13c\uc2a4\ub294 \uc811\uadfc\uc774 \ubd88\uac00\ud55c \ub77c\uc774\uc13c\uc2a4 \uc785\ub2c8\ub2e4.",
3827:         pt: "Configure ou desabilite o firewall ou antivirus que possa estar bloqueando a pasta do usu\xe1rio. Se a pasta estiver bloqueada, a licen\xe7a n\xe3o pode ser verificada.",
3828:         zh_CN:
3829:           "\u8bf7\u914d\u7f6e\u6216\u7981\u7528\u4efb\u4f55\u53ef\u80fd\u963b\u6321\u8bbf\u95ee home \u6587\u4ef6\u5939\u7684\u9632\u706b\u5899\u6216\u75c5\u6bd2\u8f6f\u4ef6\u3002\u5982\u679c\u6b64\u8bbf\u95ee\u88ab\u963b\u6b62\uff0c\u5219\u65e0\u6cd5\u9a8c\u8bc1\u8bb8\u53ef\u8bc1",
3830:       }),
3831:       title: localize({
3832:         de: "Nicht in der Lage, auf den Home-Ordner zuzugreifen",
3833:         en: "Not able to access home folder",
3834:         es: "No se puede acceder a la carpeta de inicio",
3835:         fr: "Impossible d\'acc\xe9der au dossier de l\'utilisateur",
3836:         it: "Non si riesce ad accedere alla cartella home",
3837:         ja: "\u30db\u30fc\u30e0\u30d5\u30a9\u30eb\u30c0\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u307e\u305b\u3093",
3838:         kr: "\ud648 \ud3f4\ub354\uc5d0 \uc811\uadfc \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3839:         pt: "N\xe3o foi poss\xedvel acessar a pasta do usu\xe1rio",
3840:         zh_CN: "\u65e0\u6cd5\u8bbf\u95ee home \u76ee\u5f55",
3841:       }),
3842:       url: getHelpUrls.open_ticket,
3843:     },
3844:     "-11": {
3845:       detail: localize({
3846:         de: "Lizenz ist nicht mehr g\xfcltig",
3847:         en: "License is no longer valid",
3848:         es: "La licencia ya no es v\xe1lida",
3849:         it: "Licenza non pi\xf9 valida",
3850:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u3082\u306f\u3084\u6709\u52b9\u3067\u306f\u3042\u308a\u307e\u305b\u3093",
3851:         kr: "\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \ub77c\uc774\uc13c\uc2a4 \uc785\ub2c8\ub2e4",
3852:         zh_CN: "\u8bb8\u53ef\u8bc1\u4e0d\u518d\u6709\u6548",
3853:       }),
3854:       title: strInvalidLicense,
3855:       url: getHelpUrls.open_ticket,
3856:     },
3857:     "-12": {
3858:       detail: localize({
3859:         de: "Lizenzschl\xfcssel ist ung\xfcltig",
3860:         en: "License key is invalid",
3861:         es: "La llave de la licencia no es v\xe1lida",
3862:         it: "Chiave della licenza non valida",
3863:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059",
3864:         kr: "\ub77c\uc774\uc13c\uc2a4 \ud0a4\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3865:         zh_CN: "\u8bb8\u53ef\u8bc1\u5bc6\u94a5\u65e0\u6548",
3866:       }),
3867:       title: localize({
3868:         de: "Ung\xfcltiger Schl\xfcssel",
3869:         en: "Invalid key",
3870:         es: "Invalida llave",
3871:         it: "Chiave invalida",
3872:         ja: "\u7121\u52b9\u306a\u30ad\u30fc",
3873:         kr: "\ubb34\ud6a8\ud55c \ud0a4",
3874:         zh_CN: "\u65e0\u6548\u7684\u5bc6\u94a5",
3875:       }),
3876:       url: getHelpUrls.open_ticket,
3877:     },
3878:     "-14": {
3879:       detail: localize({
3880:         de: "Es konnte keine Netzwerkkarte gefunden werden",
3881:         en: "Could not find a network adapter on this machine",
3882:         es: "No se pudo encontrar un adaptador de red en esta maquina",
3883:         fr: "Impossible de trouver une carte r\xe9seau",
3884:         it: "Non \xe8 possibile trovare un adattatore di rete su questa macchina",
3885:         ja: "\u3053\u306e\u7aef\u672b\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c0\u30d7\u30bf\u30fc\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093",
3886:         kr: "\ub124\ud2b8\uc6cc\ud06c \uc5b4\ub311\ud130\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3887:         pt: "N\xe3o foi poss\xedvel encontrar um adaptador de rede nessa m\xe1quina",
3888:         zh_CN:
3889:           "\u5728\u8fd9\u53f0\u8bbe\u5907\u4e0a\u627e\u4e0d\u5230\u7f51\u7edc\u9002\u914d\u5668",
3890:       }),
3891:       title: localize({
3892:         de: "Keine Netzwerkkarte",
3893:         en: "Network adapter error",
3894:         es: "Error de adaptador de red",
3895:         fr: "Pas de carte r\xe9seau",
3896:         it: "Errore dell\'adattatore di rete",
3897:         ja: "\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c0\u30d7\u30bf\u30fc\u30a8\u30e9\u30fc",
3898:         kr: "\ub124\ud2b8\uc6cc\ud06c \uc5b4\ub311\ud130 \uc624\ub958",
3899:         pt: "Erro ao ler adaptador de rede",
3900:         zh_CN: "\u7f51\u7edc\u9002\u914d\u5668\u9519\u8bef",
3901:       }),
3902:       url: getHelpUrls.license_faq,
3903:     },
3904:     "-15": {
3905:       detail: localize({
3906:         de: "Lizenzlaufzeit beginnt am ",
3907:         en: "License period starts on ",
3908:         es: "El per\xedodo de licencia comienza en ",
3909:         fr: "La p\xe9riode de licence commence ",
3910:         it: "Il periodo di licenza inizia il ",
3911:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u671f\u9593\u306e\u958b\u59cb\u65e5  ",
3912:         kr: "\ub77c\uc774\uc13c\uc2a4 \uae30\uac04\uc744 \uc2dc\uc791 ",
3913:         pt: "Per\xedodo de licen\xe7a come\xe7a em ",
3914:         zh_CN: "\u8bb8\u53ef\u8bc1\u6709\u6548\u671f\u5f00\u59cb\u4e8e",
3915:       }),
3916:       title: localize({
3917:         de: "Lizenzlaufzeit hat noch nicht begonnen",
3918:         en: "License period has not started yet",
3919:         es: "El periodo de licencia no ha comenzado)",
3920:         fr: "La p\xe9riode de licence n\'a pas encore commenc\xe9e",
3921:         it: "Il periodo della licenza non \xe8 ancora partito",
3922:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u671f\u9593\u304c\u307e\u3060\u59cb\u307e\u3063\u3066\u3044\u307e\u305b\u3093",
3923:         kr: "\ub77c\uc774\uc13c\uc2a4 \uae30\uac04\uc744 \uc544\uc9c1 \uc2dc\uc791\ud558\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4",
3924:         pt: "Per\xedodo de licen\xe7a ainda n\xe3o come\xe7ou",
3925:         zh_CN: "\u8bb8\u53ef\u8bc1\u6709\u6548\u671f\u5c1a\u672a\u5f00\u59cb",
3926:       }),
3927:       url: getHelpUrls.license_faq,
3928:     },
3929:     "-16": {
3930:       detail: localize({
3931:         de: "Lizenzlaufzeit endete am ",
3932:         en: "License period ended on ",
3933:         es: "El per\xedodo de licencia termin\xf3 en ",
3934:         fr: "La p\xe9riode de licence s\'est termin\xe9e le ",
3935:         it: "Il periodo di licenza termina il ",
3936:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u671f\u9593\u306e\u7d42\u4e86\u65e5 ",
3937:         kr: "\ub77c\uc774\uc13c\uc2a4 \uae30\uac04\uc774 \ub05d\ub0ac\uc2b5\ub2c8\ub2e4 ",
3938:         pt: "Per\xedodo de licen\xe7a terminou em ",
3939:         zh_CN: "\u8bb8\u53ef\u8bc1\u6709\u6548\u671f\u7ed3\u675f\u4e8e",
3940:       }),
3941:       title: localize({
3942:         de: "Lizenzlaufzeit ist abgelaufen",
3943:         en: "License period has ended",
3944:         es: "El per\xedodo de licencia ha terminado",
3945:         fr: "La p\xe9riode de licence est termin\xe9e",
3946:         it: "Il periodo di licenza \xe8 terminato",
3947:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u671f\u9593\u304c\u7d42\u4e86\u3057\u307e\u3057\u305f",
3948:         kr: "\ub77c\uc774\uc13c\uc2a4 \uae30\uac04\uc774 \uc885\ub8cc \ub418\uc5c8\uc2b5\ub2c8\ub2e4",
3949:         pt: "Per\xedodo de licen\xe7a terminou",
3950:         zh_CN: "\u8bb8\u53ef\u8bc1\u6709\u6548\u671f\u5df2\u7ed3\u675f",
3951:       }),
3952:       url: getHelpUrls.license_faq,
3953:     },
3954:     "-2": {
3955:       detail: localize({
3956:         de: "Diese Lizenz geh\xf6rt zu einem anderen Rechner",
3957:         en: "This license belongs to a different machine",
3958:         es: "Esta licencia pertence a otra maquina",
3959:         it: "Questa licenza appartiene ad una differente macchina",
3960:         ja: "\u3053\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u4ed6\u306e\u30de\u30b7\u30f3\u3067\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059",
3961:         kr: "\uc774 \ub77c\uc774\uc13c\uc2a4\ub294 \ub2e4\ub978 \uae30\uacc4\uc5d0\uc11c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4",
3962:         pt: "Esta licen\xe7a pertence a outra m\xe1quina",
3963:         zh_CN: "\u6b64\u8bb8\u53ef\u8bc1\u5c5e\u4e8e\u5176\u4ed6\u8bbe\u5907",
3964:       }),
3965:       title: strInvalidLicense,
3966:       url: getHelpUrls.license_faq,
3967:     },
3968:     "-20": {
3969:       detail: localize({
3970:         de: "Bitte \xfcberpr\xfcfe, ob die Floating-Lizenz in der Serverkonfiguration korrekt eingegeben wurde.",
3971:         en: "Please double check that the floating license code was entered correctly in the server config",
3972:         fr: "Veuillez v\xe9rifier que le code de licence flottante est entr\xe9 correctement dans la configuration du serveur",
3973:         it: "Si prega di controllare che il codice della licenza floating sia stato inserito correttamente durante la configurazione del server",
3974:         ja: "\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\u3067\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u6b63\u3057\u304f\u5165\u529b\u3055\u308c\u3066\u3044\u308b\u304b\u518d\u5ea6\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044",
3975:         kr: "\ub77c\uc774\uc13c\uc2a4 \ucf54\ub4dc\ub97c \uc62c\ubc14\ub974\uac8c \uc785\ub825\ud558\uc600\ub294\uc9c0 \ub2e4\uc2dc\ud55c\ubc88 \ud655\uc778\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624",
3976:         pt: "Por favor, cheque se a licen\xe7a flutuante foi inserida corretamente nas configura\xe7\xf5es do servidor",
3977:         zh_CN:
3978:           "\u8bf7\u518d\u6b21\u786e\u8ba4\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u5728\u670d\u52a1\u5668\u914d\u7f6e\u4e2d\u88ab\u6b63\u786e\u7684\u8f93\u5165",
3979:       }),
3980:       title: localize({
3981:         de: "Ung\xfcltige Floating-Lizenz",
3982:         en: "Invalid floating license",
3983:         es: "La licencia flotante no es v\xe1lida",
3984:         fr: "Licence flottante non valide",
3985:         it: "Licenza floating invalida",
3986:         ja: "\u7121\u52b9\u306a\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9",
3987:         kr: "\uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4\ub97c \uc0ac\uc6a9 \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
3988:         pt: "Licen\xe7a flutuante inv\xe1lida",
3989:         zh_CN: "\u65e0\u6548\u7684\u6d6e\u52a8\u8bb8\u53ef\u8bc1",
3990:       }),
3991:       url: getHelpUrls.floating_faq,
3992:     },
3993:     "-21": {
3994:       detail: localize({
3995:         de: "Bitte stellen Sie sicher, dass der Lizenzserver ordnungsgem\xe4\xdf arbeitet",
3996:         en: "Please make sure the floating license server is running properly",
3997:         es: "Aseg\xfarese de que el servidor de licencias est\xe1 funcionando correctamente",
3998:         fr: "Verifiez que le serveur de licences fonctionne correctement",
3999:         it: "Si prega di assicurarsi che il server per le licenze floating stia funzionando",
4000:         ja: "\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044",
4001:         kr: "\uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uac00 \uc62c\ubc14\ub974\uac8c \uc791\ub3d9\ud558\ub294\uc9c0 \ud655\uc778\ud558\uc2ed\uc2dc\uc624",
4002:         pt: "Verifique se o servidor da licen\xe7a flutuante est\xe1 funcionando corretamente",
4003:         zh_CN:
4004:           "\u8bf7\u786e\u4fdd\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u6b63\u5e38\u8fd0\u884c",
4005:       }),
4006:       title: localize({
4007:         de: "Kann Floating License Server nicht kontaktieren",
4008:         en: "Cannot connect to floating license server",
4009:         es: "No es posible conectar con el servidor de licensias flotantes(-9)",
4010:         fr: "Impossible de se connecter au serveur de licences flottantes",
4011:         it: "Non \xe8 possibile connettersi al server per le licenze floating",
4012:         ja: "\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093",
4013:         kr: "\uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4014:         pt: "N\xe3o foi poss\xedvel conectar com o servidor da licen\xe7a flutuante",
4015:         zh_CN:
4016:           "\u65e0\u6cd5\u8fde\u63a5\u5230\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668",
4017:       }),
4018:       url: getHelpUrls.floating_faq,
4019:     },
4020:     "-22": {
4021:       detail: localize({
4022:         de: "Weitere Informationen zum Einrichten und Lizenzieren von Client-Computern finden Sie in den Anweisungen zum Server.",
4023:         en: "Please refer to the server instructions on how to setup and license client machines.",
4024:         es: "Consulte las instrucciones del servidor sobre c\xf3mo configurar y licenciar las m\xe1quinas cliente.",
4025:         fr: "Veuillez vous reporter aux instructions du serveur pour savoir comment configurer et attribuer une licence aux ordinateurs clients.",
4026:         it: "Si prega di far riferimento alle istruzioni del server per conoscere come impostare le macchine client.",
4027:         ja: "\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30de\u30b7\u30f3\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3068\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u53d6\u5f97\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f, \u30b5\u30fc\u30d0\u306e\u624b\u5f15\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044.",
4028:         kr: "\uc14b\uc5c5\uacfc \ub77c\uc774\uc13c\uc2a4 \uae30\uacc4 \uc0ac\uc6a9\ubc95 \ud398\uc774\uc9c0\uc5d0\uc11c \uc11c\ubc84 \uc124\uba85\uc11c\ub97c \uc870\ud68c\ud558\uc2ed\uc2dc\uc624.",
4029:         pt: "Consulte as instru\xe7\xf5es do servidor para configurar e licenciar as m\xe1quinas.",
4030:         zh_CN:
4031:           "\u5173\u4e8e\u5982\u4f55\u8bbe\u7f6e\u548c\u8bb8\u53ef\u5ba2\u6237\u7aef\u8bbe\u5907\uff0c\u8bf7\u53c2\u8003\u670d\u52a1\u5668\u8bf4\u660e\u3002",
4032:       }),
4033:       title: localize({
4034:         de: "Floating-Lizenzen k\xf6nnen nur mit dem Floating License Server verwendet werden",
4035:         en: "Floating licenses can only be used with the Floating License Server",
4036:         es: "Las licencias flotantes solo se pueden utilizar con el servidor de licencias flotantes",
4037:         fr: "Les licences flottantes ne peuvent \xeatre utilis\xe9es qu\'avec le serveur de licences flottantes",
4038:         it: "Le licenze floating possono essere utilizzate esclusivamente con il server di licenze floating",
4039:         ja: "\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u306f\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u3067\u306e\u307f\u4f7f\u3048\u307e\u3059",
4040:         kr: "\uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4\ub294 \uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0\uc11c\ub9cc \uc0ac\uc6a9 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4",
4041:         pt: "Licen\xe7as flutuantes s\xf3 podem ser utilizadas no servidor de licen\xe7as flutuantes",
4042:         zh_CN:
4043:           "\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u53ea\u80fd\u7528\u4e8e\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668",
4044:       }),
4045:       url: getHelpUrls.floating_faq,
4046:     },
4047:     "-23": {
4048:       detail: localize({
4049:         de: "Auf dem Floating License Server sind aktuell alle Lizenzen vergeben",
4050:         en: "There are no more free slots for this license on the license server",
4051:         es: "No hay m\xe1s espacios libres para esta licencia en el servidor de licencias flotantes",
4052:         fr: "Il n\'y a plus de place sur le serveur de licences flottantes",
4053:         it: "Non ci sono pi\xf9 slot liberi per questa licenza sul server delle licenze floating",
4054:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306b\u3053\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u306b\u5bfe\u3059\u308b\u7a7a\u3044\u305f\u30b9\u30ed\u30c3\u30c8\u304c\u3082\u3046\u3042\u308a\u307e\u305b\u3093",
4055:         kr: "\ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0 \ube48\uc790\ub9ac\uac00 \uc5c6\uc2b5\ub2c8\ub2e4",
4056:         pt: "N\xe3o h\xe1 mais espa\xe7os dispon\xedveis para esta licen\xe7a neste servidor",
4057:         zh_CN:
4058:           "\u6b64\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u5728\u670d\u52a1\u5668\u4e0a\u6ca1\u6709\u7a7a\u4f59\u7684\u5e2d\u4f4d",
4059:       }),
4060:       title: localize({
4061:         de: "Keine freien Slots",
4062:         en: "No free slots",
4063:         es: "No hay espacios libres",
4064:         fr: "Plus de place",
4065:         it: "Non ci sono slot liberi",
4066:         ja: "\u30b9\u30ed\u30c3\u30c8\u306e\u7a7a\u304d\u304c\u3042\u308a\u307e\u305b\u3093",
4067:         kr: "\ube48\uc790\ub9ac \uc5c6\uc74c",
4068:         pt: "N\xe3o h\xe1 mais espa\xe7os dispon\xedveis",
4069:         zh_CN: "\u6ca1\u6709\u7a7a\u4f59\u7684\u5e2d\u4f4d",
4070:       }),
4071:       url: getHelpUrls.floating_faq,
4072:     },
4073:     "-24": {
4074:       detail: localize({
4075:         de: "Die Lizenz kann auf dem Floating License Server nicht gefunden werden",
4076:         en: "The license cannot be found on the floating license server",
4077:         es: "No se puede encontrar esta licencia en el servidor de licencias flotantes",
4078:         fr: "La licence est introuvable sur le serveur de licences flottantes",
4079:         it: "\xc8 impossibile trovare la licenza sul server delle licenze floating",
4080:         ja: "\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306b\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093",
4081:         kr: "\uc6d0\ud558\ub294 \ub77c\uc774\uc13c\uc2a4\ub97c \uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0\uc11c \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4",
4082:         pt: "Licen\xe7a n\xe3o encontrada no servidor de licen\xe7as flutuantes",
4083:         zh_CN:
4084:           "\u5728\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u4e0a\u627e\u4e0d\u5230\u6b64\u8bb8\u53ef\u8bc1",
4085:       }),
4086:       title: localize({
4087:         de: "Unbekannte Lizenz",
4088:         en: "Unknown license",
4089:         es: "Licencia desconocida",
4090:         fr: "Licence inconnue",
4091:         it: "Licenza sconosciuta",
4092:         ja: "\u672a\u77e5\u306e\u30e9\u30a4\u30bb\u30f3\u30b9",
4093:         kr: "\uc54c\ub824\uc9c0\uc9c0 \uc54a\uc740 \ub77c\uc774\uc13c\uc2a4",
4094:         pt: "Licen\xe7a desconhecida",
4095:         zh_CN: "\u672a\u77e5\u7684\u8bb8\u53ef\u8bc1",
4096:       }),
4097:       url: getHelpUrls.floating_faq,
4098:     },
4099:     "-25": {
4100:       detail: localize({
4101:         de: "Die Lizenz konnte nicht deaktiviert werden, da sie auf dem Floating License Server nicht gefunden werden konnte",
4102:         en: "The license you are trying to deactivate cannot be found on the floating license server",
4103:         es: "La licencia que est\xe1 intentando de desactivar no se encuentra en el servidor de licencias flotantes",
4104:         fr: "La licence que vous essayez de d\xe9sactiver est introuvable sur le serveur de licences flottantes",
4105:         it: "La licenza che si sta provando a disattivare non si riesce a trovare sul server delle licenze floating",
4106:         ja: "\u7121\u52b9\u5316\u3055\u308c\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306b\u3042\u308a\u307e\u305b\u3093",
4107:         kr: "\ube44\ud65c\uc131\ud654 \ud558\uace0 \uc2f6\uc740 \ub77c\uc774\uc13c\uc2a4\ub97c \uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0\uc11c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4108:         pt: "A licen\xe7a que est\xe1 sendo desativada n\xe3o foi encontrada no servidor de licen\xe7as flutuantes",
4109:         zh_CN:
4110:           "\u5728\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u4e0a\u627e\u4e0d\u5230\u60a8\u8981\u505c\u7528\u7684\u8bb8\u53ef\u8bc1",
4111:       }),
4112:       title: localize({
4113:         de: "Unbekannte Lizenz",
4114:         en: "Unknown license",
4115:         es: "Licencia desconocida",
4116:         fr: "Licence inconnue",
4117:         it: "Licenza sconosciuta",
4118:         ja: "\u672a\u77e5\u306e\u30e9\u30a4\u30bb\u30f3\u30b9",
4119:         kr: "\uc54c\ub824\uc9c0\uc9c0 \uc54a\uc740 \ub77c\uc774\uc13c\uc2a4",
4120:         pt: "Licen\xe7a desconhecida",
4121:         zh_CN: "\u672a\u77e5\u7684\u8bb8\u53ef\u8bc1",
4122:       }),
4123:       url: getHelpUrls.floating_faq,
4124:     },
4125:     "-26": {
4126:       detail: localize({
4127:         de: "Deine Client IP wird vom Floating License Server abgelehnt",
4128:         en: "Your client IP is being denied by the floating license server",
4129:         it: "L\'indirizzo IP del client \xe8 bloccato dal server delle licenze floating",
4130:         ja: "\u304a\u4f7f\u3044\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP\u304c\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306b\u62d2\u5426\u3055\u308c\u3066\u3044\u307e\u3059",
4131:         kr: "\uc758\ub8b0\uc778\uc758 IP\uac00 \uc720\ub3d9\uc801\uc778 \ub77c\uc774\uc13c\uc2a4 \uc11c\ubc84\uc5d0\uc11c \uac70\ubd80\ub2f9\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4",
4132:         zh_CN:
4133:           "\u60a8\u7684\u5ba2\u6237\u7aef IP \u88ab\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u62d2\u7edd",
4134:       }),
4135:       title: localize({
4136:         de: "Clients ist in der Deny-Liste der Floating License Server-Konfiguration",
4137:         en: "Client in deny list of floating license server config",
4138:         it: "Il client compare nella lista di quelli bloccati nelle impostazioni del server delle licenze floating",
4139:         ja: "\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u30d5\u30ed\u30fc\u30c6\u30a3\u30f3\u30b0\u30e9\u30a4\u30bb\u30f3\u30b9\u30b5\u30fc\u30d0\u30fc\u306e\u62d2\u5426\u30ea\u30b9\u30c8\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059",
4140:         kr: "\uc758\ub8b0\uc778\uc774 \uc720\ub3d9\uc801\uc778 \uc11c\ubc84 \ubc30\uc5f4\uc5d0\uc11c \uac70\ubd80\ub418\uc5c8\uc2b5\ub2c8\ub2e4",
4141:         zh_CN:
4142:           "\u5ba2\u6237\u7aef\u5728\u6d6e\u52a8\u8bb8\u53ef\u8bc1\u670d\u52a1\u5668\u914d\u7f6e\u7684\u62d2\u7edd\u540d\u5355\u4e2d",
4143:       }),
4144:       url: getHelpUrls.floating_faq,
4145:     },
4146:     "-3": {
4147:       detail: localize({ en: "" }),
4148:       title: localize({
4149:         de: "Lizenzdatei nicht gefunden",
4150:         en: "License file not found",
4151:         es: "No se encontr\xf3 el archivo de licencia",
4152:         fr: "Fichier de licence introuvable",
4153:         it: "File di licenza non trovato",
4154:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093",
4155:         kr: "\ub77c\uc774\uc13c\uc2a4 \ud30c\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4156:         pt: "Arquivo de licen\xe7a n\xe3o encontrado",
4157:         zh_CN: "\u672a\u627e\u5230\u8bb8\u53ef\u8bc1\u6587\u4ef6",
4158:       }),
4159:       url: getHelpUrls.open_ticket,
4160:     },
4161:     "-30": {
4162:       detail: localize({ en: "" }),
4163:       title: localize({
4164:         de: "Online Aktivierung -  Lizenz ung\xfcltig",
4165:         en: "Online activation -  license invalid",
4166:         fr: "Activation en ligne - licence invalide",
4167:         it: "Attivazione online - licenza invalida",
4168:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u7121\u52b9\u306a\u30e9\u30a4\u30bb\u30f3\u30b9",
4169:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \ub77c\uc774\uc13c\uc2a4",
4170:         pt: "Ativa\xe7\xe3o online - licen\xe7a inv\xe1lida",
4171:         zh_CN:
4172:           "\u5728\u7ebf\u6fc0\u6d3b - \u65e0\u6548\u7684\u8bb8\u53ef\u8bc1",
4173:       }),
4174:       url: getHelpUrls.activation_faq,
4175:     },
4176:     "-31": {
4177:       detail: localize({
4178:         de: "Diese Lizenz ist nicht l\xe4nger g\xfcltig",
4179:         en: "This license is no longer valid",
4180:         fr: "Cette licence n\'est plus valide",
4181:         it: "Questa licenza non \xe8 pi\xf9 valida",
4182:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6709\u52b9\u671f\u9650\u304c\u5207\u308c\u3066\u3044\u307e\u3059",
4183:         kr: "\uc774 \ub77c\uc774\uc13c\uc2a4\ub294 \ub354\uc774\uc0c1 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4184:         pt: "Essa licen\xe7a n\xe3o \xe9 mais v\xe1lida",
4185:         zh_CN: "\u6b64\u8bb8\u53ef\u8bc1\u4e0d\u518d\u6709\u6548",
4186:       }),
4187:       title: localize({
4188:         de: "Online Aktivierung -  Lizenz abgelaufen",
4189:         en: "Online activation - license expired",
4190:         fr: "Activation en ligne - licence expir\xe9e",
4191:         it: "Attivazione online - licenza scaduta",
4192:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u671f\u9650\u5207\u308c",
4193:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \uae30\ud55c\ub9cc\ub8cc\ub41c \ub77c\uc774\uc13c\uc2a4",
4194:         pt: "Ativa\xe7\xe3o online - licen\xe7a expirada",
4195:         zh_CN:
4196:           "\u5728\u7ebf\u6fc0\u6d3b - \u8bb8\u53ef\u8bc1\u5df2\u8fc7\u671f",
4197:       }),
4198:       url: getHelpUrls.activation_faq,
4199:     },
4200:     "-32": {
4201:       detail: localize({
4202:         de: "Bitte deaktiviere zuerst eine Lizenz, um diese zu aktivieren",
4203:         en: "Please deactivate an existing activation before activating this one.",
4204:         fr: "Veuillez d\xe9sactiver une licence existante avant d\'activer celle-ci.",
4205:         it: "Si prega di disattivare un\'attivazione gi\xe0 esistente prima di attivare questa",
4206:         ja: "\u3053\u306e\u7aef\u672b\u3092\u6709\u52b9\u5316\u3059\u308b\u524d\u306b\u3059\u3067\u306b\u6709\u52b9\u5316\u3055\u308c\u305f\u3082\u306e\u304b\u3089\u4e00\u3064\u7121\u52b9\u5316\u3057\u3066\u304f\u3060\u3055\u3044.",
4207:         kr: "\ud65c\uc131\ud654 \ud558\uc2dc\ub824\uba74 \ud604\uc7ac \uc0ac\uc6a9\ub418\uace0 \ud65c\uc131\uc744 \ube44\ud65c\uc131\ud654 \ud558\uc2ed\uc2dc\uc694",
4208:         pt: "Desative alguma ativa\xe7\xe3o existente, antes de ativar essa.",
4209:         zh_CN:
4210:           "\u8bf7\u5728\u6fc0\u6d3b\u524d\u5148\u505c\u7528\u73b0\u6709\u7684\u6fc0\u6d3b\u3002",
4211:       }),
4212:       title: localize({
4213:         de: "Online Aktivierung -  Die maximale Anzahl an Aktivierungen wurde erreicht",
4214:         en: "Online activation - Maximum number of activations reached",
4215:         fr: "Activation en ligne - Le nombre maximal d\'activations atteint",
4216:         it: "Attivazione online - numero massimo di attivazioni raggiunto",
4217:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u6709\u52b9\u5316\u3059\u308b\u6570\u304c\u6700\u5927\u306b\u9054\u3057\u3066\u3044\u307e\u3059",
4218:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \ud65c\uc131\ud654 \ubc94\uc704\uc758 \ucd5c\ub300 \uc218",
4219:         pt: "Ativa\xe7\xe3o online - N\xfamero m\xe1ximo de ativa\xe7\xf5es atingido",
4220:         zh_CN:
4221:           "\u5728\u7ebf\u6fc0\u6d3b - \u5df2\u8fbe\u5230\u6700\u5927\u6fc0\u6d3b\u6b21\u6570",
4222:       }),
4223:       url: getHelpUrls.activation_faq,
4224:     },
4225:     "-33": {
4226:       detail: localize({ en: "" }),
4227:       title: localize({
4228:         de: "Keine Verbindung zum Online-Aktivierungsserver",
4229:         en: "Cannot connect to online activation server",
4230:         fr: "Impossible de se connecter au service d\'activation en ligne",
4231:         it: "Impossibile connettersi al server di attivazione online",
4232:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093",
4233:         kr: "\ud65c\uc131\ud654 \uc11c\ubc84\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4234:         pt: "N\xe3o foi poss\xedvel conectar com o servidor de ativa\xe7\xe3o online",
4235:         zh_CN:
4236:           "\u65e0\u6cd5\u8fde\u63a5\u5230\u5728\u7ebf\u6fc0\u6d3b\u670d\u52a1\u5668",
4237:       }),
4238:       url: getHelpUrls.activation_faq,
4239:     },
4240:     "-34": {
4241:       detail: strClickOnGetHelp,
4242:       title: localize({
4243:         de: "Online Aktivierung - Ung\xfcltiger Payload",
4244:         en: "Online activation - invalid payload",
4245:         fr: "Activation en ligne - payload invalide",
4246:         it: "Attivazione online - payload invalido",
4247:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u4e0d\u6b63\u306a\u30da\u30a4\u30ed\u30fc\u30c9",
4248:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \ubb34\ud6a8\ud55c \ud398\uc774\ub85c\ub4dc",
4249:         pt: "Ativa\xe7\xe3o online - Carga inv\xe1lida",
4250:         zh_CN: "\u5728\u7ebf\u6fc0\u6d3b - \u65e0\u6548\u7684\u8f7d\u8377",
4251:       }),
4252:       url: getHelpUrls.open_ticket,
4253:     },
4254:     "-35": {
4255:       detail: localize({
4256:         de:
4257:           "Diese Aktivierung muss in deinem Account bei aescripts.com durchgef\xfchrt werden. " +
4258:           strClickOnGetHelp,
4259:         en:
4260:           "This activation needs to be deactivated in your aescripts.com account. " +
4261:           strClickOnGetHelp,
4262:         ja:
4263:           "\u3053\u306e\u8a8d\u8a3c\u306f aescripts.com \u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u7121\u52b9\u5316\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059. " +
4264:           strClickOnGetHelp,
4265:         kr:
4266:           "\uc774 \ud65c\uc131\ud654\ub294 \ub2f9\uc2e0\uc758 aescripts.com account \uc5d0\uc11c \ube44\ud65c\uc131\ud654 \ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4." +
4267:           strClickOnGetHelp,
4268:         zh_CN:
4269:           "\u6b64\u6fc0\u6d3b\u9700\u8981\u5728 aescripts.com \u8d26\u6237\u4e2d\u505c\u7528. " +
4270:           strClickOnGetHelp,
4271:       }),
4272:       title: localize({
4273:         de: "Online-Aktivierung - fehlende Ger\xe4te-ID",
4274:         en: "Online activation - missing device id",
4275:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u30c7\u30d0\u30a4\u30b9id\u304c\u3042\u308a\u307e\u305b\u3093",
4276:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \ubd84\uc2e4\ub41c \ub514\ubc14\uc774\uc2a4 \uc544\uc774\ub514",
4277:         zh_CN: "\u5728\u7ebf\u6fc0\u6d3b - \u7f3a\u5c11\u8bbe\u5907 ID",
4278:       }),
4279:       url: getHelpUrls.activation_faq,
4280:     },
4281:     "-36": {
4282:       detail: localize({
4283:         de: "Keine passende Aktivierung gefunden. " + strClickOnGetHelp,
4284:         en: "No matching activation found. " + strClickOnGetHelp,
4285:         ja:
4286:           "\u4e00\u81f4\u3059\u308b\u30a2\u30af\u30c6\u30a3\u30d9\u30fc\u30b7\u30e7\u30f3\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093. " +
4287:           strClickOnGetHelp,
4288:         kr:
4289:           "\ub9de\ub294 \ud65c\uc131\ud654\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. " +
4290:           strClickOnGetHelp,
4291:         zh_CN:
4292:           "\u6ca1\u6709\u5339\u914d\u7684\u6fc0\u6d3b\u8bb0\u5f55. " +
4293:           strClickOnGetHelp,
4294:       }),
4295:       title: localize({
4296:         de: "Online-Aktivierung - kein Datenbankeintrag",
4297:         en: "Online activation - no record in db",
4298:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u8a18\u9332\u304c\u3042\u308a\u307e\u305b\u3093",
4299:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uae30\ub85d\ud558\uc9c0 \uc54a\uc74c",
4300:         zh_CN:
4301:           "\u5728\u7ebf\u6fc0\u6d3b - \u6570\u636e\u5e93\u4e2d\u6ca1\u6709\u8bb0\u5f55",
4302:       }),
4303:       url: getHelpUrls.open_ticket,
4304:     },
4305:     "-37": {
4306:       detail: strClickOnGetHelp,
4307:       title: localize({
4308:         de: "Online-Aktivierung - fehlende Parameter",
4309:         en: "Online activation - missing parameters",
4310:         ja: "\u30aa\u30f3\u30e9\u30a4\u30f3\u8a8d\u8a3c - \u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u3042\u308a\u307e\u305b\u3093",
4311:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \ubd84\uc2e4\ub41c \ud55c\ub3c4",
4312:         zh_CN: "\u5728\u7ebf\u6fc0\u6d3b - \u7f3a\u5c11\u53c2\u6570",
4313:       }),
4314:       url: getHelpUrls.open_ticket,
4315:     },
4316:     "-38": {
4317:       detail: localize({
4318:         de:
4319:           "Diese Aktivierung muss in deinem Account bei aescripts.com durchgef\xfchrt werden. " +
4320:           strClickOnGetHelp,
4321:         en:
4322:           "This activation needs to be deactivated in your aescripts.com account. " +
4323:           strClickOnGetHelp,
4324:         ja:
4325:           "\u3053\u306e\u8a8d\u8a3c\u306f aescripts.com \u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u7121\u52b9\u5316\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059. " +
4326:           strClickOnGetHelp,
4327:         kr:
4328:           "\uc774 \ud65c\uc131\ud654\ub294 \ub2f9\uc2e0\uc758 aescripts.com account \uc5d0\uc11c \ube44\ud65c\uc131\ud654 \ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4. " +
4329:           strClickOnGetHelp,
4330:         zh_CN:
4331:           "\u6b64\u6fc0\u6d3b\u9700\u8981\u5728 aescripts.com \u8d26\u6237\u4e2d\u505c\u7528. " +
4332:           strClickOnGetHelp,
4333:       }),
4334:       title: localize({
4335:         de: "Online-Aktivierung - ung\xfcltige Antwort vom Server",
4336:         en: "Online activation - invalid response from server",
4337:         kr: "\uc628\ub77c\uc778 \ud65c\uc131\ud654 - \uc11c\ubc84\uc5d0\uc11c \uc628 \ubb34\ud6a8\ud55c \uc751\ub2f5",
4338:         zh_CN:
4339:           "\u5728\u7ebf\u6fc0\u6d3b - \u65e0\u6548\u7684\u670d\u52a1\u5668\u54cd\u5e94",
4340:       }),
4341:       url: getHelpUrls.activation_faq,
4342:     },
4343:     "-4": {
4344:       detail: localize({ en: "" }),
4345:       title: localize({
4346:         de: "Lizenzdatei besch\xe4digt",
4347:         en: "License file corrupted",
4348:         es: "El archivo de licencia esta da\xf1ado",
4349:         fr: "Fichier de licence corrompu",
4350:         it: "File di licenza corrotto",
4351:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u30d5\u30a1\u30a4\u30eb\u304c\u58ca\u308c\u3066\u3044\u307e\u3059",
4352:         kr: "\ub77c\uc774\uc13c\uc2a4 \ud30c\uc77c\uc774 \uc190\uc0c1\ub418\uc5c8\uc2b5\ub2c8\ub2e4",
4353:         pt: "Arquivo de licen\xe7a est\xe1 corrompido",
4354:         zh_CN: "\u8bb8\u53ef\u8bc1\u6587\u4ef6\u5df2\u635f\u574f",
4355:       }),
4356:       url: getHelpUrls.open_ticket,
4357:     },
4358:     "-40": {
4359:       detail: localize({ en: "" }),
4360:       title: localize({
4361:         de: "Ung\xfcltiger Offline-Aktivierungscode",
4362:         en: "Invalid offline activation code",
4363:         fr: "Code d\'activation hors connexion invalide",
4364:         it: "Codice di attivazione offline invalido",
4365:         ja: "\u7121\u52b9\u306a\u30aa\u30d5\u30e9\u30a4\u30f3\u8a8d\u8a3c\u30b3\u30fc\u30c9",
4366:         kr: "\ubb34\ud6a8\ud55c \uc628\ub77c\uc778 \ud65c\uc131\ud654 \ucf54\ub4dc",
4367:         pt: "C\xf3digo de ativa\xe7\xe3o offline inv\xe1lido",
4368:         zh_CN: "\u65e0\u6548\u7684\u79bb\u7ebf\u6fc0\u6d3b\u7801",
4369:       }),
4370:       url: getHelpUrls.activation_faq,
4371:     },
4372:     "-5": {
4373:       detail: localize({ en: "" }),
4374:       title: localize({
4375:         de: "Allgemeiner Fehler",
4376:         en: "Generic error",
4377:         es: "Error generico",
4378:         fr: "Erreur g\xe9n\xe9rique",
4379:         it: "Errore generico",
4380:         ja: "\u4e00\u822c\u7684\u306a\u30a8\u30e9\u30fc",
4381:         kr: "\ud3ec\uad04\uc801\uc778 \uc624\ub958",
4382:         pt: "Erro gen\xe9rico",
4383:         zh_CN: "\u4e00\u822c\u6027\u9519\u8bef",
4384:       }),
4385:       url: getHelpUrls.license_faq,
4386:     },
4387:     "-6": {
4388:       detail: localize({ en: "" }),
4389:       title: localize({
4390:         de: "Ung\xfcltiger Produktname",
4391:         en: "Invalid product name",
4392:         es: "El nombre de el producto no v\xe1lido",
4393:         fr: "Nom de produit invalide",
4394:         it: "Nome prodotto invalido",
4395:         ja: "\u7121\u52b9\u306a\u88fd\u54c1\u540d",
4396:         kr: "\uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \uc0c1\ud488\uba85",
4397:         pt: "Nome do produto \xe9 inv\xe1lido",
4398:         zh_CN: "\u65e0\u6548\u7684\u4ea7\u54c1\u540d\u79f0",
4399:       }),
4400:       url: getHelpUrls.open_ticket,
4401:     },
4402:     "-7": {
4403:       detail: localize({ en: "" }),
4404:       title: localize({
4405:         de: "Testversion",
4406:         en: "Trial",
4407:         es: "Versi\xf3n de prueba",
4408:         fr: "P\xe9riode d\'\xe9valuation",
4409:         it: "Prova",
4410:         ja: "\u30c8\u30e9\u30a4\u30a2\u30eb\u7248",
4411:         kr: "\uc2dc\ud5d8",
4412:         pt: "Vers\xe3o Teste",
4413:         zh_CN: "\u8bd5\u7528",
4414:       }),
4415:       url: getHelpUrls.license_faq,
4416:     },
4417:     "-8": {
4418:       detail: localize({
4419:         de: "Lizenz hat ung\xfcltiges Format",
4420:         en: "License has invalid format",
4421:         es: "Licencia tiene un formato invalido",
4422:         it: "La licenza ha un formato non valido",
4423:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u304c\u4e0d\u6b63\u306a\u5f62\u5f0f\u3067\u3059",
4424:         kr: "\uc774 \ub77c\uc774\uc13c\uc2a4\ub294 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub294 \ud3ec\ub9f7\uc744 \uac00\uc84c\uc2b5\ub2c8\ub2e4",
4425:         zh_CN: "\u8bb8\u53ef\u8bc1\u683c\u5f0f\u65e0\u6548",
4426:       }),
4427:       title: strInvalidLicense,
4428:       url: getHelpUrls.license_faq,
4429:     },
4430:     "-9": {
4431:       detail: localize({
4432:         de: "Lizenz-Typ nicht erkannt",
4433:         en: "License type not recognized",
4434:         es: "El tipo de la licencia no se reconoze",
4435:         it: "Tipo di licenza non riconosciuto",
4436:         ja: "\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u30bf\u30a4\u30d7\u304c\u8a8d\u8b58\u3067\u304d\u307e\u305b\u3093",
4437:         kr: "\ub77c\uc774\uc13c\uc2a4 \uc885\ub958\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
4438:         zh_CN: "\u8bb8\u53ef\u8bc1\u7c7b\u578b\u65e0\u6cd5\u8bc6\u522b",
4439:       }),
4440:       title: strInvalidLicense,
4441:       url: getHelpUrls.license_faq,
4442:     },
4443:     "-99": {
4444:       detail: strClickOnGetHelp,
4445:       title: localize({
4446:         de: "Unbekannter Fehler",
4447:         en: "Unknown error",
4448:         es: "Error desconocido",
4449:         fr: "Erreur inconnue",
4450:         it: "Errore sconosciuto",
4451:         ja: "\u672a\u77e5\u306e\u30a8\u30e9\u30fc",
4452:         kr: "\uc54c \uc218 \uc5c6\ub294 \uc5d0\ub7ec",
4453:         pt: "Erro desconhecido",
4454:         zh_CN: "\u672a\u77e5\u9519\u8bef",
4455:       }),
4456:       url: getHelpUrls.open_ticket,
4457:     },
4458:     unknown: {
4459:       detail: localize({ en: "" }),
4460:       title: localize({
4461:         de: "Unbekannter Fehler",
4462:         en: "Unknown error",
4463:         es: "Error desconocido",
4464:         fr: "Erreur inconnue",
4465:         it: "Errore sconosciuto",
4466:         ja: "\u672a\u77e5\u306e\u30a8\u30e9\u30fc",
4467:         kr: "\uc54c \uc218 \uc5c6\ub294 \uc5d0\ub7ec",
4468:         pt: "Erro desconhecido",
4469:         zh_CN: "\u672a\u77e5\u9519\u8bef",
4470:       }),
4471:       url: getHelpUrls.open_ticket,
4472:     },
4473:   };
4474:   this.getSetting = function (header, name) {
4475:     header = strHeader + "_" + header;
4476:     return getSettings(header, name, "settings");
4477:   };
4478:   this.readJSON = function (json) {
4479:     return readJSON(json);
4480:   };
4481:   this.writeJSON = function (obj, file) {
4482:     return writeJSON(obj, file);
4483:   };
4484:   this.JSONify = function (string, mode, prettyJSON) {
4485:     return JSONify(string, mode, prettyJSON);
4486:   };
4487:   this.haveSetting = function (header, name) {
4488:     header = strHeader + "_" + header;
4489:     return haveSettings(header, name, "settings");
4490:   };
4491:   this.saveSetting = function (header, name, value) {
4492:     header = strHeader + "_" + header;
4493:     return saveSettings(header, name, value, "settings");
4494:   };
4495:   this.c = function () {
4496:     saveVersionsToPrefs;
4497:     return mainFunc("l");
4498:   };
4499:   this.s = function () {
4500:     saveVersionsToPrefs;
4501:     if (
4502:       typeof licenseValidity == "undefined" ||
4503:       !licenseValidity.hasOwnProperty("result")
4504:     ) {
4505:       licenseValidity = getVerifCode("");
4506:     }
4507:     return isResultValidLicense(licenseValidity);
4508:   };
4509:   this.r = function () {
4510:     saveVersionsToPrefs;
4511:     return !mainFunc("r");
4512:   };
4513:   this.t = function () {
4514:     saveVersionsToPrefs;
4515:     if (
4516:       typeof licenseValidity == "undefined" ||
4517:       !licenseValidity.hasOwnProperty("result")
4518:     ) {
4519:       licenseValidity = getVerifCode("");
4520:     }
4521:     return isResultTrial(licenseValidity.result);
4522:   };
4523:   this.l = function () {
4524:     saveVersionsToPrefs;
4525:     if (
4526:       typeof licenseValidity == "undefined" ||
4527:       !licenseValidity.hasOwnProperty("result")
4528:     ) {
4529:       licenseValidity = getVerifCode("");
4530:     }
4531:     return licenseValidity.license;
4532:   };
4533:   this.ss = function () {
4534:     saveVersionsToPrefs;
4535:     if (
4536:       typeof licenseValidity == "undefined" ||
4537:       !licenseValidity.hasOwnProperty("result")
4538:     ) {
4539:       licenseValidity = getVerifCode("");
4540:     }
4541:     return (
4542:       isResultValidLicense(licenseValidity) &&
4543:       !isResultTrial(licenseValidity.result)
4544:     );
4545:   };
4546:   this.vt = function () {
4547:     saveVersionsToPrefs;
4548:     return isVT();
4549:   };
4550:   this.helpUI = function (options) {
4551:     saveVersionsToPrefs;
4552:     helpUI(options);
4553:   };
4554:   this.getRegistration = function (val) {
4555:     saveVersionsToPrefs;
4556:     return getRegistration(val);
4557:   };
4558:   this.openSupportTicket = function (options) {
4559:     saveVersionsToPrefs;
4560:     createSupportTicket(options);
4561:   };
4562:   this.openURL = function (url) {
4563:     saveVersionsToPrefs;
4564:     openURL(url);
4565:   };
4566:   this.doUpdateCheck = function (val) {
4567:     saveVersionsToPrefs;
4568:     setUpdateCheck(val);
4569:   };
4570:   this.getUpdateCheckStatus = function () {
4571:     return doUpdateCheck;
4572:   };
4573:   this.doUpdateCheckNow = function () {
4574:     return doUpdateCheckNow();
4575:   };
4576:   this.frameworkVersion = function () {
4577:     saveVersionsToPrefs;
4578:     return licensingVersion;
4579:   };
4580:   this.getPrefsFolder = function () {
4581:     return checkFoldersAvailability();
4582:   };
4583: }
4584: var g2 = new b(ab_settings);
4585: if (g2.c()) {
4586:   (function (thisObj) {
4587:     function buildUI(thisObj) {
4588:       function showTab_verticaltabbedpanel1() {
4589:         if (verticaltabbedpanel1_nav.selection !== null) {
4590:           for (var i = verticaltabbedpanel1_tabs.length - 1; i >= 0; i--) {
4591:             verticaltabbedpanel1_tabs[i].visible = false;
4592:           }
4593:           verticaltabbedpanel1_tabs[
4594:             verticaltabbedpanel1_nav.selection.index
4595:           ].visible = true;
4596:         }
4597:       }
4598:       function myHelp() {
4599:         g2.helpUI();
4600:       }
4601:       function myP_apply() {
4602:         var myComp = app.project.activeItem;
4603:         var myLayers = myComp.selectedLayers;
4604:         var hasEffect = false;
4605:         if (myLayers.length > 0) {
4606:           for (var ii = 0; ii < myLayers.length; ii += 1) {
4607:             var myProp = myLayers[ii].property("Effects");
4608:             for (var i = 1; i <= myProp.numProperties; i += 1) {
4609:               if (myProp.property(i).name == "Faux Parent - Position") {
4610:                 hasEffect = true;
4611:               }
4612:             }
4613:           }
4614:           if (!hasEffect) {
4615:             addPos();
4616:           } else {
4617:             alert(
4618:               "The layer(s) selected already has Faux Parent - Position applied.",
4619:             );
4620:           }
4621:         }
4622:       }
4623:       function myS_apply() {
4624:         var myComp = app.project.activeItem;
4625:         var myLayers = myComp.selectedLayers;
4626:         var hasEffect = false;
4627:         if (myLayers.length > 0) {
4628:           for (var ii = 0; ii < myLayers.length; ii += 1) {
4629:             var myProp = myLayers[ii].property("Effects");
4630:             for (var i = 1; i <= myProp.numProperties; i += 1) {
4631:               if (myProp.property(i).name == "Faux Parent - Scale") {
4632:                 hasEffect = true;
4633:               }
4634:             }
4635:           }
4636:           if (!hasEffect) {
4637:             addScale();
4638:           } else {
4639:             alert(
4640:               "The layer(s) selected already has Faux Parent - Scale applied.",
4641:             );
4642:           }
4643:         }
4644:       }
4645:       function myR_apply() {
4646:         var myComp = app.project.activeItem;
4647:         var myLayers = myComp.selectedLayers;
4648:         var hasEffect = false;
4649:         if (myLayers.length > 0) {
4650:           for (var ii = 0; ii < myLayers.length; ii += 1) {
4651:             var myProp = myLayers[ii].property("Effects");
4652:             for (var i = 1; i <= myProp.numProperties; i += 1) {
4653:               if (myProp.property(i).name == "Faux Parent - Rotation") {
4654:                 hasEffect = true;
4655:               }
4656:             }
4657:           }
4658:           if (!hasEffect) {
4659:             addRotation();
4660:           } else {
4661:             alert(
4662:               "The layer(s) selected already has Faux Parent - Rotation applied.",
4663:             );
4664:           }
4665:         }
4666:       }
4667:       function myO_apply() {
4668:         var myComp = app.project.activeItem;
4669:         var myLayers = myComp.selectedLayers;
4670:         var hasEffect = false;
4671:         if (myLayers.length > 0) {
4672:           for (var ii = 0; ii < myLayers.length; ii += 1) {
4673:             var myProp = myLayers[ii].property("Effects");
4674:             for (var i = 1; i <= myProp.numProperties; i += 1) {
4675:               if (myProp.property(i).name == "Faux Parent - Opacity") {
4676:                 hasEffect = true;
4677:               }
4678:             }
4679:           }
4680:           if (!hasEffect) {
4681:             addOpacity();
4682:           } else {
4683:             alert(
4684:               "The layer(s) selected already has Faux Parent - Opacity applied.",
4685:             );
4686:           }
4687:         }
4688:       }
4689:       function addPos() {
4690:         function addMarker_P() {
4691:           var myComp = app.project.activeItem;
4692:           var myLayers = myComp.selectedLayers;
4693:           var myMarker = new MarkerValue("FP_S");
4694:           for (var i = 0; i < myLayers.length; i += 1) {
4695:             var myProp = myLayers[i].effect("Faux Parent - Position")(
4696:               "Position Offset",
4697:             );
4698:             myProp.selected = true;
4699:             myLayers[i]
4700:               .property("Marker")
4701:               .setValueAtTime(app.project.activeItem.time, myMarker);
4702:           }
4703:         }
4704:         function addKeys_P() {
4705:           var myComp = app.project.activeItem;
4706:           var myLayers = myComp.selectedLayers;
4707:           app.executeCommand(app.findMenuCommandId("Deselect All"));
4708:           try {
4709:             for (var ii = 0; ii < myLayers.length; ii += 1) {
4710:               myLayers[ii].selected = false;
4711:               var myProp = myLayers[ii].effect("Faux Parent - Position")(
4712:                 "Position Offset",
4713:               );
4714:               myProp.expressionEnabled = true;
4715:               myProp.selected = true;
4716:               app.executeCommand(
4717:                 app.findMenuCommandId("Convert Expression to Keyframes"),
4718:               );
4719:               var myProp = myLayers[ii].property("Marker");
4720:               for (var i = 1; i <= myProp.numKeys; i += 1) {
4721:                 if (myProp.keyValue(i).comment == "FP_S") {
4722:                   myProp.removeKey(i);
4723:                   break;
4724:                 }
4725:               }
4726:             }
4727:           } catch (err) {}
4728:         }
4729:         function deselectAll(theComp) {
4730:           for (var i = 1; i <= theComp.numLayers; i += 1) {
4731:             theComp.layer(i).selected = false;
4732:           }
4733:         }
4734:         function userSelect() {
4735:           var myComp = app.project.activeItem;
4736:           var myLayers = myComp.selectedLayers;
4737:           for (var i = 0; i < myLayers.length; i += 1) {
4738:             var myType = myLayers[i].effect("Faux Parent - Position")(
4739:               "Position Parent Type",
4740:             );
4741:             try {
4742:               if (parseInt(edittext1.text, 10) > 0) {
4743:                 myType.setValue(dropdown1.selection.index + 1);
4744:               }
4745:             } catch (err) {
4746:               myType.setValue(1);
4747:             }
4748:           }
4749:         }
4750:         app.beginUndoGroup("Faux Parent - Position");
4751:         var myComp = app.project.activeItem;
4752:         var myLayers = myComp.selectedLayers;
4753:         var ffxFile = File(
4754:           File($.fileName).path + "/fp_presets/" + "FP_position.ffx",
4755:         );
4756:         for (var i = 0; i < myLayers.length; i += 1) {
4757:           deselectAll(myComp);
4758:           myLayers[i].selected = true;
4759:           myLayers[i].applyPreset(ffxFile);
4760:           var myProp = myLayers[i].effect("Faux Parent - Position")(
4761:             "Position Offset",
4762:           );
4763:           myProp.expressionEnabled = false;
4764:           userSelect();
4765:           myParent = myLayers[i].effect("Faux Parent - Position")(
4766:             "Position Parent",
4767:           );
4768:           try {
4769:             var myIndex = parseInt(edittext1.text, 10);
4770:             myParent.setValue(myIndex);
4771:             addMarker_P();
4772:             addKeys_P();
4773:           } catch (err) {
4774:             var myIndex = myLayers[i].index;
4775:             myParent.setValue(myIndex);
4776:           }
4777:         }
4778:         app.endUndoGroup();
4779:       }
4780:       function addScale() {
4781:         function addMarker_P() {
4782:           var myComp = app.project.activeItem;
4783:           var myLayers = myComp.selectedLayers;
4784:           var myMarker = new MarkerValue("FP_S");
4785:           for (var i = 0; i < myLayers.length; i += 1) {
4786:             var myProp = myLayers[i].effect("Faux Parent - Scale")(
4787:               "Scale Offset",
4788:             );
4789:             myProp.selected = true;
4790:             myLayers[i]
4791:               .property("Marker")
4792:               .setValueAtTime(app.project.activeItem.time, myMarker);
4793:           }
4794:         }
4795:         function addKeys_P() {
4796:           var myComp = app.project.activeItem;
4797:           var myLayers = myComp.selectedLayers;
4798:           app.executeCommand(app.findMenuCommandId("Deselect All"));
4799:           try {
4800:             for (var ii = 0; ii < myLayers.length; ii += 1) {
4801:               myLayers[ii].selected = false;
4802:               var myProp = myLayers[ii].effect("Faux Parent - Scale")(
4803:                 "Scale Offset",
4804:               );
4805:               myProp.expressionEnabled = true;
4806:               myProp.selected = true;
4807:               app.executeCommand(
4808:                 app.findMenuCommandId("Convert Expression to Keyframes"),
4809:               );
4810:               var myProp = myLayers[ii].property("Marker");
4811:               for (var i = 1; i <= myProp.numKeys; i += 1) {
4812:                 if (myProp.keyValue(i).comment == "FP_S") {
4813:                   myProp.removeKey(i);
4814:                   break;
4815:                 }
4816:               }
4817:             }
4818:           } catch (err) {}
4819:         }
4820:         function deselectAll(theComp) {
4821:           for (var i = 1; i <= theComp.numLayers; i += 1) {
4822:             theComp.layer(i).selected = false;
4823:           }
4824:         }
4825:         function userSelect() {
4826:           var myComp = app.project.activeItem;
4827:           var myLayers = myComp.selectedLayers;
4828:           for (var i = 0; i < myLayers.length; i += 1) {
4829:             var myType = myLayers[i].effect("Faux Parent - Scale")(
4830:               "Scale Parent Type",
4831:             );
4832:             try {
4833:               if (parseInt(edittext1.text, 10) > 0) {
4834:                 myType.setValue(dropdown2.selection.index + 1);
4835:               }
4836:             } catch (err) {
4837:               myType.setValue(1);
4838:             }
4839:           }
4840:         }
4841:         app.beginUndoGroup("Faux Parent - Scale");
4842:         var myComp = app.project.activeItem;
4843:         var myLayers = myComp.selectedLayers;
4844:         var ffxFile = File(
4845:           File($.fileName).path + "/fp_presets/" + "FP_scale.ffx",
4846:         );
4847:         for (var i = 0; i < myLayers.length; i += 1) {
4848:           deselectAll(myComp);
4849:           myLayers[i].selected = true;
4850:           myLayers[i].applyPreset(ffxFile);
4851:           var myProp = myLayers[i].effect("Faux Parent - Scale")(
4852:             "Scale Offset",
4853:           );
4854:           myProp.expressionEnabled = false;
4855:           userSelect();
4856:           myParent = myLayers[i].effect("Faux Parent - Scale")("Scale Parent");
4857:           try {
4858:             var myIndex = parseInt(edittext1.text, 10);
4859:             myParent.setValue(myIndex);
4860:             addMarker_P();
4861:             addKeys_P();
4862:           } catch (err) {
4863:             var myIndex = myLayers[i].index;
4864:             myParent.setValue(myIndex);
4865:           }
4866:         }
4867:         app.endUndoGroup();
4868:       }
4869:       function addRotation() {
4870:         function addMarker_P() {
4871:           var myComp = app.project.activeItem;
4872:           var myLayers = myComp.selectedLayers;
4873:           var myMarker = new MarkerValue("FP_S");
4874:           for (var i = 0; i < myLayers.length; i += 1) {
4875:             var myProp = myLayers[i].effect("Faux Parent - Rotation")(
4876:               "Rotation Offset",
4877:             );
4878:             myProp.selected = true;
4879:             myLayers[i]
4880:               .property("Marker")
4881:               .setValueAtTime(app.project.activeItem.time, myMarker);
4882:           }
4883:         }
4884:         function addKeys_P() {
4885:           var myComp = app.project.activeItem;
4886:           var myLayers = myComp.selectedLayers;
4887:           app.executeCommand(app.findMenuCommandId("Deselect All"));
4888:           try {
4889:             for (var ii = 0; ii < myLayers.length; ii += 1) {
4890:               myLayers[ii].selected = false;
4891:               var myProp = myLayers[ii].effect("Faux Parent - Rotation")(
4892:                 "Rotation Offset",
4893:               );
4894:               myProp.expressionEnabled = true;
4895:               myProp.selected = true;
4896:               app.executeCommand(
4897:                 app.findMenuCommandId("Convert Expression to Keyframes"),
4898:               );
4899:               var myProp = myLayers[ii].property("Marker");
4900:               for (var i = 1; i <= myProp.numKeys; i += 1) {
4901:                 if (myProp.keyValue(i).comment == "FP_S") {
4902:                   myProp.removeKey(i);
4903:                   break;
4904:                 }
4905:               }
4906:             }
4907:           } catch (err) {}
4908:         }
4909:         function deselectAll(theComp) {
4910:           for (var i = 1; i <= theComp.numLayers; i += 1) {
4911:             theComp.layer(i).selected = false;
4912:           }
4913:         }
4914:         function userSelect() {
4915:           var myComp = app.project.activeItem;
4916:           var myLayers = myComp.selectedLayers;
4917:           for (var i = 0; i < myLayers.length; i += 1) {
4918:             var myType = myLayers[i].effect("Faux Parent - Rotation")(
4919:               "Rotation Parent Type",
4920:             );
4921:             try {
4922:               if (parseInt(edittext1.text, 10) > 0) {
4923:                 myType.setValue(dropdown3.selection.index + 1);
4924:               }
4925:             } catch (err) {
4926:               myType.setValue(1);
4927:             }
4928:           }
4929:         }
4930:         app.beginUndoGroup("Faux Parent - Rotation");
4931:         var myComp = app.project.activeItem;
4932:         var myLayers = myComp.selectedLayers;
4933:         var ffxFile = File(
4934:           File($.fileName).path + "/fp_presets/" + "FP_rotation.ffx",
4935:         );
4936:         for (var i = 0; i < myLayers.length; i += 1) {
4937:           deselectAll(myComp);
4938:           myLayers[i].selected = true;
4939:           myLayers[i].applyPreset(ffxFile);
4940:           var myProp = myLayers[i].effect("Faux Parent - Rotation")(
4941:             "Rotation Offset",
4942:           );
4943:           myProp.expressionEnabled = false;
4944:           userSelect();
4945:           myParent = myLayers[i].effect("Faux Parent - Rotation")(
4946:             "Rotation Parent",
4947:           );
4948:           try {
4949:             var myIndex = parseInt(edittext1.text, 10);
4950:             myParent.setValue(myIndex);
4951:             addMarker_P();
4952:             addKeys_P();
4953:           } catch (err) {
4954:             var myIndex = myLayers[i].index;
4955:             myParent.setValue(myIndex);
4956:           }
4957:         }
4958:         app.endUndoGroup();
4959:       }
4960:       function addOpacity() {
4961:         function addMarker_P() {
4962:           var myComp = app.project.activeItem;
4963:           var myLayers = myComp.selectedLayers;
4964:           var myMarker = new MarkerValue("FP_S");
4965:           for (var i = 0; i < myLayers.length; i += 1) {
4966:             var myProp = myLayers[i].effect("Faux Parent - Opacity")(
4967:               "Opacity Offset",
4968:             );
4969:             myProp.selected = true;
4970:             myLayers[i]
4971:               .property("Marker")
4972:               .setValueAtTime(app.project.activeItem.time, myMarker);
4973:           }
4974:         }
4975:         function addKeys_P() {
4976:           var myComp = app.project.activeItem;
4977:           var myLayers = myComp.selectedLayers;
4978:           app.executeCommand(app.findMenuCommandId("Deselect All"));
4979:           try {
4980:             for (var ii = 0; ii < myLayers.length; ii += 1) {
4981:               myLayers[ii].selected = false;
4982:               var myProp = myLayers[ii].effect("Faux Parent - Opacity")(
4983:                 "Opacity Offset",
4984:               );
4985:               myProp.expressionEnabled = true;
4986:               myProp.selected = true;
4987:               app.executeCommand(
4988:                 app.findMenuCommandId("Convert Expression to Keyframes"),
4989:               );
4990:               var myProp = myLayers[ii].property("Marker");
4991:               for (var i = 1; i <= myProp.numKeys; i += 1) {
4992:                 if (myProp.keyValue(i).comment == "FP_S") {
4993:                   myProp.removeKey(i);
4994:                   break;
4995:                 }
4996:               }
4997:             }
4998:           } catch (err) {}
4999:         }
5000:         function deselectAll(theComp) {
5001:           for (var i = 1; i <= theComp.numLayers; i += 1) {
5002:             theComp.layer(i).selected = false;
5003:           }
5004:         }
5005:         function userSelect() {
5006:           var myComp = app.project.activeItem;
5007:           var myLayers = myComp.selectedLayers;
5008:           for (var i = 0; i < myLayers.length; i += 1) {
5009:             var myType = myLayers[i].effect("Faux Parent - Opacity")(
5010:               "Opacity Parent Type",
5011:             );
5012:             try {
5013:               if (parseInt(edittext1.text, 10) > 0) {
5014:                 myType.setValue(dropdown4.selection.index + 1);
5015:               }
5016:             } catch (err) {
5017:               myType.setValue(1);
5018:             }
5019:           }
5020:         }
5021:         app.beginUndoGroup("Faux Parent - Opacity");
5022:         var myComp = app.project.activeItem;
5023:         var myLayers = myComp.selectedLayers;
5024:         var ffxFile = File(
5025:           File($.fileName).path + "/fp_presets/" + "FP_opacity.ffx",
5026:         );
5027:         for (var i = 0; i < myLayers.length; i += 1) {
5028:           deselectAll(myComp);
5029:           myLayers[i].selected = true;
5030:           myLayers[i].applyPreset(ffxFile);
5031:           var myProp = myLayers[i].effect("Faux Parent - Opacity")(
5032:             "Opacity Offset",
5033:           );
5034:           myProp.expressionEnabled = false;
5035:           userSelect();
5036:           myParent = myLayers[i].effect("Faux Parent - Opacity")(
5037:             "Opacity Parent",
5038:           );
5039:           try {
5040:             var myIndex = parseInt(edittext1.text, 10);
5041:             myParent.setValue(myIndex);
5042:             addMarker_P();
5043:             addKeys_P();
5044:           } catch (err) {
5045:             var myIndex = myLayers[i].index;
5046:             myParent.setValue(myIndex);
5047:           }
5048:         }
5049:         app.endUndoGroup();
5050:       }
5051:       function syncPos() {
5052:         addMarker_P();
5053:         addKeys_P();
5054:       }
5055:       function addMarker_P() {
5056:         var myComp = app.project.activeItem;
5057:         var myLayers = myComp.selectedLayers;
5058:         var myMarker = new MarkerValue("FP_S");
5059:         app.beginUndoGroup("Snyc");
5060:         try {
5061:           for (var i = 0; i < myLayers.length; i += 1) {
5062:             var myProp = myLayers[i].effect("Faux Parent - Position")(
5063:               "Position Offset",
5064:             );
5065:             myProp.selected = true;
5066:             myLayers[i]
5067:               .property("Marker")
5068:               .setValueAtTime(app.project.activeItem.time, myMarker);
5069:           }
5070:         } catch (err) {
5071:           alert("Select layer(s) with Faux Parent - Position applied.");
5072:         }
5073:       }
5074:       function addKeys_P() {
5075:         var myComp = app.project.activeItem;
5076:         var myLayers = myComp.selectedLayers;
5077:         app.executeCommand(app.findMenuCommandId("Deselect All"));
5078:         try {
5079:           for (var ii = 0; ii < myLayers.length; ii += 1) {
5080:             myLayers[ii].selected = false;
5081:             var myProp = myLayers[ii].effect("Faux Parent - Position")(
5082:               "Position Offset",
5083:             );
5084:             myProp.expressionEnabled = true;
5085:             myProp.selected = true;
5086:             app.executeCommand(
5087:               app.findMenuCommandId("Convert Expression to Keyframes"),
5088:             );
5089:             var myProp = myLayers[ii].property("Marker");
5090:             for (var i = 1; i <= myProp.numKeys; i += 1) {
5091:               if (myProp.keyValue(i).comment == "FP_S") {
5092:                 myProp.removeKey(i);
5093:                 break;
5094:               }
5095:             }
5096:           }
5097:         } catch (err) {}
5098:         app.endUndoGroup();
5099:       }
5100:       function syncScale() {
5101:         addMarker_S();
5102:         addKeys_S();
5103:       }
5104:       function addMarker_S() {
5105:         var myComp = app.project.activeItem;
5106:         var myLayers = myComp.selectedLayers;
5107:         var myMarker = new MarkerValue("FP_S");
5108:         app.beginUndoGroup("Snyc");
5109:         try {
5110:           for (var i = 0; i < myLayers.length; i += 1) {
5111:             app.executeCommand(app.findMenuCommandId("Deselect All"));
5112:             var myProp = myLayers[i].effect("Faux Parent - Scale")(
5113:               "Scale Offset",
5114:             );
5115:             myProp.selected = true;
5116:             myLayers[i]
5117:               .property("Marker")
5118:               .setValueAtTime(app.project.activeItem.time, myMarker);
5119:           }
5120:         } catch (err) {
5121:           alert("Select layer(s) with Faux Parent - Scale applied.");
5122:         }
5123:       }
5124:       function addKeys_S() {
5125:         var myComp = app.project.activeItem;
5126:         var myLayers = myComp.selectedLayers;
5127:         app.executeCommand(app.findMenuCommandId("Deselect All"));
5128:         try {
5129:           for (var ii = 0; ii < myLayers.length; ii += 1) {
5130:             myLayers[ii].selected = false;
5131:             var myProp = myLayers[ii].effect("Faux Parent - Scale")(
5132:               "Scale Offset",
5133:             );
5134:             myProp.expressionEnabled = true;
5135:             myProp.selected = true;
5136:             app.executeCommand(
5137:               app.findMenuCommandId("Convert Expression to Keyframes"),
5138:             );
5139:             var myProp = myLayers[ii].property("Marker");
5140:             for (var i = 1; i <= myProp.numKeys; i += 1) {
5141:               if (myProp.keyValue(i).comment == "FP_S") {
5142:                 myProp.removeKey(i);
5143:                 break;
5144:               }
5145:             }
5146:           }
5147:         } catch (err) {}
5148:         app.endUndoGroup();
5149:       }
5150:       function syncRotation() {
5151:         addMarker_R();
5152:         addKeys_R();
5153:       }
5154:       function addMarker_R() {
5155:         var myComp = app.project.activeItem;
5156:         var myLayers = myComp.selectedLayers;
5157:         var myMarker = new MarkerValue("FP_S");
5158:         app.beginUndoGroup("Snyc");
5159:         try {
5160:           for (var i = 0; i < myLayers.length; i += 1) {
5161:             var myProp = myLayers[i].effect("Faux Parent - Rotation")(
5162:               "Rotation Offset",
5163:             );
5164:             myProp.selected = true;
5165:             myLayers[i]
5166:               .property("Marker")
5167:               .setValueAtTime(app.project.activeItem.time, myMarker);
5168:           }
5169:         } catch (err) {
5170:           alert("Select layer(s) with Faux Parent - Rotation applied.");
5171:         }
5172:       }
5173:       function addKeys_R() {
5174:         var myComp = app.project.activeItem;
5175:         var myLayers = myComp.selectedLayers;
5176:         app.executeCommand(app.findMenuCommandId("Deselect All"));
5177:         try {
5178:           for (var ii = 0; ii < myLayers.length; ii += 1) {
5179:             myLayers[ii].selected = false;
5180:             var myProp = myLayers[ii].effect("Faux Parent - Rotation")(
5181:               "Rotation Offset",
5182:             );
5183:             myProp.expressionEnabled = true;
5184:             myProp.selected = true;
5185:             app.executeCommand(
5186:               app.findMenuCommandId("Convert Expression to Keyframes"),
5187:             );
5188:             var myProp = myLayers[ii].property("Marker");
5189:             for (var i = 1; i <= myProp.numKeys; i += 1) {
5190:               if (myProp.keyValue(i).comment == "FP_S") {
5191:                 myProp.removeKey(i);
5192:                 break;
5193:               }
5194:             }
5195:           }
5196:         } catch (err) {}
5197:         app.endUndoGroup();
5198:       }
5199:       function syncOpacity() {
5200:         addMarker_O();
5201:         addKeys_O();
5202:       }
5203:       function addMarker_O() {
5204:         var myComp = app.project.activeItem;
5205:         var myLayers = myComp.selectedLayers;
5206:         var myMarker = new MarkerValue("FP_S");
5207:         app.beginUndoGroup("Snyc");
5208:         try {
5209:           for (var i = 0; i < myLayers.length; i += 1) {
5210:             var myProp = myLayers[i].effect("Faux Parent - Opacity")(
5211:               "Opacity Offset",
5212:             );
5213:             myProp.selected = true;
5214:             myLayers[i]
5215:               .property("Marker")
5216:               .setValueAtTime(app.project.activeItem.time, myMarker);
5217:           }
5218:         } catch (err) {
5219:           alert("Select layer(s) with Faux Parent - Opacity applied.");
5220:         }
5221:       }
5222:       function addKeys_O() {
5223:         var myComp = app.project.activeItem;
5224:         var myLayers = myComp.selectedLayers;
5225:         app.executeCommand(app.findMenuCommandId("Deselect All"));
5226:         try {
5227:           for (var ii = 0; ii < myLayers.length; ii += 1) {
5228:             myLayers[ii].selected = false;
5229:             var myProp = myLayers[ii].effect("Faux Parent - Opacity")(
5230:               "Opacity Offset",
5231:             );
5232:             myProp.expressionEnabled = true;
5233:             myProp.selected = true;
5234:             app.executeCommand(
5235:               app.findMenuCommandId("Convert Expression to Keyframes"),
5236:             );
5237:             var myProp = myLayers[ii].property("Marker");
5238:             for (var i = 1; i <= myProp.numKeys; i += 1) {
5239:               if (myProp.keyValue(i).comment == "FP_S") {
5240:                 myProp.removeKey(i);
5241:                 break;
5242:               }
5243:             }
5244:           }
5245:         } catch (err) {}
5246:         app.endUndoGroup();
5247:       }
5248:       var windowName = "Faux Parent";
5249:       var myPanel =
5250:         thisObj instanceof Panel
5251:           ? thisObj
5252:           : new Window("window", windowName, undefined, { resizeable: true });
5253:       var verticaltabbedpanel1 = myPanel.add("group", undefined, undefined, {
5254:         name: "verticaltabbedpanel1",
5255:       });
5256:       verticaltabbedpanel1.alignChildren = ["left", "fill"];
5257:       var verticaltabbedpanel1_nav = verticaltabbedpanel1.add(
5258:         "listbox",
5259:         undefined,
5260:         ["Position", "Scale", "Rotation", "Opacity", "About"],
5261:       );
5262:       var verticaltabbedpanel1_innerwrap = verticaltabbedpanel1.add("group");
5263:       verticaltabbedpanel1_innerwrap.alignment = ["fill", "fill"];
5264:       verticaltabbedpanel1_innerwrap.orientation = ["stack"];
5265:       var tab1 = verticaltabbedpanel1_innerwrap.add("group", undefined, {
5266:         name: "tab1",
5267:       });
5268:       tab1.text = "Position";
5269:       tab1.orientation = "column";
5270:       tab1.alignChildren = ["fill", "top"];
5271:       tab1.spacing = 10;
5272:       tab1.margins = 0;
5273:       var dropdown1_array = [
5274:         "Parent Type",
5275:         "XY",
5276:         "X Only",
5277:         "Y Only",
5278:         "XY Invert",
5279:         "X Invert",
5280:         "Y Invert",
5281:         "X Invert & Y",
5282:         "X  & Y Invert",
5283:       ];
5284:       var dropdown1 = tab1.add("dropdownlist", undefined, undefined, {
5285:         items: dropdown1_array,
5286:         name: "dropdown1",
5287:       });
5288:       dropdown1.helpTip = "The Parent Index must be set to apply Parent Type.";
5289:       dropdown1.selection = 0;
5290:       var button1 = tab1.add("button", undefined, undefined, {
5291:         name: "button1",
5292:       });
5293:       button1.text = "Apply";
5294:       var button2 = tab1.add("button", undefined, undefined, {
5295:         name: "button2",
5296:       });
5297:       button2.text = "Sync";
5298:       var divider1 = tab1.add("panel", undefined, undefined, {
5299:         name: "divider1",
5300:       });
5301:       divider1.alignment = "fill";
5302:       var button3 = tab1.add("button", undefined, undefined, {
5303:         name: "button3",
5304:       });
5305:       button3.text = "Remove";
5306:       var tab2 = verticaltabbedpanel1_innerwrap.add("group", undefined, {
5307:         name: "tab2",
5308:       });
5309:       tab2.text = "Scale";
5310:       tab2.orientation = "column";
5311:       tab2.alignChildren = ["fill", "top"];
5312:       tab2.spacing = 10;
5313:       tab2.margins = 0;
5314:       var dropdown2_array = [
5315:         "Parent Type",
5316:         "XY",
5317:         "X Only",
5318:         "Y Only",
5319:         "XY Invert",
5320:         "X Invert",
5321:         "Y Invert",
5322:         "X Invert & Y",
5323:         "X  & Y Invert",
5324:       ];
5325:       var dropdown2 = tab2.add("dropdownlist", undefined, undefined, {
5326:         items: dropdown2_array,
5327:         name: "dropdown2",
5328:       });
5329:       dropdown2.helpTip = "The Parent Index must be set to apply Parent Type.";
5330:       dropdown2.selection = 0;
5331:       var button4 = tab2.add("button", undefined, undefined, {
5332:         name: "button4",
5333:       });
5334:       button4.text = "Apply";
5335:       var button5 = tab2.add("button", undefined, undefined, {
5336:         name: "button5",
5337:       });
5338:       button5.text = "Sync";
5339:       var divider2 = tab2.add("panel", undefined, undefined, {
5340:         name: "divider2",
5341:       });
5342:       divider2.alignment = "fill";
5343:       var button6 = tab2.add("button", undefined, undefined, {
5344:         name: "button6",
5345:       });
5346:       button6.text = "Remove";
5347:       var tab3 = verticaltabbedpanel1_innerwrap.add("group", undefined, {
5348:         name: "tab3",
5349:       });
5350:       tab3.text = "Rotation";
5351:       tab3.orientation = "column";
5352:       tab3.alignChildren = ["fill", "top"];
5353:       tab3.spacing = 10;
5354:       tab3.margins = 0;
5355:       var dropdown3_array = ["Parent Type", "Standard", "Invert", "Target"];
5356:       var dropdown3 = tab3.add("dropdownlist", undefined, undefined, {
5357:         items: dropdown3_array,
5358:         name: "dropdown3",
5359:       });
5360:       dropdown3.helpTip = "The Parent Index must be set to apply Parent Type.";
5361:       dropdown3.selection = 0;
5362:       var button7 = tab3.add("button", undefined, undefined, {
5363:         name: "button7",
5364:       });
5365:       button7.text = "Apply";
5366:       var button8 = tab3.add("button", undefined, undefined, {
5367:         name: "button8",
5368:       });
5369:       button8.text = "Sync";
5370:       var divider3 = tab3.add("panel", undefined, undefined, {
5371:         name: "divider3",
5372:       });
5373:       divider3.alignment = "fill";
5374:       var button9 = tab3.add("button", undefined, undefined, {
5375:         name: "button9",
5376:       });
5377:       button9.text = "Remove";
5378:       var tab4 = verticaltabbedpanel1_innerwrap.add("group", undefined, {
5379:         name: "tab4",
5380:       });
5381:       tab4.text = "Opacity";
5382:       tab4.orientation = "column";
5383:       tab4.alignChildren = ["fill", "top"];
5384:       tab4.spacing = 10;
5385:       tab4.margins = 0;
5386:       var dropdown4_array = ["Parent Type", "Standard", "Invert"];
5387:       var dropdown4 = tab4.add("dropdownlist", undefined, undefined, {
5388:         items: dropdown4_array,
5389:         name: "dropdown4",
5390:       });
5391:       dropdown4.helpTip = "The Parent Index must be set to apply Parent Type.";
5392:       dropdown4.selection = 0;
5393:       var button10 = tab4.add("button", undefined, undefined, {
5394:         name: "button10",
5395:       });
5396:       button10.text = "Apply";
5397:       var button11 = tab4.add("button", undefined, undefined, {
5398:         name: "button11",
5399:       });
5400:       button11.text = "Sync";
5401:       var divider4 = tab4.add("panel", undefined, undefined, {
5402:         name: "divider4",
5403:       });
5404:       divider4.alignment = "fill";
5405:       var button12 = tab4.add("button", undefined, undefined, {
5406:         name: "button12",
5407:       });
5408:       button12.text = "Remove";
5409:       var tab5 = verticaltabbedpanel1_innerwrap.add("group", undefined, {
5410:         name: "tab5",
5411:       });
5412:       tab5.text = "About";
5413:       tab5.orientation = "column";
5414:       tab5.alignChildren = ["fill", "top"];
5415:       tab5.spacing = 10;
5416:       tab5.margins = 0;
5417:       verticaltabbedpanel1_tabs = [tab1, tab2, tab3, tab4, tab5];
5418:       for (var i = 0; i < verticaltabbedpanel1_tabs.length; i += 1) {
5419:         verticaltabbedpanel1_tabs[i].alignment = ["fill", "fill"];
5420:         verticaltabbedpanel1_tabs[i].visible = false;
5421:       }
5422:       verticaltabbedpanel1_nav.onChange = showTab_verticaltabbedpanel1;
5423:       verticaltabbedpanel1_nav.selection = 0;
5424:       showTab_verticaltabbedpanel1();
5425:       var statictext1 = tab5.add("statictext", undefined, undefined, {
5426:         name: "statictext1",
5427:       });
5428:       statictext1.text = "Faux Parent v1.1";
5429:       statictext1.justify = "center";
5430:       statictext1.alignment = ["center", "top"];
5431:       var button13 = tab5.add("button", undefined, undefined, {
5432:         name: "button13",
5433:       });
5434:       button13.text = "Help";
5435:       var group1 = myPanel.add("group", undefined, { name: "group1" });
5436:       group1.orientation = "row";
5437:       group1.alignChildren = ["left", "center"];
5438:       group1.spacing = 10;
5439:       group1.margins = 0;
5440:       var statictext2 = group1.add("statictext", undefined, undefined, {
5441:         name: "statictext2",
5442:       });
5443:       statictext2.text = "Parent Index";
5444:       var edittext1 = group1.add(
5445:         'edittext {justify: "center", properties: {name: "edittext1"}}',
5446:       );
5447:       edittext1.helpTip = "Enter the parent layer index.";
5448:       edittext1.preferredSize.width = 40;
5449:       button1.onClick = myP_apply;
5450:       button2.onClick = syncPos;
5451:       button3.onClick = removePos;
5452:       button4.onClick = myS_apply;
5453:       button5.onClick = syncScale;
5454:       button6.onClick = removeScale;
5455:       button7.onClick = myR_apply;
5456:       button8.onClick = syncRotation;
5457:       button9.onClick = removeRotation;
5458:       button10.onClick = myO_apply;
5459:       button11.onClick = syncOpacity;
5460:       button12.onClick = removeOpacity;
5461:       button13.onClick = myHelp;
5462:       myPanel.onResizing = myPanel.onResize = function () {
5463:         this.layout.resize();
5464:       };
5465:       if (myPanel instanceof Window) {
5466:         myPanel.center();
5467:         myPanel.show();
5468:       } else {
5469:         myPanel.layout.layout(true);
5470:         myPanel.layout.resize();
5471:       }
5472:     }
5473:     function removePos() {
5474:       var myComp = app.project.activeItem;
5475:       var myLayers = myComp.selectedLayers;
5476:       app.beginUndoGroup("Remove Faux Parent - Position");
5477:       for (var i = 0; i < myLayers.length; i += 1) {
5478:         try {
5479:           var myProp = myLayers[i].effect("Faux Parent - Position");
5480:           myProp.remove();
5481:           myPos = myLayers[i]
5482:             .property("ADBE Transform Group")
5483:             .property("ADBE Position");
5484:           myPos.expression = "";
5485:         } catch (err) {}
5486:       }
5487:       app.endUndoGroup();
5488:     }
5489:     function removeScale() {
5490:       var myComp = app.project.activeItem;
5491:       var myLayers = myComp.selectedLayers;
5492:       app.beginUndoGroup("Remove Faux Parent - Scale");
5493:       for (var i = 0; i < myLayers.length; i += 1) {
5494:         try {
5495:           var myProp = myLayers[i].effect("Faux Parent - Scale");
5496:           myProp.remove();
5497:           myPos = myLayers[i]
5498:             .property("ADBE Transform Group")
5499:             .property("ADBE Scale");
5500:           myPos.expression = "";
5501:         } catch (err) {}
5502:       }
5503:       app.endUndoGroup();
5504:     }
5505:     function removeRotation() {
5506:       var myComp = app.project.activeItem;
5507:       var myLayers = myComp.selectedLayers;
5508:       app.beginUndoGroup("Remove Faux Parent - Rotation");
5509:       for (var i = 0; i < myLayers.length; i += 1) {
5510:         try {
5511:           var myProp = myLayers[i].effect("Faux Parent - Rotation");
5512:           myProp.remove();
5513:           myPos = myLayers[i]
5514:             .property("ADBE Transform Group")
5515:             .property("ADBE Rotate Z");
5516:           myPos.expression = "";
5517:         } catch (err) {}
5518:       }
5519:       app.endUndoGroup();
5520:     }
5521:     function removeOpacity() {
5522:       var myComp = app.project.activeItem;
5523:       var myLayers = myComp.selectedLayers;
5524:       app.beginUndoGroup("Remove Faux Parent - Opacity");
5525:       for (var i = 0; i < myLayers.length; i += 1) {
5526:         try {
5527:           var myProp = myLayers[i].effect("Faux Parent - Opacity");
5528:           myProp.remove();
5529:           myPos = myLayers[i]
5530:             .property("ADBE Transform Group")
5531:             .property("ADBE Opacity");
5532:           myPos.expression = "";
5533:         } catch (err) {}
5534:       }
5535:       app.endUndoGroup();
5536:     }
5537:     buildUI(thisObj);
5538:   })(this);
5539: }
```

## File: Aescripts-Good Parents v1.4.1/goodParents.jsx
```javascript
   1: /*
   2:  * Decompiled with Jsxer
   3:  * Version: 1.7.4
   4:  * JSXBIN 2.0
   5:  */
   6: 
   7: var _0x4169 = [
   8:   "scriptName",
   9:   "Good Parents",
  10:   "version",
  11:   "1.4.1",
  12:   "generator_FFX",
  13:   "Effect",
  14:   "\nError \n\n id01\n",
  15:   "FaFXhead%00%00%00%10%00%00%00%03%00%00%00D%00%00%00%01%01%00%00%00LIST",
  16:   "bescbeso%00%00%002%00%00%00%01%00%00%00%01%00%00%00%00%00%00%02X%00%1E%00%00%00%00%00%00%01@%00%C3%B0%01@%00%C3%B0?%C3%B0%00%00%00%00%00%00?%C3%B0%00%00%00%00%00%00%00%00",
  17:   "sspcfnam%00%00%000",
  18:   "LIST",
  19:   "length",
  20:   "3DPoint",
  21:   "FaFXhead%00%00%00%10%00%00%00%03%00%00%00N%00%00%00%00%01%00%00%00LIST",
  22:   "bescbeso%00%00%008%00%00%00%01%00%00%00%01%00%00%00%00%00%00%5D%C2%A8%00%1D%C3%B8R%00%00%00%00%07%C2%80%048%07%C2%80%048?%C3%B0%00%00%00%00%00%00?%C3%B0%00%00%00%00%00%00%00%00%00%00%C3%BF%C3%BF%C3%BF%C3%BF",
  23:   "LIST%00%00%00%C2%ACtdsptdot%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdpl%00%00%00%04%00%00%00%02LIST%00%00%00%40tdsitdix%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdmn%00%00%00(ADBE%20Effect%20Parade%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00LIST%00%00%00%40tdsitdix%00%00%00%04%00%00%00%00tdmn%00%00%00(",
  24:   "tdsn",
  25:   "LIST%00%00%00dtdsptdot%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdpl%00%00%00%04%00%00%00%01LIST%00%00%00@tdsitdix%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdmn%00%00%00(ADBE%20End%20of%20path%20sentinel%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00LIST",
  26:   "Pseudo/",
  27:   "RIFX",
  28:   "parTparn%00%00%00%04",
  29:   "",
  30:   "0",
  31:   "tdmn%00%00%00(",
  32:   "-",
  33:   "tdgptdsb%00%00%00%04%00%00%00%01tdsn",
  34:   "tdmn%00%00%00(ADBE%20Group%20End",
  35:   "%00%00%5D%C2%A8",
  36:   "cdat",
  37:   "GroupEnd",
  38:   "%00%00%00%01%00%00",
  39:   "tdbstdsb%00%00%00%04%00%00%00%01tdsn",
  40:   "tdb4%00%00%00%7C%C2%BD%C2%99%00%01%00%01%00%00%00%01%00",
  41:   "Checkbox",
  42:   "Angle",
  43:   "Popup",
  44:   "%00%00%00(",
  45:   "Color",
  46:   "substr",
  47:   "tdb4%00%00%00%7C%C2%BD%C2%99%00%04%00%07%00%00%00%01%00",
  48:   "%00%00%00%60",
  49:   "@o%C3%A0",
  50:   "Point",
  51:   "tdb4%00%00%00%7C%C2%BD%C2%99%00%02%00%0F%00%00%00%01%00",
  52:   "tdb4%00%00%00%7C%C2%BD%C2%99%00%03%00%0F%00%00%00%01%00",
  53:   "%00%00%00H",
  54:   "Slider",
  55:   "tdum",
  56:   "%00%00%00%08",
  57:   "tduM",
  58:   "Layer",
  59:   "%00",
  60:   "%0E",
  61:   "tdpi%00%00%00%04%00%00%00",
  62:   "Group",
  63:   "Button",
  64:   "%04",
  65:   "tdbstdsb%00%00%00%04%00%00%00%03tdsn",
  66:   "tdpi%00%00%00%04%00%00%00%0E",
  67:   "\nError \n\n id03\n",
  68:   "pard%00%00%00%C2%94",
  69:   "%01",
  70:   "pdnm",
  71:   "%07",
  72:   "%C3%BF",
  73:   "%05",
  74:   "%03",
  75:   "%06",
  76:   "%12",
  77:   "%0a",
  78:   "%C3%BF%C3%BF%C3%BF%C3%BF",
  79:   "%0d",
  80:   "%0e",
  81:   "%0f",
  82:   "\nError \n\n id02\n",
  83:   "%02",
  84:   "%20",
  85:   "charCodeAt",
  86:   "abs",
  87:   "pow",
  88:   "log",
  89:   "LN2",
  90:   "floor",
  91:   "min",
  92:   "push",
  93:   "reverse",
  94:   "join",
  95:   "substring",
  96:   "toFixed",
  97:   __BLOB__BLOB_000243__,
  98:   "getDate",
  99:   "getSeconds",
 100:   "\x11",
 101:   "\x12",
 102:   "string",
 103:   "split",
 104:   "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
 105:   "random",
 106:   "round",
 107:   "fsName",
 108:   "temp",
 109:   "/temp.AEpr",
 110:   "encoding",
 111:   "ASCI",
 112:   "w",
 113:   "open",
 114:   "write",
 115:   "r",
 116:   "BINARY",
 117:   "read",
 118:   "close",
 119:   "remove",
 120:   "getMatchNames",
 121:   "ADBE Marker",
 122:   "ADBE Text Properties",
 123:   "ADBE Text Document",
 124:   "ADBE Effect Parade",
 125:   "ADBE Layer Control",
 126:   "ADBE Layer Control-0001",
 127:   "ADBE Transform Group",
 128:   "ADBE Scale",
 129:   "ADBE Position",
 130:   "ADBE Anchor Point",
 131:   "ADBE Opacity",
 132:   "ADBE Rotate Z",
 133:   "ADBE Orientation",
 134:   "ADBE Root Vectors Group",
 135:   "ADBE Vector Group",
 136:   "ADBE Vectors Group",
 137:   "ADBE Vector Shape - Group",
 138:   "ADBE Vector Shape",
 139:   "ADBE Vector Graphic - Stroke",
 140:   "ADBE Vector Stroke Width",
 141:   "ADBE Vector Stroke Color",
 142:   "ADBE Vector Stroke Line Join",
 143:   "ADBE Vector Stroke Line Cap",
 144:   "ADBE Vector Filter - Trim",
 145:   "ADBE Vector Trim End",
 146:   "ADBE Vector Transform Group",
 147:   "ADBE Vector Position",
 148:   "ADBE Paint",
 149:   "ADBE Paint Group",
 150:   "ADBE Paint Atom",
 151:   "ADBE Paint Shape",
 152:   "ADBE Paint Transform",
 153:   "ADBE Paint Position",
 154:   "ADBE Paint Properties",
 155:   "ADBE Paint End",
 156:   "ADBE Paint Color",
 157:   "ADBE Paint Diameter",
 158:   "names",
 159:   "Parents!",
 160:   "1. Select child layers\n2. Set number of parents (to the right)\n3. Hit this wonderful button\n4. (\u30ce\uffe3\u30fc\uffe3)\u30ce",
 161:   "Set number of parents.\nYou may change it later\nfor each layer individually",
 162:   "Get",
 163:   "Select master layer and click to copy GoodParents effect",
 164:   "Set",
 165:   "Select layers and click to paste GoodParents effect",
 166:   "Sorry, trial version is limited to two parents",
 167:   "addNewBttn",
 168:   "group{orientation: \'stack\'}",
 169:   "add",
 170:   "group",
 171:   "preferredSize",
 172:   "setBG",
 173:   "group{margins:[1,1,0,0],alignChildren: [\'center\', \'center\']}",
 174:   "bttnText",
 175:   "statictext",
 176:   "characters",
 177:   "justify",
 178:   "center",
 179:   "alignment",
 180:   "alignChildren",
 181:   "icon",
 182:   "image",
 183:   "size",
 184:   "minimumSize",
 185:   "maximumSize",
 186:   "setVisible",
 187:   "visible",
 188:   "setText",
 189:   "text",
 190:   "setDisabled",
 191:   "enabled",
 192:   "setEnabled",
 193:   "mouseover",
 194:   "target",
 195:   "currentTarget",
 196:   "setFG",
 197:   "addEventListener",
 198:   "mouseout",
 199:   "mousedown",
 200:   "mouseup",
 201:   "buildGUI",
 202:   "iconsFiles",
 203:   "fullName",
 204:   "userData",
 205:   "/Aescripts/good-parents/",
 206:   "create",
 207:   "iconsBinaries",
 208:   "/goodParentsIcon",
 209:   ".png",
 210:   "gpWindows",
 211:   "palette{margins: 10}",
 212:   " v.",
 213:   "left",
 214:   "top",
 215:   "group{orientation: \'row\', alignChildren: [\'left\', \'top\'], spacing: 0, margins: 0}",
 216:   "group{orientation: \'stack\', alignChildren: [\'left\', top\'], spacing: 0, margins: 0}",
 217:   "group{orientation:\'row\', spacing:3, margins: 0}",
 218:   "group{orientation:\'stack\', spacing:0, margins: [0,0,0,0]}",
 219:   "group{orientation:\'row\', spacing:0, margins: [0,0,0,0]}",
 220:   "group{orientation: \'stack\', spacing: 0}",
 221:   "edittext",
 222:   "helpTip",
 223:   "tip",
 224:   "parentsControls",
 225:   "1",
 226:   "group{orientation: \'column\', spacing:0, margins: 0}",
 227:   "+",
 228:   "name",
 229:   "createBttn",
 230:   "kektek",
 231:   "group{orientation:\'stack\', alignChildren: [\'center\', \'center\'], margins: [5,7,0,0], spacing: 0}",
 232:   "getBttn",
 233:   "setBttn",
 234:   "group{orientation: \'row\', margins: [12,1,0,0]}",
 235:   "?",
 236:   "onChanging",
 237:   "match",
 238:   "trialAlert",
 239:   "click",
 240:   "buildWatUI",
 241:   "devMode",
 242:   "savedProps",
 243:   "getProperties",
 244:   "Got it!",
 245:   "Good Parents Set Props",
 246:   "beginUndoGroup",
 247:   "setProperties",
 248:   "endUndoGroup",
 249:   "start",
 250:   "show",
 251:   "layout",
 252:   __BLOB__BLOB_000244__,
 253:   __BLOB__BLOB_000245__,
 254:   "setTip",
 255:   "setIcon",
 256:   "undefined",
 257:   "foregroundColor",
 258:   "graphics",
 259:   "PenType",
 260:   "newPen",
 261:   "backgroundColor",
 262:   "BrushType",
 263:   "newBrush",
 264:   "gpWAT",
 265:   "palette",
 266:   "Good Parents v",
 267:   "prefix",
 268:   "open ",
 269:   "toLowerCase",
 270:   "os",
 271:   "windows",
 272:   "explorer ",
 273:   "link1",
 274:   "http://aescripts.com/good-parents/",
 275:   "link2",
 276:   "http://twitter.com/extrabitesoft/",
 277:   "Good Parents allow you to keyframe parenting in After Effects in a really easy way:\n1. Select child layer or layers\n2. Set the number of parents\n3. Hit \'Parents!\' button\n\nThe custom control will be created.\nExperiment with it!\n- Set keyframes on \'Enable\' checkbox to turn parenting on and off\n\b- Select parents from the dropdown list\n- Switch parents with the slider (don\'t forget to add keyframes)\n\nCopy and Paste GoodParents effect\n\nTo copy and paste GoodParents effect, use GET and SET button located in the popup menu available after you click the \'three dots\' button.\nCopy with GET and paste with SET.\nYou can copy and paste GoodParents effect only inside one composition. \n\nGoodParents work with:\n\t- 3D layers and transforms\n\t- Element 3D\n\t- DUIK\n\t- Puppet Tools\n\t- Raytraced Shapes",
 278:   __BLOB__BLOB_000246__,
 279:   "/Aescripts/goodParents/",
 280:   "/goodParentsIconFileWat.png",
 281:   "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], spacing: 0}",
 282:   "HOW TO USE GOOD PARENTS",
 283:   "group{margins:[0,10,0,0]}",
 284:   "\nFor tutorials, refer to the",
 285:   "product page on aescripts",
 286:   "button",
 287:   "callSystem",
 288:   "For any questions or support:",
 289:   "Hit us up on Twitter",
 290:   "YOU ARE IN A TRIAL MODE",
 291:   "getRegistration",
 292:   "gatan",
 293:   "Remove Licence",
 294:   "expressions",
 295:   'function findChild(e){for(var r=1;r<=thisComp.numLayers;r++){var a=thisComp.layer(r);try{if(a.parent&&a.parent.index==thisLayer.index&&null!=a("ADBE Effect Parade")(e))return a.index}catch(t){continue}}return 0}function is3D(e){return e.hasParent?3==e("ADBE Transform Group")("ADBE Position").value.length||is3D(e.parent):3==e("ADBE Transform Group")("ADBE Position").value.length}function getKeys(e,r){try{var a=e("Parent")}catch(t){var a=null}var i=e("Enable");try{var n=e("Current Parent")}catch(t){var n=null}if(n){var l=[];if(n.numKeys>0){for(var u=1;u<=n.numKeys;u++)l.push({value:Math.round(n.key(u).value),time:n.key(u).time});l[0].time=0}else l=[{value:Math.round(n.value),time:0}]}var v=[];if(i.numKeys>0){for(var u=1;u<=i.numKeys;u++)v.push({value:i.key(u).value,time:i.key(u).time});v[0].time=0}else v=[{value:i.value,time:0}];var s=[];if(n)for(var u=0;u<v.length;u++){var f=v[u];if(f.value){if(u>0){for(var h=l[0],o=1;o<l.length;o++){var m=l[o];if(!(m.time<=f.time))break;h=m}s.push({value:h.value,time:f.time})}if(u<v.length-1)var c=v[u+1].time;else var c=thisComp.duration;for(var o=0;o<l.length;o++){var m=l[o];if(m.time>=f.time){if(!(m.time<c))break;s.push(m)}}}else s.push(f)}else s=v;for(var u=0;u<s.length;u++){var y=s[u];if(y.value>0)try{var d=e("Parent "+y.value)}catch(t){a&&1==y.value||(u>0?(s.splice(u,1),u--):y.value=0)}}for(var u=0;u<s.length;u++){var y=s[u];if(y.value>0)if(a)var d=e("Parent");else var d=e("Parent "+y.value);d&&d("ADBE Transform Group")("ADBE Position").value.length!=r("ADBE Transform Group")("ADBE Position").value.length&&(y.value=0)}for(var u=1;u<s.length;u++)s[u].value==s[u-1].value&&(s.splice(u,1),u--);return s}function main(){var e=findChild(effectMatchName);if(0==e)return"obj = {childIndex:0,keys:[{value:0,time:0}]}";childLayer=thisComp.layer(e);var r=childLayer("ADBE Effect Parade")(effectMatchName),a=getKeys(r,childLayer);str="[";for(var t=0;t<a.length;t++)curKey=a[t],str+="{",str+="value: "+curKey.value,str+=",time: "+curKey.time,str+="}",t<a.length-1&&(str+=",\\n");return str+="]","obj = {childIndex:"+e+",keys:"+str+"}"}try{main()}catch(e){}',
 296:   'function pos(){var info=eval(thisComp.layer(index)("ADBE Text Properties")("ADBE Text Document").value),keys=info.keys,childIndex=info.childIndex;if(0==childIndex)return value;for(var childLayer=thisComp.layer(childIndex),lastKeyIndex=0,i=0;i<keys.length&&!(keys[i].time>time);i++)lastKeyIndex=i;for(var newPos=valueAtTime(0),i=0;lastKeyIndex>i;i++){var curKey=keys[i];if(curKey.value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+curKey.value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}var nextKey=keys[i+1],relPos=parentLayer.fromWorld(newPos,curKey.time);newPos=parentLayer.toWorld(relPos,nextKey.time)}}if(keys[lastKeyIndex].value>0){var lastKeyTime=keys[lastKeyIndex].time;try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[lastKeyIndex].value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}var relPos=parentLayer.fromWorld(newPos,lastKeyTime),newPos=parentLayer.toWorld(relPos,time);return newPos}return newPos}try{pos()}catch(e){value}',
 297:   'function recursiveScale(e,a){var r=e("ADBE Transform Group")("ADBE Scale").valueAtTime(a);if(e.hasParent){for(var l=recursiveScale(e.parent,a),c=[],t=0;t<Math.min(r.length,l.length);t++)c[t]=r[t]/100*l[t];return c}return r}function sc(){var info=eval(thisComp.layer(index)("ADBE Text Properties")("ADBE Text Document").value),keys=info.keys,childIndex=info.childIndex;if(0==childIndex)return value;for(var childLayer=thisComp.layer(childIndex),lastKeyIndex=0,i=0;i<keys.length&&!(keys[i].time>time);i++)lastKeyIndex=i;if(3==childLayer("ADBE Transform Group")("ADBE Scale").value.length)var prevScaleAdd=[1,1,1];else var prevScaleAdd=[1,1];for(var i=0;lastKeyIndex>i;i++)if(keys[i].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[i].value)}catch(e){1==keys[i].value&&(parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent"))}parScale=parentLayer("ADBE Transform Group")("ADBE Scale"),prevScaleAdd[0]*=recursiveScale(parentLayer,keys[i+1].time)[0]/recursiveScale(parentLayer,keys[i].time)[0],prevScaleAdd[1]*=recursiveScale(parentLayer,keys[i+1].time)[1]/recursiveScale(parentLayer,keys[i].time)[1],3==childLayer("ADBE Transform Group")("ADBE Scale").value.length&&(prevScaleAdd[2]*=recursiveScale(parentLayer,keys[i+1].time)[2]/recursiveScale(parentLayer,keys[i].time)[2])}if(keys[lastKeyIndex].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[lastKeyIndex].value)}catch(e){1==keys[lastKeyIndex].value&&(parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent"))}parScale=parentLayer("ADBE Transform Group")("ADBE Scale"),prevScaleAdd[0]*=recursiveScale(parentLayer,time)[0]/recursiveScale(parentLayer,keys[lastKeyIndex].time)[0],prevScaleAdd[1]*=recursiveScale(parentLayer,time)[1]/recursiveScale(parentLayer,keys[lastKeyIndex].time)[1],3==childLayer("ADBE Transform Group")("ADBE Scale").value.length&&(prevScaleAdd[2]*=recursiveScale(parentLayer,time)[2]/recursiveScale(parentLayer,keys[lastKeyIndex].time)[2])}return 3==childLayer("ADBE Transform Group")("ADBE Scale").value.length?[value[0]*prevScaleAdd[0],value[1]*prevScaleAdd[1],value[2]*prevScaleAdd[2]]:[value[0]*prevScaleAdd[0],value[1]*prevScaleAdd[1]]}try{sc()}catch(e){value}',
 298:   'function vectorsToMatrix(e){for(var r=0;r<e.length;r++)e[r].push(0);e.push([0,0,0,1]);for(var a=[],r=0;4>r;r++)for(var t=0;4>t;t++)a[4*t+r]=e[r][t];return a}function matrixToEuler(e){var r=[];theta=-Math.asin(e[2]),cosTheta=Math.cos(theta),theta=-radiansToDegrees(theta),Math.abs(cosTheta)>5e-4?(tempX=e[10]/cosTheta,tempY=-e[6]/cosTheta,phi=Math.atan2(tempY,tempX),phi=radiansToDegrees(phi),tempX=e[0]/cosTheta,tempY=-e[1]/cosTheta,psi=Math.atan2(tempY,tempX),psi=radiansToDegrees(psi)):(phi=0,tempX=e[5],tempY=e[4],psi=Math.atan2(tempY,tempX),psi=radiansToDegrees(psi)),r[0]=phi,r[1]=theta,r[2]=psi;for(var a=0;a<r.length;a++)r[a]<0&&(r[a]+=360);return r}function vecToEuler(e){var r=vectorsToMatrix(e);return matrixToEuler(r)}function orient(){var info=eval(thisLayer("ADBE Text Properties")("ADBE Text Document").value),keys=info.keys,childIndex=info.childIndex;if(0==childIndex)return value;var childLayer=thisComp.layer(childIndex);if(childLayer("ADBE Transform Group")("ADBE Position").value.length<3)return[0,0,0];for(var lastKeyIndex=0,i=0;i<keys.length&&!(keys[i].time>time);i++)lastKeyIndex=i;var globalWorldVecs=[],childVecs=[];childVecs[0]=thisLayer.toWorldVec([1,0,0],0),childVecs[1]=thisLayer.toWorldVec([0,1,0],0),childVecs[2]=thisLayer.toWorldVec([0,0,1],0);for(var worldVecs=[],i=0;3>i;i++)worldVecs[i]=thisLayer.toWorldVec(childVecs[i],0);for(var i=0;lastKeyIndex>i;i++)if(keys[i].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[i].value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}for(var T1=keys[i].time,T2=keys[i+1].time,v=0;3>v;v++)worldVecs[v]=parentLayer.fromWorldVec(worldVecs[v],T1),worldVecs[v]=parentLayer.toWorldVec(normalize(worldVecs[v]),T2)}if(keys[lastKeyIndex].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[lastKeyIndex].value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}for(var T1=keys[lastKeyIndex].time,T2=time,v=0;3>v;v++)worldVecs[v]=parentLayer.fromWorldVec(worldVecs[v],T1),worldVecs[v]=parentLayer.toWorldVec(normalize(worldVecs[v]),T2)}for(var v=0;3>v;v++)worldVecs[v]=thisLayer.fromWorldVec(worldVecs[v]),worldVecs[v]=normalize(thisLayer.toWorldVec(worldVecs[v]));var orientAdd=vecToEuler(worldVecs);return orientAdd}try{orient()}catch(e){value}',
 299:   'function angle(e){return radiansToDegrees(Math.atan2(e[1],e[0]))}function rot(){var info=eval(thisComp.layer(index)("ADBE Text Properties")("ADBE Text Document").value),keys=info.keys,childIndex=info.childIndex;if(0==childIndex)return value;var childLayer=thisComp.layer(childIndex);if(3==childLayer("ADBE Transform Group")("ADBE Position").value.length)return 0;for(var lastKeyIndex=0,i=0;i<keys.length&&!(keys[i].time>time);i++)lastKeyIndex=i;for(var childVec=thisLayer.toWorldVec([1,0],0),worldVec=thisLayer.toWorldVec(childVec,0),i=0;lastKeyIndex>i;i++)if(keys[i].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[i].value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}var T1=keys[i].time,T2=keys[i+1].time;worldVec=parentLayer.fromWorldVec(worldVec,T1),worldVec=parentLayer.toWorldVec(normalize(worldVec),T2)}if(keys[lastKeyIndex].value>0){try{parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent "+keys[lastKeyIndex].value)}catch(e){parentLayer=childLayer("ADBE Effect Parade")(effectMatchName)("Parent")}var T1=keys[lastKeyIndex].time,T2=time;worldVec=parentLayer.fromWorldVec(worldVec,T1),worldVec=parentLayer.toWorldVec(normalize(worldVec),T2)}worldVec=thisLayer.fromWorldVec(worldVec),worldVec=normalize(thisLayer.toWorldVec(worldVec));var rotation=angle(worldVec);return rotation}try{rot()}catch(e){value}',
 300:   __BLOB__BLOB_CLEANED__,
 301:   "@JSXBIN@ES@2.1@MyBbyBn0ADJAnABXzFjHjBjUjBjOBfjzLjHjPjPjEiQjBjSjFjOjUjTCfEjzBjBDfRBWzGiPjCjKjFjDjUENzKjTjDjSjJjQjUiOjBjNjFFFeMiHjPjPjEhAiQjBjSjFjOjUjTzNjTjDjSjJjQjUiWjFjSjTjJjPjOGFd8jGjGjGjGjGjGnWhfzMjTjDjSjJjQjUiBjVjUjIjPjSHFeJiFjYjUjSjBjCjJjUjFzJjTjDjSjJjQjUiViSiMIFehBjIjUjUjQhahPhPjBjFjTjDjSjJjQjUjThOjDjPjNhPjHjPjPjEhNjQjBjSjFjOjUjTzNjQjSjJjWjBjUjFiOjVjNjCjFjSJFd8kNkcjTlLmQiGhYiDzKjQjSjPjEjVjDjUiTiLiVKFeIiOiTiHiQhNiTiViMzIjIjFjMjQiUjFjYjULFehKiUjIjJjThAjJjThAjUjIjFhAjIjFjMjQhAjEjPjDjThOhAiVjTjFhAKhAjGjPjShAjOjFjXhAjMjJjOjFjTzLjIjFjMjQiCjVjUjUjPjOjTMAnzKjPjGjGjFjSiUjSjJjBjMNFctzJjPjGjGjFjSiCjFjUjBOFcfzNjCjFjUjBiTjUjBjSjUiEjBjUjFPEjzEiEjBjUjFQfRBFeLiOjPjWhAhRhMhAhShQhRhXftzSjCjFjUjBiFjYjQjJjSjBjUjJjPjOiEjBjUjFREjQfRBFeLiEjFjDhAhRhMhAhShQhRhXftzQjCjFjUjBiTjVjQjQjPjSjUiFjNjBjJjMSFegcjIjUjUjQhahPhPjBjFjTjDjSjJjQjUjThOjDjPjNhPjDjPjOjUjBjDjUftnfJgdnABXzGjLjFjLjQjVjLTfjCfNyBnAMgdbyBn0ABZgfnAEXzBjDUfXBfjCfnf0DzAVChAnfJhCnABXzGjLjFjLjUjFjLWfjCfNyBnAMhCbyBn0ABZhFnAUzCjcjcXEXzBjUYfXBfjCfnfhzBhBZEXzBjTgafXBfjCfnfnn0DVChGnf0DVByB",
 302:   "matchNames",
 303:   "accessErrorMessage",
 304:   'This script requires access to write files.\nGo to the "General" panel of the application preferences and make sure "Allow Scripts to Write Files and Access Network" is checked.',
 305:   "preParentComment",
 306:   "Good Parents preparent layer",
 307:   "findOldPreparent",
 308:   "containingComp",
 309:   "numLayers",
 310:   "layer",
 311:   "comment",
 312:   "index",
 313:   "parent",
 314:   "getAllChildren",
 315:   "getPresetNumParents",
 316:   "Parent",
 317:   "property",
 318:   "Parent ",
 319:   "deselectAll",
 320:   "selected",
 321:   "setPropertiesToPreset",
 322:   "Enable",
 323:   "numKeys",
 324:   "removeKey",
 325:   "cbKeys",
 326:   "time",
 327:   "value",
 328:   "setValueAtTime",
 329:   "setValue",
 330:   "Current Parent",
 331:   "sliderKeys",
 332:   "parents",
 333:   "Copy parents first",
 334:   "getActiveComp",
 335:   "Open a composition",
 336:   "comp",
 337:   "You can copy-paste props only inside the same comp",
 338:   "selectedLayers",
 339:   "isParented",
 340:   "createPresetFile",
 341:   "file",
 342:   "matchName",
 343:   "applyPresetToLayer",
 344:   "getExpressions",
 345:   "updateParenting",
 346:   "hideShyLayers",
 347:   "Please select a layer with Good Parents effect",
 348:   "keyTime",
 349:   "valueAtTime",
 350:   "createPreParent",
 351:   "locked",
 352:   "threeDLayer",
 353:   "expressionEnabled",
 354:   "mn",
 355:   "sourceText",
 356:   "position",
 357:   "transform",
 358:   "rotation",
 359:   "scale",
 360:   "orientation",
 361:   "Pseudo/Good-Parents-",
 362:   "effects",
 363:   "expression",
 364:   "splice",
 365:   "numProperties",
 366:   "applyPreset",
 367:   "preparentText",
 368:   "addText",
 369:   "layers",
 370:   " preparent",
 371:   "shy",
 372:   "label",
 373:   "moveAfter",
 374:   "opacity",
 375:   "resetCharStyle",
 376:   "Error: can\'t find created effect for layer ",
 377:   ", please try again",
 378:   "Parent 1",
 379:   "createParenting",
 380:   'Unable to update Good Parents for layer "',
 381:   '", please remove existing Good Parents control first',
 382:   "// cacheCompareSamplesPerSecond 0\n",
 383:   'var effectMatchName = "',
 384:   '"\n',
 385:   "activeItem",
 386:   "project",
 387:   "Parents",
 388:   "Good-Parents-",
 389:   "str",
 390:   "\\preset.ffx",
 391:   "exists",
 392:   "binary",
 393:   "fileName",
 394:   "rootPath",
 395:   "Select at least one layer",
 396:   "run",
 397:   "kekpuk",
 398:   "Such a good time to purchase GoodParents now \xaf\\_(\u30c4)_/\xaf",
 399: ];
 400: void (function (thisObj) {
 401:   var goodParents = thisObj;
 402:   goodParents[_0x4169[0]] = _0x4169[1];
 403:   goodParents[_0x4169[2]] = _0x4169[3];
 404:   goodParents[_0x4169[4]] = function (new_arr0, myName) {
 405:     function parTparn(ID, new_arr0) {
 406:       var pt = _0x4169[20] + HexEncodeURI(new_arr0[_0x4169[11]], 4);
 407:       var data = _0x4169[21];
 408:       for (var i = 0; i < new_arr0[_0x4169[11]]; i += 1) {
 409:         temp = i;
 410:         while (temp[_0x4169[11]] < 4) {
 411:           temp = _0x4169[22] + temp;
 412:         }
 413:         data =
 414:           data +
 415:           _0x4169[23] +
 416:           FixedLength(ID + _0x4169[24] + temp, 40) +
 417:           pard(new_arr0[i]);
 418:       }
 419:       return pt + data;
 420:     }
 421:     function tdgptdsb(ID, new_arr0, lName) {
 422:       var td = _0x4169[25] + lName;
 423:       var tdEnd = _0x4169[26] + Zeros(26);
 424:       var data = _0x4169[21];
 425:       for (var i = 0; i < new_arr0[_0x4169[11]]; i += 1) {
 426:         temp = i;
 427:         while (temp[_0x4169[11]] < 4) {
 428:           temp = _0x4169[22] + temp;
 429:         }
 430:         data =
 431:           data +
 432:           _0x4169[23] +
 433:           FixedLength(ID + _0x4169[24] + temp, 40) +
 434:           tdgp(new_arr0[i]);
 435:       }
 436:       return td + data + tdEnd;
 437:     }
 438:     function tdgp(arr1) {
 439:       var temp = _0x4169[27] + Zeros(108) + _0x4169[28];
 440:       var lName = arr1[0] === _0x4169[29] ? _0x4169[30] : LengthName(arr1[1]);
 441:       var tdbstdsb = _0x4169[31] + lName + _0x4169[32];
 442:       var ret = _0x4169[21];
 443:       var value = _0x4169[21];
 444:       if (
 445:         arr1[0] == _0x4169[33] ||
 446:         arr1[0] == _0x4169[34] ||
 447:         arr1[0] == _0x4169[35]
 448:       ) {
 449:         ret =
 450:           tdbstdsb +
 451:           ExtTimer(arr1[3]) +
 452:           temp +
 453:           _0x4169[36] +
 454:           FixedLength(toDouble(arr1[4]));
 455:       } else {
 456:         if (arr1[0] == _0x4169[37]) {
 457:           for (var i = 0; i < 6; i = i + 2) {
 458:             value = value + toDouble(parseInt(arr1[4][_0x4169[38]](i, 2), 16));
 459:           }
 460:           tdbstdsb = _0x4169[31] + lName + _0x4169[39];
 461:           ret =
 462:             tdbstdsb +
 463:             ExtTimer(arr1[3]) +
 464:             temp +
 465:             _0x4169[40] +
 466:             FixedLength(_0x4169[41] + Zeros(5) + value, 96);
 467:         } else {
 468:           if (arr1[0] == _0x4169[42]) {
 469:             tdbstdsb = _0x4169[31] + lName + _0x4169[43];
 470:             ret = tdbstdsb + ExtTimer(arr1[3]) + temp + _0x4169[36] + Zeros(40);
 471:           } else {
 472:             if (arr1[0] == _0x4169[12]) {
 473:               tdbstdsb = _0x4169[31] + lName + _0x4169[44];
 474:               ret =
 475:                 tdbstdsb + ExtTimer(arr1[3]) + temp + _0x4169[45] + Zeros(72);
 476:             } else {
 477:               if (arr1[0] == _0x4169[46]) {
 478:                 ret =
 479:                   tdbstdsb +
 480:                   ExtTimer(arr1[3]) +
 481:                   temp +
 482:                   _0x4169[36] +
 483:                   FixedLength(toDouble(arr1[6])) +
 484:                   _0x4169[47] +
 485:                   _0x4169[48] +
 486:                   toDouble(arr1[5]) +
 487:                   _0x4169[49] +
 488:                   _0x4169[48] +
 489:                   toDouble(arr1[7]);
 490:               } else {
 491:                 if (arr1[0] == _0x4169[50]) {
 492:                   value = _0x4169[51];
 493:                   if (arr1[3]) {
 494:                     value = _0x4169[52];
 495:                   }
 496:                   ret =
 497:                     tdbstdsb +
 498:                     _0x4169[51] +
 499:                     temp +
 500:                     _0x4169[36] +
 501:                     Zeros(40) +
 502:                     _0x4169[53] +
 503:                     value;
 504:                 } else {
 505:                   if (
 506:                     arr1[0] == _0x4169[54] ||
 507:                     arr1[0] == _0x4169[29] ||
 508:                     arr1[0] == _0x4169[55]
 509:                   ) {
 510:                     ret =
 511:                       tdbstdsb + _0x4169[56] + temp + _0x4169[36] + Zeros(40);
 512:                   } else {
 513:                     if (arr1[0] == _0x4169[5]) {
 514:                       tdbstdsb = _0x4169[57] + lName + _0x4169[32];
 515:                       ret =
 516:                         tdbstdsb +
 517:                         _0x4169[56] +
 518:                         temp +
 519:                         _0x4169[36] +
 520:                         Zeros(40) +
 521:                         _0x4169[58];
 522:                     } else {
 523:                       alert(_0x4169[59], _0x4169[59]);
 524:                     }
 525:                   }
 526:                 }
 527:               }
 528:             }
 529:           }
 530:         }
 531:       }
 532:       return _0x4169[10] + CountLengthTo_hex(ret);
 533:     }
 534:     function pard(arr1) {
 535:       var pr = _0x4169[60];
 536:       var ret = _0x4169[21];
 537:       var temp = _0x4169[21];
 538:       var value = _0x4169[21];
 539:       if (arr1[0] == _0x4169[33]) {
 540:         value = _0x4169[51];
 541:         if (arr1[4]) {
 542:           value = _0x4169[61];
 543:         }
 544:         ret =
 545:           Zeros(7) +
 546:           Locked(arr1[2]) +
 547:           Zeros(7) +
 548:           _0x4169[56] +
 549:           FixedName(arr1[1]) +
 550:           Zeros(5) +
 551:           Timer(arr1[3]) +
 552:           Zeros(7) +
 553:           value +
 554:           value +
 555:           Zeros(87) +
 556:           _0x4169[62] +
 557:           LengthName(arr1[5]);
 558:       } else {
 559:         if (arr1[0] == _0x4169[35]) {
 560:           value = HexEncodeURI(arr1[4], 4);
 561:           ret =
 562:             Zeros(7) +
 563:             Locked(arr1[2]) +
 564:             Zeros(7) +
 565:             _0x4169[63] +
 566:             FixedName(arr1[1]) +
 567:             Zeros(5) +
 568:             Timer(arr1[3]) +
 569:             Zeros(4) +
 570:             value +
 571:             value +
 572:             Zeros(84) +
 573:             _0x4169[62] +
 574:             LengthName(arr1[5]);
 575:         } else {
 576:           if (arr1[0] == _0x4169[37]) {
 577:             value = _0x4169[64];
 578:             for (var i = 0; i < 6; i = i + 2) {
 579:               value =
 580:                 value + HexEncodeURI(parseInt(arr1[4][_0x4169[38]](i, 2), 16));
 581:             }
 582:             ret =
 583:               Zeros(7) +
 584:               Locked(arr1[2]) +
 585:               Zeros(7) +
 586:               _0x4169[65] +
 587:               FixedName(arr1[1]) +
 588:               Zeros(5) +
 589:               Timer(arr1[3]) +
 590:               Zeros(4) +
 591:               value +
 592:               value +
 593:               Zeros(84);
 594:           } else {
 595:             if (arr1[0] == _0x4169[34]) {
 596:               value = toFraction(arr1[4]);
 597:               ret =
 598:                 Zeros(7) +
 599:                 Locked(arr1[2]) +
 600:                 Zeros(7) +
 601:                 _0x4169[66] +
 602:                 FixedName(arr1[1]) +
 603:                 Zeros(5) +
 604:                 Timer(arr1[3]) +
 605:                 Zeros(4) +
 606:                 value +
 607:                 value +
 608:                 Zeros(84);
 609:             } else {
 610:               if (arr1[0] == _0x4169[42]) {
 611:                 ret =
 612:                   Zeros(7) +
 613:                   Locked(arr1[2]) +
 614:                   Zeros(7) +
 615:                   _0x4169[67] +
 616:                   FixedName(arr1[1]) +
 617:                   Zeros(5) +
 618:                   Timer(arr1[3]) +
 619:                   Zeros(14) +
 620:                   HexEncodeURI(arr1[4], 4) +
 621:                   HexEncodeURI(arr1[5], 4) +
 622:                   Zeros(74);
 623:               } else {
 624:                 if (arr1[0] == _0x4169[12]) {
 625:                   ret =
 626:                     Zeros(7) +
 627:                     Locked(arr1[2]) +
 628:                     Zeros(7) +
 629:                     _0x4169[68] +
 630:                     FixedName(arr1[1]) +
 631:                     Zeros(5) +
 632:                     Timer(arr1[3]) +
 633:                     Zeros(28) +
 634:                     toDouble(arr1[4]) +
 635:                     toDouble(arr1[5]) +
 636:                     toDouble(arr1[6]) +
 637:                     Zeros(44);
 638:                 } else {
 639:                   if (arr1[0] == _0x4169[46]) {
 640:                     ret =
 641:                       Zeros(7) +
 642:                       Locked(arr1[2]) +
 643:                       Zeros(7) +
 644:                       _0x4169[69] +
 645:                       FixedName(arr1[1]) +
 646:                       Zeros(5) +
 647:                       Timer(arr1[3]) +
 648:                       Zeros(52) +
 649:                       toFloat(arr1[4]) +
 650:                       toFloat(arr1[8]) +
 651:                       toFloat(arr1[5]) +
 652:                       toFloat(arr1[7]) +
 653:                       toFloat(arr1[6]) +
 654:                       HexEncodeURI(arr1[9], 2) +
 655:                       HexEncodeURI(arr1[10], 2) +
 656:                       Zeros(20);
 657:                   } else {
 658:                     if (arr1[0] == _0x4169[50]) {
 659:                       value = Zeros(4);
 660:                       if (arr1[3]) {
 661:                         value = _0x4169[70];
 662:                       }
 663:                       ret =
 664:                         Zeros(7) +
 665:                         Locked(arr1[2]) +
 666:                         Zeros(8) +
 667:                         FixedName(arr1[1]) +
 668:                         Zeros(82) +
 669:                         value +
 670:                         Zeros(16);
 671:                     } else {
 672:                       if (arr1[0] == _0x4169[54]) {
 673:                         ret =
 674:                           Zeros(7) +
 675:                           Locked(arr1[2]) +
 676:                           Zeros(7) +
 677:                           _0x4169[71] +
 678:                           FixedName(arr1[1]) +
 679:                           Zeros(102);
 680:                       } else {
 681:                         if (arr1[0] == _0x4169[29]) {
 682:                           ret = Zeros(15) + _0x4169[72] + Zeros(132);
 683:                         } else {
 684:                           if (arr1[0] == _0x4169[55]) {
 685:                             ret =
 686:                               Zeros(7) +
 687:                               Locked(arr1[2]) +
 688:                               Zeros(7) +
 689:                               _0x4169[73] +
 690:                               FixedName(arr1[1]) +
 691:                               Zeros(5) +
 692:                               Zeros(97) +
 693:                               _0x4169[62] +
 694:                               LengthName(arr1[3]);
 695:                           } else {
 696:                             if (arr1[0] == _0x4169[5]) {
 697:                               ret = Zeros(148);
 698:                             } else {
 699:                               alert(_0x4169[74], _0x4169[74]);
 700:                               return _0x4169[21];
 701:                             }
 702:                           }
 703:                         }
 704:                       }
 705:                     }
 706:                   }
 707:                 }
 708:               }
 709:             }
 710:           }
 711:         }
 712:       }
 713:       return pr + ret;
 714:     }
 715:     function LengthName(arg) {
 716:       var i = ansi2binary(arg) + _0x4169[51];
 717:       var b = _0x4169[21];
 718:       if (decodeURIComponent(i)[_0x4169[11]] % 2 != 0) {
 719:         b = _0x4169[51];
 720:       }
 721:       return CountLengthTo_hex(i) + b;
 722:     }
 723:     function FixedName(arg) {
 724:       return FixedLength(ansi2binary(arg), 30);
 725:     }
 726:     function Timer(arg) {
 727:       if (arg == 0) {
 728:         return _0x4169[75];
 729:       }
 730:       return _0x4169[51];
 731:     }
 732:     function ExtTimer(arg) {
 733:       if (arg == 2) {
 734:         return _0x4169[64];
 735:       }
 736:       return _0x4169[56];
 737:     }
 738:     function Locked(arg) {
 739:       if (arg) {
 740:         return _0x4169[76];
 741:       }
 742:       return _0x4169[51];
 743:     }
 744:     function LengthDown(data, length_) {
 745:       var length = parseInt(length_);
 746:       if (
 747:         isNaN(length) ||
 748:         length == null ||
 749:         length == undefined ||
 750:         length <= 0
 751:       ) {
 752:         length = 40;
 753:       }
 754:       var Sdata = decodeURIComponent(data);
 755:       if (Sdata[_0x4169[11]] >= length) {
 756:         Sdata = Sdata[_0x4169[38]](0, length);
 757:       }
 758:       Sdata = encodeURIComponent(Sdata);
 759:       return Sdata;
 760:     }
 761:     function FixedLength(data, length_) {
 762:       var length = parseInt(length_);
 763:       if (
 764:         isNaN(length) ||
 765:         length == null ||
 766:         length == undefined ||
 767:         length <= 0
 768:       ) {
 769:         length = 40;
 770:       }
 771:       var Sdata = decodeURIComponent(data);
 772:       if (Sdata[_0x4169[11]] >= length) {
 773:         Sdata = Sdata[_0x4169[38]](0, length - 1);
 774:       }
 775:       Sdata = encodeURIComponent(Sdata) + Zeros(length - Sdata[_0x4169[11]]);
 776:       return Sdata;
 777:     }
 778:     function Zeros(amount) {
 779:       var data = _0x4169[21];
 780:       for (var i = 0; i < amount; i += 1) {
 781:         data = data + _0x4169[51];
 782:       }
 783:       return data;
 784:     }
 785:     function CountLengthTo_hex(data, length_) {
 786:       var length = length_;
 787:       if (length == null || length == undefined) {
 788:         length = 4;
 789:       }
 790:       var HEXStringLength = HexEncodeURI(
 791:         decodeURIComponent(data)[_0x4169[11]],
 792:         length,
 793:       );
 794:       return HEXStringLength + data;
 795:     }
 796:     function crc32(str) {
 797:       var crc = 4294967295;
 798:       var table = new Array();
 799:       for (var i = 0; i < 256; i += 1) {
 800:         n = i;
 801:         for (var j = 8; j > 0; j += -1) {
 802:           if ((n & 1) == 1) {
 803:             n = (n >>> 1) ^ 3988292384;
 804:           } else {
 805:             n = n >>> 1;
 806:           }
 807:         }
 808:         table[i] = n;
 809:       }
 810:       for (var i = 0; i < str[_0x4169[11]]; i += 1) {
 811:         crc = (crc >>> 8) ^ table[str[_0x4169[77]](i) ^ (crc & 255)];
 812:       }
 813:       crc = ~crc;
 814:       crc = crc < 0 ? 4294967295 + crc + 1 : crc;
 815:       crc = crc.toString(16);
 816:       return crc;
 817:     }
 818:     function toFloat(number) {
 819:       return toDouble(number, true);
 820:     }
 821:     function toDouble(v, fl) {
 822:       var ebits = 11;
 823:       var fbits = 52;
 824:       if (fl) {
 825:         ebits = 8;
 826:         fbits = 23;
 827:       }
 828:       var bias = (1 << (ebits - 1)) - 1;
 829:       if (isNaN(v)) {
 830:         e = (1 << bias) - 1;
 831:         f = 1;
 832:         s = 0;
 833:       } else {
 834:         if (v === Infinity || v === -Infinity) {
 835:           e = (1 << bias) - 1;
 836:           f = 0;
 837:           s = v < 0 ? 1 : 0;
 838:         } else {
 839:           if (v === 0) {
 840:             e = 0;
 841:             f = 0;
 842:             s = 1 / v === -Infinity ? 1 : 0;
 843:           } else {
 844:             s = v < 0;
 845:             v = Math[_0x4169[78]](v);
 846:             if (v >= Math[_0x4169[79]](2, 1 - bias)) {
 847:               var ln = Math[_0x4169[83]](
 848:                 Math[_0x4169[82]](Math[_0x4169[80]](v) / Math[_0x4169[81]]),
 849:                 bias,
 850:               );
 851:               e = ln + bias;
 852:               f =
 853:                 v * Math[_0x4169[79]](2, fbits - ln) -
 854:                 Math[_0x4169[79]](2, fbits);
 855:             } else {
 856:               e = 0;
 857:               f = v / Math[_0x4169[79]](2, 1 - bias - fbits);
 858:             }
 859:           }
 860:         }
 861:       }
 862:       var bits = [];
 863:       for (i = fbits; i; i -= 1) {
 864:         bits[_0x4169[84]](f % 2 ? 1 : 0);
 865:         f = Math[_0x4169[82]](f / 2);
 866:       }
 867:       for (i = ebits; i; i -= 1) {
 868:         bits[_0x4169[84]](e % 2 ? 1 : 0);
 869:         e = Math[_0x4169[82]](e / 2);
 870:       }
 871:       bits[_0x4169[84]](s ? 1 : 0);
 872:       bits[_0x4169[85]]();
 873:       var str = bits[_0x4169[86]](_0x4169[21]);
 874:       var bytes = _0x4169[21];
 875:       while (str[_0x4169[11]]) {
 876:         bytes = bytes + HexEncodeURI(parseInt(str[_0x4169[87]](0, 8), 2));
 877:         str = str[_0x4169[87]](8);
 878:       }
 879:       return bytes;
 880:     }
 881:     function toFraction(number_) {
 882:       var number = number_;
 883:       if (number > 32767) {
 884:         number = 32767;
 885:       } else {
 886:         if (number < -32768) {
 887:           number = 32768;
 888:         } else {
 889:           number = parseFloat(number[_0x4169[88]](5));
 890:         }
 891:       }
 892:       integer = parseInt(number);
 893:       fractional = number - integer[_0x4169[88]](14)[_0x4169[38]](-14);
 894:       fractional = fractional / (1525878906)[_0x4169[88]]();
 895:       if (number < 0) {
 896:         fractional = 65535 - fractional;
 897:         integer = 65535 + integer;
 898:       }
 899:       return HexEncodeURI(integer, 2) + HexEncodeURI(fractional, 2);
 900:     }
 901:     function HexEncodeURI(number, length_) {
 902:       var length = length_;
 903:       var URLdata = _0x4169[89];
 904:       if (length == null || length == undefined) {
 905:         var length = 1;
 906:       }
 907:       var str = number.toString(16);
 908:       while (str[_0x4169[11]] < length * 2) {
 909:         str = _0x4169[22] + str;
 910:       }
 911:       var bytes = _0x4169[21];
 912:       var sstrn = _0x4169[21];
 913:       var i = 0;
 914:       while (bytes[_0x4169[11]] < length) {
 915:         sstrn = parseInt(str[_0x4169[38]](i, 2), 16);
 916:         bytes = bytes + URLdata[_0x4169[38]](sstrn, 1);
 917:         i = i + 2;
 918:       }
 919:       return encodeURIComponent(bytes);
 920:     }
 921:     function CreateID(new_arr0) {
 922:       var date = new Date();
 923:       var day = date[_0x4169[90]]();
 924:       var ss = date[_0x4169[91]]();
 925:       var ret = LengthDown(
 926:         encodeURIComponent(
 927:           RandomSymbol() +
 928:             NumberToSymbol(ss) +
 929:             crc32(ArrayParser(new_arr0)) +
 930:             RandomSymbol() +
 931:             NumberToSymbol(day) +
 932:             RandomSymbol(),
 933:         ),
 934:         31,
 935:       );
 936:       return ret;
 937:     }
 938:     function ArrayParser(data) {
 939:       var x = _0x4169[92];
 940:       var y = _0x4169[93];
 941:       if (typeof data === _0x4169[94]) {
 942:         str = decodeURIComponent(data);
 943:         str = str[_0x4169[95]](y);
 944:         var arr = new Array();
 945:         for (var i = 0; i < str[_0x4169[11]]; i += 1) {
 946:           arr[i] = str[i][_0x4169[95]](x);
 947:         }
 948:         return arr;
 949:       } else {
 950:         str = data[0][_0x4169[86]](x);
 951:         for (var i = 1; i < data[_0x4169[11]]; i += 1) {
 952:           str += y + data[i][_0x4169[86]](x);
 953:         }
 954:         return str;
 955:       }
 956:     }
 957:     function NumberToSymbol(number_) {
 958:       var line = _0x4169[96];
 959:       var number = number_ % line[_0x4169[11]];
 960:       return line[_0x4169[38]](number, 1);
 961:     }
 962:     function RandomSymbol() {
 963:       var min = 0;
 964:       var max = 62;
 965:       var rand = min - 0.5 + Math[_0x4169[97]]() * (max - min + 1);
 966:       rand = parseInt(Math[_0x4169[98]](rand));
 967:       rand = NumberToSymbol(rand);
 968:       return rand;
 969:     }
 970:     function ansi2binary(name_) {
 971:       var name = name_;
 972:       var Converter = new File(
 973:         Folder[_0x4169[100]][_0x4169[99]] + _0x4169[101],
 974:       );
 975:       Converter[_0x4169[102]] = _0x4169[103];
 976:       Converter[_0x4169[105]](_0x4169[104]);
 977:       Converter[_0x4169[106]](name);
 978:       Converter[_0x4169[105]](_0x4169[107]);
 979:       Converter[_0x4169[102]] = _0x4169[108];
 980:       name = encodeURI(Converter[_0x4169[109]]());
 981:       Converter[_0x4169[110]]();
 982:       Converter[_0x4169[111]]();
 983:       return name;
 984:     }
 985:     if (new_arr0[0][0] != _0x4169[5]) {
 986:       alert(_0x4169[6], _0x4169[6]);
 987:       return;
 988:     }
 989:     var FaFX = _0x4169[7];
 990:     var beso = _0x4169[8];
 991:     var sspc = _0x4169[9] + Zeros(48) + _0x4169[10];
 992:     for (var i = 0; i < new_arr0[_0x4169[11]]; i += 1) {
 993:       if (new_arr0[i][0] == _0x4169[12]) {
 994:         FaFX = _0x4169[13];
 995:         beso = _0x4169[14];
 996:         break;
 997:       }
 998:     }
 999:     var lName = LengthName(new_arr0[0][1]);
1000:     var tdsptdot1 = _0x4169[15];
1001:     var tdsptdot2 = _0x4169[16] + lName + _0x4169[17];
1002:     var ID = LengthDown(encodeURIComponent(_0x4169[18] + myName), 31);
1003:     var fullMatchName = decodeURIComponent(ID);
1004:     var ss = CountLengthTo_hex(
1005:       sspc +
1006:         CountLengthTo_hex(parTparn(ID, new_arr0)) +
1007:         _0x4169[10] +
1008:         CountLengthTo_hex(tdgptdsb(ID, new_arr0, lName)),
1009:     );
1010:     return {
1011:       mn: fullMatchName,
1012:       str:
1013:         _0x4169[19] +
1014:         CountLengthTo_hex(
1015:           FaFX +
1016:             CountLengthTo_hex(
1017:               beso + tdsptdot1 + FixedLength(ID, 40) + tdsptdot2 + ss,
1018:             ),
1019:         ),
1020:     };
1021:   };
1022:   goodParents[_0x4169[112]] = function () {
1023:     var matchNames = {
1024:       layer: {
1025:         effects: {
1026:           layerControl: { layer: { mn: _0x4169[118] }, mn: _0x4169[117] },
1027:           mn: _0x4169[116],
1028:         },
1029:         marker: { mn: _0x4169[113] },
1030:         text: { mn: _0x4169[114], sourceText: { mn: _0x4169[115] } },
1031:         transform: {
1032:           anchorPoint: { mn: _0x4169[122] },
1033:           mn: _0x4169[119],
1034:           opacity: { mn: _0x4169[123] },
1035:           orientation: { mn: _0x4169[125] },
1036:           position: { mn: _0x4169[121] },
1037:           rotation: { mn: _0x4169[124] },
1038:           scale: { mn: _0x4169[120] },
1039:         },
1040:       },
1041:       paint: {
1042:         effect: {
1043:           mn: _0x4169[140],
1044:           strokes: {
1045:             brush: {
1046:               mn: _0x4169[142],
1047:               path: { mn: _0x4169[143] },
1048:               stroke: {
1049:                 color: { mn: _0x4169[148] },
1050:                 diameter: { mn: _0x4169[149] },
1051:                 end: { mn: _0x4169[147] },
1052:                 mn: _0x4169[146],
1053:               },
1054:               transform: { mn: _0x4169[144], position: { mn: _0x4169[145] } },
1055:             },
1056:             mn: _0x4169[141],
1057:           },
1058:         },
1059:       },
1060:       shape: {
1061:         contents: {
1062:           group: {
1063:             content: {
1064:               mn: _0x4169[128],
1065:               pathGroup: { mn: _0x4169[129], path: { mn: _0x4169[130] } },
1066:               stroke: {
1067:                 color: { mn: _0x4169[133] },
1068:                 lineCap: { mn: _0x4169[135] },
1069:                 lineJoin: { mn: _0x4169[134] },
1070:                 mn: _0x4169[131],
1071:                 width: { mn: _0x4169[132] },
1072:               },
1073:               trimPaths: { end: { mn: _0x4169[137] }, mn: _0x4169[136] },
1074:             },
1075:             mn: _0x4169[127],
1076:             transform: { mn: _0x4169[138], position: { mn: _0x4169[139] } },
1077:           },
1078:           mn: _0x4169[126],
1079:         },
1080:       },
1081:     };
1082:     return matchNames;
1083:   };
1084:   goodParents[_0x4169[150]] = {
1085:     createBttn: { name: _0x4169[151], tip: _0x4169[152] },
1086:     getBttn: { name: _0x4169[154], tip: _0x4169[155] },
1087:     parentsControls: { tip: _0x4169[153] },
1088:     setBttn: { name: _0x4169[156], tip: _0x4169[157] },
1089:     strokeColor: [0.6, 0.6, 0.6, 1],
1090:     trialAlert: _0x4169[158],
1091:   };
1092:   goodParents[_0x4169[159]] = function (
1093:     thisObj,
1094:     parentGroup,
1095:     _size,
1096:     txt,
1097:     icon,
1098:     iconOver,
1099:     iconOnly,
1100:   ) {
1101:     iconOnly = iconOnly || false;
1102:     var newBttnGroup = parentGroup[_0x4169[161]](_0x4169[160]);
1103:     var newBttnBG = newBttnGroup[_0x4169[161]](_0x4169[162]);
1104:     newBttnBG[_0x4169[163]] = _size;
1105:     if (iconOnly === false) {
1106:       thisObj[_0x4169[164]](newBttnBG, [94, 94, 94, 255] / 255);
1107:     }
1108:     var newBttn = newBttnGroup[_0x4169[161]](_0x4169[165]);
1109:     newBttn[_0x4169[163]] = _size - [2, 2];
1110:     if (iconOnly === false) {
1111:       thisObj[_0x4169[164]](newBttn, [39, 39, 39, 255] / 255);
1112:     }
1113:     if (txt !== _0x4169[21]) {
1114:       newBttn[_0x4169[166]] = newBttn[_0x4169[161]](
1115:         _0x4169[167],
1116:         undefined,
1117:         txt,
1118:       );
1119:       newBttn[_0x4169[166]][_0x4169[168]] = 20;
1120:       newBttn[_0x4169[166]][_0x4169[169]] = _0x4169[170];
1121:       newBttn[_0x4169[166]][_0x4169[163]] = _size - [4, 4];
1122:       newBttn[_0x4169[166]][_0x4169[171]] = newBttn[_0x4169[166]][
1123:         _0x4169[172]
1124:       ] = [_0x4169[170], _0x4169[170]];
1125:     } else {
1126:       if (icon !== _0x4169[21]) {
1127:         newBttn[_0x4169[173]] = newBttn[_0x4169[161]](
1128:           _0x4169[174],
1129:           undefined,
1130:           icon,
1131:         );
1132:       }
1133:     }
1134:     var newBttnClickZone = newBttnGroup[_0x4169[161]](_0x4169[162]);
1135:     newBttnClickZone[_0x4169[175]] =
1136:       newBttnClickZone[_0x4169[163]] =
1137:       newBttnClickZone[_0x4169[176]] =
1138:       newBttnClickZone[_0x4169[177]] =
1139:         _size;
1140:     newBttnClickZone[_0x4169[178]] = function (visible) {
1141:       newBttn[_0x4169[179]] = visible;
1142:       newBttnBG[_0x4169[179]] = visible;
1143:     };
1144:     newBttnClickZone[_0x4169[180]] = function (_text) {
1145:       newBttn[_0x4169[166]][_0x4169[181]] = _text;
1146:     };
1147:     newBttnClickZone[_0x4169[182]] = function () {
1148:       newBttn[_0x4169[183]] = false;
1149:       newBttnBG[_0x4169[183]] = false;
1150:     };
1151:     newBttnClickZone[_0x4169[184]] = function () {
1152:       newBttn[_0x4169[183]] = true;
1153:       newBttnBG[_0x4169[183]] = true;
1154:     };
1155:     newBttnClickZone[_0x4169[189]](_0x4169[185], function (e) {
1156:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1157:         if (iconOnly === false) {
1158:           thisObj[_0x4169[164]](newBttnBG, [92, 232, 254, 255] / 255);
1159:           thisObj[_0x4169[164]](newBttn, [42, 49, 50, 255] / 255);
1160:         }
1161:         if (txt !== _0x4169[21]) {
1162:           thisObj[_0x4169[188]](newBttn[_0x4169[166]], [1, 1, 1, 1]);
1163:         } else {
1164:           newBttn[_0x4169[173]][_0x4169[174]] = iconOver;
1165:         }
1166:       }
1167:     });
1168:     newBttnClickZone[_0x4169[189]](_0x4169[190], function (e) {
1169:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1170:         if (iconOnly === false) {
1171:           thisObj[_0x4169[164]](newBttnBG, [94, 94, 94, 255] / 255);
1172:           thisObj[_0x4169[164]](newBttn, [39, 39, 39, 255] / 255);
1173:         }
1174:         if (txt !== _0x4169[21]) {
1175:           thisObj[_0x4169[188]](
1176:             newBttn[_0x4169[166]],
1177:             [192, 192, 192, 192] / 255,
1178:           );
1179:         } else {
1180:           newBttn[_0x4169[173]][_0x4169[174]] = icon;
1181:         }
1182:       }
1183:     });
1184:     newBttnClickZone[_0x4169[189]](_0x4169[191], function () {
1185:       if (iconOnly === false) {
1186:         thisObj[_0x4169[164]](newBttn, [23, 23, 23, 255] / 255);
1187:       }
1188:     });
1189:     newBttnClickZone[_0x4169[189]](_0x4169[192], function () {
1190:       if (iconOnly === false) {
1191:         thisObj[_0x4169[164]](newBttn, [39, 39, 39, 255] / 255);
1192:       }
1193:     });
1194:     return newBttnClickZone;
1195:   };
1196:   goodParents[_0x4169[193]] = function (thisObj) {
1197:     thisObj[_0x4169[194]] = [];
1198:     var fldr = new Folder(Folder[_0x4169[196]][_0x4169[195]] + _0x4169[197]);
1199:     fldr[_0x4169[198]]();
1200:     for (var i = 0; i < thisObj[_0x4169[199]][_0x4169[11]]; i += 1) {
1201:       thisObj[_0x4169[194]][i] = new File(
1202:         fldr[_0x4169[195]] + _0x4169[200] + i + _0x4169[201],
1203:       );
1204:       thisObj[_0x4169[194]][i][_0x4169[102]] = _0x4169[108];
1205:       thisObj[_0x4169[194]][i][_0x4169[105]](_0x4169[104]);
1206:       thisObj[_0x4169[194]][i][_0x4169[106]](thisObj[_0x4169[199]][i]);
1207:       thisObj[_0x4169[194]][i][_0x4169[110]]();
1208:     }
1209:     thisObj[_0x4169[202]] =
1210:       thisObj instanceof Panel
1211:         ? thisObj
1212:         : new Window(
1213:             _0x4169[203],
1214:             thisObj[_0x4169[0]] + _0x4169[204] + thisObj[_0x4169[2]],
1215:             undefined,
1216:             { resizeable: true },
1217:           );
1218:     if (thisObj[_0x4169[202]] === null) {
1219:       return;
1220:     }
1221:     thisObj[_0x4169[202]][_0x4169[172]] = [_0x4169[205], _0x4169[206]];
1222:     var mainGroup = thisObj[_0x4169[202]][_0x4169[161]](_0x4169[207]);
1223:     var mainContainer = mainGroup[_0x4169[161]](_0x4169[208]);
1224:     var mainScreen = mainContainer[_0x4169[161]](_0x4169[209]);
1225:     var parentsBttnGroup = mainScreen[_0x4169[161]](_0x4169[210]);
1226:     var parentsControls = parentsBttnGroup[_0x4169[161]](_0x4169[211]);
1227:     var numParentsGroup = parentsControls[_0x4169[161]](_0x4169[212]);
1228:     var numParentsBG = numParentsGroup[_0x4169[161]](_0x4169[162]);
1229:     numParentsBG[_0x4169[175]] = numParentsBG[_0x4169[163]] = [32, 40];
1230:     goodParents[_0x4169[164]](numParentsBG, [94, 94, 94, 255] / 255);
1231:     var numParents = numParentsGroup[_0x4169[161]](
1232:       _0x4169[213],
1233:       undefined,
1234:       _0x4169[21],
1235:     );
1236:     numParents[_0x4169[214]] =
1237:       thisObj[_0x4169[150]][_0x4169[216]][_0x4169[215]];
1238:     numParents[_0x4169[168]] = 2;
1239:     numParents[_0x4169[181]] = _0x4169[217];
1240:     numParents[_0x4169[163]] = [30, 38];
1241:     var plusMinusBttn = parentsControls[_0x4169[161]](_0x4169[218]);
1242:     var plusButton = goodParents[_0x4169[159]](
1243:       goodParents,
1244:       plusMinusBttn,
1245:       [23, 20],
1246:       _0x4169[219],
1247:       _0x4169[21],
1248:       _0x4169[21],
1249:     );
1250:     var minusButton = goodParents[_0x4169[159]](
1251:       goodParents,
1252:       plusMinusBttn,
1253:       [23, 20],
1254:       _0x4169[24],
1255:       _0x4169[21],
1256:       _0x4169[21],
1257:     );
1258:     var createBttn = goodParents[_0x4169[159]](
1259:       goodParents,
1260:       mainScreen,
1261:       [79, 40],
1262:       thisObj[_0x4169[150]][_0x4169[221]][_0x4169[220]],
1263:       _0x4169[21],
1264:       _0x4169[21],
1265:     );
1266:     createBttn[_0x4169[214]] =
1267:       thisObj[_0x4169[150]][_0x4169[221]][_0x4169[215]];
1268:     if (goodParents[_0x4169[222]]() === true) {
1269:       limit = 2;
1270:     } else {
1271:       limit = 32;
1272:     }
1273:     var vertGroupGroup = mainGroup[_0x4169[161]](_0x4169[223]);
1274:     var vertGroup = goodParents[_0x4169[159]](
1275:       thisObj,
1276:       vertGroupGroup,
1277:       [14, 26],
1278:       _0x4169[21],
1279:       thisObj[_0x4169[194]][0],
1280:       thisObj[_0x4169[194]][1],
1281:       true,
1282:     );
1283:     var secondScreen = mainContainer[_0x4169[161]](_0x4169[209]);
1284:     var getBttn = goodParents[_0x4169[159]](
1285:       goodParents,
1286:       secondScreen,
1287:       [56, 40],
1288:       thisObj[_0x4169[150]][_0x4169[224]][_0x4169[220]],
1289:       _0x4169[21],
1290:       _0x4169[21],
1291:     );
1292:     getBttn[_0x4169[214]] = thisObj[_0x4169[150]][_0x4169[224]][_0x4169[215]];
1293:     var setBttn = goodParents[_0x4169[159]](
1294:       goodParents,
1295:       secondScreen,
1296:       [56, 40],
1297:       thisObj[_0x4169[150]][_0x4169[225]][_0x4169[220]],
1298:       _0x4169[21],
1299:       _0x4169[21],
1300:     );
1301:     setBttn[_0x4169[214]] = thisObj[_0x4169[150]][_0x4169[225]][_0x4169[215]];
1302:     var watGroup = secondScreen[_0x4169[161]](_0x4169[226]);
1303:     var watSign = watGroup[_0x4169[161]](_0x4169[167], undefined, _0x4169[227]);
1304:     numParents[_0x4169[228]] = function () {
1305:       var preFilter = /([0-9]*)/;
1306:       this[_0x4169[181]] = this[_0x4169[181]][_0x4169[229]](preFilter)[0];
1307:       str = parseInt(this[_0x4169[181]]);
1308:       if (!str || str < 1) {
1309:         this[_0x4169[181]] = _0x4169[217];
1310:       } else {
1311:         if (str > limit) {
1312:           this[_0x4169[181]] = String(limit);
1313:           if (goodParents[_0x4169[222]]() === true) {
1314:             alert(thisObj[_0x4169[150]][_0x4169[230]]);
1315:           }
1316:         } else {
1317:           this[_0x4169[181]] = String(str);
1318:         }
1319:       }
1320:     };
1321:     vertGroup[_0x4169[189]](_0x4169[231], function (e) {
1322:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1323:         mainScreen[_0x4169[179]] = !mainScreen[_0x4169[179]];
1324:         secondScreen[_0x4169[179]] = !secondScreen[_0x4169[179]];
1325:       }
1326:     });
1327:     watSign[_0x4169[189]](_0x4169[231], function (e) {
1328:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1329:         thisObj[_0x4169[232]](thisObj);
1330:       }
1331:     });
1332:     getBttn[_0x4169[189]](_0x4169[231], function (e) {
1333:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1334:         if (goodParents[_0x4169[233]]) {
1335:           goodParents[_0x4169[234]] = goodParents[_0x4169[235]]();
1336:           alert(_0x4169[236]);
1337:         } else {
1338:           try {
1339:             goodParents[_0x4169[234]] = goodParents[_0x4169[235]]();
1340:             alert(_0x4169[236]);
1341:           } catch (e) {
1342:             alert(e);
1343:           }
1344:         }
1345:       }
1346:     });
1347:     setBttn[_0x4169[189]](_0x4169[231], function (e) {
1348:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1349:         app[_0x4169[238]](_0x4169[237]);
1350:         if (goodParents[_0x4169[233]]) {
1351:           goodParents[_0x4169[239]](goodParents[_0x4169[234]]);
1352:         } else {
1353:           try {
1354:             goodParents[_0x4169[239]](goodParents[_0x4169[234]]);
1355:           } catch (e) {
1356:             alert(e);
1357:           }
1358:         }
1359:         app[_0x4169[240]]();
1360:       }
1361:     });
1362:     secondScreen[_0x4169[179]] = false;
1363:     plusButton[_0x4169[189]](_0x4169[231], function (e) {
1364:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1365:         str = parseInt(numParents[_0x4169[181]]);
1366:         str++;
1367:         if (!str || str < 1) {
1368:           numParents[_0x4169[181]] = _0x4169[217];
1369:         } else {
1370:           if (str > limit) {
1371:             numParents[_0x4169[181]] = limit;
1372:             if (goodParents[_0x4169[222]]() === true) {
1373:               alert(thisObj[_0x4169[150]][_0x4169[230]]);
1374:             }
1375:           } else {
1376:             numParents[_0x4169[181]] = String(str);
1377:           }
1378:         }
1379:       }
1380:     });
1381:     minusButton[_0x4169[189]](_0x4169[231], function (e) {
1382:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1383:         str = parseInt(numParents[_0x4169[181]]);
1384:         str--;
1385:         if (!str || str < 1) {
1386:           numParents[_0x4169[181]] = _0x4169[217];
1387:         } else {
1388:           if (str > limit) {
1389:             numParents[_0x4169[181]] = limit;
1390:             if (goodParents[_0x4169[222]]() === true) {
1391:               alert(thisObj[_0x4169[150]][_0x4169[230]]);
1392:             }
1393:           } else {
1394:             numParents[_0x4169[181]] = String(str);
1395:           }
1396:         }
1397:       }
1398:     });
1399:     createBttn[_0x4169[189]](_0x4169[231], function (e) {
1400:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1401:         app[_0x4169[238]](_0x4169[1]);
1402:         if (goodParents[_0x4169[233]]) {
1403:           goodParents[_0x4169[241]](parseInt(numParents[_0x4169[181]]));
1404:         } else {
1405:           try {
1406:             goodParents[_0x4169[241]](parseInt(numParents[_0x4169[181]]));
1407:           } catch (e) {
1408:             alert(e);
1409:           }
1410:         }
1411:         app[_0x4169[240]]();
1412:       }
1413:     });
1414:     if (thisObj[_0x4169[202]] instanceof Window) {
1415:       thisObj[_0x4169[202]][_0x4169[170]]();
1416:       thisObj[_0x4169[202]][_0x4169[242]]();
1417:     } else {
1418:       thisObj[_0x4169[202]][_0x4169[243]][_0x4169[243]](false);
1419:     }
1420:   };
1421:   goodParents[_0x4169[199]] = [_0x4169[244], _0x4169[245]];
1422:   goodParents[_0x4169[246]] = function (obj, hlpTip) {
1423:     if (hlpTip) {
1424:       if (obj[_0x4169[173]]) {
1425:         obj[_0x4169[173]][_0x4169[214]] = hlpTip;
1426:       } else {
1427:         obj[_0x4169[214]] = hlpTip;
1428:       }
1429:     }
1430:     return obj;
1431:   };
1432:   goodParents[_0x4169[247]] = function (obj, iconFile) {
1433:     if (iconFile) {
1434:       obj[_0x4169[173]] = obj[_0x4169[161]](_0x4169[174], undefined, iconFile);
1435:     }
1436:     return obj;
1437:   };
1438:   goodParents[_0x4169[188]] = function (obj, colorArray) {
1439:     if (typeof colorArray != _0x4169[248] && colorArray[_0x4169[11]] >= 3) {
1440:       obj[_0x4169[250]][_0x4169[249]] = obj[_0x4169[250]][_0x4169[252]](
1441:         obj[_0x4169[250]][_0x4169[251]].SOLID_COLOR,
1442:         colorArray,
1443:         1,
1444:       );
1445:     }
1446:     return obj;
1447:   };
1448:   goodParents[_0x4169[164]] = function (obj, colorArray) {
1449:     if (typeof colorArray != _0x4169[248] && colorArray[_0x4169[11]] >= 3) {
1450:       obj[_0x4169[250]][_0x4169[253]] = obj[_0x4169[250]][_0x4169[255]](
1451:         obj[_0x4169[250]][_0x4169[254]].SOLID_COLOR,
1452:         colorArray,
1453:       );
1454:     }
1455:     return obj;
1456:   };
1457:   goodParents[_0x4169[232]] = function (thisObj) {
1458:     thisObj[_0x4169[256]] = new Window(
1459:       _0x4169[257],
1460:       _0x4169[258] + thisObj[_0x4169[2]],
1461:       undefined,
1462:       { resizeable: false },
1463:     );
1464:     thisObj[_0x4169[256]][_0x4169[172]] = [_0x4169[205], _0x4169[206]];
1465:     goodParents[_0x4169[259]] = _0x4169[260];
1466:     if ($[_0x4169[262]][_0x4169[38]](0, 7)[_0x4169[261]]() == _0x4169[263]) {
1467:       goodParents[_0x4169[259]] = _0x4169[264];
1468:     }
1469:     goodParents[_0x4169[265]] = goodParents[_0x4169[259]] + _0x4169[266];
1470:     goodParents[_0x4169[267]] = goodParents[_0x4169[259]] + _0x4169[268];
1471:     var inputText = _0x4169[269];
1472:     var logoFile = [_0x4169[270]];
1473:     var fldr = new Folder(Folder[_0x4169[196]][_0x4169[195]] + _0x4169[271]);
1474:     fldr[_0x4169[198]]();
1475:     iconFile = new File(fldr[_0x4169[195]] + _0x4169[272]);
1476:     iconFile[_0x4169[102]] = _0x4169[108];
1477:     iconFile[_0x4169[105]](_0x4169[104]);
1478:     iconFile[_0x4169[106]](logoFile[0]);
1479:     iconFile[_0x4169[110]]();
1480:     var mainGroup = thisObj[_0x4169[256]][_0x4169[161]](_0x4169[273]);
1481:     mainGroup[_0x4169[161]](_0x4169[174], undefined, iconFile);
1482:     var txt0 = mainGroup[_0x4169[161]](_0x4169[275])[_0x4169[161]](
1483:       _0x4169[167],
1484:       undefined,
1485:       _0x4169[274],
1486:     );
1487:     goodParents[_0x4169[188]](txt0, [0.4, 0.4, 0.4, 1]);
1488:     var txt = mainGroup[_0x4169[161]](_0x4169[275])[_0x4169[161]](
1489:       _0x4169[213],
1490:       undefined,
1491:       inputText,
1492:       { multiline: true, readonly: true, scrolling: true },
1493:     );
1494:     txt[_0x4169[177]] = [250, 120];
1495:     mainGroup[_0x4169[161]](_0x4169[167], undefined, _0x4169[276], {
1496:       multiline: true,
1497:     });
1498:     var txt1 = mainGroup[_0x4169[161]](_0x4169[167], undefined, _0x4169[277]);
1499:     txt1[_0x4169[189]](_0x4169[192], function (k) {
1500:       if (k[_0x4169[278]] === 0) {
1501:         system[_0x4169[279]](thisObj[_0x4169[265]]);
1502:       }
1503:     });
1504:     goodParents[_0x4169[188]](txt1, [67, 170, 207, 255] / 255);
1505:     mainGroup[_0x4169[161]](_0x4169[275])[_0x4169[161]](
1506:       _0x4169[167],
1507:       undefined,
1508:       _0x4169[280],
1509:       { multiline: true },
1510:     );
1511:     var txt2 = mainGroup[_0x4169[161]](_0x4169[167], undefined, _0x4169[281]);
1512:     txt2[_0x4169[189]](_0x4169[192], function (k) {
1513:       if (k[_0x4169[278]] === 0) {
1514:         system[_0x4169[279]](thisObj[_0x4169[267]]);
1515:       }
1516:     });
1517:     goodParents[_0x4169[188]](txt2, [67, 170, 207, 255] / 255);
1518:     var regtextST = mainGroup[_0x4169[161]](_0x4169[167], undefined, {
1519:       multiline: true,
1520:     });
1521:     goodParents[_0x4169[188]](regtextST, [0.4, 0.4, 0.4, 1]);
1522:     regtextST[_0x4169[181]] = goodParents[_0x4169[222]]()
1523:       ? _0x4169[282]
1524:       : goodParents[_0x4169[284]][_0x4169[283]]();
1525:     var deactivateButton = goodParents[_0x4169[159]](
1526:       goodParents,
1527:       mainGroup,
1528:       [100, 20],
1529:       _0x4169[285],
1530:       _0x4169[21],
1531:       _0x4169[21],
1532:     );
1533:     deactivateButton[_0x4169[178]](!goodParents[_0x4169[222]]());
1534:     deactivateButton[_0x4169[189]](_0x4169[231], function (e) {
1535:       if (e[_0x4169[186]] === e[_0x4169[187]]) {
1536:         if (goodParents[_0x4169[284]][_0x4169[107]]()) {
1537:           regtextST[_0x4169[181]] = goodParents[_0x4169[284]][_0x4169[283]]();
1538:           deactivateButton[_0x4169[178]](false);
1539:         }
1540:       }
1541:     });
1542:     if (thisObj[_0x4169[256]] instanceof Window) {
1543:       thisObj[_0x4169[256]][_0x4169[170]]();
1544:       thisObj[_0x4169[256]][_0x4169[242]]();
1545:     } else {
1546:       thisObj[_0x4169[256]][_0x4169[243]][_0x4169[243]](true);
1547:     }
1548:   };
1549:   goodParents[_0x4169[286]] = {
1550:     orientation: _0x4169[290],
1551:     position: _0x4169[288],
1552:     preparentText: _0x4169[287],
1553:     rotation: _0x4169[291],
1554:     scale: _0x4169[289],
1555:   };
1556:   eval(_0x4169[292]);
1557:   eval(_0x4169[293]);
1558:   goodParents[_0x4169[294]] = goodParents[_0x4169[112]]();
1559:   goodParents[_0x4169[295]] = _0x4169[296];
1560:   goodParents[_0x4169[297]] = _0x4169[298];
1561:   goodParents[_0x4169[233]] = false;
1562:   goodParents[_0x4169[299]] = function (layer) {
1563:     var myComp = layer[_0x4169[300]];
1564:     for (var i = 1; i <= myComp[_0x4169[301]]; i += 1) {
1565:       var curLayer = myComp[_0x4169[302]](i);
1566:       if (curLayer[_0x4169[303]] != goodParents[_0x4169[297]]) {
1567:         continue;
1568:       }
1569:       try {
1570:         if (layer[_0x4169[305]][_0x4169[304]] == curLayer[_0x4169[304]]) {
1571:           return curLayer;
1572:         }
1573:       } catch (e) {
1574:         continue;
1575:       }
1576:     }
1577:   };
1578:   goodParents[_0x4169[306]] = function (layer) {
1579:     var arr = [];
1580:     var myComp = layer[_0x4169[300]];
1581:     for (var i = 1; i <= myComp[_0x4169[301]]; i += 1) {
1582:       var curLayer = myComp[_0x4169[302]](i);
1583:       if (curLayer[_0x4169[305]] == layer) {
1584:         arr[_0x4169[84]](curLayer);
1585:       }
1586:     }
1587:     return arr;
1588:   };
1589:   goodParents[_0x4169[307]] = function (preset) {
1590:     if (preset[_0x4169[309]](_0x4169[308]) != null) {
1591:       return 1;
1592:     }
1593:     var i = 0;
1594:     while (true) {
1595:       i++;
1596:       if (preset[_0x4169[309]](_0x4169[310] + i) == null) {
1597:         break;
1598:       }
1599:     }
1600:     return i - 1;
1601:   };
1602:   goodParents[_0x4169[311]] = function (comp) {
1603:     for (var i = 1; i <= comp[_0x4169[301]]; i += 1) {
1604:       comp[_0x4169[302]](i)[_0x4169[312]] = false;
1605:     }
1606:   };
1607:   goodParents[_0x4169[313]] = function (preset, props, layer) {
1608:     var numParents = goodParents[_0x4169[307]](preset);
1609:     var cb = preset[_0x4169[309]](_0x4169[314]);
1610:     for (var i = cb[_0x4169[315]]; i >= 1; i--) {
1611:       cb[_0x4169[316]](i);
1612:     }
1613:     if (props[_0x4169[317]] instanceof Array) {
1614:       for (var i = 0; i < props[_0x4169[317]][_0x4169[11]]; i += 1) {
1615:         cb[_0x4169[320]](
1616:           props[_0x4169[317]][i][_0x4169[318]],
1617:           props[_0x4169[317]][i][_0x4169[319]],
1618:         );
1619:       }
1620:     } else {
1621:       cb[_0x4169[321]](props[_0x4169[317]]);
1622:     }
1623:     var slider = preset[_0x4169[309]](_0x4169[322]);
1624:     if (slider) {
1625:       for (var i = slider[_0x4169[315]]; i >= 1; i--) {
1626:         slider[_0x4169[316]](i);
1627:       }
1628:       if (props[_0x4169[323]] instanceof Array) {
1629:         for (var i = 0; i < props[_0x4169[323]][_0x4169[11]]; i += 1) {
1630:           slider[_0x4169[320]](
1631:             props[_0x4169[323]][i][_0x4169[318]],
1632:             props[_0x4169[323]][i][_0x4169[319]],
1633:           );
1634:         }
1635:       } else {
1636:         slider[_0x4169[321]](props[_0x4169[323]]);
1637:       }
1638:     }
1639:     if (goodParents[_0x4169[307]](preset) > 1) {
1640:       for (var i = 1; i <= numParents; i += 1) {
1641:         preset[_0x4169[309]](_0x4169[310] + i)[_0x4169[321]](0);
1642:       }
1643:       for (var i = 0; i < props[_0x4169[324]][_0x4169[11]]; i += 1) {
1644:         if (isValid(props[_0x4169[324]][i])) {
1645:           preset[_0x4169[309]](_0x4169[310] + i + 1)[_0x4169[321]](
1646:             props[_0x4169[324]][i][_0x4169[304]],
1647:           );
1648:         }
1649:       }
1650:     } else {
1651:       if (isValid(props[_0x4169[324]][0])) {
1652:         preset[_0x4169[309]](_0x4169[308])[_0x4169[321]](
1653:           props[_0x4169[324]][0][_0x4169[304]],
1654:         );
1655:       } else {
1656:         preset[_0x4169[309]](_0x4169[308])[_0x4169[321]](0);
1657:       }
1658:     }
1659:   };
1660:   goodParents[_0x4169[239]] = function (props) {
1661:     if (!props) {
1662:       throw new Error(_0x4169[325]);
1663:     }
1664:     var myComp = goodParents[_0x4169[326]]();
1665:     if (!myComp) {
1666:       throw new Error(_0x4169[327]);
1667:     }
1668:     if (props[_0x4169[328]] != myComp) {
1669:       throw new Error(_0x4169[329]);
1670:     }
1671:     var selectedLayers = myComp[_0x4169[330]];
1672:     var children = [];
1673:     for (var i = 0; i < selectedLayers[_0x4169[11]]; i += 1) {
1674:       children[_0x4169[84]](selectedLayers[i]);
1675:     }
1676:     for (var i = 0; i < children[_0x4169[11]]; i += 1) {
1677:       var curChild = children[i];
1678:       var presetEffect = goodParents[_0x4169[331]](curChild);
1679:       var newNumParents = props[_0x4169[324]][_0x4169[11]];
1680:       var newPreset = goodParents[_0x4169[332]](newNumParents);
1681:       var newPresetFile = newPreset[_0x4169[333]];
1682:       var newEffectMatchName = newPreset[_0x4169[334]];
1683:       if (!presetEffect) {
1684:         goodParents[_0x4169[335]](curChild, newPresetFile, newEffectMatchName);
1685:         presetEffect = goodParents[_0x4169[331]](curChild);
1686:       } else {
1687:         var oldNumParents = goodParents[_0x4169[307]](presetEffect);
1688:         if (newNumParents > oldNumParents) {
1689:           var newExpressions = goodParents[_0x4169[336]](newEffectMatchName);
1690:           presetEffect = goodParents[_0x4169[337]](
1691:             curChild,
1692:             presetEffect,
1693:             newPresetFile,
1694:             newNumParents,
1695:             newEffectMatchName,
1696:             newExpressions,
1697:           );
1698:         }
1699:       }
1700:       goodParents[_0x4169[313]](presetEffect, props, curChild);
1701:     }
1702:     if (newPresetFile) {
1703:       newPresetFile[_0x4169[111]]();
1704:     }
1705:     if (children[_0x4169[11]] > 0) {
1706:       myComp[_0x4169[338]] = true;
1707:     }
1708:   };
1709:   goodParents[_0x4169[235]] = function () {
1710:     var myComp = goodParents[_0x4169[326]]();
1711:     if (!myComp) {
1712:       throw new Error(_0x4169[327]);
1713:     }
1714:     var selectedLayers = myComp[_0x4169[330]];
1715:     var childLayer = null;
1716:     var preset = null;
1717:     for (var i = 0; i < selectedLayers[_0x4169[11]]; i += 1) {
1718:       var curLayer = selectedLayers[i];
1719:       var prevParentPreset = goodParents[_0x4169[331]](curLayer);
1720:       if (prevParentPreset) {
1721:         childLayer = curLayer;
1722:         preset = prevParentPreset;
1723:         break;
1724:       }
1725:     }
1726:     if (childLayer === null) {
1727:       throw new Error(_0x4169[339]);
1728:     }
1729:     var props = { cbKeys: null, comp: myComp, parents: [], sliderKeys: null };
1730:     var numParents = goodParents[_0x4169[307]](preset);
1731:     var cb = preset[_0x4169[309]](_0x4169[314]);
1732:     if (cb[_0x4169[315]] > 0) {
1733:       props[_0x4169[317]] = [];
1734:       for (var i = 1; i <= cb[_0x4169[315]]; i += 1) {
1735:         props[_0x4169[317]][_0x4169[84]]({
1736:           time: cb[_0x4169[340]](i),
1737:           value: cb[_0x4169[341]](cb[_0x4169[340]](i), true),
1738:         });
1739:       }
1740:     } else {
1741:       props[_0x4169[317]] = cb[_0x4169[319]];
1742:     }
1743:     var slider = preset[_0x4169[309]](_0x4169[322]);
1744:     if (slider) {
1745:       if (slider[_0x4169[315]] > 0) {
1746:         props[_0x4169[323]] = [];
1747:         for (var i = 1; i <= slider[_0x4169[315]]; i += 1) {
1748:           props[_0x4169[323]][_0x4169[84]]({
1749:             time: slider[_0x4169[340]](i),
1750:             value: slider[_0x4169[341]](slider[_0x4169[340]](i), true),
1751:           });
1752:         }
1753:       } else {
1754:         props[_0x4169[323]] = slider[_0x4169[319]];
1755:       }
1756:     } else {
1757:       props[_0x4169[323]] = 1;
1758:     }
1759:     if (numParents > 1) {
1760:       for (var i = 1; i <= numParents; i += 1) {
1761:         var curProp = preset[_0x4169[309]](_0x4169[310] + i);
1762:         if (curProp[_0x4169[319]] != 0) {
1763:           props[_0x4169[324]][_0x4169[84]](
1764:             myComp[_0x4169[302]](curProp[_0x4169[319]]),
1765:           );
1766:         } else {
1767:           props[_0x4169[324]][_0x4169[84]](null);
1768:         }
1769:       }
1770:     } else {
1771:       var curProp = preset[_0x4169[309]](_0x4169[308]);
1772:       if (curProp[_0x4169[319]] != 0) {
1773:         props[_0x4169[324]][_0x4169[84]](
1774:           myComp[_0x4169[302]](curProp[_0x4169[319]]),
1775:         );
1776:       } else {
1777:         props[_0x4169[324]][_0x4169[84]](null);
1778:       }
1779:     }
1780:     return props;
1781:   };
1782:   goodParents[_0x4169[337]] = function (
1783:     myLayer,
1784:     oldPreset,
1785:     newPresetFile,
1786:     newNumParents,
1787:     newPresetMatchName,
1788:     expressions,
1789:   ) {
1790:     var oldPreParent = goodParents[_0x4169[299]](myLayer);
1791:     if (oldPreParent) {
1792:       if (goodParents[_0x4169[306]](oldPreParent)[_0x4169[11]] != 1) {
1793:         goodParents[_0x4169[342]](myLayer, expressions);
1794:         return 0;
1795:       }
1796:       oldPreParent[_0x4169[343]] = false;
1797:       if (!oldPreParent[_0x4169[344]]) {
1798:         oldPreParent[_0x4169[344]] = true;
1799:       }
1800:       oldPreParent[_0x4169[309]](
1801:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[346]],
1802:       )[_0x4169[309]](
1803:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[347]][
1804:           _0x4169[346]
1805:         ],
1806:       )[_0x4169[345]] = false;
1807:       oldPreParent[_0x4169[309]](
1808:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1809:       )[_0x4169[309]](
1810:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
1811:           _0x4169[346]
1812:         ],
1813:       )[_0x4169[345]] = false;
1814:       oldPreParent[_0x4169[309]](
1815:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1816:       )[_0x4169[309]](
1817:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[350]][
1818:           _0x4169[346]
1819:         ],
1820:       )[_0x4169[345]] = false;
1821:       oldPreParent[_0x4169[309]](
1822:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1823:       )[_0x4169[309]](
1824:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[351]][
1825:           _0x4169[346]
1826:         ],
1827:       )[_0x4169[345]] = false;
1828:       oldPreParent[_0x4169[309]](
1829:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1830:       )[_0x4169[309]](
1831:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[352]][
1832:           _0x4169[346]
1833:         ],
1834:       )[_0x4169[345]] = false;
1835:     }
1836:     var presetPrefix = _0x4169[353];
1837:     var oldNumParents = goodParents[_0x4169[307]](oldPreset);
1838:     var effects = myLayer[_0x4169[309]](
1839:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[354]][_0x4169[346]],
1840:     );
1841:     if (oldNumParents != newNumParents) {
1842:       var parents = [];
1843:       if (oldNumParents > 1) {
1844:         for (var i = 1; i <= oldNumParents; i += 1) {
1845:           var curParent = oldPreset[_0x4169[309]](_0x4169[310] + i);
1846:           parents[_0x4169[84]](curParent[_0x4169[319]]);
1847:         }
1848:         var oldSlider = oldPreset[_0x4169[309]](_0x4169[322]);
1849:         var oldSliderKeys = [];
1850:         for (var i = 1; i <= oldSlider[_0x4169[315]]; i += 1) {
1851:           oldSliderKeys[_0x4169[84]]({
1852:             time: oldSlider[_0x4169[340]](i),
1853:             value: oldSlider[_0x4169[341]](oldSlider[_0x4169[340]](i), true),
1854:           });
1855:         }
1856:         if (oldSlider[_0x4169[315]] == 0) {
1857:           var oldSliderValue = oldSlider[_0x4169[319]];
1858:         }
1859:         var oldSliderExpression = oldSlider[_0x4169[355]];
1860:         var oldSliderExpressionEnabled = oldSlider[_0x4169[345]];
1861:       } else {
1862:         parents[_0x4169[84]](
1863:           oldPreset[_0x4169[309]](_0x4169[308])[_0x4169[319]],
1864:         );
1865:       }
1866:       var oldCB = oldPreset[_0x4169[309]](_0x4169[314]);
1867:       var oldCBKeys = [];
1868:       for (var i = 1; i <= oldCB[_0x4169[315]]; i += 1) {
1869:         oldCBKeys[_0x4169[84]]({
1870:           time: oldCB[_0x4169[340]](i),
1871:           value: oldCB[_0x4169[341]](oldCB[_0x4169[340]](i), true),
1872:         });
1873:       }
1874:       if (oldCB[_0x4169[315]] == 0) {
1875:         var oldCBValue = oldCB[_0x4169[319]];
1876:       }
1877:       var oldCBExpression = oldCB[_0x4169[355]];
1878:       var oldCBExpressionEnabled = oldCB[_0x4169[345]];
1879:       if (newNumParents < oldNumParents && oldNumParents > 1) {
1880:         for (var i = 0; i < oldSliderKeys[_0x4169[11]]; i += 1) {
1881:           var curKey = oldSliderKeys[i];
1882:           if (curKey[_0x4169[319]] > newNumParents) {
1883:             oldSliderKeys[_0x4169[356]](i, 1);
1884:           }
1885:         }
1886:       }
1887:       var checkStr = _0x4169[353];
1888:       for (var i = effects[_0x4169[357]]; i >= 1; i--) {
1889:         var curEffect = effects[_0x4169[309]](i);
1890:         if (
1891:           curEffect[_0x4169[334]][_0x4169[38]](0, checkStr[_0x4169[11]]) ==
1892:           checkStr
1893:         ) {
1894:           curEffect[_0x4169[111]]();
1895:         }
1896:       }
1897:       goodParents[_0x4169[311]](myLayer[_0x4169[300]]);
1898:       myLayer[_0x4169[312]] = true;
1899:       myLayer[_0x4169[358]](newPresetFile);
1900:       var newPreset = myLayer[_0x4169[309]](
1901:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[354]][_0x4169[346]],
1902:       )[_0x4169[309]](newPresetMatchName);
1903:       newPreset[_0x4169[220]] = _0x4169[1];
1904:       var newCB = newPreset[_0x4169[309]](_0x4169[314]);
1905:       if (oldCBKeys[_0x4169[11]] > 0) {
1906:         for (var i = 0; i < oldCBKeys[_0x4169[11]]; i += 1) {
1907:           newCB[_0x4169[320]](
1908:             oldCBKeys[i][_0x4169[318]],
1909:             oldCBKeys[i][_0x4169[319]],
1910:           );
1911:         }
1912:       } else {
1913:         if (oldCBValue !== undefined) {
1914:           newCB[_0x4169[321]](oldCBValue);
1915:         }
1916:       }
1917:       newCB[_0x4169[355]] = oldCBExpression;
1918:       newCB[_0x4169[345]] = oldCBExpressionEnabled;
1919:       if (newNumParents > 1 && oldNumParents > 1) {
1920:         var newSlider = newPreset[_0x4169[309]](_0x4169[322]);
1921:         if (oldSliderKeys[_0x4169[11]] > 0) {
1922:           for (var i = 0; i < oldSliderKeys[_0x4169[11]]; i += 1) {
1923:             var curKey = oldSliderKeys[i];
1924:             newSlider[_0x4169[320]](curKey[_0x4169[318]], curKey[_0x4169[319]]);
1925:           }
1926:         } else {
1927:           if (oldSliderValue) {
1928:             newSlider[_0x4169[321]](oldSliderValue);
1929:           }
1930:         }
1931:         newSlider[_0x4169[355]] = oldSliderExpression;
1932:         newSlider[_0x4169[345]] = oldSliderExpressionEnabled;
1933:       }
1934:       if (newNumParents > 1) {
1935:         for (
1936:           var i = 0;
1937:           i < Math[_0x4169[83]](newNumParents, parents[_0x4169[11]]);
1938:           i += 1
1939:         ) {
1940:           var curParent = newPreset[_0x4169[309]](_0x4169[310] + i + 1);
1941:           curParent[_0x4169[321]](parents[i]);
1942:         }
1943:       } else {
1944:         if (parents[0]) {
1945:           newPreset[_0x4169[309]](_0x4169[308])[_0x4169[321]](parents[0]);
1946:         }
1947:       }
1948:     }
1949:     if (oldPreParent) {
1950:       oldPreParent[_0x4169[343]] = false;
1951:       var preParentText = oldPreParent[_0x4169[309]](
1952:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[346]],
1953:       )[_0x4169[309]](
1954:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[347]][
1955:           _0x4169[346]
1956:         ],
1957:       );
1958:       preParentText[_0x4169[355]] = expressions[_0x4169[359]];
1959:       oldPreParent[_0x4169[309]](
1960:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1961:       )[_0x4169[309]](
1962:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
1963:           _0x4169[346]
1964:         ],
1965:       )[_0x4169[355]] = expressions[_0x4169[348]];
1966:       oldPreParent[_0x4169[309]](
1967:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1968:       )[_0x4169[309]](
1969:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[350]][
1970:           _0x4169[346]
1971:         ],
1972:       )[_0x4169[355]] = expressions[_0x4169[350]];
1973:       oldPreParent[_0x4169[309]](
1974:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1975:       )[_0x4169[309]](
1976:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[351]][
1977:           _0x4169[346]
1978:         ],
1979:       )[_0x4169[355]] = expressions[_0x4169[351]];
1980:       oldPreParent[_0x4169[309]](
1981:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1982:       )[_0x4169[309]](
1983:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[352]][
1984:           _0x4169[346]
1985:         ],
1986:       )[_0x4169[355]] = expressions[_0x4169[352]];
1987:       oldPreParent[_0x4169[309]](
1988:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[346]],
1989:       )[_0x4169[309]](
1990:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[347]][
1991:           _0x4169[346]
1992:         ],
1993:       )[_0x4169[345]] = true;
1994:       oldPreParent[_0x4169[309]](
1995:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
1996:       )[_0x4169[309]](
1997:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
1998:           _0x4169[346]
1999:         ],
2000:       )[_0x4169[345]] = true;
2001:       oldPreParent[_0x4169[309]](
2002:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2003:       )[_0x4169[309]](
2004:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[350]][
2005:           _0x4169[346]
2006:         ],
2007:       )[_0x4169[345]] = true;
2008:       oldPreParent[_0x4169[309]](
2009:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2010:       )[_0x4169[309]](
2011:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[351]][
2012:           _0x4169[346]
2013:         ],
2014:       )[_0x4169[345]] = true;
2015:       oldPreParent[_0x4169[309]](
2016:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2017:       )[_0x4169[309]](
2018:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[352]][
2019:           _0x4169[346]
2020:         ],
2021:       )[_0x4169[345]] = true;
2022:       oldPreParent[_0x4169[343]] = true;
2023:     } else {
2024:       goodParents[_0x4169[342]](myLayer, expressions);
2025:     }
2026:     return newPreset || oldPreset;
2027:   };
2028:   goodParents[_0x4169[331]] = function (layer) {
2029:     var layerEffects = layer[_0x4169[309]](
2030:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[354]][_0x4169[346]],
2031:     );
2032:     var checkStr = _0x4169[353];
2033:     for (var i = 1; i <= layerEffects[_0x4169[357]]; i += 1) {
2034:       var curEffect = layerEffects[_0x4169[309]](i);
2035:       if (
2036:         curEffect[_0x4169[334]][_0x4169[38]](0, checkStr[_0x4169[11]]) ==
2037:         checkStr
2038:       ) {
2039:         return curEffect;
2040:       }
2041:     }
2042:     return false;
2043:   };
2044:   goodParents[_0x4169[342]] = function (curChild, expressions) {
2045:     var myComp = curChild[_0x4169[300]];
2046:     var preParent = myComp[_0x4169[361]][_0x4169[360]](
2047:       goodParents[_0x4169[297]],
2048:     );
2049:     preParent[_0x4169[183]] = false;
2050:     preParent[_0x4169[220]] = curChild[_0x4169[220]] + _0x4169[362];
2051:     preParent[_0x4169[363]] = true;
2052:     preParent[_0x4169[364]] = 0;
2053:     preParent[_0x4169[344]] = true;
2054:     var childPos = curChild[_0x4169[309]](
2055:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2056:     )[_0x4169[309]](
2057:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
2058:         _0x4169[346]
2059:       ],
2060:     );
2061:     preParent[_0x4169[309]](
2062:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2063:     )
2064:       [_0x4169[309]](
2065:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
2066:           _0x4169[346]
2067:         ],
2068:       )
2069:       [_0x4169[321]](childPos[_0x4169[341]](0, false));
2070:     curChild[_0x4169[305]] = preParent;
2071:     preParent[_0x4169[365]](curChild);
2072:     preParent[_0x4169[309]](
2073:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2074:     )
2075:       [_0x4169[309]](
2076:         goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[366]][
2077:           _0x4169[346]
2078:         ],
2079:       )
2080:       [_0x4169[321]](0);
2081:     var preParentText = preParent[_0x4169[309]](
2082:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[346]],
2083:     )[_0x4169[309]](
2084:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[181]][_0x4169[347]][
2085:         _0x4169[346]
2086:       ],
2087:     );
2088:     var textDoc = preParentText[_0x4169[319]];
2089:     textDoc[_0x4169[367]]();
2090:     preParentText[_0x4169[321]](textDoc);
2091:     preParentText[_0x4169[355]] = expressions[_0x4169[359]];
2092:     preParent[_0x4169[309]](
2093:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2094:     )[_0x4169[309]](
2095:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[348]][
2096:         _0x4169[346]
2097:       ],
2098:     )[_0x4169[355]] = expressions[_0x4169[348]];
2099:     preParent[_0x4169[309]](
2100:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2101:     )[_0x4169[309]](
2102:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[350]][
2103:         _0x4169[346]
2104:       ],
2105:     )[_0x4169[355]] = expressions[_0x4169[350]];
2106:     preParent[_0x4169[309]](
2107:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2108:     )[_0x4169[309]](
2109:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[351]][
2110:         _0x4169[346]
2111:       ],
2112:     )[_0x4169[355]] = expressions[_0x4169[351]];
2113:     preParent[_0x4169[309]](
2114:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[346]],
2115:     )[_0x4169[309]](
2116:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[349]][_0x4169[352]][
2117:         _0x4169[346]
2118:       ],
2119:     )[_0x4169[355]] = expressions[_0x4169[352]];
2120:     preParent[_0x4169[303]] = goodParents[_0x4169[297]];
2121:     preParent[_0x4169[343]] = true;
2122:     return preParent;
2123:   };
2124:   goodParents[_0x4169[335]] = function (layer, presetFile, effectMatchName) {
2125:     goodParents[_0x4169[311]](layer[_0x4169[300]]);
2126:     layer[_0x4169[312]] = true;
2127:     layer[_0x4169[358]](presetFile);
2128:     var presetEffect = layer[_0x4169[309]](
2129:       goodParents[_0x4169[294]][_0x4169[302]][_0x4169[354]][_0x4169[346]],
2130:     )[_0x4169[309]](effectMatchName);
2131:     if (!presetEffect) {
2132:       throw new Error(_0x4169[368] + layer[_0x4169[220]] + _0x4169[369]);
2133:     }
2134:     var parentProperty = presetEffect[_0x4169[309]](_0x4169[370]);
2135:     if (!parentProperty) {
2136:       parentProperty = presetEffect[_0x4169[309]](_0x4169[308]);
2137:     }
2138:     if (layer[_0x4169[305]] != null) {
2139:       parentProperty[_0x4169[321]](layer[_0x4169[305]][_0x4169[304]]);
2140:     }
2141:     layer[_0x4169[305]] = null;
2142:     var newExpressions = goodParents[_0x4169[336]](effectMatchName);
2143:     var preParent = goodParents[_0x4169[342]](layer, newExpressions);
2144:     return presetEffect;
2145:   };
2146:   goodParents[_0x4169[371]] = function (
2147:     myComp,
2148:     presetFile,
2149:     effectMatchName,
2150:     numParents,
2151:   ) {
2152:     var expressions = goodParents[_0x4169[336]](effectMatchName);
2153:     var childLayers = [];
2154:     for (var i = 0; i < myComp[_0x4169[330]][_0x4169[11]]; i += 1) {
2155:       childLayers[_0x4169[84]](myComp[_0x4169[330]][i]);
2156:     }
2157:     for (var i = 0; i < childLayers[_0x4169[11]]; i += 1) {
2158:       var curChild = childLayers[i];
2159:       var prevParentPreset = goodParents[_0x4169[331]](curChild);
2160:       if (prevParentPreset) {
2161:         try {
2162:           goodParents[_0x4169[337]](
2163:             curChild,
2164:             prevParentPreset,
2165:             presetFile,
2166:             numParents,
2167:             effectMatchName,
2168:             expressions,
2169:           );
2170:         } catch (e) {
2171:           throw new Error(_0x4169[372] + myLayer[_0x4169[220]] + _0x4169[373]);
2172:         }
2173:       } else {
2174:         goodParents[_0x4169[335]](curChild, presetFile, effectMatchName);
2175:       }
2176:     }
2177:     for (var i = myComp[_0x4169[330]][_0x4169[11]] - 1; i >= 0; i--) {
2178:       myComp[_0x4169[330]][i][_0x4169[312]] = false;
2179:     }
2180:     for (var i = 0; i < childLayers[_0x4169[11]]; i += 1) {
2181:       childLayers[i][_0x4169[312]] = true;
2182:     }
2183:   };
2184:   goodParents[_0x4169[336]] = function (effectMatchName) {
2185:     var expressions = {};
2186:     for (var key in goodParents[_0x4169[286]]) {
2187:       if (!(goodParents[_0x4169[286]][key] instanceof Function)) {
2188:         if (key == _0x4169[359]) {
2189:           expressions[key] =
2190:             _0x4169[374] +
2191:             _0x4169[375] +
2192:             effectMatchName +
2193:             _0x4169[376] +
2194:             goodParents[_0x4169[286]][key];
2195:         } else {
2196:           expressions[key] =
2197:             _0x4169[375] +
2198:             effectMatchName +
2199:             _0x4169[376] +
2200:             goodParents[_0x4169[286]][key];
2201:         }
2202:       }
2203:     }
2204:     return expressions;
2205:   };
2206:   goodParents[_0x4169[326]] = function () {
2207:     var myComp = app[_0x4169[378]][_0x4169[377]];
2208:     if (!myComp) {
2209:       return null;
2210:     }
2211:     if (!(myComp instanceof CompItem)) {
2212:       return null;
2213:     }
2214:     return myComp;
2215:   };
2216:   goodParents[_0x4169[332]] = function (numParents) {
2217:     var customPreset = [];
2218:     customPreset[_0x4169[84]]([_0x4169[5], _0x4169[1]]);
2219:     customPreset[_0x4169[84]]([
2220:       _0x4169[33],
2221:       _0x4169[314],
2222:       false,
2223:       1,
2224:       false,
2225:       _0x4169[21],
2226:     ]);
2227:     if (numParents > 1) {
2228:       customPreset[_0x4169[84]]([_0x4169[54], _0x4169[379], false]);
2229:       for (var i = 1; i <= numParents; i += 1) {
2230:         customPreset[_0x4169[84]]([
2231:           _0x4169[50],
2232:           _0x4169[310] + i,
2233:           false,
2234:           false,
2235:         ]);
2236:       }
2237:       customPreset[_0x4169[84]]([_0x4169[29]]);
2238:       customPreset[_0x4169[84]]([
2239:         _0x4169[46],
2240:         _0x4169[322],
2241:         false,
2242:         1,
2243:         1,
2244:         1,
2245:         1,
2246:         numParents,
2247:         numParents,
2248:         0,
2249:         true,
2250:       ]);
2251:     } else {
2252:       customPreset[_0x4169[84]]([_0x4169[50], _0x4169[308], false, false]);
2253:     }
2254:     var effectMatchName = _0x4169[380] + numParents;
2255:     var preset = goodParents[_0x4169[4]](customPreset, effectMatchName);
2256:     var presetString = preset[_0x4169[381]];
2257:     effectMatchName = preset[_0x4169[346]];
2258:     var presetFile = new File(
2259:       Folder[_0x4169[196]][_0x4169[195]] + _0x4169[382],
2260:     );
2261:     if (presetFile[_0x4169[383]]) {
2262:       presetFile[_0x4169[111]]();
2263:     }
2264:     if (!presetFile[_0x4169[383]]) {
2265:       presetFile[_0x4169[102]] = _0x4169[384];
2266:       presetFile[_0x4169[105]](_0x4169[104]);
2267:       presetFile[_0x4169[106]](decodeURIComponent(presetString));
2268:       presetFile[_0x4169[110]]();
2269:     }
2270:     return { file: presetFile, matchName: effectMatchName };
2271:   };
2272:   goodParents[_0x4169[241]] = function (numParents) {
2273:     var myComp = goodParents[_0x4169[326]]();
2274:     if (myComp) {
2275:       var scriptFile = new File($[_0x4169[385]]);
2276:       goodParents[_0x4169[386]] = String(scriptFile[_0x4169[305]]);
2277:       if (myComp[_0x4169[330]][_0x4169[11]] != 0) {
2278:         var preset = goodParents[_0x4169[332]](numParents);
2279:         var effectMatchName = preset[_0x4169[334]];
2280:         var presetFile = preset[_0x4169[333]];
2281:         goodParents[_0x4169[371]](
2282:           myComp,
2283:           presetFile,
2284:           effectMatchName,
2285:           numParents,
2286:         );
2287:         presetFile[_0x4169[111]]();
2288:         myComp[_0x4169[338]] = true;
2289:       } else {
2290:         alert(_0x4169[387]);
2291:       }
2292:     } else {
2293:       alert(_0x4169[327]);
2294:     }
2295:   };
2296:   goodParents[_0x4169[388]] = function (thisObj) {
2297:     goodParents[_0x4169[193]](thisObj);
2298:   };
2299:   if (goodParents[_0x4169[389]]()) {
2300:     goodParents[_0x4169[388]](goodParents);
2301:   } else {
2302:     alert(_0x4169[390]);
2303:   }
2304: })(this);
```

## File: Aescripts-Origami v1.4.0/(Origami_packages)/basicSlice.jsx
```javascript
  1: /*
  2:  * Decompiled with Jsxer
  3:  * Version: 1.7.4
  4:  * JSXBIN 2.0
  5:  */
  6: 
  7: origami.voronoiSlice = function (poly, pointCount) {
  8:   var bbox = poly.boundingBox;
  9:   bbox = {
 10:     xl: bbox[0][0] - 20,
 11:     xr: bbox[1][0] + 20,
 12:     yb: bbox[1][1] + 20,
 13:     yt: bbox[0][1] - 20,
 14:   };
 15:   if (pointCount) {
 16:     randPoints = poly.genRandomPoints(pointCount);
 17:   }
 18:   var voronoiVertices = poly.vertices.map(function (o) {
 19:     return { x: o.x, y: o.y };
 20:   });
 21:   randPoints = randPoints.map(function (o) {
 22:     return { x: o.x, y: o.y };
 23:   });
 24:   var polyVertices = poly.vertices.map(function (o) {
 25:     return { x: o.x, y: o.y };
 26:   });
 27:   voronoiVertices = voronoiVertices.concat(randPoints);
 28:   var voronoi = new Voronoi();
 29:   result = voronoi.compute(voronoiVertices, bbox);
 30:   var prePolygons = result.cells.map(function (o) {
 31:     return o.halfedges.map(function (r) {
 32:       return [r.getStartpoint().x, r.getStartpoint().y];
 33:     });
 34:   });
 35:   var resulted = [];
 36:   for (var p = 0; p < prePolygons.length; p += 1) {
 37:     origami.writeln("P " + p);
 38:     var res = greinerHormann.intersection(prePolygons[p], polyVertices);
 39:     origami.writeln("ClippingPoly is: ");
 40:     for (var i = 0; i < polyVertices.length; i += 1) {
 41:       origami.writeln("## " + polyVertices[i].x + " " + polyVertices[i].y);
 42:     }
 43:     origami.writeln("Resulted Polygon after clipping: ");
 44:     for (var k = 0; k < res.length; k += 1) {
 45:       for (var i = 0; i < res[k].length; i += 1) {
 46:         origami.writeln(">> " + res[k][i][0] + " " + res[k][i][1]);
 47:       }
 48:     }
 49:     origami.writeln("Before clipping was: ");
 50:     for (var i = 0; i < prePolygons[p].length; i += 1) {
 51:       origami.writeln(
 52:         "-- " + prePolygons[p][i][0] + " " + prePolygons[p][i][1],
 53:       );
 54:     }
 55:     for (var k = 0; k < res.length; k += 1) {
 56:       resulted.push(res[k]);
 57:     }
 58:   }
 59:   polygons = resulted;
 60:   return polygons;
 61: };
 62: origami.delauneySlice = function (poly, pointCount) {
 63:   if (poly instanceof Array) {
 64:     holes = poly[1];
 65:     holes = holes.map(function (o) {
 66:       return o.vertices;
 67:     });
 68:     poly = poly[0];
 69:     vertices = poly.vertices;
 70:   } else {
 71:     vertices = poly.vertices;
 72:     holes = [];
 73:   }
 74:   if (vertices && vertices.length > 2) {
 75:     if (pointCount) {
 76:       randPoints = poly.genRandomPoints(pointCount);
 77:     }
 78:     var contour = vertices.map(function (o) {
 79:       return new poly2tri.Point(o.x, o.y);
 80:     });
 81:     var swctx = new poly2tri.SweepContext(contour);
 82:     if (randPoints.length > 0) {
 83:       var points = randPoints.map(function (o) {
 84:         return new poly2tri.Point(o.x, o.y);
 85:       });
 86:       for (var p = 0; p < points.length; p += 1) {
 87:         swctx.addPoint(points[p]);
 88:       }
 89:     }
 90:     if (holes.length > 0) {
 91:       var holesArray = [];
 92:       for (var h = 0; h < holes.length; h += 1) {
 93:         swctx.addHole(
 94:           holes[h].map(function (o) {
 95:             return new poly2tri.Point(o.x, o.y);
 96:           }),
 97:         );
 98:       }
 99:     }
100:     swctx.triangulate();
101:     var polygons = swctx.getTriangles();
102:     polygons = polygons.map(function (o) {
103:       return [
104:         [o.getPoint(0).x, o.getPoint(0).y],
105:         [o.getPoint(1).x, o.getPoint(1).y],
106:         [o.getPoint(2).x, o.getPoint(2).y],
107:       ];
108:     });
109:   }
110:   return polygons;
111: };
112: origami.trianglesOneSlice = function (poly, pointCount) {
113:   var polyVertices = poly.vertices.map(function (o) {
114:     return { x: o.x, y: o.y };
115:   });
116:   var prePolygons = [];
117:   var bbox = poly.boundingBox;
118:   bbox = [
119:     [bbox[0][0] - 0.1, bbox[0][1] - 0.1],
120:     [bbox[1][0] + 0.1, bbox[1][1] + 0.1],
121:   ];
122:   var polyLenght = bbox[1][0] - bbox[0][0];
123:   var polyHeight = bbox[1][1] - bbox[0][1];
124:   var sq = Math.ceil((polyLenght * polyHeight) / pointCount);
125:   var size = Math.ceil(Math.sqrt(sq));
126:   var lines = Math.ceil(polyHeight / size);
127:   var cols = Math.ceil(polyLenght / size) * 2;
128:   var triangleTypes = [1, 3, 4, 2];
129:   for (var line = 0; line < lines; line += 1) {
130:     for (var col = 0; col < cols; col += 1) {
131:       var type = triangleTypes[(col + 2 * (line % 2)) % 4];
132:       var shift = [Math.floor(col / 2) * size, line * size];
133:       var vertices = [
134:         bbox[0] + [0, 0] + shift,
135:         bbox[0] + [size, 0] + shift,
136:         bbox[0] + [size, size] + shift,
137:         bbox[0] + [0, size] + shift,
138:       ];
139:       vertices.splice(type - 1, 1);
140:       prePolygons.push(vertices);
141:     }
142:   }
143:   var polygons = [];
144:   for (var p = 0; p < prePolygons.length; p += 1) {
145:     var res = greinerHormann.intersection(prePolygons[p], polyVertices);
146:     if (res != null) {
147:       res.map(function (o) {
148:         polygons.push(o);
149:       });
150:     }
151:   }
152:   return polygons;
153: };
154: origami.trianglesTwoSlice = function (poly, pointCount) {
155:   var polyVertices = poly.vertices.map(function (o) {
156:     return { x: o.x, y: o.y };
157:   });
158:   var prePolygons = [];
159:   var bbox = poly.boundingBox;
160:   bbox = [
161:     [bbox[0][0] - 0.1, bbox[0][1] - 0.1],
162:     [bbox[1][0] + 0.1, bbox[1][1] + 0.1],
163:   ];
164:   var polyLenght = bbox[1][0] - bbox[0][0];
165:   var polyHeight = bbox[1][1] - bbox[0][1];
166:   var sq = Math.ceil((polyLenght * polyHeight) / pointCount);
167:   var size = Math.ceil(Math.sqrt(sq));
168:   var lines = Math.ceil(polyHeight / size);
169:   var cols = Math.ceil(polyLenght / size) * 2;
170:   var triangleTypes = [1, 3, 1, 3];
171:   for (var line = 0; line < lines; line += 1) {
172:     for (var col = 0; col < cols; col += 1) {
173:       var type = triangleTypes[(col + 2 * (line % 2)) % 4];
174:       var shift = [Math.floor(col / 2) * size, line * size];
175:       var vertices = [
176:         bbox[0] + [0, 0] + shift,
177:         bbox[0] + [size, 0] + shift,
178:         bbox[0] + [size, size] + shift,
179:         bbox[0] + [0, size] + shift,
180:       ];
181:       vertices.splice(type - 1, 1);
182:       prePolygons.push(vertices);
183:     }
184:   }
185:   var polygons = [];
186:   for (var p = 0; p < prePolygons.length; p += 1) {
187:     var res = greinerHormann.intersection(prePolygons[p], polyVertices);
188:     if (res != null) {
189:       res.map(function (o) {
190:         polygons.push(o);
191:       });
192:     }
193:   }
194:   return polygons;
195: };
196: origami.squaresSlice = function (poly, pointCount) {
197:   var polyVertices = poly.vertices.map(function (o) {
198:     return { x: o.x, y: o.y };
199:   });
200:   var prePolygons = [];
201:   var bbox = poly.boundingBox;
202:   bbox = [
203:     [bbox[0][0] - 0.1, bbox[0][1] - 0.1],
204:     [bbox[1][0] + 0.1, bbox[1][1] + 0.1],
205:   ];
206:   var polyLenght = bbox[1][0] - bbox[0][0];
207:   var polyHeight = bbox[1][1] - bbox[0][1];
208:   var sq = (polyLenght * polyHeight) / pointCount;
209:   var size = Math.round(Math.sqrt(sq) * 100) / 100;
210:   var lines = Math.ceil(polyHeight / size);
211:   var cols = Math.ceil(polyLenght / size);
212:   for (var line = 0; line < lines; line += 1) {
213:     for (var col = 0; col < cols; col += 1) {
214:       var shift = [col * size, line * size];
215:       var vertices = [
216:         bbox[0] + [0, 0] + shift,
217:         bbox[0] + [size, 0] + shift,
218:         bbox[0] + [size, size] + shift,
219:         bbox[0] + [0, size] + shift,
220:       ];
221:       prePolygons.push(vertices);
222:     }
223:   }
224:   var polygons = [];
225:   for (var p = 0; p < prePolygons.length; p += 1) {
226:     var res = greinerHormann.intersection(prePolygons[p], polyVertices);
227:     if (res != null) {
228:       res.map(function (o) {
229:         polygons.push(o);
230:       });
231:     }
232:   }
233:   return polygons;
234: };
235: origami.sliceAlgorithms = {
236:   slice0: { name: "Triangulation", slicer: origami.delauneySlice },
237:   slice1: { name: "Voronoi", slicer: origami.voronoiSlice },
238:   slice2: { name: "Regular Trianges - 1", slicer: origami.trianglesOneSlice },
239:   slice3: { name: "Regular Triangles - 2", slicer: origami.trianglesTwoSlice },
240:   slice4: { name: "Squares", slicer: origami.squaresSlice },
241: };
```

## File: Aescripts-Origami v1.4.0/Origami.jsx
```javascript
    1: /*
    2:  * Decompiled with Jsxer
    3:  * Version: 1.7.4
    4:  * JSXBIN 2.0
    5:  */
    6: 
    7: function triangulate(tcx) {
    8:   tcx.initTriangulation();
    9:   tcx.createAdvancingFront();
   10:   sweepPoints(tcx);
   11:   finalizationPolygon(tcx);
   12: }
   13: function sweepPoints(tcx) {
   14:   var len = tcx.pointCount();
   15:   for (var i = 1; i < len; i += 1) {
   16:     var point = tcx.getPoint(i);
   17:     var node = pointEvent(tcx, point);
   18:     var edges = point._p2t_edge_list;
   19:     for (var j = 0; edges && j < edges.length; ++j) {
   20:       edgeEventByEdge(tcx, edges[j], node);
   21:     }
   22:   }
   23: }
   24: function finalizationPolygon(tcx) {
   25:   var t = tcx.front().head().next.triangle;
   26:   var p = tcx.front().head().next.point;
   27:   while (!t.getConstrainedEdgeCW(p)) {
   28:     t = t.neighborCCW(p);
   29:   }
   30:   tcx.meshClean(t);
   31: }
   32: function pointEvent(tcx, point) {
   33:   var node = tcx.locateNode(point);
   34:   var new_node = newFrontTriangle(tcx, point, node);
   35:   if (point.x <= node.point.x + EPSILON) {
   36:     fill(tcx, node);
   37:   }
   38:   fillAdvancingFront(tcx, new_node);
   39:   return new_node;
   40: }
   41: function edgeEventByEdge(tcx, edge, node) {
   42:   tcx.edge_event.constrained_edge = edge;
   43:   tcx.edge_event.right = edge.p.x > edge.q.x;
   44:   if (isEdgeSideOfTriangle(node.triangle, edge.p, edge.q)) {
   45:     return;
   46:   }
   47:   fillEdgeEvent(tcx, edge, node);
   48:   edgeEventByPoints(tcx, edge.p, edge.q, node.triangle, edge.q);
   49: }
   50: function edgeEventByPoints(tcx, ep, eq, triangle, point) {
   51:   if (isEdgeSideOfTriangle(triangle, ep, eq)) {
   52:     return;
   53:   }
   54:   var p1 = triangle.pointCCW(point);
   55:   var o1 = orient2d(eq, p1, ep);
   56:   if (o1 === Orientation.COLLINEAR) {
   57:     throw new PointError("poly2tri EdgeEvent: Collinear not supported!", [
   58:       eq,
   59:       p1,
   60:       ep,
   61:     ]);
   62:   }
   63:   var p2 = triangle.pointCW(point);
   64:   var o2 = orient2d(eq, p2, ep);
   65:   if (o2 === Orientation.COLLINEAR) {
   66:     throw new PointError("poly2tri EdgeEvent: Collinear not supported!", [
   67:       eq,
   68:       p2,
   69:       ep,
   70:     ]);
   71:   }
   72:   if (o1 === o2) {
   73:     if (o1 === Orientation.CW) {
   74:       triangle = triangle.neighborCCW(point);
   75:     } else {
   76:       triangle = triangle.neighborCW(point);
   77:     }
   78:     edgeEventByPoints(tcx, ep, eq, triangle, point);
   79:   } else {
   80:     flipEdgeEvent(tcx, ep, eq, triangle, point);
   81:   }
   82: }
   83: function isEdgeSideOfTriangle(triangle, ep, eq) {
   84:   var index = triangle.edgeIndex(ep, eq);
   85:   if (index !== -1) {
   86:     triangle.markConstrainedEdgeByIndex(index);
   87:     var t = triangle.getNeighbor(index);
   88:     if (t) {
   89:       t.markConstrainedEdgeByPoints(ep, eq);
   90:     }
   91:     return true;
   92:   }
   93:   return false;
   94: }
   95: function newFrontTriangle(tcx, point, node) {
   96:   var triangle = new Triangle(point, node.point, node.next.point);
   97:   triangle.markNeighbor(node.triangle);
   98:   tcx.addToMap(triangle);
   99:   var new_node = new Node(point);
  100:   new_node.next = node.next;
  101:   new_node.prev = node;
  102:   node.next.prev = new_node;
  103:   node.next = new_node;
  104:   if (!legalize(tcx, triangle)) {
  105:     tcx.mapTriangleToNodes(triangle);
  106:   }
  107:   return new_node;
  108: }
  109: function fill(tcx, node) {
  110:   var triangle = new Triangle(node.prev.point, node.point, node.next.point);
  111:   triangle.markNeighbor(node.prev.triangle);
  112:   triangle.markNeighbor(node.triangle);
  113:   tcx.addToMap(triangle);
  114:   node.prev.next = node.next;
  115:   node.next.prev = node.prev;
  116:   if (!legalize(tcx, triangle)) {
  117:     tcx.mapTriangleToNodes(triangle);
  118:   }
  119: }
  120: function fillAdvancingFront(tcx, n) {
  121:   var node = n.next;
  122:   while (node.next) {
  123:     angle = holeAngle(node);
  124:     if (angle > PI_div2 || angle < -PI_div2) {
  125:       break;
  126:     }
  127:     fill(tcx, node);
  128:     node = node.next;
  129:   }
  130:   node = n.prev;
  131:   while (node.prev) {
  132:     angle = holeAngle(node);
  133:     if (angle > PI_div2 || angle < -PI_div2) {
  134:       break;
  135:     }
  136:     fill(tcx, node);
  137:     node = node.prev;
  138:   }
  139:   if (n.next && n.next.next) {
  140:     angle = basinAngle(n);
  141:     if (angle < PI_3div4) {
  142:       fillBasin(tcx, n);
  143:     }
  144:   }
  145: }
  146: function basinAngle(node) {
  147:   var ax = node.point.x - node.next.next.point.x;
  148:   var ay = node.point.y - node.next.next.point.y;
  149:   return Math.atan2(ay, ax);
  150: }
  151: function holeAngle(node) {
  152:   var ax = node.next.point.x - node.point.x;
  153:   var ay = node.next.point.y - node.point.y;
  154:   var bx = node.prev.point.x - node.point.x;
  155:   var by = node.prev.point.y - node.point.y;
  156:   return Math.atan2(ax * by - ay * bx, ax * bx + ay * by);
  157: }
  158: function legalize(tcx, t) {
  159:   for (var i = 0; i < 3; i += 1) {
  160:     if (t.delaunay_edge[i]) {
  161:       continue;
  162:     }
  163:     var ot = t.getNeighbor(i);
  164:     if (ot) {
  165:       var p = t.getPoint(i);
  166:       var op = ot.oppositePoint(t, p);
  167:       var oi = ot.index(op);
  168:       if (ot.constrained_edge[oi] || ot.delaunay_edge[oi]) {
  169:         t.constrained_edge[i] = ot.constrained_edge[oi];
  170:         continue;
  171:       }
  172:       var inside = inCircle(p, t.pointCCW(p), t.pointCW(p), op);
  173:       if (inside) {
  174:         t.delaunay_edge[i] = true;
  175:         ot.delaunay_edge[oi] = true;
  176:         rotateTrianglePair(t, p, ot, op);
  177:         var not_legalized = !legalize(tcx, t);
  178:         if (not_legalized) {
  179:           tcx.mapTriangleToNodes(t);
  180:         }
  181:         not_legalized = !legalize(tcx, ot);
  182:         if (not_legalized) {
  183:           tcx.mapTriangleToNodes(ot);
  184:         }
  185:         t.delaunay_edge[i] = false;
  186:         ot.delaunay_edge[oi] = false;
  187:         return true;
  188:       }
  189:     }
  190:   }
  191:   return false;
  192: }
  193: function inCircle(pa, pb, pc, pd) {
  194:   var adx = pa.x - pd.x;
  195:   var ady = pa.y - pd.y;
  196:   var bdx = pb.x - pd.x;
  197:   var bdy = pb.y - pd.y;
  198:   var adxbdy = adx * bdy;
  199:   var bdxady = bdx * ady;
  200:   var oabd = adxbdy - bdxady;
  201:   if (oabd <= 0) {
  202:     return false;
  203:   }
  204:   var cdx = pc.x - pd.x;
  205:   var cdy = pc.y - pd.y;
  206:   var cdxady = cdx * ady;
  207:   var adxcdy = adx * cdy;
  208:   var ocad = cdxady - adxcdy;
  209:   if (ocad <= 0) {
  210:     return false;
  211:   }
  212:   var bdxcdy = bdx * cdy;
  213:   var cdxbdy = cdx * bdy;
  214:   var alift = adx * adx + ady * ady;
  215:   var blift = bdx * bdx + bdy * bdy;
  216:   var clift = cdx * cdx + cdy * cdy;
  217:   var det = alift * (bdxcdy - cdxbdy) + blift * ocad + clift * oabd;
  218:   return det > 0;
  219: }
  220: function rotateTrianglePair(t, p, ot, op) {
  221:   n1 = t.neighborCCW(p);
  222:   n2 = t.neighborCW(p);
  223:   n3 = ot.neighborCCW(op);
  224:   n4 = ot.neighborCW(op);
  225:   ce1 = t.getConstrainedEdgeCCW(p);
  226:   ce2 = t.getConstrainedEdgeCW(p);
  227:   ce3 = ot.getConstrainedEdgeCCW(op);
  228:   ce4 = ot.getConstrainedEdgeCW(op);
  229:   de1 = t.getDelaunayEdgeCCW(p);
  230:   de2 = t.getDelaunayEdgeCW(p);
  231:   de3 = ot.getDelaunayEdgeCCW(op);
  232:   de4 = ot.getDelaunayEdgeCW(op);
  233:   t.legalize(p, op);
  234:   ot.legalize(op, p);
  235:   ot.setDelaunayEdgeCCW(p, de1);
  236:   t.setDelaunayEdgeCW(p, de2);
  237:   t.setDelaunayEdgeCCW(op, de3);
  238:   ot.setDelaunayEdgeCW(op, de4);
  239:   ot.setConstrainedEdgeCCW(p, ce1);
  240:   t.setConstrainedEdgeCW(p, ce2);
  241:   t.setConstrainedEdgeCCW(op, ce3);
  242:   ot.setConstrainedEdgeCW(op, ce4);
  243:   t.clearNeigbors();
  244:   ot.clearNeigbors();
  245:   if (n1) {
  246:     ot.markNeighbor(n1);
  247:   }
  248:   if (n2) {
  249:     t.markNeighbor(n2);
  250:   }
  251:   if (n3) {
  252:     t.markNeighbor(n3);
  253:   }
  254:   if (n4) {
  255:     ot.markNeighbor(n4);
  256:   }
  257:   t.markNeighbor(ot);
  258: }
  259: function fillBasin(tcx, node) {
  260:   if (
  261:     orient2d(node.point, node.next.point, node.next.next.point) ===
  262:     Orientation.CCW
  263:   ) {
  264:     tcx.basin.left_node = node.next.next;
  265:   } else {
  266:     tcx.basin.left_node = node.next;
  267:   }
  268:   tcx.basin.bottom_node = tcx.basin.left_node;
  269:   while (
  270:     tcx.basin.bottom_node.next &&
  271:     tcx.basin.bottom_node.point.y >= tcx.basin.bottom_node.next.point.y
  272:   ) {
  273:     tcx.basin.bottom_node = tcx.basin.bottom_node.next;
  274:   }
  275:   if (tcx.basin.bottom_node === tcx.basin.left_node) {
  276:     return;
  277:   }
  278:   tcx.basin.right_node = tcx.basin.bottom_node;
  279:   while (
  280:     tcx.basin.right_node.next &&
  281:     tcx.basin.right_node.point.y < tcx.basin.right_node.next.point.y
  282:   ) {
  283:     tcx.basin.right_node = tcx.basin.right_node.next;
  284:   }
  285:   if (tcx.basin.right_node === tcx.basin.bottom_node) {
  286:     return;
  287:   }
  288:   tcx.basin.width = tcx.basin.right_node.point.x - tcx.basin.left_node.point.x;
  289:   tcx.basin.left_highest =
  290:     tcx.basin.left_node.point.y > tcx.basin.right_node.point.y;
  291:   fillBasinReq(tcx, tcx.basin.bottom_node);
  292: }
  293: function fillBasinReq(tcx, node) {
  294:   if (isShallow(tcx, node)) {
  295:     return;
  296:   }
  297:   fill(tcx, node);
  298:   if (node.prev === tcx.basin.left_node && node.next === tcx.basin.right_node) {
  299:     return;
  300:   } else if (node.prev === tcx.basin.left_node) {
  301:     o = orient2d(node.point, node.next.point, node.next.next.point);
  302:     if (o === Orientation.CW) {
  303:       return;
  304:     }
  305:     node = node.next;
  306:   } else if (node.next === tcx.basin.right_node) {
  307:     o = orient2d(node.point, node.prev.point, node.prev.prev.point);
  308:     if (o === Orientation.CCW) {
  309:       return;
  310:     }
  311:     node = node.prev;
  312:   } else {
  313:     if (node.prev.point.y < node.next.point.y) {
  314:       node = node.prev;
  315:     } else {
  316:       node = node.next;
  317:     }
  318:   }
  319:   fillBasinReq(tcx, node);
  320: }
  321: function isShallow(tcx, node) {
  322:   if (tcx.basin.left_highest) {
  323:     height = tcx.basin.left_node.point.y - node.point.y;
  324:   } else {
  325:     height = tcx.basin.right_node.point.y - node.point.y;
  326:   }
  327:   if (tcx.basin.width > height) {
  328:     return true;
  329:   }
  330:   return false;
  331: }
  332: function fillEdgeEvent(tcx, edge, node) {
  333:   if (tcx.edge_event.right) {
  334:     fillRightAboveEdgeEvent(tcx, edge, node);
  335:   } else {
  336:     fillLeftAboveEdgeEvent(tcx, edge, node);
  337:   }
  338: }
  339: function fillRightAboveEdgeEvent(tcx, edge, node) {
  340:   while (node.next.point.x < edge.p.x) {
  341:     if (orient2d(edge.q, node.next.point, edge.p) === Orientation.CCW) {
  342:       fillRightBelowEdgeEvent(tcx, edge, node);
  343:     } else {
  344:       node = node.next;
  345:     }
  346:   }
  347: }
  348: function fillRightBelowEdgeEvent(tcx, edge, node) {
  349:   if (node.point.x < edge.p.x) {
  350:     if (
  351:       orient2d(node.point, node.next.point, node.next.next.point) ===
  352:       Orientation.CCW
  353:     ) {
  354:       fillRightConcaveEdgeEvent(tcx, edge, node);
  355:     } else {
  356:       fillRightConvexEdgeEvent(tcx, edge, node);
  357:       fillRightBelowEdgeEvent(tcx, edge, node);
  358:     }
  359:   }
  360: }
  361: function fillRightConcaveEdgeEvent(tcx, edge, node) {
  362:   fill(tcx, node.next);
  363:   if (node.next.point !== edge.p) {
  364:     if (orient2d(edge.q, node.next.point, edge.p) === Orientation.CCW) {
  365:       if (
  366:         orient2d(node.point, node.next.point, node.next.next.point) ===
  367:         Orientation.CCW
  368:       ) {
  369:         fillRightConcaveEdgeEvent(tcx, edge, node);
  370:       }
  371:     }
  372:   }
  373: }
  374: function fillRightConvexEdgeEvent(tcx, edge, node) {
  375:   if (
  376:     orient2d(
  377:       node.next.point,
  378:       node.next.next.point,
  379:       node.next.next.next.point,
  380:     ) === Orientation.CCW
  381:   ) {
  382:     fillRightConcaveEdgeEvent(tcx, edge, node.next);
  383:   } else {
  384:     if (orient2d(edge.q, node.next.next.point, edge.p) === Orientation.CCW) {
  385:       fillRightConvexEdgeEvent(tcx, edge, node.next);
  386:     }
  387:   }
  388: }
  389: function fillLeftAboveEdgeEvent(tcx, edge, node) {
  390:   while (node.prev.point.x > edge.p.x) {
  391:     if (orient2d(edge.q, node.prev.point, edge.p) === Orientation.CW) {
  392:       fillLeftBelowEdgeEvent(tcx, edge, node);
  393:     } else {
  394:       node = node.prev;
  395:     }
  396:   }
  397: }
  398: function fillLeftBelowEdgeEvent(tcx, edge, node) {
  399:   if (node.point.x > edge.p.x) {
  400:     if (
  401:       orient2d(node.point, node.prev.point, node.prev.prev.point) ===
  402:       Orientation.CW
  403:     ) {
  404:       fillLeftConcaveEdgeEvent(tcx, edge, node);
  405:     } else {
  406:       fillLeftConvexEdgeEvent(tcx, edge, node);
  407:       fillLeftBelowEdgeEvent(tcx, edge, node);
  408:     }
  409:   }
  410: }
  411: function fillLeftConvexEdgeEvent(tcx, edge, node) {
  412:   if (
  413:     orient2d(
  414:       node.prev.point,
  415:       node.prev.prev.point,
  416:       node.prev.prev.prev.point,
  417:     ) === Orientation.CW
  418:   ) {
  419:     fillLeftConcaveEdgeEvent(tcx, edge, node.prev);
  420:   } else {
  421:     if (orient2d(edge.q, node.prev.prev.point, edge.p) === Orientation.CW) {
  422:       fillLeftConvexEdgeEvent(tcx, edge, node.prev);
  423:     }
  424:   }
  425: }
  426: function fillLeftConcaveEdgeEvent(tcx, edge, node) {
  427:   fill(tcx, node.prev);
  428:   if (node.prev.point !== edge.p) {
  429:     if (orient2d(edge.q, node.prev.point, edge.p) === Orientation.CW) {
  430:       if (
  431:         orient2d(node.point, node.prev.point, node.prev.prev.point) ===
  432:         Orientation.CW
  433:       ) {
  434:         fillLeftConcaveEdgeEvent(tcx, edge, node);
  435:       }
  436:     }
  437:   }
  438: }
  439: function flipEdgeEvent(tcx, ep, eq, t, p) {
  440:   var ot = t.neighborAcross(p);
  441:   if (!ot) {
  442:     throw new Error(
  443:       "poly2tri [BUG:FIXME] FLIP failed due to missing triangle!",
  444:     );
  445:   }
  446:   var op = ot.oppositePoint(t, p);
  447:   if (t.getConstrainedEdgeAcross(p)) {
  448:     var index = t.index(p);
  449:     throw new PointError("poly2tri Intersecting Constraints", [
  450:       p,
  451:       op,
  452:       t.getPoint((index + 1) % 3),
  453:       t.getPoint((index + 2) % 3),
  454:     ]);
  455:   }
  456:   if (inScanArea(p, t.pointCCW(p), t.pointCW(p), op)) {
  457:     rotateTrianglePair(t, p, ot, op);
  458:     tcx.mapTriangleToNodes(t);
  459:     tcx.mapTriangleToNodes(ot);
  460:     if (p === eq && op === ep) {
  461:       if (
  462:         eq === tcx.edge_event.constrained_edge.q &&
  463:         ep === tcx.edge_event.constrained_edge.p
  464:       ) {
  465:         t.markConstrainedEdgeByPoints(ep, eq);
  466:         ot.markConstrainedEdgeByPoints(ep, eq);
  467:         legalize(tcx, t);
  468:         legalize(tcx, ot);
  469:       }
  470:     } else {
  471:       var o = orient2d(eq, op, ep);
  472:       t = nextFlipTriangle(tcx, o, t, ot, p, op);
  473:       flipEdgeEvent(tcx, ep, eq, t, p);
  474:     }
  475:   } else {
  476:     var newP = nextFlipPoint(ep, eq, ot, op);
  477:     flipScanEdgeEvent(tcx, ep, eq, t, ot, newP);
  478:     edgeEventByPoints(tcx, ep, eq, t, p);
  479:   }
  480: }
  481: function nextFlipTriangle(tcx, o, t, ot, p, op) {
  482:   if (o === Orientation.CCW) {
  483:     edge_index = ot.edgeIndex(p, op);
  484:     ot.delaunay_edge[edge_index] = true;
  485:     legalize(tcx, ot);
  486:     ot.clearDelunayEdges();
  487:     return t;
  488:   }
  489:   edge_index = t.edgeIndex(p, op);
  490:   t.delaunay_edge[edge_index] = true;
  491:   legalize(tcx, t);
  492:   t.clearDelunayEdges();
  493:   return ot;
  494: }
  495: function nextFlipPoint(ep, eq, ot, op) {
  496:   var o2d = orient2d(eq, op, ep);
  497:   if (o2d === Orientation.CW) {
  498:     return ot.pointCCW(op);
  499:   } else if (o2d === Orientation.CCW) {
  500:     return ot.pointCW(op);
  501:   } else {
  502:     throw new PointError(
  503:       "poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",
  504:       [eq, op, ep],
  505:     );
  506:   }
  507: }
  508: function flipScanEdgeEvent(tcx, ep, eq, flip_triangle, t, p) {
  509:   var ot = t.neighborAcross(p);
  510:   if (!ot) {
  511:     throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle");
  512:   }
  513:   var op = ot.oppositePoint(t, p);
  514:   if (
  515:     inScanArea(eq, flip_triangle.pointCCW(eq), flip_triangle.pointCW(eq), op)
  516:   ) {
  517:     flipEdgeEvent(tcx, eq, op, ot, op);
  518:   } else {
  519:     var newP = nextFlipPoint(ep, eq, ot, op);
  520:     flipScanEdgeEvent(tcx, ep, eq, flip_triangle, ot, newP);
  521:   }
  522: }
  523: function orient2d(pa, pb, pc) {
  524:   var detleft = (pa.x - pc.x) * (pb.y - pc.y);
  525:   var detright = (pa.y - pc.y) * (pb.x - pc.x);
  526:   var val = detleft - detright;
  527:   if (val > -EPSILON && val < EPSILON) {
  528:     return Orientation.COLLINEAR;
  529:   } else if (val > 0) {
  530:     return Orientation.CCW;
  531:   } else {
  532:     return Orientation.CW;
  533:   }
  534: }
  535: function inScanArea(pa, pb, pc, pd) {
  536:   var oadb = (pa.x - pb.x) * (pd.y - pb.y) - (pd.x - pb.x) * (pa.y - pb.y);
  537:   if (oadb >= -EPSILON) {
  538:     return false;
  539:   }
  540:   var oadc = (pa.x - pc.x) * (pd.y - pc.y) - (pd.x - pc.x) * (pa.y - pc.y);
  541:   if (oadc <= EPSILON) {
  542:     return false;
  543:   }
  544:   return true;
  545: }
  546: function toStringBase(p) {
  547:   return "(" + p.x + ";" + p.y + ")";
  548: }
  549: function toString(p) {
  550:   var s = p.toString();
  551:   return s === "[object Object]" ? toStringBase(p) : s;
  552: }
  553: function compare(a, b) {
  554:   if (a.y === b.y) {
  555:     return a.x - b.x;
  556:   } else {
  557:     return a.y - b.y;
  558:   }
  559: }
  560: function equals(a, b) {
  561:   return a.x === b.x && a.y === b.y;
  562: }
  563: function Voronoi() {
  564:   this.vertices = null;
  565:   this.edges = null;
  566:   this.cells = null;
  567:   this.toRecycle = null;
  568:   this.beachsectionJunkyard = [];
  569:   this.circleEventJunkyard = [];
  570:   this.vertexJunkyard = [];
  571:   this.edgeJunkyard = [];
  572:   this.cellJunkyard = [];
  573: }
  574: function _contains(p, polygon) {
  575:   var isInside = false;
  576:   var minX = polygon[0].x;
  577:   var maxX = polygon[0].x;
  578:   var minY = polygon[0].y;
  579:   var maxY = polygon[0].y;
  580:   for (var n = 1; n < polygon.length; n += 1) {
  581:     var q = polygon[n];
  582:     minX = Math.min(q.x, minX);
  583:     maxX = Math.max(q.x, maxX);
  584:     minY = Math.min(q.y, minY);
  585:     maxY = Math.max(q.y, maxY);
  586:   }
  587:   if (p.x < minX || p.x > maxX || p.y < minY || p.y > maxY) {
  588:     return false;
  589:   }
  590:   var i = 0;
  591:   var j = polygon.length - 1;
  592:   for (i, j; i < polygon.length; j = i++) {
  593:     if (polygon[j].y - polygon[i].y == 0) {
  594:     } else {
  595:       if (
  596:         polygon[i].y > p.y != polygon[j].y > p.y &&
  597:         p.x <
  598:           ((polygon[j].x - polygon[i].x) * (p.y - polygon[i].y)) /
  599:             (polygon[j].y - polygon[i].y) +
  600:             polygon[i].x
  601:       ) {
  602:         isInside = !isInside;
  603:       }
  604:     }
  605:   }
  606:   return isInside;
  607: }
  608: if (!String.prototype.startsWith) {
  609:   String.prototype.startsWith = function (searchString, position) {
  610:     position = position || 0;
  611:     return this.substr(position, searchString.length) === searchString;
  612:   };
  613: }
  614: if (!Array.prototype.filter) {
  615:   Array.prototype.filter = function (fun) {
  616:     "use strict";
  617:     if (this === void 0 || this === null) {
  618:       throw new TypeError();
  619:     }
  620:     var t = Object(this);
  621:     var len = t.length >>> 0;
  622:     if (typeof fun !== "function") {
  623:       throw new TypeError();
  624:     }
  625:     var res = [];
  626:     var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
  627:     for (var i = 0; i < len; i += 1) {
  628:       if (i in t) {
  629:         var val = t[i];
  630:         if (fun.call(thisArg, val, i, t)) {
  631:           res.push(val);
  632:         }
  633:       }
  634:     }
  635:     return res;
  636:   };
  637: }
  638: if (!Array.prototype.forEach) {
  639:   Array.prototype.forEach = function (callback, thisArg) {
  640:     if (this === null) {
  641:       throw new TypeError(" this is null or not defined");
  642:     }
  643:     var O = Object(this);
  644:     var len = O.length >>> 0;
  645:     if (typeof callback !== "function") {
  646:       throw new TypeError(callback + " is not a function");
  647:     }
  648:     if (arguments.length > 1) {
  649:       T = thisArg;
  650:     }
  651:     k = 0;
  652:     while (k < len) {
  653:       if (k in O) {
  654:         kValue = O[k];
  655:         callback.call(T, kValue, k, O);
  656:       }
  657:       k++;
  658:     }
  659:   };
  660: }
  661: if (typeof Object.assign != "function") {
  662:   (function () {
  663:     Object.assign = function (target) {
  664:       "use strict";
  665:       if (target === undefined || target === null) {
  666:         throw new TypeError("Cannot convert undefined or null to object");
  667:       }
  668:       var output = Object(target);
  669:       for (var index = 1; index < arguments.length; index += 1) {
  670:         var source = arguments[index];
  671:         if (source !== undefined && source !== null) {
  672:           for (var nextKey in source) {
  673:             if (source.hasOwnProperty(nextKey)) {
  674:               output[nextKey] = source[nextKey];
  675:             }
  676:           }
  677:         }
  678:       }
  679:       return output;
  680:     };
  681:   })();
  682: }
  683: origami = this;
  684: origami.scriptTitle = "Origami";
  685: origami.writeln = function (args) {
  686:   if (origami.devMode) {
  687:     return $.writeln(args);
  688:   }
  689: };
  690: AVLayer.prototype.findEffectByName = function (_name) {
  691:   var eff = this.property("ADBE Effect Parade");
  692:   for (var e = 1; e <= eff.numProperties; e += 1) {
  693:     if (eff.property(e).name == _name) {
  694:       return eff.property(e);
  695:     }
  696:   }
  697:   return null;
  698: };
  699: CompItem.prototype.findLayerByName = function (_name) {
  700:   for (var l = 1; l <= this.layers.length; l += 1) {
  701:     if (this.layers[l].name == _name) {
  702:       return this.layers[l];
  703:     } else {
  704:       return null;
  705:     }
  706:   }
  707: };
  708: Property.prototype.removeAllKeys = function () {
  709:   for (var k = this.numKeys; k > 0; k--) {
  710:     this.removeKey(k);
  711:   }
  712: };
  713: Array.prototype.isThere = function (el) {
  714:   for (var i = 0; i < this.length; i += 1) {
  715:     if (this[i] == el) {
  716:       return i;
  717:     }
  718:   }
  719:   return false;
  720: };
  721: Array.prototype.indexOf = function (elem) {
  722:   for (var i = 0; i < this.length; i += 1) {
  723:     if (this[i] == elem) {
  724:       return i;
  725:     }
  726:   }
  727:   return -1;
  728: };
  729: Array.prototype.getRandomArrayElements = function (count, randomNum) {
  730:   count = count || this.length - 1;
  731:   if (count == 0) {
  732:     count = 1;
  733:   }
  734:   if (randomNum) {
  735:     count = Math.ceil(Math.random() * this.length) + 1;
  736:   }
  737:   var shuffled = this.slice(0);
  738:   var i = this.length;
  739:   var min = i - count;
  740:   while (i-- > min) {
  741:     index = Math.floor(i * Math.random());
  742:     temp = shuffled[index];
  743:     shuffled[index] = shuffled[i];
  744:     shuffled[i] = temp;
  745:   }
  746:   return shuffled.slice(min);
  747: };
  748: Array.prototype.addToAll = function (el) {
  749:   var tmp = [];
  750:   for (var i = 0; i < this.length; i += 1) {
  751:     tmp.push(this[i] + el);
  752:   }
  753:   return tmp;
  754: };
  755: Array.prototype.map = function (fun) {
  756:   "use strict";
  757:   if (this === void 0 || this === null) {
  758:     throw new TypeError();
  759:   }
  760:   var t = Object(this);
  761:   var len = t.length >>> 0;
  762:   if (typeof fun !== "function") {
  763:     throw new TypeError();
  764:   }
  765:   var res = new Array(len);
  766:   var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
  767:   for (var i = 0; i < len; i += 1) {
  768:     if (i in t) {
  769:       res[i] = fun.call(thisArg, t[i], i, t);
  770:     }
  771:   }
  772:   return res;
  773: };
  774: if (!Array.prototype.lastIndexOf) {
  775:   Array.prototype.lastIndexOf = function (searchElement) {
  776:     "use strict";
  777:     if (this == null) {
  778:       throw new TypeError();
  779:     }
  780:     var t = Object(this);
  781:     var len = t.length >>> 0;
  782:     if (len === 0) {
  783:       return -1;
  784:     }
  785:     n = len;
  786:     if (arguments.length > 1) {
  787:       n = Number(arguments[1]);
  788:       if (n != n) {
  789:         n = 0;
  790:       } else {
  791:         if (n != 0 && n != inf && n != -inf) {
  792:           n = n > 0 || -1 * Math.floor(Math.abs(n));
  793:         }
  794:       }
  795:     }
  796:     for (k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n); k >= 0; k--) {
  797:       if (k in t && t[k] === searchElement) {
  798:         return k;
  799:       }
  800:     }
  801:     return -1;
  802:   };
  803: }
  804: Object.prototype.nsSetBG = function (colorArray) {
  805:   if (typeof colorArray != "undefined" && colorArray.length >= 3) {
  806:     this.graphics.backgroundColor = this.graphics.newBrush(
  807:       this.graphics.BrushType.SOLID_COLOR,
  808:       colorArray,
  809:     );
  810:   }
  811:   return this;
  812: };
  813: Object.prototype.nsSetFG = function (colorArray) {
  814:   if (typeof colorArray != "undefined" && colorArray.length >= 3) {
  815:     this.graphics.foregroundColor = this.graphics.newPen(
  816:       this.graphics.PenType.SOLID_COLOR,
  817:       colorArray,
  818:       1,
  819:     );
  820:   }
  821:   return this;
  822: };
  823: Group.prototype.nsSetIcon = function (iconFile) {
  824:   if (iconFile) {
  825:     this.icon = this.add("image", undefined, iconFile);
  826:   }
  827:   return this;
  828: };
  829: Object.prototype.nsSetTip = function (hlpTip) {
  830:   if (hlpTip) {
  831:     if (this.icon) {
  832:       this.icon.helpTip = hlpTip;
  833:     } else {
  834:       this.helpTip = hlpTip;
  835:     }
  836:   }
  837:   return this;
  838: };
  839: if (typeof generateRandomNumber != "undefined") {
  840:   Math.random = function () {
  841:     return generateRandomNumber();
  842:   };
  843: }
  844: var global = {};
  845: origami.devMode = false;
  846: origami.version = "1.4.0";
  847: origami.AEversion = app.version.split("x")[0].split(".");
  848: origami.AEversion = Number(origami.AEversion[0] + "." + origami.AEversion[1]);
  849: origami.AllSlices = [];
  850: origami.AllSlicesNames = [];
  851: origami.preFlight = function () {
  852:   function isSecurityPrefSet() {
  853:     var securitySetting = app.preferences.getPrefAsLong(
  854:       "Main Pref Section",
  855:       "Pref_SCRIPTING_FILE_NETWORK_SECURITY",
  856:     );
  857:     return securitySetting == 1;
  858:   }
  859:   function isAE() {
  860:     return BridgeTalk.appName == "aftereffects";
  861:   }
  862:   var strErrScriptAccess = localize({
  863:     de: 'Dieses Skript ben\xf6tigt die Erlaubnis Dateien zu schreiben.\n Gehe in Voreinstellungen von After Effects in die Rubrik "Allgemein" und aktiviere die Option "Skripten k\xf6nnen Dateien schreiben und haben Netzwerkzugang".',
  864:     en: 'This script requires access to write files.\nGo to the "General" panel of the application preferences and make sure "Allow Scripts to Write Files and Access Network" is checked.',
  865:     es: 'Este script necesita poder escribir archivos.\nVaya al panel "General" de las Preferencias y aseg\xfarese de que "Permitir que los scripts puedan escribir archivos y acceder a la red" est\xe1 marcado.\n',
  866:     fr: 'Ce script n\xe9cessite les droits d\'\xe9criture de fichiers.\nAllez dans le panneau "G\xe9n\xe9ral" des pr\xe9f\xe9rences de l\'application et cochez \n"Autoriser les scripts \xe0 \xe9crire des fichiers et \xe0 acc\xe9der au r\xe9seau"',
  867:   });
  868:   if (isAE() && !isSecurityPrefSet()) {
  869:     alert(strErrScriptAccess);
  870:     app.executeCommand(2359);
  871:     if (!isSecurityPrefSet()) {
  872:       return;
  873:     }
  874:   }
  875: };
  876: origami.preFlight();
  877: origami.readExternalFile = function (_path) {
  878:   try {
  879:     var f = new File(_path);
  880:     f.open("r");
  881:     var externalFile = "";
  882:     while (!f.eof) {
  883:       externalFile += f.readln() + "\n";
  884:     }
  885:     return externalFile;
  886:   } catch (err) {
  887:     return null;
  888:   }
  889: };
  890: origami.readAndEval = function (_path) {
  891:   var content = origami.readExternalFile(_path);
  892:   if (content) {
  893:     eval(content);
  894:   }
  895: };
  896: origami.add_slices_funcs = function () {
  897:   var all_slices_loaded = origami.sliceAlgorithms.reflect.properties.filter(
  898:     function (el) {
  899:       return String(el).startsWith("slice");
  900:     },
  901:   );
  902:   all_slices_loaded.sort(function (a, b) {
  903:     if (
  904:       origami.sliceAlgorithms[a].pack_priority ===
  905:       origami.sliceAlgorithms[b].pack_priority
  906:     ) {
  907:       a_val = parseInt(String(a).slice(5));
  908:       b_val = parseInt(String(b).slice(5));
  909:       return a_val > b_val;
  910:     }
  911:     return (
  912:       origami.sliceAlgorithms[a].pack_priority >
  913:       origami.sliceAlgorithms[b].pack_priority
  914:     );
  915:   });
  916:   all_slices_loaded.forEach(function (el) {
  917:     if (
  918:       origami.AllSlicesNames.indexOf(origami.sliceAlgorithms[el].name) === -1
  919:     ) {
  920:       origami.AllSlices.push(origami.sliceAlgorithms[el]);
  921:       origami.AllSlicesNames.push(origami.sliceAlgorithms[el].name);
  922:     }
  923:   });
  924: };
  925: origami.getSliceByType = function (sliceType) {
  926:   return origami.AllSlices[sliceType];
  927: };
  928: if ($.os.toLowerCase().split(" ")[0] == "macintosh") {
  929:   origami.path_f =
  930:     Folder.appPackage.path + "/Plug-ins/(Origami_packages)/basicSlice.jsxbin";
  931:   origami.path_f_dev =
  932:     new File($.fileName).parent.fsName +
  933:     "/(Origami_packages)/basicSlice.jsxbin";
  934:   origami.presetString = Folder.userData.fullName + "/Origami/preset.ffx";
  935:   origami.prefix = "open ";
  936: } else {
  937:   origami.path_f =
  938:     Folder.appPackage.fsName +
  939:     "\\Plug-ins\\(Origami_packages)\\basicSlice.jsxbin";
  940:   origami.path_f_dev = "(Origami_packages)\\basicSlice.jsxbin";
  941:   origami.presetString = Folder.userData.fsName + "\\Origami\\preset.ffx";
  942:   origami.prefix = "explorer ";
  943: }
  944: origami.folder = new Folder(new File(origami.presetString).path);
  945: origami.folder.create();
  946: origami.devFile = new File(origami.path_f_dev);
  947: origami.userFile = new File(origami.path_f);
  948: origami.package_folder = null;
  949: if (origami.devFile.exists) {
  950:   origami.readAndEval(origami.path_f_dev);
  951:   origami.package_folder = new Folder(origami.devFile.parent);
  952:   origami.add_slices_funcs();
  953: } else if (origami.userFile.exists) {
  954:   origami.readAndEval(origami.path_f);
  955:   origami.package_folder = new Folder(origami.userFile.parent);
  956:   origami.add_slices_funcs();
  957: } else {
  958:   alert("Origami packages file is absent\nPlease reinstall Origami");
  959: }
  960: var packs = origami.package_folder.getFiles("*.jsxbin");
  961: var hasPacks = false;
  962: for (var i = 0; i < packs.length; i += 1) {
  963:   var end = packs[i].fsName.substr(packs[i].fsName.length - 17, 17);
  964:   if (!(end === "basicSlice.jsxbin")) {
  965:     hasPacks = true;
  966:     origami.readAndEval(packs[i].fsName);
  967:   }
  968: }
  969: if (hasPacks) {
  970:   origami.add_slices_funcs();
  971: }
  972: var Node = function (p, t) {
  973:   this.point = p;
  974:   this.triangle = t || null;
  975:   this.next = null;
  976:   this.prev = null;
  977:   this.value = p.x;
  978: };
  979: var AdvancingFront = function (head, tail) {
  980:   this.head_ = head;
  981:   this.tail_ = tail;
  982:   this.search_node_ = head;
  983: };
  984: AdvancingFront.prototype.head = function () {
  985:   return this.head_;
  986: };
  987: AdvancingFront.prototype.setHead = function (node) {
  988:   this.head_ = node;
  989: };
  990: AdvancingFront.prototype.tail = function () {
  991:   return this.tail_;
  992: };
  993: AdvancingFront.prototype.setTail = function (node) {
  994:   this.tail_ = node;
  995: };
  996: AdvancingFront.prototype.search = function () {
  997:   return this.search_node_;
  998: };
  999: AdvancingFront.prototype.setSearch = function (node) {
 1000:   this.search_node_ = node;
 1001: };
 1002: AdvancingFront.prototype.findSearchNode = function () {
 1003:   return this.search_node_;
 1004: };
 1005: AdvancingFront.prototype.locateNode = function (x) {
 1006:   var node = this.search_node_;
 1007:   if (x < node.value) {
 1008:     while ((node = node.prev)) {
 1009:       if (x >= node.value) {
 1010:         this.search_node_ = node;
 1011:         return node;
 1012:       }
 1013:     }
 1014:   } else {
 1015:     while ((node = node.next)) {
 1016:       if (x < node.value) {
 1017:         this.search_node_ = node.prev;
 1018:         return node.prev;
 1019:       }
 1020:     }
 1021:   }
 1022:   return null;
 1023: };
 1024: AdvancingFront.prototype.locatePoint = function (point) {
 1025:   var px = point.x;
 1026:   var node = this.findSearchNode(px);
 1027:   var nx = node.point.x;
 1028:   if (px === nx) {
 1029:     if (point !== node.point) {
 1030:       if (point === node.prev.point) {
 1031:         node = node.prev;
 1032:       } else if (point === node.next.point) {
 1033:         node = node.next;
 1034:       } else {
 1035:         throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");
 1036:       }
 1037:     }
 1038:   } else if (px < nx) {
 1039:     while ((node = node.prev)) {
 1040:       if (point === node.point) {
 1041:         break;
 1042:       }
 1043:     }
 1044:   } else {
 1045:     while ((node = node.next)) {
 1046:       if (point === node.point) {
 1047:         break;
 1048:       }
 1049:     }
 1050:   }
 1051:   if (node) {
 1052:     this.search_node_ = node;
 1053:   }
 1054:   return node;
 1055: };
 1056: ("use strict");
 1057: var Point = function (x, y) {
 1058:   this.x = x || 0;
 1059:   this.y = y || 0;
 1060:   this._p2t_edge_list = null;
 1061: };
 1062: Point.prototype.toString = function () {
 1063:   return toStringBase(this);
 1064: };
 1065: Point.prototype.clone = function () {
 1066:   return new Point(this.x, this.y);
 1067: };
 1068: Point.prototype.set_zero = function () {
 1069:   this.x = 0;
 1070:   this.y = 0;
 1071:   return this;
 1072: };
 1073: Point.prototype.set = function (x, y) {
 1074:   this.x = x || 0;
 1075:   this.y = y || 0;
 1076:   return this;
 1077: };
 1078: Point.prototype.negate = function () {
 1079:   this.x = -this.x;
 1080:   this.y = -this.y;
 1081:   return this;
 1082: };
 1083: Point.prototype.add = function (n) {
 1084:   this.x += n.x;
 1085:   this.y += n.y;
 1086:   return this;
 1087: };
 1088: Point.prototype.sub = function (n) {
 1089:   this.x -= n.x;
 1090:   this.y -= n.y;
 1091:   return this;
 1092: };
 1093: Point.prototype.mul = function (s) {
 1094:   this.x *= s;
 1095:   this.y *= s;
 1096:   return this;
 1097: };
 1098: Point.prototype.length = function () {
 1099:   return Math.sqrt(this.x * this.x + this.y * this.y);
 1100: };
 1101: Point.prototype.normalize = function () {
 1102:   var len = this.length();
 1103:   this.x /= len;
 1104:   this.y /= len;
 1105:   return len;
 1106: };
 1107: Point.prototype.equals = function (p) {
 1108:   return this.x === p.x && this.y === p.y;
 1109: };
 1110: Point.negate = function (p) {
 1111:   return new Point(-p.x, -p.y);
 1112: };
 1113: Point.add = function (a, b) {
 1114:   return new Point(a.x + b.x, a.y + b.y);
 1115: };
 1116: Point.sub = function (a, b) {
 1117:   return new Point(a.x - b.x, a.y - b.y);
 1118: };
 1119: Point.mul = function (s, p) {
 1120:   return new Point(s * p.x, s * p.y);
 1121: };
 1122: Point.cross = function (a, b) {
 1123:   if (typeof a === "number") {
 1124:     if (typeof b === "number") {
 1125:       return a * b;
 1126:     } else {
 1127:       return new Point(-a * b.y, a * b.x);
 1128:     }
 1129:   } else {
 1130:     if (typeof b === "number") {
 1131:       return new Point(b * a.y, -b * a.x);
 1132:     } else {
 1133:       return a.x * b.y - a.y * b.x;
 1134:     }
 1135:   }
 1136: };
 1137: Point.toString = toString;
 1138: Point.compare = compare;
 1139: Point.cmp = compare;
 1140: Point.equals = equals;
 1141: Point.dot = function (a, b) {
 1142:   return a.x * b.x + a.y * b.y;
 1143: };
 1144: ("use strict");
 1145: var PointError = function (message, points) {
 1146:   this.name = "PointError";
 1147:   this.points = points = points || [];
 1148:   this.message = message || "Invalid Points!";
 1149:   for (var i = 0; i < points.length; i += 1) {
 1150:     this.message += " " + toString(points[i]);
 1151:   }
 1152: };
 1153: PointError.prototype = new Error();
 1154: PointError.prototype.constructor = PointError;
 1155: var global =
 1156:   typeof self !== "undefined"
 1157:     ? self
 1158:     : typeof window !== "undefined"
 1159:       ? window
 1160:       : {};
 1161: ("use strict");
 1162: ("use strict");
 1163: var PI_3div4 = (3 * Math.PI) / 4;
 1164: var PI_div2 = Math.PI / 2;
 1165: ("use strict");
 1166: var kAlpha = 0.3;
 1167: var Edge = function (p1, p2) {
 1168:   this.p = p1;
 1169:   this.q = p2;
 1170:   if (p1.y > p2.y) {
 1171:     this.q = p1;
 1172:     this.p = p2;
 1173:   } else {
 1174:     if (p1.y === p2.y) {
 1175:       if (p1.x > p2.x) {
 1176:         this.q = p1;
 1177:         this.p = p2;
 1178:       } else {
 1179:         if (p1.x === p2.x) {
 1180:           throw new PointError(
 1181:             "poly2tri Invalid Edge constructor: repeated points!",
 1182:             [p1],
 1183:           );
 1184:         }
 1185:       }
 1186:     }
 1187:   }
 1188:   if (!this.q._p2t_edge_list) {
 1189:     this.q._p2t_edge_list = [];
 1190:   }
 1191:   this.q._p2t_edge_list.push(this);
 1192: };
 1193: var Basin = function () {
 1194:   this.left_node = null;
 1195:   this.bottom_node = null;
 1196:   this.right_node = null;
 1197:   this.width = 0;
 1198:   this.left_highest = false;
 1199: };
 1200: Basin.prototype.clear = function () {
 1201:   this.left_node = null;
 1202:   this.bottom_node = null;
 1203:   this.right_node = null;
 1204:   this.width = 0;
 1205:   this.left_highest = false;
 1206: };
 1207: var EdgeEvent = function () {
 1208:   this.constrained_edge = null;
 1209:   this.right = false;
 1210: };
 1211: var SweepContext = function (contour, options) {
 1212:   options = options || {};
 1213:   this.triangles_ = [];
 1214:   this.map_ = [];
 1215:   this.points_ = options.cloneArrays ? contour.slice(0) : contour;
 1216:   this.edge_list = [];
 1217:   this.pmin_ = this.pmax_ = null;
 1218:   this.front_ = null;
 1219:   this.head_ = null;
 1220:   this.tail_ = null;
 1221:   this.af_head_ = null;
 1222:   this.af_middle_ = null;
 1223:   this.af_tail_ = null;
 1224:   this.basin = new Basin();
 1225:   this.edge_event = new EdgeEvent();
 1226:   this.initEdges(this.points_);
 1227: };
 1228: SweepContext.prototype.addHole = function (polyline) {
 1229:   this.initEdges(polyline);
 1230:   var len = polyline.length;
 1231:   for (var i = 0; i < len; i += 1) {
 1232:     this.points_.push(polyline[i]);
 1233:   }
 1234:   return this;
 1235: };
 1236: SweepContext.prototype.AddHole = SweepContext.prototype.addHole;
 1237: SweepContext.prototype.addPoint = function (point) {
 1238:   this.points_.push(point);
 1239:   return this;
 1240: };
 1241: SweepContext.prototype.AddPoint = SweepContext.prototype.addPoint;
 1242: SweepContext.prototype.addPoints = function (points) {
 1243:   this.points_ = this.points_.concat(points);
 1244:   return this;
 1245: };
 1246: var sweep = this;
 1247: SweepContext.prototype.triangulate = function () {
 1248:   sweep.triangulate(this);
 1249:   return this;
 1250: };
 1251: SweepContext.prototype.getBoundingBox = function () {
 1252:   return { max: this.pmax_, min: this.pmin_ };
 1253: };
 1254: SweepContext.prototype.getTriangles = function () {
 1255:   return this.triangles_;
 1256: };
 1257: SweepContext.prototype.GetTriangles = SweepContext.prototype.getTriangles;
 1258: SweepContext.prototype.front = function () {
 1259:   return this.front_;
 1260: };
 1261: SweepContext.prototype.pointCount = function () {
 1262:   return this.points_.length;
 1263: };
 1264: SweepContext.prototype.head = function () {
 1265:   return this.head_;
 1266: };
 1267: SweepContext.prototype.setHead = function (p1) {
 1268:   this.head_ = p1;
 1269: };
 1270: SweepContext.prototype.tail = function () {
 1271:   return this.tail_;
 1272: };
 1273: SweepContext.prototype.setTail = function (p1) {
 1274:   this.tail_ = p1;
 1275: };
 1276: SweepContext.prototype.getMap = function () {
 1277:   return this.map_;
 1278: };
 1279: SweepContext.prototype.initTriangulation = function () {
 1280:   var xmax = this.points_[0].x;
 1281:   var xmin = this.points_[0].x;
 1282:   var ymax = this.points_[0].y;
 1283:   var ymin = this.points_[0].y;
 1284:   var len = this.points_.length;
 1285:   for (var i = 1; i < len; i += 1) {
 1286:     var p = this.points_[i];
 1287:     p.x > xmax && (xmax = p.x);
 1288:     p.x < xmin && (xmin = p.x);
 1289:     p.y > ymax && (ymax = p.y);
 1290:     p.y < ymin && (ymin = p.y);
 1291:   }
 1292:   this.pmin_ = new Point(xmin, ymin);
 1293:   this.pmax_ = new Point(xmax, ymax);
 1294:   var dx = kAlpha * (xmax - xmin);
 1295:   var dy = kAlpha * (ymax - ymin);
 1296:   this.head_ = new Point(xmax + dx, ymin - dy);
 1297:   this.tail_ = new Point(xmin - dx, ymin - dy);
 1298:   this.points_.sort(Point.compare);
 1299: };
 1300: SweepContext.prototype.initEdges = function (polyline) {
 1301:   var len = polyline.length;
 1302:   for (var i = 0; i < len; i += 1) {
 1303:     this.edge_list.push(new Edge(polyline[i], polyline[(i + 1) % len]));
 1304:   }
 1305: };
 1306: SweepContext.prototype.getPoint = function (index) {
 1307:   return this.points_[index];
 1308: };
 1309: SweepContext.prototype.addToMap = function (triangle) {
 1310:   this.map_.push(triangle);
 1311: };
 1312: SweepContext.prototype.locateNode = function (point) {
 1313:   return this.front_.locateNode(point.x);
 1314: };
 1315: SweepContext.prototype.createAdvancingFront = function () {
 1316:   var triangle = new Triangle(this.points_[0], this.tail_, this.head_);
 1317:   this.map_.push(triangle);
 1318:   head = new Node(triangle.getPoint(1), triangle);
 1319:   middle = new Node(triangle.getPoint(0), triangle);
 1320:   tail = new Node(triangle.getPoint(2));
 1321:   this.front_ = new AdvancingFront(head, tail);
 1322:   head.next = middle;
 1323:   middle.next = tail;
 1324:   middle.prev = head;
 1325:   tail.prev = middle;
 1326: };
 1327: SweepContext.prototype.removeNode = function (node) {};
 1328: SweepContext.prototype.mapTriangleToNodes = function (t) {
 1329:   for (var i = 0; i < 3; i += 1) {
 1330:     if (!t.getNeighbor(i)) {
 1331:       var n = this.front_.locatePoint(t.pointCW(t.getPoint(i)));
 1332:       if (n) {
 1333:         n.triangle = t;
 1334:       }
 1335:     }
 1336:   }
 1337: };
 1338: SweepContext.prototype.removeFromMap = function (triangle) {
 1339:   var map = this.map_;
 1340:   var len = map.length;
 1341:   for (var i = 0; i < len; i += 1) {
 1342:     if (map[i] === triangle) {
 1343:       map.splice(i, 1);
 1344:       break;
 1345:     }
 1346:   }
 1347: };
 1348: SweepContext.prototype.meshClean = function (triangle) {
 1349:   var triangles = [triangle];
 1350:   while ((t = triangles.pop())) {
 1351:     if (!t.isInterior()) {
 1352:       t.setInterior(true);
 1353:       this.triangles_.push(t);
 1354:       for (var i = 0; i < 3; i += 1) {
 1355:         if (!t.constrained_edge[i]) {
 1356:           triangles.push(t.getNeighbor(i));
 1357:         }
 1358:       }
 1359:     }
 1360:   }
 1361: };
 1362: ("use strict");
 1363: var Triangle = function (a, b, c) {
 1364:   this.points_ = [a, b, c];
 1365:   this.neighbors_ = [null, null, null];
 1366:   this.interior_ = false;
 1367:   this.constrained_edge = [false, false, false];
 1368:   this.delaunay_edge = [false, false, false];
 1369: };
 1370: var p2s = toString;
 1371: Triangle.prototype.toString = function () {
 1372:   return (
 1373:     "[" +
 1374:     p2s(this.points_[0]) +
 1375:     p2s(this.points_[1]) +
 1376:     p2s(this.points_[2]) +
 1377:     "]"
 1378:   );
 1379: };
 1380: Triangle.prototype.getPoint = function (index) {
 1381:   return this.points_[index];
 1382: };
 1383: Triangle.prototype.GetPoint = Triangle.prototype.getPoint;
 1384: Triangle.prototype.getPoints = function () {
 1385:   return this.points_;
 1386: };
 1387: Triangle.prototype.getNeighbor = function (index) {
 1388:   return this.neighbors_[index];
 1389: };
 1390: Triangle.prototype.containsPoint = function (point) {
 1391:   var points = this.points_;
 1392:   return point === points[0] || point === points[1] || point === points[2];
 1393: };
 1394: Triangle.prototype.containsEdge = function (edge) {
 1395:   return this.containsPoint(edge.p) && this.containsPoint(edge.q);
 1396: };
 1397: Triangle.prototype.containsPoints = function (p1, p2) {
 1398:   return this.containsPoint(p1) && this.containsPoint(p2);
 1399: };
 1400: Triangle.prototype.isInterior = function () {
 1401:   return this.interior_;
 1402: };
 1403: Triangle.prototype.setInterior = function (interior) {
 1404:   this.interior_ = interior;
 1405:   return this;
 1406: };
 1407: Triangle.prototype.markNeighborPointers = function (p1, p2, t) {
 1408:   var points = this.points_;
 1409:   if (
 1410:     (p1 === points[2] && p2 === points[1]) ||
 1411:     (p1 === points[1] && p2 === points[2])
 1412:   ) {
 1413:     this.neighbors_[0] = t;
 1414:   } else if (
 1415:     (p1 === points[0] && p2 === points[2]) ||
 1416:     (p1 === points[2] && p2 === points[0])
 1417:   ) {
 1418:     this.neighbors_[1] = t;
 1419:   } else if (
 1420:     (p1 === points[0] && p2 === points[1]) ||
 1421:     (p1 === points[1] && p2 === points[0])
 1422:   ) {
 1423:     this.neighbors_[2] = t;
 1424:   } else {
 1425:     throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");
 1426:   }
 1427: };
 1428: Triangle.prototype.markNeighbor = function (t) {
 1429:   var points = this.points_;
 1430:   if (t.containsPoints(points[1], points[2])) {
 1431:     this.neighbors_[0] = t;
 1432:     t.markNeighborPointers(points[1], points[2], this);
 1433:   } else if (t.containsPoints(points[0], points[2])) {
 1434:     this.neighbors_[1] = t;
 1435:     t.markNeighborPointers(points[0], points[2], this);
 1436:   } else {
 1437:     if (t.containsPoints(points[0], points[1])) {
 1438:       this.neighbors_[2] = t;
 1439:       t.markNeighborPointers(points[0], points[1], this);
 1440:     }
 1441:   }
 1442: };
 1443: Triangle.prototype.clearNeigbors = function () {
 1444:   this.neighbors_[0] = null;
 1445:   this.neighbors_[1] = null;
 1446:   this.neighbors_[2] = null;
 1447: };
 1448: Triangle.prototype.clearDelunayEdges = function () {
 1449:   this.delaunay_edge[0] = false;
 1450:   this.delaunay_edge[1] = false;
 1451:   this.delaunay_edge[2] = false;
 1452: };
 1453: Triangle.prototype.pointCW = function (p) {
 1454:   var points = this.points_;
 1455:   if (p === points[0]) {
 1456:     return points[2];
 1457:   } else if (p === points[1]) {
 1458:     return points[0];
 1459:   } else if (p === points[2]) {
 1460:     return points[1];
 1461:   } else {
 1462:     return null;
 1463:   }
 1464: };
 1465: Triangle.prototype.pointCCW = function (p) {
 1466:   var points = this.points_;
 1467:   if (p === points[0]) {
 1468:     return points[1];
 1469:   } else if (p === points[1]) {
 1470:     return points[2];
 1471:   } else if (p === points[2]) {
 1472:     return points[0];
 1473:   } else {
 1474:     return null;
 1475:   }
 1476: };
 1477: Triangle.prototype.neighborCW = function (p) {
 1478:   if (p === this.points_[0]) {
 1479:     return this.neighbors_[1];
 1480:   } else if (p === this.points_[1]) {
 1481:     return this.neighbors_[2];
 1482:   } else {
 1483:     return this.neighbors_[0];
 1484:   }
 1485: };
 1486: Triangle.prototype.neighborCCW = function (p) {
 1487:   if (p === this.points_[0]) {
 1488:     return this.neighbors_[2];
 1489:   } else if (p === this.points_[1]) {
 1490:     return this.neighbors_[0];
 1491:   } else {
 1492:     return this.neighbors_[1];
 1493:   }
 1494: };
 1495: Triangle.prototype.getConstrainedEdgeCW = function (p) {
 1496:   if (p === this.points_[0]) {
 1497:     return this.constrained_edge[1];
 1498:   } else if (p === this.points_[1]) {
 1499:     return this.constrained_edge[2];
 1500:   } else {
 1501:     return this.constrained_edge[0];
 1502:   }
 1503: };
 1504: Triangle.prototype.getConstrainedEdgeCCW = function (p) {
 1505:   if (p === this.points_[0]) {
 1506:     return this.constrained_edge[2];
 1507:   } else if (p === this.points_[1]) {
 1508:     return this.constrained_edge[0];
 1509:   } else {
 1510:     return this.constrained_edge[1];
 1511:   }
 1512: };
 1513: Triangle.prototype.getConstrainedEdgeAcross = function (p) {
 1514:   if (p === this.points_[0]) {
 1515:     return this.constrained_edge[0];
 1516:   } else if (p === this.points_[1]) {
 1517:     return this.constrained_edge[1];
 1518:   } else {
 1519:     return this.constrained_edge[2];
 1520:   }
 1521: };
 1522: Triangle.prototype.setConstrainedEdgeCW = function (p, ce) {
 1523:   if (p === this.points_[0]) {
 1524:     this.constrained_edge[1] = ce;
 1525:   } else if (p === this.points_[1]) {
 1526:     this.constrained_edge[2] = ce;
 1527:   } else {
 1528:     this.constrained_edge[0] = ce;
 1529:   }
 1530: };
 1531: Triangle.prototype.setConstrainedEdgeCCW = function (p, ce) {
 1532:   if (p === this.points_[0]) {
 1533:     this.constrained_edge[2] = ce;
 1534:   } else if (p === this.points_[1]) {
 1535:     this.constrained_edge[0] = ce;
 1536:   } else {
 1537:     this.constrained_edge[1] = ce;
 1538:   }
 1539: };
 1540: Triangle.prototype.getDelaunayEdgeCW = function (p) {
 1541:   if (p === this.points_[0]) {
 1542:     return this.delaunay_edge[1];
 1543:   } else if (p === this.points_[1]) {
 1544:     return this.delaunay_edge[2];
 1545:   } else {
 1546:     return this.delaunay_edge[0];
 1547:   }
 1548: };
 1549: Triangle.prototype.getDelaunayEdgeCCW = function (p) {
 1550:   if (p === this.points_[0]) {
 1551:     return this.delaunay_edge[2];
 1552:   } else if (p === this.points_[1]) {
 1553:     return this.delaunay_edge[0];
 1554:   } else {
 1555:     return this.delaunay_edge[1];
 1556:   }
 1557: };
 1558: Triangle.prototype.setDelaunayEdgeCW = function (p, e) {
 1559:   if (p === this.points_[0]) {
 1560:     this.delaunay_edge[1] = e;
 1561:   } else if (p === this.points_[1]) {
 1562:     this.delaunay_edge[2] = e;
 1563:   } else {
 1564:     this.delaunay_edge[0] = e;
 1565:   }
 1566: };
 1567: Triangle.prototype.setDelaunayEdgeCCW = function (p, e) {
 1568:   if (p === this.points_[0]) {
 1569:     this.delaunay_edge[2] = e;
 1570:   } else if (p === this.points_[1]) {
 1571:     this.delaunay_edge[0] = e;
 1572:   } else {
 1573:     this.delaunay_edge[1] = e;
 1574:   }
 1575: };
 1576: Triangle.prototype.neighborAcross = function (p) {
 1577:   if (p === this.points_[0]) {
 1578:     return this.neighbors_[0];
 1579:   } else if (p === this.points_[1]) {
 1580:     return this.neighbors_[1];
 1581:   } else {
 1582:     return this.neighbors_[2];
 1583:   }
 1584: };
 1585: Triangle.prototype.oppositePoint = function (t, p) {
 1586:   var cw = t.pointCW(p);
 1587:   return this.pointCW(cw);
 1588: };
 1589: Triangle.prototype.legalize = function (opoint, npoint) {
 1590:   var points = this.points_;
 1591:   if (opoint === points[0]) {
 1592:     points[1] = points[0];
 1593:     points[0] = points[2];
 1594:     points[2] = npoint;
 1595:   } else if (opoint === points[1]) {
 1596:     points[2] = points[1];
 1597:     points[1] = points[0];
 1598:     points[0] = npoint;
 1599:   } else if (opoint === points[2]) {
 1600:     points[0] = points[2];
 1601:     points[2] = points[1];
 1602:     points[1] = npoint;
 1603:   } else {
 1604:     throw new Error("poly2tri Invalid Triangle.legalize() call");
 1605:   }
 1606: };
 1607: Triangle.prototype.index = function (p) {
 1608:   var points = this.points_;
 1609:   if (p === points[0]) {
 1610:     return 0;
 1611:   } else if (p === points[1]) {
 1612:     return 1;
 1613:   } else if (p === points[2]) {
 1614:     return 2;
 1615:   } else {
 1616:     throw new Error("poly2tri Invalid Triangle.index() call");
 1617:   }
 1618: };
 1619: Triangle.prototype.edgeIndex = function (p1, p2) {
 1620:   var points = this.points_;
 1621:   if (p1 === points[0]) {
 1622:     if (p2 === points[1]) {
 1623:       return 2;
 1624:     } else {
 1625:       if (p2 === points[2]) {
 1626:         return 1;
 1627:       }
 1628:     }
 1629:   } else if (p1 === points[1]) {
 1630:     if (p2 === points[2]) {
 1631:       return 0;
 1632:     } else {
 1633:       if (p2 === points[0]) {
 1634:         return 2;
 1635:       }
 1636:     }
 1637:   } else {
 1638:     if (p1 === points[2]) {
 1639:       if (p2 === points[0]) {
 1640:         return 1;
 1641:       } else {
 1642:         if (p2 === points[1]) {
 1643:           return 0;
 1644:         }
 1645:       }
 1646:     }
 1647:   }
 1648:   return -1;
 1649: };
 1650: Triangle.prototype.markConstrainedEdgeByIndex = function (index) {
 1651:   this.constrained_edge[index] = true;
 1652: };
 1653: Triangle.prototype.markConstrainedEdgeByEdge = function (edge) {
 1654:   this.markConstrainedEdgeByPoints(edge.p, edge.q);
 1655: };
 1656: Triangle.prototype.markConstrainedEdgeByPoints = function (p, q) {
 1657:   var points = this.points_;
 1658:   if (
 1659:     (q === points[0] && p === points[1]) ||
 1660:     (q === points[1] && p === points[0])
 1661:   ) {
 1662:     this.constrained_edge[2] = true;
 1663:   } else if (
 1664:     (q === points[0] && p === points[2]) ||
 1665:     (q === points[2] && p === points[0])
 1666:   ) {
 1667:     this.constrained_edge[1] = true;
 1668:   } else {
 1669:     if (
 1670:       (q === points[1] && p === points[2]) ||
 1671:       (q === points[2] && p === points[1])
 1672:     ) {
 1673:       this.constrained_edge[0] = true;
 1674:     }
 1675:   }
 1676: };
 1677: ("use strict");
 1678: var EPSILON = 1e-12;
 1679: var Orientation = { CCW: -1, COLLINEAR: 0, CW: 1 };
 1680: ("use strict");
 1681: var poly2tri = this;
 1682: poly2tri.Node = Node;
 1683: poly2tri.AdvancingFront = AdvancingFront;
 1684: poly2tri.Point = Point;
 1685: poly2tri.PointError = PointError;
 1686: poly2tri.Basin = Basin;
 1687: poly2tri.triangulate = triangulate;
 1688: poly2tri.sweepPoints = sweepPoints;
 1689: poly2tri.finalizationPolygon = finalizationPolygon;
 1690: poly2tri.edgeEventByEdge = edgeEventByEdge;
 1691: poly2tri.edgeEventByPoints = edgeEventByPoints;
 1692: poly2tri.isEdgeSideOfTriangle = isEdgeSideOfTriangle;
 1693: poly2tri.newFrontTriangle = newFrontTriangle;
 1694: poly2tri.fill = fill;
 1695: poly2tri.fillAdvancingFront = fillAdvancingFront;
 1696: poly2tri.basinAngle = basinAngle;
 1697: poly2tri.holeAngle = holeAngle;
 1698: poly2tri.legalize = legalize;
 1699: poly2tri.inCircle = inCircle;
 1700: poly2tri.rotateTrianglePair = rotateTrianglePair;
 1701: poly2tri.fillBasin = fillBasin;
 1702: poly2tri.fillRightAboveEdgeEvent = fillRightAboveEdgeEvent;
 1703: poly2tri.fillRightBelowEdgeEvent = fillRightBelowEdgeEvent;
 1704: poly2tri.fillRightConcaveEdgeEvent = fillRightConcaveEdgeEvent;
 1705: poly2tri.fillRightConvexEdgeEvent = fillRightConvexEdgeEvent;
 1706: poly2tri.fillLeftAboveEdgeEvent = fillLeftAboveEdgeEvent;
 1707: poly2tri.fillLeftBelowEdgeEvent = fillLeftBelowEdgeEvent;
 1708: poly2tri.fillLeftConcaveEdgeEvent = fillLeftConcaveEdgeEvent;
 1709: poly2tri.fillLeftConvexEdgeEvent = fillLeftConvexEdgeEvent;
 1710: poly2tri.flipEdgeEvent = flipEdgeEvent;
 1711: poly2tri.nextFlipPoint = nextFlipPoint;
 1712: poly2tri.nextFlipTriangle = nextFlipTriangle;
 1713: poly2tri.flipScanEdgeEvent = flipScanEdgeEvent;
 1714: poly2tri.Edge = Edge;
 1715: poly2tri.EdgeEvent = EdgeEvent;
 1716: poly2tri.SweepContext = SweepContext;
 1717: poly2tri.Triangle = Triangle;
 1718: poly2tri.orient2d = orient2d;
 1719: poly2tri.inScanArea = inScanArea;
 1720: poly2tri.toStringBase = toStringBase;
 1721: poly2tri.toString = toString;
 1722: poly2tri.compare = compare;
 1723: poly2tri.equals = equals;
 1724: poly2tri.global = global;
 1725: poly2tri.PI_3div4 = PI_3div4;
 1726: poly2tri.PI_div2 = PI_div2;
 1727: poly2tri.kAlpha = kAlpha;
 1728: poly2tri.sweep = sweep;
 1729: poly2tri.p2s = p2s;
 1730: poly2tri.EPSILON = EPSILON;
 1731: poly2tri.Orientation = Orientation;
 1732: function a(vars) {
 1733:   function licUI() {
 1734:     var e = new Window(
 1735:       "dialog",
 1736:       strTrialWelcomeHeader + " - " + strVersion + " " + strScriptVersion,
 1737:       void 0,
 1738:       { resizeable: true },
 1739:     );
 1740:     if (null != e) {
 1741:       var t =
 1742:         "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\tinfoGrp: Group { \t\t\t\t\talignment: [\'fill\',\'top\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\torientation: \'column\', \t\t\t\t\t\thdrGrp: Group {\t\t\t\t\t\t\ttxt: StaticText {}, \t\t\t\t\t\t\tpaste: StaticText {}, \t\t\t\t\t\t}\t\t\t\t\t\ttrial: StaticText {}, \t\t\t\t\t} \t\t\t\t\tlicGrp: Group { \t\t\t\t\t\ttxt: EditText {alignment: [\'fill\',\'fill\'], properties:{multiline:false}}, \t\t\t\t\t} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'],                             buyGrp: Group {                             alignment: [\'left\',\'fill\'],                             alignChildren: [\'left\',\'fill\'],                             orientation: \'column\',                             spacing:1,                                  retrieveReg: Button {text:\'" +
 1743:         strRetrieveLic.replace(/%t/, strLicense) +
 1744:         "\', name:\'retrieve\',preferredSize:[130,25]}                                   buyLic: Button {text:\'" +
 1745:         strBuyLic.replace(/%t/, strLicense) +
 1746:         "\', name:\'buy\',preferredSize:[130,25]}                                   }\t\t\t\t\t\tcancelBtn: Button {text:\'" +
 1747:         strCancel +
 1748:         "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t\tokBtn: Button {text:\'" +
 1749:         strOK +
 1750:         "\', preferredSize:[150,50], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
 1751:       e.grp = e.add(t);
 1752:       var i = ScriptUI.newFont(
 1753:         "dialog || palette",
 1754:         ScriptUI.FontStyle.BOLD,
 1755:         12,
 1756:       );
 1757:       var n = ScriptUI.newFont(
 1758:         "dialog || palette",
 1759:         ScriptUI.FontStyle.REGULAR,
 1760:         9,
 1761:       );
 1762:       return (
 1763:         (e.grp.licGrp.txt.preferredSize = [600, 30]),
 1764:         (e.grp.infoGrp.hdrGrp.txt.text = strEnterLicenseCode),
 1765:         (e.grp.infoGrp.hdrGrp.txt.graphics.font = i),
 1766:         (e.grp.infoGrp.hdrGrp.paste.text = ""),
 1767:         (e.grp.infoGrp.hdrGrp.paste.graphics.font = n),
 1768:         (e.grp.infoGrp.trial.text =
 1769:           betaMode || !offerTrial ? "" : strTrialInstructMsg),
 1770:         isServerConfigured(licenseValidity) &&
 1771:           (isServerRunning(licenseValidity)
 1772:             ? (e.grp.infoGrp.hdrGrp.txt.text = strServerInstructMsg)
 1773:             : (e.grp.infoGrp.hdrGrp.txt.text =
 1774:                 strEnterLicenseCode + " " + strServerNotRunning),
 1775:           (e.grp.infoGrp.trial.text = strTrialInstructMsg)),
 1776:         (e.grp.licGrp.txt.text = betaMode || !offerTrial ? "" : "trial"),
 1777:         isServerConfigured(licenseValidity) &&
 1778:           isServerRunning(licenseValidity) &&
 1779:           (e.grp.licGrp.txt.text = "@REMOTE"),
 1780:         (e.grp.okGrp.buyGrp.retrieveReg.visible =
 1781:           e.grp.okGrp.buyGrp.buyLic.visible =
 1782:             !betaMode),
 1783:         (e.grp.okGrp.buyGrp.buyLic.onClick = function () {
 1784:           openURL(strTrialUrl);
 1785:           e.close(false);
 1786:         }),
 1787:         (e.grp.okGrp.buyGrp.retrieveReg.onClick = function () {
 1788:           retrieveLicenseUI(strLicense);
 1789:           e.close(false);
 1790:         }),
 1791:         (e.grp.okGrp.cancelBtn.onClick = function () {
 1792:           e.close(false);
 1793:         }),
 1794:         (e.grp.okGrp.okBtn.onClick = function () {
 1795:           license = e.grp.licGrp.txt.text
 1796:             .replace(/^\s\s*/, "")
 1797:             .replace(/\s\s*$/, "");
 1798:           e.close(true);
 1799:         }),
 1800:         e.layout.layout(true),
 1801:         e.layout.resize(),
 1802:         (e.onResizing = e.onResize =
 1803:           function () {
 1804:             this.layout.resize();
 1805:           }),
 1806:         e
 1807:       );
 1808:     }
 1809:   }
 1810:   function retrieveLicenseUI(e) {
 1811:     var t = new Window("dialog", strRetrieveLic.replace(/%t/, e), void 0, {
 1812:       resizeable: true,
 1813:     });
 1814:     if (null != t) {
 1815:       var i =
 1816:         "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'],                     hdrGrp: Group {                         orientation: \'column\',                         alignment: [\'fill\',\'fill\'],                         alignChildren: [\'fill\',\'fill\'],                                 hdr: StaticText {text:\'" +
 1817:         strLicenseDownloadOptions.replace(
 1818:           /%t/,
 1819:           e.toLowerCase() + "de" == locale ? "n" : "s",
 1820:         ) +
 1821:         "\', alignment: [\'fill\',\'top\'], properties:{multiline:true} },                                },                     buttonsGrp: Group {                         alignment: [\'fill\',\'bottom\'],                         alignChildren: [\'fill\',\'fill\'],                             myDownloadsBtn: Button {text:\'" +
 1822:         strMyDownloads +
 1823:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                             downloadManagerBtn: Button {text:\'" +
 1824:         strDownloadManager +
 1825:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']},                         }, \t\t\t\t}";
 1826:       t.grp = t.add(i);
 1827:       t.grp.buttonsGrp.myDownloadsBtn.onClick = function () {
 1828:         openURL(retrieveUrl);
 1829:         t.close(false);
 1830:       };
 1831:       t.grp.buttonsGrp.downloadManagerBtn.onClick = function () {
 1832:         openURL(managerAppUrl);
 1833:         t.close(false);
 1834:       };
 1835:       t.layout.layout(true);
 1836:       t.layout.resize();
 1837:       t.onResizing = t.onResize = function () {
 1838:         this.layout.resize();
 1839:       };
 1840:       t.show();
 1841:     }
 1842:   }
 1843:   function checkBeta(e, t) {
 1844:     return new Date() < t || new Date() > e;
 1845:   }
 1846:   function helpUI() {
 1847:     var e = new Window(
 1848:       "dialog",
 1849:       strScriptName + " - " + strVersion + " " + strScriptVersion,
 1850:       void 0,
 1851:       { resizeable: true },
 1852:     );
 1853:     if (null != e) {
 1854:       for (
 1855:         var t =
 1856:             -1 != $.os.indexOf("Windows") &&
 1857:             12 <= parseFloat(app.version) &&
 1858:             parseFloat(app.version) < 14
 1859:               ? ["left", "top"]
 1860:               : ["fill", "fill"],
 1861:           i =
 1862:             "group { \t\torientation: \'column\', \t\talignment: [\'" +
 1863:             t[0] +
 1864:             "\',\'" +
 1865:             t[1] +
 1866:             "\'], \t\talignChildren: [\'fill\',\'fill\'],                    infoGrp: Group {                    alignment: [\'fill\',\'top\'],                    alignChildren: [\'fill\',\'top\'], \t\t\t\t\ttxt: StaticText {properties:{multiline:true}, preferredSize:[150,50]},                       hdr: StaticText {properties:{multiline:true}},                       removeLic: Button {text:\'" +
 1867:             strDeactivate +
 1868:             "\', preferredSize:[40,30]} \t\t\t\t} \t\t\t\thelpGrp: Group {                    alignment: [\'" +
 1869:             t[0] +
 1870:             "\',\'" +
 1871:             t[1] +
 1872:             "\'],                    alignChildren: [\'fill\',\'fill\'],                     txt: EditText {properties:{multiline:true, readonly:true}}, \t\t\t\t}                 prefsGrp: Group {                       alignment: [\'fill\',\'bottom\'],                        alignChildren: [\'left\',\'center\'],                        orientation: \'row\',                        checkNow: Button {text:\'" +
 1873:             strCheckNow +
 1874:             "\', preferredSize:[150,25]}                        doUpdateCheck: Checkbox {text:\'" +
 1875:             strVersionCheck +
 1876:             "\', preferredSize:[-1,25]}                        }\t\t\tokGrp: Group {                 alignment: [\'fill\',\'bottom\'],                 alignChildren: [\'fill\',\'center\'],                 supportBtn: Button {text:\'" +
 1877:             strGetSupport +
 1878:             "\', preferredSize:[150,30], alignment: [\'left\',\'center\']}                 ",
 1879:           n = 0;
 1880:         n < Math.min(maxUIButtons, vars.helpButtons.length);
 1881:         n++
 1882:       ) {
 1883:         if (vars.helpButtons[n].hasOwnProperty("name")) {
 1884:           i +=
 1885:             "btn" + n + ": " + vars.helpButtons[n].hasOwnProperty("type") &&
 1886:             validateButtonType(vars.helpButtons[n].type)
 1887:               ? vars.helpButtons[n].type
 1888:               : "Button" +
 1889:                 " {id: \'" +
 1890:                 n +
 1891:                 "\', alignment: [\'left\',\'center\']}";
 1892:         }
 1893:       }
 1894:       i +=
 1895:         "\t\t\t\t\tokBtn: Button {text:\'" +
 1896:         strOK +
 1897:         "\', preferredSize:[150,30], alignment: [\'right\',\'center\']} \t\t\t\t} \t\t}";
 1898:       e.grp = e.add(i);
 1899:       e.grp.helpGrp.txt.preferredSize = [800, 500];
 1900:       var r = "\xa9" + (new Date().getYear() + 1900).toString();
 1901:       e.grp.infoGrp.txt.text =
 1902:         strScriptName +
 1903:         " - " +
 1904:         strVersion +
 1905:         " " +
 1906:         strScriptVersion +
 1907:         "\n" +
 1908:         r +
 1909:         " " +
 1910:         vars.scriptAuthor +
 1911:         "\n\n";
 1912:       e.grp.infoGrp.hdr.text = getRegistration();
 1913:       e.grp.helpGrp.txt.text = vars.helpText;
 1914:       haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
 1915:         (doUpdateCheck = !(
 1916:           "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
 1917:         ));
 1918:       e.grp.prefsGrp.doUpdateCheck.value = doUpdateCheck;
 1919:       e.grp.prefsGrp.doUpdateCheck.onClick = function () {
 1920:         setUpdateCheck(this.value);
 1921:       };
 1922:       e.grp.prefsGrp.checkNow.onClick = function () {
 1923:         ScriptUI.environment.keyboardState.altKey
 1924:           ? alert("aescripts licensing framework version\n" + licensingVersion)
 1925:           : doUpdateCheckNow();
 1926:       };
 1927:       for (
 1928:         var n = 0;
 1929:         n < Math.min(maxUIButtons, vars.helpButtons.length);
 1930:         n += 1
 1931:       ) {
 1932:         vars.helpButtons[n].hasOwnProperty("name") &&
 1933:           ((e.grp.okGrp["btn" + n].text = vars.helpButtons[n].name),
 1934:           vars.helpButtons[n].hasOwnProperty("url")
 1935:             ? (e.grp.okGrp["btn" + n].onClick = function () {
 1936:                 openURL(vars.helpButtons[this.id].url);
 1937:               })
 1938:             : vars.helpButtons[n].hasOwnProperty("onClickFunction") &&
 1939:               (e.grp.okGrp["btn" + n].onClick =
 1940:                 vars.helpButtons[n].onClickFunction),
 1941:           vars.helpButtons[n].hasOwnProperty("btnValue") &&
 1942:             (e.grp.okGrp["btn" + n].value = vars.helpButtons[n].btnValue));
 1943:       }
 1944:       e.grp.infoGrp.removeLic.visible = !isResultTrial(licenseValidity.result);
 1945:       e.grp.infoGrp.removeLic.onClick = function () {
 1946:         removeLic() &&
 1947:           ((e.grp.infoGrp.hdr.text = getRegistration()),
 1948:           (this.visible = false));
 1949:       };
 1950:       e.grp.okGrp.supportBtn.onClick = function () {
 1951:         ScriptUI.environment.keyboardState.shiftKey &&
 1952:         ScriptUI.environment.keyboardState.altKey
 1953:           ? alert(
 1954:               "aescripts + aeplugins\nFramework version: " +
 1955:                 licensingVersion +
 1956:                 "\n" +
 1957:                 strScriptName +
 1958:                 " - " +
 1959:                 strVersion +
 1960:                 " " +
 1961:                 strScriptVersion,
 1962:             )
 1963:           : (openSupportTicket({}), e.close());
 1964:       };
 1965:       e.grp.okGrp.okBtn.onClick = function () {
 1966:         e.close();
 1967:       };
 1968:       -1 != $.os.indexOf("Windows") &&
 1969:         12 <= parseFloat(app.version) &&
 1970:         parseFloat(app.version) < 14 &&
 1971:         (e.maximumSize = [840, 670]);
 1972:       e.layout.layout(true);
 1973:       e.layout.resize();
 1974:       e.onResizing = e.onResize = function () {
 1975:         this.layout.resize();
 1976:       };
 1977:       e.show();
 1978:     }
 1979:   }
 1980:   function validateButtonType(e) {
 1981:     return "Button" === e || "Checkbox" === e;
 1982:   }
 1983:   function openSupportTicket(e) {
 1984:     i = n = "";
 1985:     t = "&subject=";
 1986:     null != e &&
 1987:       void 0 !== e &&
 1988:       (e.hasOwnProperty("subject") && (t += File.encode(e.subject)),
 1989:       e.hasOwnProperty("message") && (i = File.encode(e.message)),
 1990:       e.hasOwnProperty("diagnostic") &&
 1991:         (n = File.encode(e.diagnostic + "\n--\n")));
 1992:     var r =
 1993:       true === isAescriptsSupportUrl
 1994:         ? strSKU + t + "&message="
 1995:         : t.replace(/\&/, "?") + "&body=";
 1996:     var a =
 1997:       "" != r
 1998:         ? i +
 1999:           "%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A%0D%0A-------%0D%0A" +
 2000:           n +
 2001:           getDiagnosticData(true)
 2002:         : "";
 2003:     supportUrl.toString().match(/@/) &&
 2004:       !supportUrl.toString().match(/^mailto:/) &&
 2005:       (supportUrl = "mailto:" + supportUrl);
 2006:     openURL(supportUrl + r + a);
 2007:   }
 2008:   function getDiagnosticData(e) {
 2009:     var t = $.os.toString();
 2010:     var i =
 2011:       BridgeTalk.getDisplayName(BridgeTalk.appName) +
 2012:       " (" +
 2013:       app.version +
 2014:       ") - " +
 2015:       $.locale.toString();
 2016:     var n =
 2017:       strScriptName.replace(/&/, "and") +
 2018:       " - " +
 2019:       strVersion +
 2020:       " " +
 2021:       strScriptVersion;
 2022:     var r = "Lic. fw v" + licensingVersion + isVT() ? " (Trial)" : "";
 2023:     return e
 2024:       ? File.encode(n) +
 2025:           "%0D%0A" +
 2026:           File.encode(t) +
 2027:           "%0D%0A" +
 2028:           File.encode(i) +
 2029:           "%0D%0A" +
 2030:           File.encode(r)
 2031:       : n + "\n" + t + "\n" + i + "\n" + r;
 2032:   }
 2033:   function setUpdateCheck(e) {
 2034:     saveSettings(prefsSectionName, prefsDoUpdateCheck, (doUpdateCheck = e));
 2035:   }
 2036:   function doUpdateCheckNow() {
 2037:     checkForNewVersion((doUpdateCheck = true));
 2038:   }
 2039:   function newVersionUI(t) {
 2040:     var i = new Window("dialog", strNewVersionAvailableHdr, void 0, {
 2041:       resizeable: true,
 2042:     });
 2043:     if (null != i) {
 2044:       var e =
 2045:         "group { \t\t\t\torientation: \'column\', \t\t\t\talignment: [\'fill\',\'fill\'], \t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t   hdrGrp: Group { \t\t\t\t   alignment: [\'fill\',\'fill\'], \t\t\t\t   alignChildren: [\'fill\',\'fill\'], \t\t\t\t   orientation: \'column\',                         hdr: StaticText {alignment: [\'fill\',\'top\'], properties:{multiline:true}}, ";
 2046:       t.hasOwnProperty("header") &&
 2047:         (e +=
 2048:           "   infoGrp: Panel {                            alignment: [\'fill\',\'fill\'],                            alignChildren: [\'fill\',\'fill\'],                            orientation: \'column\',                               info: StaticText {properties:{multiline:true}},                               } ");
 2049:       e +=
 2050:         "} \t\t\t\t\tokGrp: Group { \t\t\t\t\talignment: [\'fill\',\'bottom\'], \t\t\t\t\talignChildren: [\'fill\',\'fill\'], \t\t\t\t\t\tskipVersionBtn: Button {text:\'" +
 2051:         strSkipVersion +
 2052:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']}                            remindMeLaterBtn: Button {text:\'" +
 2053:         strRemindMeLater +
 2054:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t\tdownloadBtn: Button {text:\'" +
 2055:         strDownload +
 2056:         "\', preferredSize:[-1,30], alignment: [\'right\',\'center\']} \t\t\t\t\t} \t\t\t\t}";
 2057:       i.grp = i.add(e);
 2058:       var n = ScriptUI.newFont(
 2059:         "dialog || palette",
 2060:         ScriptUI.FontStyle.BOLD,
 2061:         12,
 2062:       );
 2063:       ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.BOLD, 11);
 2064:       ScriptUI.newFont("dialog || palette", ScriptUI.FontStyle.REGULAR, 9);
 2065:       i.grp.hdrGrp.hdr.graphics.font = n;
 2066:       i.grp.hdrGrp.hdr.text = strNewVersionAvailable.replace(
 2067:         /%v/,
 2068:         t.version + "\n" + strCurrentVersion.replace(/%v/, strScriptVersion),
 2069:       );
 2070:       t.hasOwnProperty("header") &&
 2071:         (i.grp.hdrGrp.infoGrp.info.text = t.header + "\n\n" + t.detail);
 2072:       i.grp.okGrp.skipVersionBtn.onClick = function () {
 2073:         saveSettings(
 2074:           prefsSectionName,
 2075:           prefsLastVersionChecked,
 2076:           strScriptVersion,
 2077:         );
 2078:         saveSettings(
 2079:           prefsSectionName,
 2080:           prefsLastTimeVersionChecked,
 2081:           new Date().toString(),
 2082:         );
 2083:         saveSettings(
 2084:           prefsSectionName,
 2085:           prefsNextTimeVersionCheckedSkipVersion,
 2086:           t.version,
 2087:         );
 2088:         saveSettings(
 2089:           prefsSectionName,
 2090:           prefsLastServerVersionChecked,
 2091:           t.version,
 2092:         );
 2093:         i.close(false);
 2094:       };
 2095:       i.grp.okGrp.remindMeLaterBtn.onClick = function () {
 2096:         try {
 2097:           var e = new Date();
 2098:           e = dateAddDays(remindMeLaterDays);
 2099:           saveSettings(
 2100:             prefsSectionName,
 2101:             prefsLastVersionChecked,
 2102:             strScriptVersion,
 2103:           );
 2104:           saveSettings(
 2105:             prefsSectionName,
 2106:             prefsLastTimeVersionChecked,
 2107:             new Date().toString(),
 2108:           );
 2109:           saveSettings(
 2110:             prefsSectionName,
 2111:             prefsNextTimeVersionChecked,
 2112:             e.toString(),
 2113:           );
 2114:           saveSettings(
 2115:             prefsSectionName,
 2116:             prefsLastServerVersionChecked,
 2117:             t.version,
 2118:           );
 2119:           i.close(false);
 2120:         } catch (e) {
 2121:           alert(e.toString());
 2122:         }
 2123:       };
 2124:       i.grp.okGrp.downloadBtn.onClick = function () {
 2125:         retrieveLicenseUI(strDownload);
 2126:         i.close(true);
 2127:       };
 2128:       i.layout.layout(true);
 2129:       i.layout.resize();
 2130:       i.onResizing = i.onResize = function () {
 2131:         this.layout.resize();
 2132:       };
 2133:       t.hasOwnProperty("header") &&
 2134:         ((i.grp.hdrGrp.infoGrp.size.height = Math.min(
 2135:           i.grp.hdrGrp.infoGrp.size.height,
 2136:           300,
 2137:         )),
 2138:         i.layout.layout(true),
 2139:         i.layout.resize());
 2140:       i.show();
 2141:     }
 2142:   }
 2143:   function dateAddDays(e) {
 2144:     var t = new Date().getTime() + 86400000 * e;
 2145:     return new Date(t);
 2146:   }
 2147:   function checkForNewVersion(e) {
 2148:     if ((null == e && (e = false), doUpdateCheck)) {
 2149:       haveSettings(prefsSectionName, prefsLastVersionChecked) &&
 2150:         (i = getSettings(prefsSectionName, prefsLastVersionChecked));
 2151:       haveSettings(prefsSectionName, prefsLastServerVersionChecked) &&
 2152:         (n = getSettings(prefsSectionName, prefsLastServerVersionChecked));
 2153:       haveSettings(prefsSectionName, prefsLastTimeVersionChecked) &&
 2154:         (r = new Date(
 2155:           getSettings(prefsSectionName, prefsLastTimeVersionChecked),
 2156:         ));
 2157:       haveSettings(prefsSectionName, prefsNextTimeVersionCheckedSkipVersion) &&
 2158:         (s = getSettings(
 2159:           prefsSectionName,
 2160:           prefsNextTimeVersionCheckedSkipVersion,
 2161:         ));
 2162:       haveSettings(prefsSectionName, prefsNextTimeVersionChecked) &&
 2163:         (a = new Date(
 2164:           getSettings(prefsSectionName, prefsNextTimeVersionChecked),
 2165:         ));
 2166:       haveSettings(prefsSectionName, prefsVersionCheckInit) &&
 2167:         (t = getSettings(prefsSectionName, prefsVersionCheckInit));
 2168:       var o = new Date();
 2169:       if (e || null == t || null == a || !(o < a)) {
 2170:         var l = versionCheck(strSKU, true, e);
 2171:         if (null != l) {
 2172:           var c =
 2173:             null != l && l.hasOwnProperty("version")
 2174:               ? l.version
 2175:               : strScriptVersion;
 2176:           if ((e || null == n || n != c) && (e || null == s || s != n)) {
 2177:             saveSettings(prefsSectionName, prefsVersionCheckInit, 1);
 2178:             try {
 2179:               var f = new Date();
 2180:               f = dateAddDays(updateCheckInterval);
 2181:               saveSettings(
 2182:                 prefsSectionName,
 2183:                 prefsLastVersionChecked,
 2184:                 strScriptVersion,
 2185:               );
 2186:               saveSettings(
 2187:                 prefsSectionName,
 2188:                 prefsLastTimeVersionChecked,
 2189:                 new Date().toString(),
 2190:               );
 2191:               saveSettings(
 2192:                 prefsSectionName,
 2193:                 prefsNextTimeVersionChecked,
 2194:                 f.toString(),
 2195:               );
 2196:             } catch (e) {
 2197:               alert(e.toString());
 2198:             }
 2199:             var d = compareVersions(c, strScriptVersion);
 2200:             0 < d && (null == i || null == r || null == a || e || a <= o)
 2201:               ? newVersionUI(l)
 2202:               : d <= 0 && e && alert(strUpToDate);
 2203:           }
 2204:         } else {
 2205:           saveSettings(
 2206:             prefsSectionName,
 2207:             prefsDoUpdateCheck,
 2208:             (doUpdateCheck = false),
 2209:           );
 2210:         }
 2211:       }
 2212:     }
 2213:   }
 2214:   function versionCheck(e, t, i) {
 2215:     var n = extComms(
 2216:       "https://notify.aescripts.com/versioncheck2.php?json=1&plain=1&sku=" +
 2217:         e +
 2218:         t
 2219:         ? "&latest=1"
 2220:         : "" + parseFloat(app.version) < 12
 2221:           ? "&clip_length=200"
 2222:           : "&clip_length=300",
 2223:       null,
 2224:     );
 2225:     if (null == n || "" == n || !validateJSON(n)) {
 2226:       return (i && alert(strUpdateCheckError), null);
 2227:     }
 2228:     try {
 2229:       if (null == (n = JSONify(n, "parse"))) {
 2230:         return null;
 2231:       }
 2232:     } catch (e) {
 2233:       return null;
 2234:     }
 2235:     return "ok" != n.status
 2236:       ? null
 2237:       : t
 2238:         ? {
 2239:             date: n.latest.release_date,
 2240:             detail: n.latest.detail,
 2241:             header: strVersionRev
 2242:               .replace(/%a/, n.version)
 2243:               .replace(/%b/, "")
 2244:               .replace(/%c/, n.latest.release_date),
 2245:             version: n.version,
 2246:           }
 2247:         : { version: n.version };
 2248:   }
 2249:   function extComms(e) {
 2250:     try {
 2251:       if (-1 != $.os.indexOf("Mac")) {
 2252:         var t = system.callSystem('curl -s 2 "' + e + '"');
 2253:       } else {
 2254:         var i =
 2255:           ((n = new File(
 2256:             Folder.userData.fsName + "/Aescripts/aescripts_helper.vbs",
 2257:           )).open("w"),
 2258:           n.write(
 2259:             'dim o: Set o = createobject("MSXML2.XMLHTTP.6.0")\no.Open "GET", WScript.Arguments(0), False\no.Send\nIf o.Status >= 200 And o.Status <= 202 Then\nWScript.Echo o.responseText\nElse\nWScript.Echo "Error"\nEnd If',
 2260:           ),
 2261:           n.close(),
 2262:           n.exists ? n : null);
 2263:         if (null == i) {
 2264:           return null;
 2265:         }
 2266:         t = system.callSystem(
 2267:           'cscript //nologo "' + i.fsName + '" "' + e + '"',
 2268:         );
 2269:       }
 2270:       return t;
 2271:     } catch (e) {
 2272:       return (alert("extComms error\n" + e.toString()), null);
 2273:     }
 2274:   }
 2275:   function socketConnect(e, t) {
 2276:     var i = new Socket();
 2277:     if (
 2278:       ((i.encoding = "binary"), (i.timeout = 2), i.open(e + ":80", "UTF-8"))
 2279:     ) {
 2280:       i.write(
 2281:         "GET /" + t + " HTTP/1.1\nHost: " + e + "\n\nConnection: close\n\n",
 2282:       );
 2283:       var n = i.read(2000);
 2284:       return (i.close(), null != n ? (n = n.toString()) : null);
 2285:     }
 2286:     return null;
 2287:   }
 2288:   function formatHistory(e, t) {
 2289:     var i = e.data;
 2290:     var n = [];
 2291:     for (var r in i) {
 2292:       if (i.hasOwnProperty(r)) {
 2293:         for (var a = i[r].history, s = a.length - 1; 0 <= s; s--) {
 2294:           var o = a[s];
 2295:           var l = "";
 2296:           var c = o.detail;
 2297:           s == a.length - 1 && (l = " (" + strNewestVersionAvailable + ")");
 2298:           var f = strVersionRev
 2299:             .replace(/%0/, o.version_number)
 2300:             .replace(/%1/, l)
 2301:             .replace(/%2/, o.release_date)
 2302:             .replace(/%3/, c);
 2303:           (!options.summaryOnlyNewChanges ||
 2304:             compareVersions(t, o.version_number) < 0) &&
 2305:             n.push(f);
 2306:         }
 2307:       }
 2308:     }
 2309:     return n.join("\n\n");
 2310:   }
 2311:   function getVerifCode(e) {
 2312:     return "1";
 2313:     "trial" == e.toLowerCase() && (e = "");
 2314:     var i =
 2315:       -1 != $.os.indexOf("Mac") &&
 2316:       (Folder("/Volumes/Private").exists || Folder("/Volumes/private").exists)
 2317:         ? Folder.userData.fsName
 2318:         : Folder.temp.fsName +
 2319:           "/" +
 2320:           Math.round(Math.random() * 42132 * new Date().getTime());
 2321:     if (-1 != $.os.indexOf("Win")) {
 2322:       t = wx;
 2323:       i += ".exe";
 2324:     } else {
 2325:       if (systemCall("arch").toLowerCase().match(/ppc/)) {
 2326:         return (alert(strPpcNotSupported), false);
 2327:       }
 2328:       t = mx;
 2329:     }
 2330:     var n = createFile(File(i), t, "BINARY");
 2331:     if (!n.exists) {
 2332:       return ((licenseData = { result: -108 }), licenseData);
 2333:     }
 2334:     n.hidden = true;
 2335:     -1 != $.os.indexOf("Mac") && systemCall('chmod +x "' + n.fsName + '"');
 2336:     var r = systemCall(
 2337:       '"' + n.fsName + '" "' + strHeader + '" ' + privateNum + ' "' + e + '"',
 2338:     );
 2339:     return (n.remove(), parseResult(r));
 2340:   }
 2341:   function parseResult(t) {
 2342:     try {
 2343:       i = parseVerifCode(t.toString());
 2344:     } catch (e) {
 2345:       (i = { result: -101 }).e = e.toString() + "\nresult:\n\n" + t.toString();
 2346:     }
 2347:     return i;
 2348:   }
 2349:   function parseVerifCode(e) {
 2350:     for (var t = e.match(/[^\r\n]+/g), i = {}, n = 0; n < t.length; n++) {
 2351:       var r = t[n].split(":");
 2352:       if (2 <= r.length) {
 2353:         var a = r[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
 2354:         var s = trimQuotes(r[1]);
 2355:         "LS" == a && "UP" == s && (a = "LSS");
 2356:         isNaN(s) || (s = parseFloat(s));
 2357:         i[a] = s;
 2358:       }
 2359:     }
 2360:     return (
 2361:       void 0 === i.result && ((i.result = -102), (i.e = e)),
 2362:       checkTrialDetails(i),
 2363:       checkBetaDetails(i),
 2364:       (isTimeLimited = checkTimeLimited(i)),
 2365:       i
 2366:     );
 2367:   }
 2368:   function checkTimeLimited(e) {
 2369:     var t = retProp("rt$", e);
 2370:     var i = retProp("nd$", e);
 2371:     if ("" == t || "" == i) {
 2372:       return false;
 2373:     }
 2374:     switch (e.result) {
 2375:       case -20:
 2376:         e.e = t;
 2377:         break;
 2378:       case -21:
 2379:         e.e = i;
 2380:     }
 2381:   }
 2382:   function checkFloatingLicense(e) {
 2383:     retProp("pe$", e) != bD("RkxU") || isServerRunning(e) || (e.result = -109);
 2384:   }
 2385:   function checkTrialDetails(e) {
 2386:     if (-7 !== e.result) {
 2387:     } else if (0 == trialLengthDays) {
 2388:       e.result = -106;
 2389:     } else {
 2390:       var t = retProp("^d", e);
 2391:       if (void 0 === t) {
 2392:         return void (e.result = -103);
 2393:       }
 2394:       var i = trialLengthDays - t;
 2395:       0 < i
 2396:         ? ((e.result = 100), (e.tdl = i), (e.license = bD("VFJJQUw=")))
 2397:         : ((e.result = -100), (e.tdl = 0));
 2398:     }
 2399:   }
 2400:   function checkBetaDetails(e) {
 2401:     var t = e.result;
 2402:     var i = retProp("pe$", e).match(/^B/);
 2403:     betaMode && (isResultTrial(t) || -106 == t || -7 == t)
 2404:       ? (e.result = -107)
 2405:       : !betaMode && i && (e.result = -105);
 2406:   }
 2407:   function isResultValidLicense(e) {
 2408:     return true;
 2409:   }
 2410:   function isResultTrial(e) {
 2411:     return false;
 2412:   }
 2413:   function isServerConfigured(e) {
 2414:     try {
 2415:       return retProp("^L", e).match(/^O/);
 2416:     } catch (e) {}
 2417:   }
 2418:   function isServerRunning(e) {
 2419:     try {
 2420:       return retProp("SS$", e).match(/^U/);
 2421:     } catch (e) {}
 2422:   }
 2423:   function trimQuotes(e) {
 2424:     return (
 2425:       "\'" == (e = e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ""))[0] &&
 2426:         "\'" == e[e.length - 1] &&
 2427:         (e = e.substring(1, e.length - 1)),
 2428:       e
 2429:     );
 2430:   }
 2431:   function sanitizeProductName(e) {
 2432:     return e.toString().replace(/[^a-z0-9]/gi, "");
 2433:   }
 2434:   function checkErrorCode(e) {
 2435:     return licErrors[locale].hasOwnProperty(e.toString()) ? e : "unknown";
 2436:   }
 2437:   function string_encode3(e) {
 2438:     for (var t = 0, i = 0; i < e.length; i++) {
 2439:       t += e.charCodeAt(i);
 2440:     }
 2441:     return t;
 2442:   }
 2443:   function getVerifCode3(e) {
 2444:     var t = e.split("*");
 2445:     if (4 == t.length) {
 2446:       var i = t[3].replace(/^[0-9]+/, "");
 2447:       var n = t[3].match(/^[0-9]+/, "");
 2448:       var r = n[0].substr(0, 2);
 2449:       var a = n[0].substr(n[0].length - 2);
 2450:       var s = r[0] + t[0] + r[1] + t[1] + a[0] + t[2] + a[1] + i;
 2451:       var o = n[0].substring(2, n[0].length - 2);
 2452:       return string_encode3(s) * privateNum == o ? "1" : "0";
 2453:     }
 2454:     return (e != bE("bad") && alert(strNewLicenseFormat), "0");
 2455:   }
 2456:   function string_encode(e) {
 2457:     return (
 2458:       e.length * e.charCodeAt(0) +
 2459:       e.charCodeAt(Math.floor(0.1 * (e.length - 1))) +
 2460:       e.charCodeAt(Math.floor(0.2 * (e.length - 1))) +
 2461:       e.charCodeAt(Math.floor(0.3 * (e.length - 1))) +
 2462:       e.charCodeAt(Math.floor(0.4 * (e.length - 1))) +
 2463:       e.charCodeAt(Math.floor(0.5 * (e.length - 1))) +
 2464:       e.charCodeAt(Math.floor(0.7 * (e.length - 1))) +
 2465:       e.charCodeAt(Math.floor(0.8 * (e.length - 1))) +
 2466:       e.charCodeAt(Math.floor(0.9 * (e.length - 1))) +
 2467:       e.charCodeAt(e.length - 1)
 2468:     );
 2469:   }
 2470:   function check_v1_License(e) {
 2471:     var t = e.split("**");
 2472:     return (
 2473:       !(
 2474:         !e.replace(/^ +|| +$/g, "").match(/^.+\*\*.+\*\*[0-9]+[A-Za-z]{3}$/) ||
 2475:         3 != t.length
 2476:       ) || (alert(strOldLicenseFormat), false)
 2477:     );
 2478:   }
 2479:   function check_v2_License(e) {
 2480:     var t = e.split("*");
 2481:     return (
 2482:       e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[0-9]+[A-Za-z]{3}[0-9]+$/) &&
 2483:       4 == t.length
 2484:     );
 2485:   }
 2486:   function check_timed_License(e) {
 2487:     var t = e.split("*");
 2488:     return (
 2489:       e.match(/^[A-Z0-9]+\*[^\*]+\*[^\*]+\*[A-Z0-9#]+[A-Za-z]{3}[0-9]+$/) &&
 2490:       4 == t.length
 2491:     );
 2492:   }
 2493:   function checkCode(e, t, i) {
 2494:     if (
 2495:       ((t = null == t ? "" : t.replace(/^\s\s*/, "").replace(/\s\s*$/, "")),
 2496:       (myLicense = false),
 2497:       e && ((regUI = licUI()), (myRegPrompt = regUI.show()), !myRegPrompt))
 2498:     ) {
 2499:       return false;
 2500:     }
 2501:     var n = false;
 2502:     "@remote" == (t = null == license ? t : license).toLowerCase() &&
 2503:       ((t = strHeader + t), (n = true));
 2504:     var r = t.split("*");
 2505:     var a = t.match(/#/);
 2506:     var s = a && check_timed_License(t);
 2507:     var o = check_v2_License(t);
 2508:     if (!((offerTrial && "trial" == t.toLowerCase()) || n || o || s)) {
 2509:       if (t.match(/^[A-Z]{2}[A-Z0-9]{30}$/)) {
 2510:         var l = confirm(strTempCode);
 2511:         return (
 2512:           isSecurityPrefSet() && l && openURL(exchangeUrl + "?serial=" + t),
 2513:           myLicense
 2514:         );
 2515:       }
 2516:       return (
 2517:         alert(
 2518:           strInvalidCode + "\n" + betaMode
 2519:             ? strNewLicenseFormat.replace(
 2520:                 new RegExp(bD("U1VM"), "g"),
 2521:                 bD("QlRB"),
 2522:               )
 2523:             : strNewLicenseFormat + "\n\n" + strContactSupport,
 2524:         ),
 2525:         saveSettings(prefsSectionName, prefsName, bE("bad")),
 2526:         saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
 2527:         saveSettings(prefsSectionName, prefsLicVersion, licensingVersion),
 2528:         checkCode(true),
 2529:         myLicense
 2530:       );
 2531:     }
 2532:     if (("trial" != t.toLowerCase() || n) && !n) {
 2533:       if (null != r[0] && r[0] != strHeader) {
 2534:         return (
 2535:           alert(strWrongProduct + "\n" + strContactSupport),
 2536:           checkCode(e),
 2537:           false
 2538:         );
 2539:       }
 2540:       var c = r[3].match(/[A-Z]{3}[0-9]+$/);
 2541:       if (null != c) {
 2542:         if (c[0].match(bD("QlRB")) && !betaMode) {
 2543:           return (
 2544:             alert(strBetaCodeAlert),
 2545:             saveSettings(prefsSectionName, prefsName, bE("bad")),
 2546:             checkCode(true),
 2547:             false
 2548:           );
 2549:         }
 2550:         myLicense = true;
 2551:       }
 2552:     }
 2553:     if (
 2554:       !isResultValidLicense(
 2555:         (licenseValidity = 2 == licV ? getVerifCode(t) : getVerifCode3(t)),
 2556:       )
 2557:     ) {
 2558:       e || (e = true);
 2559:       var f = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
 2560:       return (
 2561:         alert(
 2562:           licErrors[locale][checkErrorCode(licenseValidity.result)].title +
 2563:             "\n" +
 2564:             licErrors[locale][checkErrorCode(licenseValidity.result)].detail +
 2565:             f,
 2566:         ),
 2567:         -9 == licenseValidity.result &&
 2568:           prompt(strDeactivate + "?") &&
 2569:           getVerifCode("-"),
 2570:         checkCode(e),
 2571:         myLicense
 2572:       );
 2573:     }
 2574:     if (
 2575:       ((isValidTrial =
 2576:         !a &&
 2577:         offerTrial &&
 2578:         "trial" == t.toLowerCase() &&
 2579:         isResultTrial(licenseValidity.result)),
 2580:       e && !isValidTrial)
 2581:     ) {
 2582:       var d = parseInt(retProp("^n", licenseValidity), 10);
 2583:       t.match(/@remote/i) ||
 2584:         alert(
 2585:           strRegSuccess.replace("%u", d) + (1 < d) && "de" != locale
 2586:             ? "s"
 2587:             : "" + betaMode
 2588:               ? ""
 2589:               : "\n" + strRegSuccess1,
 2590:         );
 2591:     }
 2592:     return ((myLicense = true), myLicense);
 2593:   }
 2594:   function checkForLegacyLic() {
 2595:     var e = haveSettings(prefsSectionName, prefsName)
 2596:       ? bD(getSettings(prefsSectionName, prefsName))
 2597:       : "";
 2598:     return check_v2_License(e) ? e : "";
 2599:   }
 2600:   function trial_expired() {
 2601:     var e = confirm(strExpiredAlert);
 2602:     isSecurityPrefSet() && e
 2603:       ? openURL(strTrialUrl)
 2604:       : e && isAE() && alert(strErrScriptAccess);
 2605:   }
 2606:   function bD(e) {
 2607:     var o = "";
 2608:     var l = 0;
 2609:     e = e.replace(/[^A-Za-z0-9\+\/\=]/g, "");
 2610:     for (
 2611:       var c =
 2612:         "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
 2613:       l < e.length;
 2614:     ) {
 2615:       t =
 2616:         (c.indexOf(e.charAt(l++)) << 2) | ((r = c.indexOf(e.charAt(l++))) >> 4);
 2617:       i = ((15 & r) << 4) | ((a = c.indexOf(e.charAt(l++))) >> 2);
 2618:       n = ((3 & a) << 6) | (s = c.indexOf(e.charAt(l++)));
 2619:       o += String.fromCharCode(t);
 2620:       64 != a && (o += String.fromCharCode(i));
 2621:       64 != s && (o += String.fromCharCode(n));
 2622:     }
 2623:     return o;
 2624:   }
 2625:   function bE(e) {
 2626:     for (
 2627:       t,
 2628:         i,
 2629:         n,
 2630:         r,
 2631:         a,
 2632:         s,
 2633:         o,
 2634:         l = "",
 2635:         c = 0,
 2636:         f = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
 2637:       c < e.length;
 2638:     ) {
 2639:       r = (t = e.charCodeAt(c++)) >> 2;
 2640:       a = ((3 & t) << 4) | ((i = e.charCodeAt(c++)) >> 4);
 2641:       s = ((15 & i) << 2) | ((n = e.charCodeAt(c++)) >> 6);
 2642:       o = 63 & n;
 2643:       isNaN(i) ? (s = o = 64) : isNaN(n) && (o = 64);
 2644:       l = l + f.charAt(r) + f.charAt(a) + f.charAt(s) + f.charAt(o);
 2645:     }
 2646:     return l;
 2647:   }
 2648:   function isSecurityPrefSet() {
 2649:     var e =
 2650:       parseFloat(app.version) < 12
 2651:         ? "Main Pref Section"
 2652:         : "Main Pref Section v2";
 2653:     return (
 2654:       1 ==
 2655:       app.preferences.getPrefAsLong(e, "Pref_SCRIPTING_FILE_NETWORK_SECURITY")
 2656:     );
 2657:   }
 2658:   function openURL(e) {
 2659:     if (
 2660:       ((e = e.toString()).match(/@/) ||
 2661:         e.match(/^https?:\/\//) ||
 2662:         (e = "http://" + e.replace(/^(http)?s?:?\/?\/?/, "")),
 2663:       isAE() || isPS())
 2664:     ) {
 2665:       Folder.commonFiles.parent.fsName;
 2666:       -1 != $.os.indexOf("Windows")
 2667:         ? systemCall('cmd /c "start ' + (e = e.replace(/&/g, "^&")) + '"')
 2668:         : systemCall('open "' + e + '"');
 2669:     } else {
 2670:       createFile(
 2671:         File(Folder.temp.fsName + "/openUrl.url"),
 2672:         "[InternetShortcut]\rURL=" + e + "\r",
 2673:         "UTF-8",
 2674:         true,
 2675:       ).execute();
 2676:     }
 2677:   }
 2678:   function parseRegistration(e) {
 2679:     if (0 == retProp("^r", licenseValidity)) {
 2680:       if (
 2681:         ((a = retProp("^f", licenseValidity)),
 2682:         (s = retProp("^la", licenseValidity)),
 2683:         (o = retProp("^n", licenseValidity)),
 2684:         (l = retProp("pe$", licenseValidity)),
 2685:         isTimeLimited &&
 2686:           (parseDateString(retProp("rt$", licenseValidity)),
 2687:           (f = parseDateString(retProp("nd$", licenseValidity)))),
 2688:         0 < e)
 2689:       ) {
 2690:         return a + "\'" + s + "\'" + retProp("^s", licenseValidity) + l + o;
 2691:       }
 2692:       n = a + s.toString().match(/^@/) ? "" : " " + s + " ";
 2693:       r = l;
 2694:     } else {
 2695:       n = "";
 2696:     }
 2697:     var d = strUsers.replace("%u", o) + (1 < o) && "de" != locale ? "s" : "";
 2698:     switch (r) {
 2699:       case bD("U1VM"):
 2700:         t = " - " + strLicense + " " + d;
 2701:         break;
 2702:       case bD("QlRB"):
 2703:         t = " - " + strBTA + " " + d;
 2704:         break;
 2705:       case bD("RURV"):
 2706:         t = " - " + strEDU + " " + d;
 2707:         break;
 2708:       case bD("RkxU"):
 2709:         t = " - " + strFLT + " " + d;
 2710:         break;
 2711:       default:
 2712:         c = retProp("^t", licenseValidity);
 2713:         isTimeLimited ||
 2714:           (t = c < 1 ? strTrialExpired : strTrialTxt.replace(/%E/, c));
 2715:     }
 2716:     return (
 2717:       (i = "" != n ? strRegistration + n + t : t),
 2718:       isTimeLimited && (i += "\nLicense ends: " + f),
 2719:       i
 2720:     );
 2721:   }
 2722:   function parseDateString(e) {
 2723:     var t = e.toString().split("-");
 2724:     return new Date(
 2725:       parseInt(t[0]),
 2726:       parseInt(t[1] - 1),
 2727:       parseInt(t[2]),
 2728:     ).toDateString();
 2729:   }
 2730:   function retProp(e, t) {
 2731:     for (var i in t) {
 2732:       if (t.hasOwnProperty(i) && i.toString().match(new RegExp(e))) {
 2733:         return t[i];
 2734:       }
 2735:     }
 2736:     return "";
 2737:   }
 2738:   function isAE() {
 2739:     return BridgeTalk.appName.match(new RegExp(bD("YWZ0ZXJlZmZlY3Rz")));
 2740:   }
 2741:   function isPS() {
 2742:     return BridgeTalk.appName.match(new RegExp(bD("cGhvdG9zaG9w")));
 2743:   }
 2744:   function readFile(e) {
 2745:     if (null != e && null != e && e.exists && e.open("r")) {
 2746:       var t = e.read();
 2747:       return (e.close(), t);
 2748:     }
 2749:     return null;
 2750:   }
 2751:   function createFile(e, t, i, n, r) {
 2752:     return (
 2753:       ((null == e || null == e || e.exists) && !n) ||
 2754:         (e.exists && e.remove(),
 2755:         ((e =
 2756:           -1 != $.os.indexOf("Win")
 2757:             ? new File(e.fsName)
 2758:             : new File(e.absoluteURI)).encoding = i),
 2759:         e.open("w"),
 2760:         e.write(t),
 2761:         e.close(),
 2762:         (null != r && r) || (e.hidden = true),
 2763:         -1 != $.os.indexOf("Mac") &&
 2764:           systemCall(bD("Y2htb2QgK3gg") + e.absoluteURI)),
 2765:       e
 2766:     );
 2767:   }
 2768:   function systemCall(e) {
 2769:     if (isAE()) {
 2770:       return system.callSystem(e);
 2771:     }
 2772:     if (isPS()) {
 2773:       var t =
 2774:         -1 != $.os.indexOf("Win")
 2775:           ? Folder.temp.fsName
 2776:           : Folder.temp.absoluteURI +
 2777:             "/" +
 2778:             Math.round(Math.random() * 71827 * new Date().getTime());
 2779:       return (app.system(e + " > " + t), readFile(File(t)));
 2780:     }
 2781:     return "";
 2782:   }
 2783:   function parseSettings(e, t) {
 2784:     for (var i in t) {
 2785:       if (t.hasOwnProperty(i)) {
 2786:         if ("object" == typeof t[i]) {
 2787:           return parseSettings(e, t[i]);
 2788:         }
 2789:         if (i === e) {
 2790:           return t[i];
 2791:         }
 2792:       }
 2793:     }
 2794:   }
 2795:   function readJSON(e) {
 2796:     if (null == e || null == e) {
 2797:       return false;
 2798:     }
 2799:     e instanceof File || File(e);
 2800:     var t = readFile(e);
 2801:     return JSONify(t, "parse");
 2802:   }
 2803:   function writeJSON(e, t) {
 2804:     if (null == e || null == e || null == t || null == t) {
 2805:       return false;
 2806:     }
 2807:     t instanceof File || File(t);
 2808:     return (
 2809:       createFile(t, JSONify(e, "stringify", "\t"), "UTF-8", true, true),
 2810:       t.exists
 2811:     );
 2812:   }
 2813:   function getSettings(e, t, i) {
 2814:     if (isAE() && "settings" != i) {
 2815:       return app.settings.getSetting(e, t);
 2816:     }
 2817:     var n = File(prefsLocation + prefsPrefix + File.encode(e));
 2818:     var r = readFile(n);
 2819:     var a = JSONify(r, "parse");
 2820:     if (a instanceof Array) {
 2821:       for (var s in ((a = fixSettingsFile(a)), n.remove(), a)) {
 2822:         saveSettings(e, s, a[s]);
 2823:       }
 2824:     }
 2825:     return a[t];
 2826:   }
 2827:   function haveSettings(e, t, i) {
 2828:     if (isAE() && "settings" != i) {
 2829:       return app.settings.haveSetting(e, t);
 2830:     }
 2831:     var n = readFile(File(prefsLocation + prefsPrefix + File.encode(e)));
 2832:     if (null != n) {
 2833:       var r = JSONify(n.toString(), "parse");
 2834:       return (r instanceof Array && (r = fixSettingsFile(r)), t in r);
 2835:     }
 2836:     return false;
 2837:   }
 2838:   function fixSettingsFile(e) {
 2839:     for (var t = {}, i = 0; i < e.length - 1; i++) {
 2840:       t[e[i]] = e[i + 1];
 2841:       i++;
 2842:     }
 2843:     return t;
 2844:   }
 2845:   function saveSettings(e, t, i, n) {
 2846:     if (isAE() && "settings" != n) {
 2847:       app.settings.saveSetting(e, t, i);
 2848:       app.preferences.saveToDisk();
 2849:     } else {
 2850:       var r = {};
 2851:       var a = File(prefsLocation + prefsPrefix + File.encode(e));
 2852:       if (a.exists) {
 2853:         var s = readFile(a);
 2854:         null != s && (r = JSONify(s.toString(), "parse"));
 2855:       }
 2856:       r instanceof Array && (r = fixSettingsFile(r));
 2857:       r[t] = i;
 2858:       createFile(
 2859:         File(prefsLocation + prefsPrefix + File.encode(e)),
 2860:         JSONify(r, "stringify", "\t"),
 2861:         "UTF-8",
 2862:         true,
 2863:       );
 2864:     }
 2865:   }
 2866:   function saveVersionsToPrefs() {
 2867:     saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
 2868:     saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
 2869:   }
 2870:   function isVT() {
 2871:     return (
 2872:       (void 0 !== licenseValidity &&
 2873:         licenseValidity.hasOwnProperty("result")) ||
 2874:         (licenseValidity = getVerifCode("")),
 2875:       isResultValidLicense(licenseValidity) &&
 2876:         isResultTrial(licenseValidity.result)
 2877:     );
 2878:   }
 2879:   function getRegistration(e) {
 2880:     return (
 2881:       (void 0 !== licenseValidity &&
 2882:         licenseValidity.hasOwnProperty("result")) ||
 2883:         (licenseValidity = getVerifCode("")),
 2884:       parseRegistration(e)
 2885:     );
 2886:   }
 2887:   function removeLic() {
 2888:     (void 0 !== licenseValidity && licenseValidity.hasOwnProperty("result")) ||
 2889:       (licenseValidity = getVerifCode(""));
 2890:     var e =
 2891:       isServerConfigured(licenseValidity) && isServerRunning(licenseValidity)
 2892:         ? strHeader + "@REMOTE"
 2893:         : "";
 2894:     return (
 2895:       (licenseValidity = getVerifCode("-" + e)),
 2896:       (theLicense = false),
 2897:       alert(strScriptName + ": " + strLicenseRemoved),
 2898:       isServerConfigured(licenseValidity) ||
 2899:         (saveSettings(prefsSectionName, prefsName, bE("bad")),
 2900:         saveSettings(prefsSectionName, prefsVersionName, strScriptVersion),
 2901:         saveSettings(prefsSectionName, prefsLicVersion, licensingVersion)),
 2902:       !theLicense
 2903:     );
 2904:   }
 2905:   function mainFunc(e) {
 2906:     if (
 2907:       !isAE() ||
 2908:       isSecurityPrefSet() ||
 2909:       (alert(strErrScriptAccess),
 2910:       parseFloat(app.version) < 16.1
 2911:         ? app.executeCommand(2359)
 2912:         : app.executeCommand(3131),
 2913:       isSecurityPrefSet())
 2914:     ) {
 2915:       if (betaMode && checkBeta(betaExpirationDate, betaStartDate)) {
 2916:         "l" == e && alert(strBetaExpiredAlert);
 2917:       } else {
 2918:         if ("l" == e || "c" == e || "r" == e) {
 2919:           var n = false;
 2920:           if (("l" == e && doUpdateCheck && checkForNewVersion(), 2 == licV)) {
 2921:             if ("r" == e) {
 2922:               i = !removeLic();
 2923:             } else {
 2924:               if ("-22" == (licenseValidity = getVerifCode("")).result) {
 2925:                 var r = "e" in licenseValidity ? "\n" + licenseValidity.e : "";
 2926:                 alert(
 2927:                   licErrors[locale][checkErrorCode(licenseValidity.result)]
 2928:                     .title +
 2929:                     "\n" +
 2930:                     licErrors[locale][checkErrorCode(licenseValidity.result)]
 2931:                       .detail +
 2932:                     r,
 2933:                 );
 2934:                 getVerifCode("-");
 2935:                 n = true;
 2936:                 t =
 2937:                   isServerConfigured(licenseValidity) &&
 2938:                   isServerRunning(licenseValidity)
 2939:                     ? "@REMOTE"
 2940:                     : "trial";
 2941:               }
 2942:               if (
 2943:                 isResultValidLicense(licenseValidity) &&
 2944:                 !isResultTrial(licenseValidity.result)
 2945:               ) {
 2946:                 return true;
 2947:               }
 2948:               "" == (t = checkForLegacyLic()) &&
 2949:                 ((n = true),
 2950:                 (t =
 2951:                   isServerConfigured(licenseValidity) &&
 2952:                   isServerRunning(licenseValidity)
 2953:                     ? "@REMOTE"
 2954:                     : "trial"));
 2955:               i = checkCode(n, t, privateNum);
 2956:             }
 2957:           } else {
 2958:             haveSettings(prefsSectionName, prefsName)
 2959:               ? ((t = getSettings(prefsSectionName, prefsName)),
 2960:                 (n = !(
 2961:                   "c" == e ||
 2962:                   !(
 2963:                     ("bad" == t || "bad" == bD(t) || offerTrial) &&
 2964:                     "trial" == bD(t)
 2965:                   )
 2966:                 )))
 2967:               : "c" == e
 2968:                 ? (saveSettings(
 2969:                     prefsSectionName,
 2970:                     prefsName,
 2971:                     bE((t = !isTimeLimited && offerTrial ? "trial" : "")),
 2972:                   ),
 2973:                   saveSettings(
 2974:                     prefsSectionName,
 2975:                     prefsVersionName,
 2976:                     strScriptVersion,
 2977:                   ),
 2978:                   saveSettings(
 2979:                     prefsSectionName,
 2980:                     prefsLicVersion,
 2981:                     licensingVersion,
 2982:                   ),
 2983:                   (n = false))
 2984:                 : (n = true);
 2985:             i = checkCode(n, t, privateNum);
 2986:           }
 2987:           return i;
 2988:         }
 2989:       }
 2990:     }
 2991:   }
 2992:   var licensingVersion = "3.0.42";
 2993:   null == vars.scriptName &&
 2994:     alert("scriptName variable missing in settings object");
 2995:   var strScriptName = vars.scriptName;
 2996:   null == vars.scriptVersion &&
 2997:     alert("scriptVersion variable missing in settings object");
 2998:   var strScriptVersion = vars.scriptVersion;
 2999:   null == vars.scriptURL &&
 3000:     alert("scriptURL variable missing in settings object");
 3001:   var strTrialUrl = vars.scriptURL;
 3002:   null == vars.privateNumber &&
 3003:     alert("privateNumber variable missing in settings object");
 3004:   var privateNum = vars.privateNumber;
 3005:   null == vars.productSKU &&
 3006:     alert("productSKU variable missing in settings object");
 3007:   var strSKU = vars.productSKU;
 3008:   var strSKUArray = strSKU.toString().split("-");
 3009:   if (null == strSKUArray || 2 != strSKUArray.length) {
 3010:     return (
 3011:       alert(
 3012:         "Product SKU incorrectly entered in settings. Should looks like this: XXXX-SUL",
 3013:       ),
 3014:       false
 3015:     );
 3016:   }
 3017:   null == vars.helpText && (vars.helpText = "");
 3018:   null == vars.helpButtons && (vars.helpButtons = []);
 3019:   var isTimeLimited =
 3020:     vars.hasOwnProperty("isTimeLimited") && vars.isTimeLimited;
 3021:   var strHeader = strSKUArray[0];
 3022:   var betaSupportEmail = vars.hasOwnProperty("betaSupportEmail")
 3023:     ? vars.betaSupportEmail
 3024:     : "";
 3025:   var offerTrial = !vars.hasOwnProperty("offerTrial") || vars.offerTrial;
 3026:   var trialLengthDays = vars.hasOwnProperty("trialLengthDaysX")
 3027:     ? vars.trialLengthDaysX
 3028:     : Math.round(Math.sqrt(parseInt(bD("NTU3Ng==").substr(0, 2))));
 3029:   var betaMode = !!vars.hasOwnProperty("offerBeta") && vars.offerBeta;
 3030:   if (betaMode) {
 3031:     null == vars.betaStartDate &&
 3032:       alert("betaStartDate variable missing in settings object");
 3033:     var betaStartDate = vars.betaStartDate;
 3034:     null == vars.betaExpirationDate &&
 3035:       alert("betaExpirationDate variable missing in settings object");
 3036:     var betaExpirationDate = vars.betaExpirationDate;
 3037:   }
 3038:   var supportEmail =
 3039:     vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
 3040:       ? vars.externalSupportURL
 3041:       : "http://aescripts.com/contact";
 3042:   betaMode && "" != betaSupportEmail && (supportEmail = betaSupportEmail);
 3043:   var aescriptsSupportUrl = "https://aescripts.com/contact";
 3044:   var supportUrl =
 3045:     vars.hasOwnProperty("externalSupportURL") && "" != vars.externalSupportURL
 3046:       ? vars.externalSupportURL
 3047:       : aescriptsSupportUrl;
 3048:   var isAescriptsSupportUrl = supportUrl === aescriptsSupportUrl;
 3049:   isAescriptsSupportUrl &&
 3050:     (supportUrl = supportUrl.replace(/\/*/, "") + "/?direct=1&sku=");
 3051:   var aescriptsRetrieveUrl =
 3052:     "https://aescripts.com/downloadable/customer/products";
 3053:   var retrieveUrl =
 3054:     vars.hasOwnProperty("retrieveLicenseURL") && "" != vars.retrieveLicenseURL
 3055:       ? vars.retrieveLicenseURL
 3056:       : aescriptsRetrieveUrl;
 3057:   var exchangeUrl = "https://license.aescripts.com/exchange";
 3058:   var useLegacyPrefsHeader =
 3059:     !!vars.hasOwnProperty("useLegacyPrefsHeader") && vars.useLegacyPrefsHeader;
 3060:   var managerAppUrl =
 3061:     "https://aescripts.com/learn/aescripts-aeplugins-manager-app/";
 3062:   var remindMeLaterDays = 7;
 3063:   var doUpdateCheck =
 3064:     !vars.hasOwnProperty("doUpdateCheck") || vars.doUpdateCheck;
 3065:   var updateCheckInterval = 5;
 3066:   var maxUIButtons = 3;
 3067:   var licV = 2;
 3068:   var wx = __BLOB__BLOB_000450__;
 3069:   var mx = __BLOB__BLOB_000451__;
 3070:   function JSONify(string, mode, prettyJSON) {
 3071:     if (typeof JSON !== "object") {
 3072:       JSON = {};
 3073:     }
 3074:     (function () {
 3075:       function f(n) {
 3076:         return n < 10 ? "0" + n : n;
 3077:       }
 3078:       function this_value() {
 3079:         return this.valueOf();
 3080:       }
 3081:       function quote(string) {
 3082:         rx_escapable.lastIndex = 0;
 3083:         return rx_escapable.test(string)
 3084:           ? '"' +
 3085:               string.replace(rx_escapable, function (a) {
 3086:                 var c = meta[a];
 3087:                 return typeof c === "string"
 3088:                   ? c
 3089:                   : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 3090:               }) +
 3091:               '"'
 3092:           : '"' + string + '"';
 3093:       }
 3094:       function str(key, holder) {
 3095:         var mind = gap;
 3096:         var value = holder[key];
 3097:         if (
 3098:           value &&
 3099:           typeof value === "object" &&
 3100:           typeof value.toJSON === "function"
 3101:         ) {
 3102:           value = value.toJSON(key);
 3103:         }
 3104:         if (typeof rep === "function") {
 3105:           value = rep.call(holder, key, value);
 3106:         }
 3107:         switch (typeof value) {
 3108:           case "string":
 3109:             return quote(value);
 3110:           case "number":
 3111:             return isFinite(value) ? String(value) : "null";
 3112:           case "boolean":
 3113:           case "null":
 3114:             return String(value);
 3115:           case "object":
 3116:             if (!value) {
 3117:               return "null";
 3118:             }
 3119:             gap += indent;
 3120:             partial = [];
 3121:             if (Object.prototype.toString.apply(value) === "[object Array]") {
 3122:               length = value.length;
 3123:               for (var i = 0; i < length; i += 1) {
 3124:                 partial[i] = str(i, value) || "null";
 3125:               }
 3126:               v =
 3127:                 partial.length === 0
 3128:                   ? "[]"
 3129:                   : gap
 3130:                     ? "[\n" +
 3131:                       gap +
 3132:                       partial.join(",\n" + gap) +
 3133:                       "\n" +
 3134:                       mind +
 3135:                       "]"
 3136:                     : "[" + partial.join(",") + "]";
 3137:               gap = mind;
 3138:               return v;
 3139:             }
 3140:             if (rep && typeof rep === "object") {
 3141:               length = rep.length;
 3142:               for (var i = 0; i < length; i += 1) {
 3143:                 if (typeof rep[i] === "string") {
 3144:                   k = rep[i];
 3145:                   v = str(k, value);
 3146:                   if (v) {
 3147:                     partial.push(quote(k) + gap ? ": " : ":" + v);
 3148:                   }
 3149:                 }
 3150:               }
 3151:             } else {
 3152:               for (var k in value) {
 3153:                 if (Object.prototype.hasOwnProperty.call(value, k)) {
 3154:                   v = str(k, value);
 3155:                   if (v) {
 3156:                     partial.push(quote(k) + gap ? ": " : ":" + v);
 3157:                   }
 3158:                 }
 3159:               }
 3160:             }
 3161:             v =
 3162:               partial.length === 0
 3163:                 ? "{}"
 3164:                 : gap
 3165:                   ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}"
 3166:                   : "{" + partial.join(",") + "}";
 3167:             gap = mind;
 3168:             return v;
 3169:         }
 3170:       }
 3171:       ("use strict");
 3172:       var rx_one = /^[\],:{}\s]*$/;
 3173:       var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
 3174:       var rx_three =
 3175:         /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
 3176:       var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
 3177:       var rx_escapable =
 3178:         /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 3179:       var rx_dangerous =
 3180:         /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 3181:       if (typeof Date.prototype.toJSON !== "function") {
 3182:         Date.prototype.toJSON = function () {
 3183:           return isFinite(this.valueOf())
 3184:             ? this.getUTCFullYear() +
 3185:                 "-" +
 3186:                 f(this.getUTCMonth() + 1) +
 3187:                 "-" +
 3188:                 f(this.getUTCDate()) +
 3189:                 "T" +
 3190:                 f(this.getUTCHours()) +
 3191:                 ":" +
 3192:                 f(this.getUTCMinutes()) +
 3193:                 ":" +
 3194:                 f(this.getUTCSeconds()) +
 3195:                 "Z"
 3196:             : null;
 3197:         };
 3198:         Boolean.prototype.toJSON = this_value;
 3199:         Number.prototype.toJSON = this_value;
 3200:         String.prototype.toJSON = this_value;
 3201:       }
 3202:       if (typeof JSON.stringify !== "function") {
 3203:         meta = {
 3204:           "\b": "\\b",
 3205:           "\t": "\\t",
 3206:           "\n": "\\n",
 3207:           "\f": "\\f",
 3208:           "\r": "\\r",
 3209:           '"': '\\"',
 3210:           "\\": "\\\\",
 3211:         };
 3212:         JSON.stringify = function (value, replacer, space) {
 3213:           gap = "";
 3214:           indent = "";
 3215:           if (typeof space === "number") {
 3216:             for (var i = 0; i < space; i += 1) {
 3217:               indent += " ";
 3218:             }
 3219:           } else {
 3220:             if (typeof space === "string") {
 3221:               indent = space;
 3222:             }
 3223:           }
 3224:           rep = replacer;
 3225:           if (
 3226:             replacer &&
 3227:             typeof replacer !== "function" &&
 3228:             (typeof replacer !== "object" ||
 3229:               typeof replacer.length !== "number")
 3230:           ) {
 3231:             throw new Error("JSON.stringify");
 3232:           }
 3233:           return str("", { "": value });
 3234:         };
 3235:       }
 3236:     })();
 3237:     var jsonParse = (function () {
 3238:       function v(h, j, e) {
 3239:         return j ? u[j] : String.fromCharCode(parseInt(e, 16));
 3240:       }
 3241:       var r = "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
 3242:       var k =
 3243:         '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
 3244:       k = '(?:"' + k + '*")';
 3245:       var s = new RegExp(
 3246:         "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
 3247:         "g",
 3248:       );
 3249:       var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
 3250:       var u = {
 3251:         '"': '"',
 3252:         "/": "/",
 3253:         "\\": "\\",
 3254:         b: "\b",
 3255:         f: "\f",
 3256:         n: "\n",
 3257:         r: "\r",
 3258:         t: "\t",
 3259:       };
 3260:       var w = new String("");
 3261:       var x = Object.hasOwnProperty;
 3262:       return function (h, j) {
 3263:         h = h.match(s);
 3264:         var c = h[0];
 3265:         var l = false;
 3266:         if ("{" === c) {
 3267:           e = {};
 3268:         } else if ("[" === c) {
 3269:           e = [];
 3270:         } else {
 3271:           e = [];
 3272:           l = true;
 3273:         }
 3274:         for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
 3275:           c = h[m];
 3276:           switch (c.charCodeAt(0)) {
 3277:             default:
 3278:               a = d[0];
 3279:               a[b || a.length] = c;
 3280:               b = void 0;
 3281:               break;
 3282:             case 34:
 3283:               c = c.substring(1, c.length - 1);
 3284:               if (c.indexOf("\\") !== -1) {
 3285:                 c = c.replace(t, v);
 3286:               }
 3287:               a = d[0];
 3288:               if (!b) {
 3289:                 if (a instanceof Array) {
 3290:                   b = a.length;
 3291:                 } else {
 3292:                   b = c || w;
 3293:                   break;
 3294:                 }
 3295:               }
 3296:               a[b] = c;
 3297:               b = void 0;
 3298:               break;
 3299:             case 91:
 3300:               a = d[0];
 3301:               d.unshift((a[b || a.length] = []));
 3302:               b = void 0;
 3303:               break;
 3304:             case 93:
 3305:               d.shift();
 3306:               break;
 3307:             case 102:
 3308:               a = d[0];
 3309:               a[b || a.length] = false;
 3310:               b = void 0;
 3311:               break;
 3312:             case 110:
 3313:               a = d[0];
 3314:               a[b || a.length] = null;
 3315:               b = void 0;
 3316:               break;
 3317:             case 116:
 3318:               a = d[0];
 3319:               a[b || a.length] = true;
 3320:               b = void 0;
 3321:               break;
 3322:             case 123:
 3323:               a = d[0];
 3324:               d.unshift((a[b || a.length] = {}));
 3325:               b = void 0;
 3326:               break;
 3327:             case 125:
 3328:               d.shift();
 3329:               break;
 3330:           }
 3331:         }
 3332:         if (l) {
 3333:           if (d.length !== 1) {
 3334:             throw new Error();
 3335:           }
 3336:           e = e[0];
 3337:         } else {
 3338:           if (d.length) {
 3339:             throw new Error();
 3340:           }
 3341:         }
 3342:         if (j) {
 3343:           var p = function (n, o) {
 3344:             var f = n[o];
 3345:             if (f && typeof f === "object") {
 3346:               var i = null;
 3347:               for (var g in f) {
 3348:                 if (x.call(f, g) && f !== n) {
 3349:                   var q = p(f, g);
 3350:                   if (q !== void 0) {
 3351:                     f[g] = q;
 3352:                   } else {
 3353:                     i || (i = []);
 3354:                     i.push(g);
 3355:                   }
 3356:                 }
 3357:               }
 3358:               if (i) {
 3359:                 for (g = i.length; --g >= 0; ) {
 3360:                   delete f[i[g]];
 3361:                 }
 3362:               }
 3363:             }
 3364:             return j.call(n, o, f);
 3365:           };
 3366:           e = p({ "": e }, "");
 3367:         }
 3368:         return e;
 3369:       };
 3370:     })();
 3371:     try {
 3372:       switch (mode) {
 3373:         case "parse":
 3374:           if (
 3375:             /^[\],:{}\s]*$/.test(
 3376:               string
 3377:                 .replace(/\\["\\\/bfnrtu]/g, "@")
 3378:                 .replace(
 3379:                   /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
 3380:                   "]",
 3381:                 )
 3382:                 .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
 3383:             )
 3384:           ) {
 3385:             return jsonParse(string);
 3386:           } else {
 3387:             alert("JSON validation error\n" + string.substring(0, 1000));
 3388:           }
 3389:           break;
 3390:         case "stringify":
 3391:           return JSON.stringify(string, undefined, prettyJSON);
 3392:           break;
 3393:       }
 3394:     } catch (e) {
 3395:       alert(e.toString());
 3396:     }
 3397:   }
 3398:   $.locale = isAE() ? app.isoLanguage : $.locale;
 3399:   var locale = $.locale.split("_")[0];
 3400:   ("fr" == locale && "de" == locale && "es" == locale) || (locale = "en");
 3401:   var strTempCode = localize({
 3402:     de:
 3403:       "Du hast eine tempor\xe4re Seriennummer eingegeben, die gegen eine permanente Lizenz eingetauscht werden muss.\n\nSobald Du eine permanente Lizenz erhalten hast, kannst Du sie verwenden um" +
 3404:       strScriptName +
 3405:       " zu registrieren.  Der Austausch ist schnell und unkompliziert, gehe einfach zu:\n\n" +
 3406:       exchangeUrl +
 3407:       "\n\nWillst Du jetzt dorthin gehen?",
 3408:     en:
 3409:       "You entered a temporary serial number that needs to be exchanged for a permanent license.\n\nOnce you obtain your permanent license you can use it to register " +
 3410:       strScriptName +
 3411:       ".  It is quick and easy to exchange it, simply go to:\n\n" +
 3412:       exchangeUrl +
 3413:       "\n\nWould you like to go there now?",
 3414:     es:
 3415:       "Ha introducido un n\xfamero de serie provisional que necesita ser sustituido por una licencia permanente.\n\nUna vez obtenga una licencia permamente puede usarla para registrar " +
 3416:       strScriptName +
 3417:       ". Reemplazarla es r\xe1pido y sencillo, simplemente vaya a:\n\n" +
 3418:       exchangeUrl +
 3419:       "\n\n\xbfQuiere ir all\xed ahora?",
 3420:     fr:
 3421:       "Vous avez entr\xe9 un num\xe9ro de s\xe9rie temporaire devant \xeatre \xe9chang\xe9 contre une licence permanente.\n\nUne fois votre licence permanente acquise, vous pouvez l\'utiliser pour vous enregistrer " +
 3422:       strScriptName +
 3423:       ".  Le changement est rapide et facile,  allez simplement \xe0:\n\n" +
 3424:       exchangeUrl +
 3425:       "\n\nVoulez-vous y aller maintenant?",
 3426:   });
 3427:   var strExpiredAlert = localize({
 3428:     de:
 3429:       "Die Testversion ist leider abgelaufen.\nDu kannst unter " +
 3430:       strTrialUrl +
 3431:       " eine Lizenz erwerben.\n\nM\xf6chtest Du jetzt dorthin gehen?",
 3432:     en:
 3433:       "Sorry, this trial version has expired. \nYou can purchase a license at " +
 3434:       strTrialUrl +
 3435:       "\n\nWould you like to go there now?",
 3436:     es:
 3437:       "Lo siento, esta versi\xf3n de prueba ha expirado.\nPuede obtener una licencia en" +
 3438:       strTrialUrl +
 3439:       "\n\n\xbfQuiere ir all\xed ahora?",
 3440:     fr:
 3441:       "D\xe9sol\xe9, la p\xe9riode d\'essai a expir\xe9.\nPour acheter une licence, veuillez vous rendre sur la page " +
 3442:       strTrialUrl +
 3443:       "\n\nVoulez-vous ouvrir cette page maintenant ?",
 3444:   });
 3445:   var strBetaExpiredAlert = localize({
 3446:     de: "Die Betaversion ist leider abgelaufen",
 3447:     en: "Sorry, this beta version has expired",
 3448:     es: "Lo siento est\xe1 versi\xf3n beta ha expirado",
 3449:     fr: "D\xe9sol\xe9, la p\xe9riode beta a expir\xe9",
 3450:   });
 3451:   var strBetaCodeAlert = localize({
 3452:     de:
 3453:       "Beta Lizenzcode erkannt f\xfcr " +
 3454:       strScriptName +
 3455:       "\nBeta Lizenzen k\xf6nnen nur f\xfcr Betaversionen verwendet werden. Bitte verwende eine normale Lizenz f\xfcr diese Version.",
 3456:     en:
 3457:       "Beta license code detected for " +
 3458:       strScriptName +
 3459:       "\nBeta license codes can only be used on beta versions, please obtain a normal license to use this version.",
 3460:     es:
 3461:       "Licencia beta detectada para " +
 3462:       strScriptName +
 3463:       "\nLas licencias beta s\xf3lo pueden ser usadas con versiones beta, por favor obtenga una licencia normal para usar esta versi\xf3n.",
 3464:     fr:
 3465:       "Licence beta d\xe9tect\xe9e pour " +
 3466:       strScriptName +
 3467:       "\nLes codes pour licence beta ne peuvent \xeatre utilis\xe9s que pour les versions beta, merci de demander une licence r\xe9guli\xe8re pour utiliser cette version.",
 3468:   });
 3469:   var strBetaLicReq = localize({
 3470:     de: "F\xfcr diese Betaversion wird eine Lizenz ben\xf6tigt.\nBitte kontaktiere den Autor f\xfcr eine Betatester-Lizenz.",
 3471:     en: "A license is required to run this beta version\nPlease contact the author for a beta testing license.",
 3472:     es: "Es necesaria una licencia para utilizar esta versi\xf3n beta.\nPor favor, p\xf3ngase en contacto con el autor para obtener una licencia beta.",
 3473:     fr: "Une licence est requise pour ex\xe9cuter cette version beta\nMerci de contacter l\'auteur pour une licence beta de test.",
 3474:   });
 3475:   var strUsers = localize({
 3476:     de: "f\xfcr %u Nutzer",
 3477:     en: "for %u user",
 3478:     es: "para %u usuario",
 3479:     fr: "pour %u utilisateur",
 3480:   });
 3481:   var strRegSuccess = localize({
 3482:     de: "Registrierung erfolgreich " + strUsers,
 3483:     en: "Registration successful " + strUsers,
 3484:     es: "Registro completado " + strUsers,
 3485:     fr: "Enregistrement r\xe9ussi " + strUsers,
 3486:   });
 3487:   var strRegSuccess1 = localize({
 3488:     de: "Danke f\xfcr den Kauf von " + strScriptName,
 3489:     en: "Thank you for purchasing " + strScriptName,
 3490:     es: "Gracias por comprar " + strScriptName,
 3491:     fr: "Merci d\'avoir achet\xe9 " + strScriptName,
 3492:   });
 3493:   var strInvalidCode = localize({
 3494:     de: "Entschuldigung, der Lizenzcode ist nicht g\xfcltig.",
 3495:     en: "Sorry, the license code is not valid",
 3496:     es: "Lo siento, la licencia no es v\xe1lida",
 3497:     fr: "D\xe9sol\xe9, ce num\xe9ro de licence n\'est pas valide.",
 3498:   });
 3499:   var strFirewall = localize({
 3500:     de: "Eine Firewall oder ein Antivirus-Programm blockiert den Lizenz-Prozess. Bitte deaktiviere das Antivirus-Programm oder konfiguriere das System so, dass die Lizenz verifiziert werden kann.",
 3501:     en: "A firewall or virus protection software is blocking the licensing process.  Please disable this or configure it to allow this process so that the license can be verified.",
 3502:     es: 'Un software de "firewall" o de protecci\xf3n antivirus est\xe1 bloqueando el proceso de concesi\xf3n de licencias. Desactivela o configurela para permitir este proceso para que la licencia puede ser verificada.',
 3503:     fr: "Un logiciel pare-feu ou un logiciel antivirus bloque le processus de v\xe9rification de licence. Veuillez le d\xe9sactiver ou le configurer pour permettre \xe0 ce processus de v\xe9rifier la licence.",
 3504:   });
 3505:   var strContactSupport = localize({
 3506:     de: "Wenn Du Hilfe ben\xf6tigst, kontaktiere bitte " + supportEmail,
 3507:     en: "If you require assistance please contact " + supportEmail,
 3508:     es: "Si necesita ayuda, por favor contacte " + supportEmail,
 3509:     fr: "Si vous avez besoin d\'aide, merci de contacter " + supportEmail,
 3510:   });
 3511:   var strCorruptedCode = localize({
 3512:     de:
 3513:       "Entschuldigung, irgendetwas ist mit dem " +
 3514:       strScriptName +
 3515:       " Lizenzcode passiert. Bitte gebe ihn erneut ein.\n\n" +
 3516:       strContactSupport,
 3517:     en:
 3518:       "Sorry, something must have happened to the " +
 3519:       strScriptName +
 3520:       " license code.  Please re-enter it at the prompt.\n" +
 3521:       strContactSupport,
 3522:     es:
 3523:       "Lo siento, algo ha ocurrido con la licencia de " +
 3524:       strScriptName +
 3525:       ". Por favor, vuelva a introducirla en la casilla.\n" +
 3526:       strContactSupport,
 3527:     fr:
 3528:       "D\xe9sol\xe9, il y a eu un probl\xe8me avec le num\xe9ro de licence pour " +
 3529:       strScriptName +
 3530:       ". Merci de bien vouloir le saisir \xe0 nouveau.n\n" +
 3531:       strContactSupport,
 3532:   });
 3533:   var strTrialThanks = localize({
 3534:     de: "Danke, dass Du " + strScriptName + " ausprobierst!",
 3535:     en: "Thanks for trying " + strScriptName + "!",
 3536:     es: "\xa1Gracias por probar " + strScriptName + "!",
 3537:     fr: "Merci d\'avoir essay\xe9 " + strScriptName + "!",
 3538:   });
 3539:   var strTrialTxt = localize({
 3540:     de: "Testversion - noch %E Tage g\xfcltig",
 3541:     en: "Trial version - %E days left",
 3542:     es: "Versi\xf3n de prueba - faltan %E d\xedas",
 3543:     fr: "Version d\'\xe9valuation - %E jour(s) restant",
 3544:   });
 3545:   var strTrialTxt2 = localize({
 3546:     de: "%E Programmstarts \xfcbrig f\xfcr die Testversion",
 3547:     en: "%E launches left in the trial",
 3548:     es: "%E usos restantes de la versi\xf3n de prueba",
 3549:     fr: "Il vous reste %E essais",
 3550:   });
 3551:   var strTrialWelcomeHeader = localize({
 3552:     de: "Willkommen bei " + strScriptName,
 3553:     en: "Welcome to " + strScriptName,
 3554:     es: "Bienvenido a " + strScriptName,
 3555:     fr: "Bienvenue sur " + strScriptName,
 3556:   });
 3557:   var strOK = localize({ de: "OK", en: "OK", es: "OK", fr: "OK" });
 3558:   var strCancel = localize({
 3559:     de: "Abbrechen",
 3560:     en: "Cancel",
 3561:     es: "Cancelar",
 3562:     fr: "Annuler",
 3563:   });
 3564:   var strGetSupport = localize({
 3565:     de: "Support zu erhalten",
 3566:     en: "Get support",
 3567:     es: "Obtener apoyo",
 3568:     fr: "Contacter le support client",
 3569:   });
 3570:   var strRetrieveLic = localize({
 3571:     de: "%t vergessen?",
 3572:     en: "Retrieve %t",
 3573:     es: "Recuperar %t",
 3574:     fr: "Retrouver votre %t",
 3575:   });
 3576:   var strBuyLic = localize({
 3577:     de: "%t Kaufen",
 3578:     en: "Buy %t",
 3579:     es: "Compra %t",
 3580:     fr: "Acheter une %t",
 3581:   });
 3582:   var strLicense = localize({
 3583:     de: "Lizenz",
 3584:     en: "License",
 3585:     es: "licencia",
 3586:     fr: "Licence",
 3587:   });
 3588:   var strDownloads = localize({
 3589:     de: "Download",
 3590:     en: "Download",
 3591:     es: "Descarga",
 3592:     fr: "T\xe9l\xe9chargement",
 3593:   });
 3594:   var strPpcNotSupported = localize({
 3595:     de: "PowerPC (PPC) Prozessoren werden leider nicht unterst\xfctzt. Bitte kontaktiere den Support f\xfcr weitere Informationen.",
 3596:     en: "Sorry, PowerPC (PPC) processors are not supported, please contact support for further assistance.",
 3597:     es: "Lo siendto, los procesadores PowerPC (PPC) no est\xe1n soportados, por favor contacte con soporte para m\xe1s informaci\xf3n.",
 3598:     fr: "D\xe9sol\xe9, les processeurs PowerPC (PPC) ne sont pas support\xe9s, veuillez contacter le service client\xe8le pour plus de d\xe9tails.",
 3599:   });
 3600:   var strAllowScriptsPrefsSection =
 3601:     parseFloat(app.version) < 16.1
 3602:       ? localize({
 3603:           de: "Allgemein",
 3604:           en: "General",
 3605:           es: "General",
 3606:           fr: "G\xe9n\xe9ral",
 3607:         })
 3608:       : localize({
 3609:           de: "Skripterstellung und Expression",
 3610:           en: "Scripting & Expressions",
 3611:           es: "Escripts y expresi\xf3nes",
 3612:           fr: "Scripts et expressions",
 3613:         });
 3614:   var strErrScriptAccess = localize({
 3615:     de:
 3616:       strScriptName +
 3617:       ' ben\xf6tigt die Erlaubnis Dateien zu schreiben\n Gehe in Voreinstellungen von After Effects in die Rubrik "' +
 3618:       strAllowScriptsPrefsSection +
 3619:       '" und aktiviere die Option "Skripten k\xf6nnen Dateien schreiben und haben Netzwerkzugang".',
 3620:     en:
 3621:       strScriptName +
 3622:       ' requires access to write files\nGo to the "' +
 3623:       strAllowScriptsPrefsSection +
 3624:       '" panel of the application preferences and make sure "Allow Scripts to Write Files and Access Network" is checked.',
 3625:     es:
 3626:       strScriptName +
 3627:       ' necesita poder escribir archivos\nVaya al panel "' +
 3628:       strAllowScriptsPrefsSection +
 3629:       '" de las Preferencias y aseg\xfarese de que "Permitir que los scripts puedan escribir archivos y acceder a la red" est\xe1 marcado.\n',
 3630:     fr:
 3631:       strScriptName +
 3632:       " n\xe9cessite les droits d\'\xe9criture de fichiers\nAllez dans le panneau \"" +
 3633:       strAllowScriptsPrefsSection +
 3634:       '" des pr\xe9f\xe9rences de l\'application et cochez \n"Autoriser les scripts \xe0 \xe9crire des fichiers et \xe0 acc\xe9der au r\xe9seau"',
 3635:   });
 3636:   var strUpdateLicenseHeader = localize({
 3637:     de: strScriptName + " Lizenz-Update ben\xf6tigt",
 3638:     en: strScriptName + " License Update Required",
 3639:     es: strScriptName + " necesita actualizar la licencia",
 3640:     fr: "La licence de " + strScriptName + " doit \xeatre mise \xe0 jour",
 3641:   });
 3642:   var strLicenseDownloadOptions = localize({
 3643:     de: 'Alle Deine %t findest Du unter "My Downloads & Licenses" in Deinem aescripts.com Benutzer-Account, oder \xfcber unsere Manager-App.',
 3644:     en: 'All your %t are in the "My Downloads & Licenses" section of your aescripts.com user account, or via our Manager App.',
 3645:     es: 'Todas sus %t est\xe1n en la secci\xf3n "My Downloads & Licenses" de su cuenta de usuario en aescripts.com, o a trav\xe9s de nuestra App Manager.',
 3646:     fr: 'Toutes vos %t se trouvent dans la section "My Downloads & Licenses" de votre compte utilisateur sur aescripts.com, ou via notre App Manager.',
 3647:   });
 3648:   var strMyDownloads = localize({
 3649:     de: "Gehen Sie zu My Downloads & Licenses",
 3650:     en: "Go to My Downloads & Licenses",
 3651:     es: "Ir a My Downloads & Licenses",
 3652:     fr: "Aller \xe0 My Downloads & Licenses",
 3653:   });
 3654:   var strDownloadManager = localize({
 3655:     de: "Laden Sie die Manager-App herunter",
 3656:     en: "Download Manager App",
 3657:     es: "Descargar App Manager",
 3658:     fr: "T\xe9l\xe9charger App Manager",
 3659:   });
 3660:   var strOldLicenseFormat = localize({
 3661:     de: "Die Lizenz sollte so aussehen:\n\nFirstname**Lastname**111111111SUL",
 3662:     en: "License should look like this:\n\nFirstname**Lastname**111111111SUL",
 3663:     es: "La licencia debe tener este aspecto:\n\nNombre**Apellido**111111111SUL",
 3664:     fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPr\xe9nom**Nom**111111111SUL",
 3665:   });
 3666:   var strNewLicenseFormat = localize({
 3667:     de: "Die Lizenz sollte so aussehen:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
 3668:     en: "License should look like this:\n\nPRODUCTID*FIRSTNAME*LASTNAME*1111111SUL1",
 3669:     es: "La licencia debe tener este aspecto:\n\nPRODUCTID*NOMBRE*APELLIDO*1111111SUL1",
 3670:     fr: "Votre licence doit \xeatre similaire \xe0 : \n\nPRODUCTID*PRENOM*NOM*1111111SUL1",
 3671:   });
 3672:   var strRegistration = localize({
 3673:     de: "Registriert f\xfcr: ",
 3674:     en: "Registered to: ",
 3675:     es: "Registrado a: ",
 3676:     fr: "Enregistr\xe9 pour: ",
 3677:   });
 3678:   var strUnknownError = localize({
 3679:     de:
 3680:       "Es gab einen unerwarteten Fehler\nBitte \xf6ffne hier ein Support-Ticket:\n" +
 3681:       supportEmail +
 3682:       "\n\nund f\xfcge einen Screenshot der Fehlermeldung bei\n\n",
 3683:     en:
 3684:       "There was an unexpected error\nPlease please open a support ticket here:\n" +
 3685:       supportEmail +
 3686:       "\n\nand submit screenshot of this error message\n\n",
 3687:     es:
 3688:       "Se ha producido un error desconocido\nPor favor habra un ticket de soporte aqui:\n" +
 3689:       supportEmail +
 3690:       "\n\ny presente una captura de pantalla con este mensaje de error\n\n",
 3691:     fr:
 3692:       "Une erreur vient de se produire \nVeuillez ouvrir un ticket de service client \xe0 cette adresse:\n" +
 3693:       supportEmail +
 3694:       "\n\net n\'oubliez pas d\'y joindre une capture d\'\xe9cran de ce message\n\n",
 3695:   });
 3696:   var strWrongProduct = localize({
 3697:     de: "Dieser Lizenz-Code ist f\xfcr ein anderes Produkt, bitte stelle sicher, dass du den richtigen Lizenzcode eingibst\n\n",
 3698:     en: "This license code is for a different product, please double check that you are entering the correct license\n\n",
 3699:     es: "Este c\xf3digo de licencia es para un producto diferente, por favor, comprobar que esta introduciendo la licencia correcta\n\n",
 3700:     fr: "Vous venez d\'entrer la cl\xe9 de licence d\'un autre produit, assurez-vous d\'utiliser la bonne cl\xe9 de licence\n\n",
 3701:   });
 3702:   var strNewVersionAvailableHdr = localize({
 3703:     de: strScriptName + " Update verf\xfcgbar",
 3704:     en: strScriptName + " Update Available",
 3705:     es: strScriptName + " Actualizaci\xf3n disponible",
 3706:     fr: strScriptName + " Mise \xe0 jour disponible",
 3707:   });
 3708:   var strNewVersionAvailable = localize({
 3709:     de: "Eine neuere Version von " + strScriptName + " ist verf\xfcgbar: v%\n",
 3710:     en: "A newer version of " + strScriptName + " is available: %v\n",
 3711:     es:
 3712:       "Una versi\xf3n nueva de " + strScriptName + " est\xe1 disponible: v%\n",
 3713:     fr: "Une version plus de " + strScriptName + " est disponible: v%\n",
 3714:   });
 3715:   var strCurrentVersion = localize({
 3716:     de: "Votre version install\xe9e est: v%",
 3717:     en: "Your installed version is: %v",
 3718:     es: "Su versi\xf3n instalada es: v%",
 3719:     fr: "Votre version install\xe9e est: v%",
 3720:   });
 3721:   var strDownload = localize({
 3722:     de: "Download",
 3723:     en: "Download",
 3724:     es: "Descargar",
 3725:     fr: "T\xe9l\xe9charger",
 3726:   });
 3727:   var strVersion = localize({
 3728:     de: "Version",
 3729:     en: "version",
 3730:     es: "versi\xf3n",
 3731:     fr: "version",
 3732:   });
 3733:   var strSkipVersion = localize({
 3734:     de: "Diese Version \xdcberspringen",
 3735:     en: "Skip this Version",
 3736:     es: "Salta esta versi\xf3n",
 3737:     fr: "Ignorer cette version",
 3738:   });
 3739:   var strRemindMeLater = localize({
 3740:     de: "Erinnere mich sp\xe4ter",
 3741:     en: "Remind Me Later",
 3742:     es: "Recu\xe9rdame m\xe1s tarde",
 3743:     fr: "Rappelle-moi plus tard",
 3744:   });
 3745:   var strNewestVersionAvailable = localize({
 3746:     de: "Neueste verf\xfcgbare Version",
 3747:     en: "Newest available version",
 3748:     es: "Versi\xf3n mas nueva disponible",
 3749:     fr: "Nouvelle version disponible",
 3750:   });
 3751:   var strVersionRev = localize({
 3752:     de: "v%a%b - %c",
 3753:     en: "v%a%b - %c",
 3754:     es: "v%a%b - %c",
 3755:     fr: "v%a%b - %c",
 3756:   });
 3757:   var strDeactivate = localize({
 3758:     de: "Lizenz Deaktivieren",
 3759:     en: "Deactivate License",
 3760:     es: "Desactivar Licencia",
 3761:     fr: "D\xe9sactiver la licence",
 3762:   });
 3763:   var strVersionCheck = localize({
 3764:     de: "Automatisch nach Aktualisierungen suchen",
 3765:     en: "Check for updates automatically",
 3766:     es: "Revisar actualizaciones automaticamente",
 3767:     fr: "V\xe9rifier les mises \xe0 jour automatiquement",
 3768:   });
 3769:   var strCheckNow = localize({
 3770:     de: "Jetzt nach Update suchenn",
 3771:     en: "Check for update now",
 3772:     es: "Buscar actualizaci\xf3n ahora",
 3773:     fr: "V\xe9rifier les mise \xe0 jour maintenant",
 3774:   });
 3775:   var strUpdateCheckError = localize({
 3776:     de: "Bei der Suche nach Updates ist ein Fehler aufgetreten.\nBitte vergewissern Sie sich, dass Sie \xfcber eine g\xfcltige Internetverbindung verf\xfcgen und diese nicht durch Firewalls blockiert wird.",
 3777:     en: "There was an error when checking for updates.\nPlease verify that you have a valid internet connection and that it is not blocked by any firewalls.",
 3778:     es: "Hubo un error en la comprobaci\xf3n de actualizaciones.\nPor favor compruebe que tiene una conexi\xf3n a Internet v\xe1lida y que no est\xe9 bloqueada por un cortafuegos.",
 3779:     fr: "Une erreur s\'est produite lors de la recherche de mises \xe0 jour.\nV\xe9rifiez que votre connexion Internet est valide et qu\'elle n\'est bloqu\xe9e par aucun pare-feu.",
 3780:   });
 3781:   var strUpToDate = localize({
 3782:     de:
 3783:       "Sie sind auf dem neuesten Stand! \n" +
 3784:       strScriptName +
 3785:       " " +
 3786:       strVersion +
 3787:       " " +
 3788:       strScriptVersion +
 3789:       " ist derzeit die neueste Version verf\xfcgbar.",
 3790:     en:
 3791:       "You are up to date!\n" +
 3792:       strScriptName +
 3793:       " " +
 3794:       strVersion +
 3795:       " " +
 3796:       strScriptVersion +
 3797:       " is currently the latest version available.",
 3798:     es:
 3799:       "\xa1Est\xe1 actualizado! \n" +
 3800:       strScriptName +
 3801:       " " +
 3802:       strVersion +
 3803:       " " +
 3804:       strScriptVersion +
 3805:       " es actualmente la \xfaltima versi\xf3n disponible.",
 3806:     fr:
 3807:       "Vous \xeates \xe0 jour!\n" +
 3808:       strScriptName +
 3809:       " " +
 3810:       strVersion +
 3811:       " " +
 3812:       strScriptVersion +
 3813:       " est actuellement la derni\xe8re version disponible.",
 3814:   });
 3815:   var strInvalidLicense = localize({
 3816:     de: "Ung\xfcltige Lizenz",
 3817:     en: "Invalid license",
 3818:     es: "La licencia no es v\xe1lida",
 3819:     fr: "Licence non valide",
 3820:   });
 3821:   var strLicenseRemoved = localize({
 3822:     de: "Lizenz entfernt",
 3823:     en: "License removed",
 3824:     es: "Licencia eliminada",
 3825:     fr: "Licence supprim\xe9e",
 3826:   });
 3827:   var strLicense = localize({
 3828:     de: "Lizenz",
 3829:     en: "License",
 3830:     es: "Licencia",
 3831:     fr: "Licence",
 3832:   });
 3833:   var strBTA = localize({
 3834:     de: "Beta-Lizenz",
 3835:     en: "Beta License",
 3836:     es: "Licencia Beta",
 3837:     fr: "Licence Beta",
 3838:   });
 3839:   var strEDU = localize({
 3840:     de: "EDU-Lizenz",
 3841:     en: "Educational License",
 3842:     es: "Licencia Educacional",
 3843:     fr: "T\xe9l\xe9charger",
 3844:   });
 3845:   var strFLT = localize({
 3846:     de: "Floating-Lizenz",
 3847:     en: "Floating License",
 3848:     es: "Licencia flotante",
 3849:     fr: "Licence flottante",
 3850:   });
 3851:   var strUNKNOWN = localize({
 3852:     de: "License mit unbekanntem Typ",
 3853:     en: "License of unknown type",
 3854:     es: "Licencia de tipo desconocido",
 3855:     fr: "Licence inconnue",
 3856:   });
 3857:   var strTrialExpired = localize({
 3858:     de: "Testversion abgelaufen",
 3859:     en: "MONTER GROUP\xa9",
 3860:     es: "Termino de prueba expirado",
 3861:     fr: "\xc9valuation termin\xe9e",
 3862:   });
 3863:   var licErrors = {
 3864:     de: {
 3865:       "-1": { detail: "", title: "Ung\xfcltige Lizenz (-1)" },
 3866:       "-10": {
 3867:         detail: "Auf dem Lizenzserver sind alle Lizenzen bereits vergeben",
 3868:         title: "Keine freien Slots (-10)",
 3869:       },
 3870:       "-100": {
 3871:         detail:
 3872:           "Eine Lizenz kann \xfcber den Button \'Lizenz Kaufen\' erworben werden",
 3873:         title: "Testversion abgelaufen",
 3874:       },
 3875:       "-101": {
 3876:         detail:
 3877:           "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
 3878:         title: "Zugriff blockiert (-101)",
 3879:       },
 3880:       "-102": {
 3881:         detail:
 3882:           "Bitte kontaktieren Sie den Support und senden Sie einen Screenshot dieses Fehlers. " +
 3883:           supportEmail,
 3884:         title: "Kein Ergebnis (-102)",
 3885:       },
 3886:       "-103": {
 3887:         detail: "Could not find the number of trial days",
 3888:         title: "Anzahl der Test-Tage nicht festgelegt (-103)",
 3889:       },
 3890:       "-104": {
 3891:         detail: "Die Lizenz ist nicht f\xfcr dieses Produkt",
 3892:         title: "Ung\xfcltige Lizenz (-104)",
 3893:       },
 3894:       "-105": {
 3895:         detail:
 3896:           "Eine Beta-Lizenz kann f\xfcr diese Vollversion nicht verwendet werden",
 3897:         title: "Beta-Lizenz nicht verwendbar (-105)",
 3898:       },
 3899:       "-106": {
 3900:         detail:
 3901:           "Dieses Produkt beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
 3902:         title: "Bitte Lizenz installieren (-106)",
 3903:       },
 3904:       "-107": {
 3905:         detail:
 3906:           "Diese Beta beinhaltet keine Testversion und ben\xf6tigt eine Lizenz",
 3907:         title: "Bitte Lizenz installieren (-107)",
 3908:       },
 3909:       "-108": {
 3910:         detail:
 3911:           "Bitte konfigurieren oder deaktivieren Sie alle Firewalls oder Virenprogramme, die den Zugriff auf den Basisordner blockieren k\xf6nnten. Wenn dieser Zugriff blockiert ist, kann die Lizenz nicht verifiziert werden.",
 3912:         title: "Nicht in der Lage, auf den Home-Ordner zuzugreifen (-108)",
 3913:       },
 3914:       "-11": {
 3915:         detail: "Die Lizenz kann auf dem Lizenzserver nicht gefunden werden",
 3916:         title: "Unbekannte Lizenz (-11)",
 3917:       },
 3918:       "-12": {
 3919:         detail:
 3920:           "Die Lizenz konnte nicht deaktiviert werden, da sie dem Server unbekannt ist",
 3921:         title: "Unbekannte Lizenz (-12)",
 3922:       },
 3923:       "-13": {
 3924:         detail:
 3925:           "Die IP-Adresse dieses Rechners ist \xfcber eine Blacklist auf dem Lizenzserver gesperrt",
 3926:         title: "Klient ist auf Blacklist (-13)",
 3927:       },
 3928:       "-14": {
 3929:         detail: "Konnte keine Netzwerkkarte finden",
 3930:         title: "Keine Netzwerkkarte (-14)",
 3931:       },
 3932:       "-2": { detail: "", title: "Ung\xfcltige Lizenz (-2)" },
 3933:       "-20": {
 3934:         detail: "Lizenzlaufzeit beginnt am ",
 3935:         title: "Lizenzlaufzeit hat noch nicht begonnen (-20)",
 3936:       },
 3937:       "-21": {
 3938:         detail: "Lizenzlaufzeit endete am ",
 3939:         title: "Lizenzlaufzeit ist abgelaufen (-21)",
 3940:       },
 3941:       "-22": {
 3942:         detail:
 3943:           "Weitere Informationen zum Einrichten und Lizenzieren von Client-Computern finden Sie in den Anweisungen zum Server.",
 3944:         title:
 3945:           "Floating-Lizenzen k\xf6nnen nur mit dem Floating License Server verwendet werden (-22)",
 3946:       },
 3947:       "-3": { detail: "", title: "Lizenzdatei nicht gefunden (-3)" },
 3948:       "-4": { detail: "", title: "Lizenzdatei besch\xe4digt (-4)" },
 3949:       "-5": { detail: "", title: "Generischer Fehler (-5)" },
 3950:       "-6": { detail: "", title: "Ung\xfcltiger Produktname (-6)" },
 3951:       "-7": { detail: "", title: "Testversion (-7)" },
 3952:       "-8": { detail: "", title: "Ung\xfcltige Lizenz (-8)" },
 3953:       "-9": {
 3954:         detail:
 3955:           "Bitte stellen Sie sicher, dass der Lizenzserver ordnungsgem\xe4\xdf arbeitet",
 3956:         title: "Kann Server nicht kontaktieren (-9)",
 3957:       },
 3958:       "-99": { detail: "", title: "Unbekannter Fehler (-99)" },
 3959:       unknown: { detail: "", title: "Unbekannter Fehler (0)" },
 3960:     },
 3961:     en: {
 3962:       "-1": { detail: "", title: "Invalid license (-1)" },
 3963:       "-10": {
 3964:         detail: "There are no more free slots on the license server",
 3965:         title: "No free slots (-10)",
 3966:       },
 3967:       "-100": {
 3968:         detail:
 3969:           "You can purchase a license by clicking the button \'Buy License\'",
 3970:         title: "MONTER GROUP\xa9",
 3971:       },
 3972:       "-101": {
 3973:         detail:
 3974:           "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
 3975:         title: "Access Blocked(-101)",
 3976:       },
 3977:       "-102": {
 3978:         detail:
 3979:           "Please contact support " +
 3980:           supportEmail +
 3981:           " and send a screenshot of this error.\n\n",
 3982:         title: "No result code (-102)",
 3983:       },
 3984:       "-103": {
 3985:         detail: "Could not find the number of trial days",
 3986:         title: "No trial days found (-103)",
 3987:       },
 3988:       "-104": {
 3989:         detail: "The license is not for this product",
 3990:         title: "License mismatch (-104)",
 3991:       },
 3992:       "-105": {
 3993:         detail: "A beta license cannot be used for the full version",
 3994:         title: "Cannot use beta license (-105)",
 3995:       },
 3996:       "-106": {
 3997:         detail: "This product does not offer a trial and requires a license",
 3998:         title: "Please install a license (-106)",
 3999:       },
 4000:       "-107": {
 4001:         detail:
 4002:           "The beta version does not offer a trial and requires a license",
 4003:         title: "Please install a license (-107)",
 4004:       },
 4005:       "-108": {
 4006:         detail:
 4007:           "Please configure or disable any firewalls or virus software that might be blocking access to the home folder. If this access is blocked the license cannot be verified.",
 4008:         title: "Not able to access home folder (-108)",
 4009:       },
 4010:       "-11": {
 4011:         detail: "The license cannot be found on the license server",
 4012:         title: "Unknown license (-11)",
 4013:       },
 4014:       "-12": {
 4015:         detail:
 4016:           "The license you are trying to deactivate is not found on the license server",
 4017:         title: "Unknown license (-12)",
 4018:       },
 4019:       "-13": {
 4020:         detail: "Your client IP is blacklisted on the license server",
 4021:         title: "Client blacklisted (-13)",
 4022:       },
 4023:       "-14": {
 4024:         detail: "Could not find a network adapter",
 4025:         title: "No network adapter (-14)",
 4026:       },
 4027:       "-2": { detail: "", title: "Invalid license (-2)" },
 4028:       "-20": {
 4029:         detail: "License period starts on ",
 4030:         title: "License period has not started yet (-20)",
 4031:       },
 4032:       "-21": {
 4033:         detail: "License period ended on ",
 4034:         title: "License period has ended (-21)",
 4035:       },
 4036:       "-22": {
 4037:         detail:
 4038:           "Please refer to the server instructions on how to setup and license client machines.",
 4039:         title:
 4040:           "Floating licenses can only be used with the Floating License Server (-22)",
 4041:       },
 4042:       "-3": { detail: "", title: "License file not found (-3)" },
 4043:       "-4": { detail: "", title: "License file corrupted (-4)" },
 4044:       "-5": { detail: "", title: "Generic error (-5)" },
 4045:       "-6": { detail: "", title: "Invalid product name (-6)" },
 4046:       "-7": { detail: "", title: "Trial (-7)" },
 4047:       "-8": { detail: "", title: "Invalid license (-8)" },
 4048:       "-9": {
 4049:         detail: "Please make sure the license server is running properly",
 4050:         title: "Cannot connect to server (-9)",
 4051:       },
 4052:       "-99": { detail: "", title: "Unknown error (-99)" },
 4053:       unknown: { detail: "", title: "Unknown error (0)" },
 4054:     },
 4055:     es: {
 4056:       "-1": { detail: "", title: "La licencia no es v\xe1lida (-1)" },
 4057:       "-10": {
 4058:         detail: "No hay m\xe1s espacios libres en el servidor de licencias",
 4059:         title: "No hay espacios libres (-10)",
 4060:       },
 4061:       "-100": {
 4062:         detail:
 4063:           "Puede adquirir una licencia haciendo clic en el bot\xf3n \'Comprar Licencia\'",
 4064:         title: "Esta versi\xf3n de prueba se ha expirado",
 4065:       },
 4066:       "-101": {
 4067:         detail:
 4068:           "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
 4069:         title: "Acceso bloqueado (-101)",
 4070:       },
 4071:       "-102": {
 4072:         detail:
 4073:           "Por favor, p\xf3ngase en contacto con soporte y env\xede una captura de pantalla de este error. " +
 4074:           supportEmail,
 4075:         title: "No hay c\xf3digo de resultado (-102)",
 4076:       },
 4077:       "-103": {
 4078:         detail: "No se pudo encontrar el n\xfamero de d\xedas de prueba",
 4079:         title: "No se encontraron d\xedas de prueba (-103)",
 4080:       },
 4081:       "-104": {
 4082:         detail: "La licencia no es para este producto",
 4083:         title: "La licencia no es la correcta (-104)",
 4084:       },
 4085:       "-105": {
 4086:         detail:
 4087:           "No se puede utilizar una licencia \'beta\' con esta versi\xf3n",
 4088:         title: "No se puede usar licencia beta (-105)",
 4089:       },
 4090:       "-106": {
 4091:         detail:
 4092:           "Este producto no ofrece una version de prueba y requiere una licencia",
 4093:         title: "Por favor, instale una licencia (-106)",
 4094:       },
 4095:       "-107": {
 4096:         detail:
 4097:           "La versi\xf3n beta no ofrece una versi\xf3n de prueba y requiere una licencia",
 4098:         title: "Por favor, instale una licencia (-107)",
 4099:       },
 4100:       "-108": {
 4101:         detail:
 4102:           "Configure o desactive cualquier firewall o software antivirus que pueda estar bloqueando el acceso a la carpeta de inicio. Si este acceso est\xe1 bloqueado, la licencia no se puede verificar.",
 4103:         title: "No se puede acceder a la carpeta de inicio (-108)",
 4104:       },
 4105:       "-11": {
 4106:         detail:
 4107:           "No se puede encontrar esta licencia en el servidor de licencias",
 4108:         title: "Licencia desconocida (-11)",
 4109:       },
 4110:       "-12": {
 4111:         detail:
 4112:           "La licencia que est\xe1 intentando de desactivar no se encuentra en el servidor de licencias",
 4113:         title: "Licencia desconocida (-12)",
 4114:       },
 4115:       "-13": {
 4116:         detail: "Su IP est\xe1 en la lista negra del servidor de licencias",
 4117:         title: "IP en la lista negra (-13)",
 4118:       },
 4119:       "-14": {
 4120:         detail: "No se pudo encontrar un adaptador de red",
 4121:         title: "No hay adaptador de red (-14)",
 4122:       },
 4123:       "-2": { detail: "", title: "La licencia no es v\xe1lida (-2)" },
 4124:       "-20": {
 4125:         detail: "El per\xedodo de licencia comienza en ",
 4126:         title: "El periodo de licencia no ha comenzado (-20)",
 4127:       },
 4128:       "-21": {
 4129:         detail: "El per\xedodo de licencia termin\xf3 en ",
 4130:         title: "El per\xedodo de licencia ha terminado (-21)",
 4131:       },
 4132:       "-22": {
 4133:         detail:
 4134:           "Consulte las instrucciones del servidor sobre c\xf3mo configurar y licenciar las m\xe1quinas cliente.",
 4135:         title:
 4136:           "Las licencias flotantes solo se pueden utilizar con el Servidor de licencias flotantes (-22)",
 4137:       },
 4138:       "-3": {
 4139:         detail: "",
 4140:         title: "No se encontr\xf3 el archivo de licencia (-3)",
 4141:       },
 4142:       "-4": { detail: "", title: "El archivo de licencia esta da\xf1ado (-4)" },
 4143:       "-5": { detail: "", title: "Error generico (-5)" },
 4144:       "-6": { detail: "", title: "El nombre de el producto no v\xe1lido (-6)" },
 4145:       "-7": { detail: "", title: "Versi\xf3n de prueba (-7)" },
 4146:       "-8": { detail: "", title: "La licencia no es v\xe1lida (-8)" },
 4147:       "-9": {
 4148:         detail:
 4149:           "Aseg\xfarese de que el servidor de licencias est\xe1 funcionando correctamente",
 4150:         title: "No es posible conectar con el servidor (-9)",
 4151:       },
 4152:       "-99": { detail: "", title: "Error desconocido (-99)" },
 4153:       unknown: { detail: "", title: "Error desconocido (0)" },
 4154:     },
 4155:     fr: {
 4156:       "-1": { detail: "", title: "Licence non valide (-1)" },
 4157:       "-10": {
 4158:         detail: "Il n\'y a plus de place sur le serveur de licence",
 4159:         title: "Plus de place (-10)",
 4160:       },
 4161:       "-100": {
 4162:         detail:
 4163:           "Vous pouvez acqu\xe9rir une licence en cliquant sur le bouton \'Acheter une Licence\' ci-dessous",
 4164:         title: "P\xe9riode d\'\xe9valuation expir\xe9e",
 4165:       },
 4166:       "-101": {
 4167:         detail:
 4168:           "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
 4169:         title: "Acc\xe8s bloqu\xe9 (-101)",
 4170:       },
 4171:       "-102": {
 4172:         detail:
 4173:           "S\'il vous pla\xeet contacter le support et envoyer une capture d\'\xe9cran de cette erreur. " +
 4174:           supportEmail,
 4175:         title: "Pas de code de r\xe9sultat (-102)",
 4176:       },
 4177:       "-103": {
 4178:         detail:
 4179:           "Echec d\'identification du nombre de jour de p\xe9riode d\'essai disponible",
 4180:         title: "Impossible de trouver des jours d\'essai (-103)",
 4181:       },
 4182:       "-104": {
 4183:         detail: "Cette licence n\'est pas valable pour ce produit",
 4184:         title: "Mauvaise licence (-104)",
 4185:       },
 4186:       "-105": {
 4187:         detail:
 4188:           "Une licence de version Beta ne peut \xeatre utilis\xe9e pour le produit final",
 4189:         title: "Licence Beta invalide (-105)",
 4190:       },
 4191:       "-106": {
 4192:         detail:
 4193:           "Ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
 4194:         title: "Licence n\xe9cessaire (-106)",
 4195:       },
 4196:       "-107": {
 4197:         detail:
 4198:           "La version Beta de ce produit ne propose pas de p\xe9riode d\'essai et n\xe9cessite une licence",
 4199:         title: "Licence n\xe9cessaire (-107)",
 4200:       },
 4201:       "-108": {
 4202:         detail:
 4203:           "Veuillez configurer ou d\xe9sactiver tous les firewall ou logiciels antivirus susceptibles de bloquer l\'acc\xe8s au dossier de d\xe9part. Si cet acc\xe8s est bloqu\xe9, la licence ne peut pas \xeatre v\xe9rifi\xe9e.",
 4204:         title: "Impossible d\'acc\xe9der au dossier de d\xe9part (-108)",
 4205:       },
 4206:       "-11": {
 4207:         detail: "La licence est introuvable sur le serveur",
 4208:         title: "Licence inconnue (-11)",
 4209:       },
 4210:       "-12": {
 4211:         detail:
 4212:           "La licence que vous essayez de d\xe9sactiver est introuvable sur le serveur",
 4213:         title: "Licence inconnue (-12)",
 4214:       },
 4215:       "-13": {
 4216:         detail:
 4217:           "L\'adresse ip de votre client est bannie du serveur de licence",
 4218:         title: "Client sur liste noire (-13)",
 4219:       },
 4220:       "-14": {
 4221:         detail: "Impossible de trouver une carte r\xe9seau",
 4222:         title: "Pas de carte r\xe9seau (-14)",
 4223:       },
 4224:       "-2": { detail: "", title: "Licence non valide (-2)" },
 4225:       "-20": {
 4226:         detail: "La p\xe9riode de licence commence ",
 4227:         title: "La p\xe9riode de licence n\'a pas encore commenc\xe9 (-20)",
 4228:       },
 4229:       "-21": {
 4230:         detail: "La p\xe9riode de licence s\'est termin\xe9e le ",
 4231:         title: "La p\xe9riode de licence est termin\xe9e (-21)",
 4232:       },
 4233:       "-22": {
 4234:         detail:
 4235:           "Veuillez vous reporter aux instructions du serveur pour savoir comment configurer et attribuer une licence aux ordinateurs clients.",
 4236:         title:
 4237:           "Les licences flottantes ne peuvent \xeatre utilis\xe9es qu\'avec le serveur de licences flottantes (-22)",
 4238:       },
 4239:       "-3": { detail: "", title: "Fichier de licence introuvable (-3)" },
 4240:       "-4": { detail: "", title: "Fichier de licence corrompu (-4)" },
 4241:       "-5": { detail: "", title: "Erreur g\xe9n\xe9rique (-5)" },
 4242:       "-6": { detail: "", title: "Nom de produit invalide (-6)" },
 4243:       "-7": { detail: "", title: "P\xe9riode d\'\xe9valuation (-7)" },
 4244:       "-8": { detail: "", title: "Licence non valide (-8)" },
 4245:       "-9": {
 4246:         detail: "Verifiez que le serveur de licence fonctionne correctement",
 4247:         title: "Impossible de se connecter au serveur (-9)",
 4248:       },
 4249:       "-99": { detail: "", title: "Erreur inconnue (-99)" },
 4250:       unknown: { detail: "", title: "Erreur inconnue (0)" },
 4251:     },
 4252:   };
 4253:   var prefsSectionName = vars.hasOwnProperty("legacyPrefsGroup")
 4254:     ? vars.legacyPrefsGroup
 4255:     : "aescripts";
 4256:   var prefsName = useLegacyPrefsHeader
 4257:     ? strScriptName
 4258:     : strHeader + "_Registration";
 4259:   var prefsVersionName = strHeader + "_Version";
 4260:   var prefsLicVersion = strHeader + "_LicVersion";
 4261:   var prefsVersionCheckInit = strHeader + "_VersionCheckInit";
 4262:   var prefsLastVersionChecked = strHeader + "_LastVersionChecked";
 4263:   var prefsLastServerVersionChecked = strHeader + "_LastServerVersionChecked";
 4264:   var prefsLastTimeVersionChecked = strHeader + "_LastTimeVersionChecked";
 4265:   var prefsNextTimeVersionChecked = strHeader + "_NextTimeVersionChecked";
 4266:   var prefsNextTimeVersionCheckedSkipVersion =
 4267:     strHeader + "_NextTimeVersionCheckedSkipVersion";
 4268:   var prefsDoUpdateCheck = strHeader + "_doUpdateCheck";
 4269:   haveSettings(prefsSectionName, prefsDoUpdateCheck) &&
 4270:     (doUpdateCheck = !(
 4271:       "false" == getSettings(prefsSectionName, prefsDoUpdateCheck)
 4272:     ));
 4273:   ScriptUI.environment.keyboardState.shiftKey &&
 4274:     ScriptUI.environment.keyboardState.altKey &&
 4275:     !ScriptUI.environment.keyboardState.ctrlKey &&
 4276:     !ScriptUI.environment.keyboardState.metaKey &&
 4277:     ((doUpdateCheck = false),
 4278:     saveSettings(prefsSectionName, prefsDoUpdateCheck, false),
 4279:     alert("New version update checks disabled"));
 4280:   saveSettings(prefsSectionName, prefsVersionName, strScriptVersion);
 4281:   saveSettings(prefsSectionName, prefsLicVersion, licensingVersion);
 4282:   cmdKey = -1 != $.os.indexOf("Mac") ? "cmd" : "Ctrl";
 4283:   var strEnterLicenseCode = localize({
 4284:     de: "Bitte gebe den Lizenzcode ein.",
 4285:     en: "Please enter the license code.",
 4286:     es: "Por favor, introduzca el c\xf3digo de licencia.",
 4287:     fr: "Veuillez entrer votre num\xe9ro de licence.",
 4288:   });
 4289:   var strPasteHelp = localize({
 4290:     de:
 4291:       "(Wenn das Einf\xfcgen mit " +
 4292:       cmdKey +
 4293:       "+V nicht funktioniert, versuche Bearbeiten->Einf\xfcgen.)",
 4294:     en:
 4295:       "(If pasting the code with " + cmdKey + "+V doesn\'t work try " + 10 <=
 4296:       parseFloat(app.version)
 4297:         ? "Right-Click and Paste)"
 4298:         : "Edit->Paste)",
 4299:     es:
 4300:       "(Si pegar la licencia usando " +
 4301:         cmdKey +
 4302:         "+V no funciona, pruebe " +
 4303:         10 <=
 4304:       parseFloat(app.version)
 4305:         ? "Clic derecho y pegar)"
 4306:         : "Edici\xf3n->Pegar)",
 4307:     fr:
 4308:       "(Si vous ne parvenez pas \xe0 coller le code avec " +
 4309:         cmdKey +
 4310:         "+V essayez " +
 4311:         10 <=
 4312:       parseFloat(app.version)
 4313:         ? "Clique droit et Coller)"
 4314:         : "Edition->Coller)",
 4315:   });
 4316:   var strTrialInstructMsg = localize({
 4317:     de: 'Um die Testversion zu starten, gebe "trial" ein.',
 4318:     en: "To run in trial mode type: trial",
 4319:     es: "Para ejecutar el modo Trial, escriba: trial",
 4320:     fr: "Pour lancer la version de d\xe9monstration, tapez : trial",
 4321:   });
 4322:   var strOr = localize({ de: "oder", en: "or", es: "o", fr: "ou" });
 4323:   var strServerInstructMsg = localize({
 4324:     de: "Aktivieren Sie eine Lizenz vom Server mit @REMOTE",
 4325:     en: "Activate a license from the server with @REMOTE",
 4326:     es: "Activar una licencia del servidor con @REMOTE",
 4327:     fr: "Activer une licence du serveur avec @REMOTE",
 4328:   });
 4329:   var strServerNotRunning = localize({
 4330:     de: "Der Client ist konfiguriert, aber der Floating License Server l\xe4uft nicht oder ist nicht erreichbar.",
 4331:     en: "Client configured but floating license server is either not running or not accessible.",
 4332:     es: "Cliente configurado pero servidor de licencias flotantes o no est\xe1 ejecutado o no es accesible.",
 4333:     fr: "Client configur\xe9 mais le serveur de licence flottante est soit en cours d\'ex\xe9cution ou ne pas accessible.",
 4334:   });
 4335:   var prefHeader = "Initialization Fragments";
 4336:   var prefSection1 = (
 4337:     string_encode(
 4338:       Math.floor(parseFloat(app.version))
 4339:         .toString()
 4340:         .charAt(
 4341:           Math.max(
 4342:             0,
 4343:             Math.floor(parseFloat(app.version)).toString().length - 1,
 4344:           ),
 4345:         ) +
 4346:         strScriptName.substring(
 4347:           Math.max(0, strScriptName.length - 15),
 4348:           strScriptName.length,
 4349:         ) +
 4350:         strScriptVersion,
 4351:     ) *
 4352:     0.457 *
 4353:     privateNum
 4354:   ).toString(36);
 4355:   var prefSection2 = (
 4356:     string_encode(
 4357:       Math.floor(parseFloat(app.version))
 4358:         .toString()
 4359:         .charAt(
 4360:           Math.max(
 4361:             0,
 4362:             Math.floor(parseFloat(app.version)).toString().length - 1,
 4363:           ),
 4364:         ) +
 4365:         strScriptName.substring(
 4366:           Math.max(0, strScriptName.length - 15),
 4367:           strScriptName.length,
 4368:         ) +
 4369:         strScriptVersion,
 4370:     ) *
 4371:     (privateNum / 3.981)
 4372:   ).toString(36);
 4373:   var prefsLocation = Folder.userData.fsName + "/Aescripts/";
 4374:   var prefsPrefix = "pref_";
 4375:   isAE() || Folder(prefsLocation).exists || Folder(prefsLocation).create();
 4376:   var sanitizedName = sanitizeProductName(strScriptName);
 4377:   this.getSetting = function (e, t) {
 4378:     return getSettings((e = strHeader + "_" + e), t, "settings");
 4379:   };
 4380:   this.readJSON = function (e) {
 4381:     return readJSON(e);
 4382:   };
 4383:   this.writeJSON = function (e, t) {
 4384:     return writeJSON(e, t);
 4385:   };
 4386:   this.JSONify = function (e, t, i) {
 4387:     return JSONify(e, t, i);
 4388:   };
 4389:   this.haveSetting = function (e, t) {
 4390:     return haveSettings((e = strHeader + "_" + e), t, "settings");
 4391:   };
 4392:   this.saveSetting = function (e, t, i) {
 4393:     return saveSettings((e = strHeader + "_" + e), t, i, "settings");
 4394:   };
 4395:   function compareVersions(a, b) {
 4396:     if (a === b) {
 4397:       return 0;
 4398:     }
 4399:     var a_components = a.toString().split(".");
 4400:     var b_components = b.toString().split(".");
 4401:     if (a_components.length <= 2 && b_components.length <= 2) {
 4402:       if (a > b) {
 4403:         return 1;
 4404:       }
 4405:       if (a < b) {
 4406:         return -1;
 4407:       }
 4408:     } else {
 4409:       var len = Math.min(a_components.length, b_components.length);
 4410:       for (var i = 0; i < len; i += 1) {
 4411:         if (parseInt(a_components[i]) > parseInt(b_components[i])) {
 4412:           return 1;
 4413:         }
 4414:         if (parseInt(a_components[i]) < parseInt(b_components[i])) {
 4415:           return -1;
 4416:         }
 4417:       }
 4418:       if (a_components.length > b_components.length) {
 4419:         return 1;
 4420:       }
 4421:       if (a_components.length < b_components.length) {
 4422:         return -1;
 4423:       }
 4424:       return 0;
 4425:     }
 4426:   }
 4427:   function JSONify(string, mode, prettyJSON) {
 4428:     if (typeof JSON !== "object") {
 4429:       JSON = {};
 4430:     }
 4431:     (function () {
 4432:       function f(n) {
 4433:         return n < 10 ? "0" + n : n;
 4434:       }
 4435:       function this_value() {
 4436:         return this.valueOf();
 4437:       }
 4438:       function quote(string) {
 4439:         rx_escapable.lastIndex = 0;
 4440:         return rx_escapable.test(string)
 4441:           ? '"' +
 4442:               string.replace(rx_escapable, function (a) {
 4443:                 var c = meta[a];
 4444:                 return typeof c === "string"
 4445:                   ? c
 4446:                   : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
 4447:               }) +
 4448:               '"'
 4449:           : '"' + string + '"';
 4450:       }
 4451:       function str(key, holder) {
 4452:         var mind = gap;
 4453:         var value = holder[key];
 4454:         if (
 4455:           value &&
 4456:           typeof value === "object" &&
 4457:           typeof value.toJSON === "function"
 4458:         ) {
 4459:           value = value.toJSON(key);
 4460:         }
 4461:         if (typeof rep === "function") {
 4462:           value = rep.call(holder, key, value);
 4463:         }
 4464:         switch (typeof value) {
 4465:           case "string":
 4466:             return quote(value);
 4467:           case "number":
 4468:             return isFinite(value) ? String(value) : "null";
 4469:           case "boolean":
 4470:           case "null":
 4471:             return String(value);
 4472:           case "object":
 4473:             if (!value) {
 4474:               return "null";
 4475:             }
 4476:             gap += indent;
 4477:             partial = [];
 4478:             if (Object.prototype.toString.apply(value) === "[object Array]") {
 4479:               length = value.length;
 4480:               for (var i = 0; i < length; i += 1) {
 4481:                 partial[i] = str(i, value) || "null";
 4482:               }
 4483:               v =
 4484:                 partial.length === 0
 4485:                   ? "[]"
 4486:                   : gap
 4487:                     ? "[\n" +
 4488:                       gap +
 4489:                       partial.join(",\n" + gap) +
 4490:                       "\n" +
 4491:                       mind +
 4492:                       "]"
 4493:                     : "[" + partial.join(",") + "]";
 4494:               gap = mind;
 4495:               return v;
 4496:             }
 4497:             if (rep && typeof rep === "object") {
 4498:               length = rep.length;
 4499:               for (var i = 0; i < length; i += 1) {
 4500:                 if (typeof rep[i] === "string") {
 4501:                   k = rep[i];
 4502:                   v = str(k, value);
 4503:                   if (v) {
 4504:                     partial.push(quote(k) + gap ? ": " : ":" + v);
 4505:                   }
 4506:                 }
 4507:               }
 4508:             } else {
 4509:               for (var k in value) {
 4510:                 if (Object.prototype.hasOwnProperty.call(value, k)) {
 4511:                   v = str(k, value);
 4512:                   if (v) {
 4513:                     partial.push(quote(k) + gap ? ": " : ":" + v);
 4514:                   }
 4515:                 }
 4516:               }
 4517:             }
 4518:             v =
 4519:               partial.length === 0
 4520:                 ? "{}"
 4521:                 : gap
 4522:                   ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}"
 4523:                   : "{" + partial.join(",") + "}";
 4524:             gap = mind;
 4525:             return v;
 4526:         }
 4527:       }
 4528:       ("use strict");
 4529:       var rx_one = /^[\],:{}\s]*$/;
 4530:       var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
 4531:       var rx_three =
 4532:         /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
 4533:       var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
 4534:       var rx_escapable =
 4535:         /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 4536:       var rx_dangerous =
 4537:         /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
 4538:       if (typeof Date.prototype.toJSON !== "function") {
 4539:         Date.prototype.toJSON = function () {
 4540:           return isFinite(this.valueOf())
 4541:             ? this.getUTCFullYear() +
 4542:                 "-" +
 4543:                 f(this.getUTCMonth() + 1) +
 4544:                 "-" +
 4545:                 f(this.getUTCDate()) +
 4546:                 "T" +
 4547:                 f(this.getUTCHours()) +
 4548:                 ":" +
 4549:                 f(this.getUTCMinutes()) +
 4550:                 ":" +
 4551:                 f(this.getUTCSeconds()) +
 4552:                 "Z"
 4553:             : null;
 4554:         };
 4555:         Boolean.prototype.toJSON = this_value;
 4556:         Number.prototype.toJSON = this_value;
 4557:         String.prototype.toJSON = this_value;
 4558:       }
 4559:       if (typeof JSON.stringify !== "function") {
 4560:         meta = {
 4561:           "\b": "\\b",
 4562:           "\t": "\\t",
 4563:           "\n": "\\n",
 4564:           "\f": "\\f",
 4565:           "\r": "\\r",
 4566:           '"': '\\"',
 4567:           "\\": "\\\\",
 4568:         };
 4569:         JSON.stringify = function (value, replacer, space) {
 4570:           gap = "";
 4571:           indent = "";
 4572:           if (typeof space === "number") {
 4573:             for (var i = 0; i < space; i += 1) {
 4574:               indent += " ";
 4575:             }
 4576:           } else {
 4577:             if (typeof space === "string") {
 4578:               indent = space;
 4579:             }
 4580:           }
 4581:           rep = replacer;
 4582:           if (
 4583:             replacer &&
 4584:             typeof replacer !== "function" &&
 4585:             (typeof replacer !== "object" ||
 4586:               typeof replacer.length !== "number")
 4587:           ) {
 4588:             throw new Error("JSON.stringify");
 4589:           }
 4590:           return str("", { "": value });
 4591:         };
 4592:       }
 4593:     })();
 4594:     var jsonParse = (function () {
 4595:       function v(h, j, e) {
 4596:         return j ? u[j] : String.fromCharCode(parseInt(e, 16));
 4597:       }
 4598:       var r = "(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";
 4599:       var k =
 4600:         '(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';
 4601:       k = '(?:"' + k + '*")';
 4602:       var s = new RegExp(
 4603:         "(?:false|true|null|[\\{\\}\\[\\]]|" + r + "|" + k + ")",
 4604:         "g",
 4605:       );
 4606:       var t = new RegExp("\\\\(?:([^u])|u(.{4}))", "g");
 4607:       var u = {
 4608:         '"': '"',
 4609:         "/": "/",
 4610:         "\\": "\\",
 4611:         b: "\b",
 4612:         f: "\f",
 4613:         n: "\n",
 4614:         r: "\r",
 4615:         t: "\t",
 4616:       };
 4617:       var w = new String("");
 4618:       var x = Object.hasOwnProperty;
 4619:       return function (h, j) {
 4620:         h = h.match(s);
 4621:         var c = h[0];
 4622:         var l = false;
 4623:         if ("{" === c) {
 4624:           e = {};
 4625:         } else if ("[" === c) {
 4626:           e = [];
 4627:         } else {
 4628:           e = [];
 4629:           l = true;
 4630:         }
 4631:         for (b, d = [e], m = 1 - l, y = h.length; m < y; ++m) {
 4632:           c = h[m];
 4633:           switch (c.charCodeAt(0)) {
 4634:             default:
 4635:               a = d[0];
 4636:               a[b || a.length] = c;
 4637:               b = void 0;
 4638:               break;
 4639:             case 34:
 4640:               c = c.substring(1, c.length - 1);
 4641:               if (c.indexOf("\\") !== -1) {
 4642:                 c = c.replace(t, v);
 4643:               }
 4644:               a = d[0];
 4645:               if (!b) {
 4646:                 if (a instanceof Array) {
 4647:                   b = a.length;
 4648:                 } else {
 4649:                   b = c || w;
 4650:                   break;
 4651:                 }
 4652:               }
 4653:               a[b] = c;
 4654:               b = void 0;
 4655:               break;
 4656:             case 91:
 4657:               a = d[0];
 4658:               d.unshift((a[b || a.length] = []));
 4659:               b = void 0;
 4660:               break;
 4661:             case 93:
 4662:               d.shift();
 4663:               break;
 4664:             case 102:
 4665:               a = d[0];
 4666:               a[b || a.length] = false;
 4667:               b = void 0;
 4668:               break;
 4669:             case 110:
 4670:               a = d[0];
 4671:               a[b || a.length] = null;
 4672:               b = void 0;
 4673:               break;
 4674:             case 116:
 4675:               a = d[0];
 4676:               a[b || a.length] = true;
 4677:               b = void 0;
 4678:               break;
 4679:             case 123:
 4680:               a = d[0];
 4681:               d.unshift((a[b || a.length] = {}));
 4682:               b = void 0;
 4683:               break;
 4684:             case 125:
 4685:               d.shift();
 4686:               break;
 4687:           }
 4688:         }
 4689:         if (l) {
 4690:           if (d.length !== 1) {
 4691:             throw new Error();
 4692:           }
 4693:           e = e[0];
 4694:         } else {
 4695:           if (d.length) {
 4696:             throw new Error();
 4697:           }
 4698:         }
 4699:         if (j) {
 4700:           var p = function (n, o) {
 4701:             var f = n[o];
 4702:             if (f && typeof f === "object") {
 4703:               var i = null;
 4704:               for (var g in f) {
 4705:                 if (x.call(f, g) && f !== n) {
 4706:                   var q = p(f, g);
 4707:                   if (q !== void 0) {
 4708:                     f[g] = q;
 4709:                   } else {
 4710:                     i || (i = []);
 4711:                     i.push(g);
 4712:                   }
 4713:                 }
 4714:               }
 4715:               if (i) {
 4716:                 for (g = i.length; --g >= 0; ) {
 4717:                   delete f[i[g]];
 4718:                 }
 4719:               }
 4720:             }
 4721:             return j.call(n, o, f);
 4722:           };
 4723:           e = p({ "": e }, "");
 4724:         }
 4725:         return e;
 4726:       };
 4727:     })();
 4728:     try {
 4729:       switch (mode) {
 4730:         case "parse":
 4731:           if (validateJSON(string)) {
 4732:             return jsonParse(string);
 4733:           } else {
 4734:             alert("JSON validation error\n" + string.substring(0, 1000));
 4735:             return null;
 4736:           }
 4737:           break;
 4738:         case "stringify":
 4739:           return JSON.stringify(string, undefined, prettyJSON);
 4740:           break;
 4741:       }
 4742:     } catch (e) {
 4743:       alert(e.toString());
 4744:     }
 4745:   }
 4746:   function validateJSON(string) {
 4747:     return /^[\],:{}\s]*$/.test(
 4748:       string
 4749:         .replace(/\\["\\\/bfnrtu]/g, "@")
 4750:         .replace(
 4751:           /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
 4752:           "]",
 4753:         )
 4754:         .replace(/(?:^|:|,)(?:\s*\[)+/g, ""),
 4755:     );
 4756:   }
 4757:   this.c = function () {
 4758:     return mainFunc("l");
 4759:   };
 4760:   this.s = function () {
 4761:     return (
 4762:       (void 0 !== licenseValidity &&
 4763:         licenseValidity.hasOwnProperty("result")) ||
 4764:         (licenseValidity = getVerifCode("")),
 4765:       isResultValidLicense(licenseValidity)
 4766:     );
 4767:   };
 4768:   this.r = function () {
 4769:     return !mainFunc("r");
 4770:   };
 4771:   this.t = function () {
 4772:     return (
 4773:       (void 0 !== licenseValidity &&
 4774:         licenseValidity.hasOwnProperty("result")) ||
 4775:         (licenseValidity = getVerifCode("")),
 4776:       isResultTrial(licenseValidity.result)
 4777:     );
 4778:   };
 4779:   this.l = function () {
 4780:     return (
 4781:       (void 0 !== licenseValidity &&
 4782:         licenseValidity.hasOwnProperty("result")) ||
 4783:         (licenseValidity = getVerifCode("")),
 4784:       licenseValidity.license
 4785:     );
 4786:   };
 4787:   this.ss = function () {
 4788:     return (
 4789:       (void 0 !== licenseValidity &&
 4790:         licenseValidity.hasOwnProperty("result")) ||
 4791:         (licenseValidity = getVerifCode("")),
 4792:       isResultValidLicense(licenseValidity) &&
 4793:         !isResultTrial(licenseValidity.result)
 4794:     );
 4795:   };
 4796:   this.vt = function () {
 4797:     return isVT();
 4798:   };
 4799:   this.helpUI = function (e) {
 4800:     helpUI(e);
 4801:   };
 4802:   this.getRegistration = function (e) {
 4803:     return getRegistration(e);
 4804:   };
 4805:   this.openSupportTicket = function (e) {
 4806:     openSupportTicket(e);
 4807:   };
 4808:   this.openURL = function (e) {
 4809:     openURL(e);
 4810:   };
 4811:   this.doUpdateCheck = function (e) {
 4812:     setUpdateCheck(e);
 4813:   };
 4814:   this.getUpdateCheckStatus = function () {
 4815:     return doUpdateCheck;
 4816:   };
 4817:   this.doUpdateCheckNow = function () {
 4818:     return doUpdateCheckNow();
 4819:   };
 4820:   this.frameworkVersion = function () {
 4821:     return licensingVersion;
 4822:   };
 4823: }
 4824: origami.graph = function (comp) {
 4825:   this.comp = comp;
 4826:   this.vertices = [];
 4827:   this.edges = [];
 4828:   this.startVertices = [];
 4829:   this.bondsReversed = false;
 4830:   this.addStartVertex = function (vertex) {
 4831:     this.startVertices.push(vertex);
 4832:   };
 4833:   this.addVertex = function (vertex) {
 4834:     this.vertices.push(vertex);
 4835:   };
 4836:   this.addEdges = function (edgesArray) {
 4837:     this.edges = this.edges.concat(edgesArray);
 4838:   };
 4839:   this.buildFullGraph = function () {
 4840:     for (var v = 0; v < this.vertices.length; v += 1) {
 4841:       thisVert = this.vertices[v];
 4842:       allNeighbors = this.getVertexNeighbors(thisVert, false);
 4843:       this.addEdges(
 4844:         allNeighbors.map(function (o) {
 4845:           return new origami.graphEdge(thisVert, o);
 4846:         }),
 4847:       );
 4848:     }
 4849:   };
 4850:   this.buildEdges = function (randomVertices, onePoint, progress) {
 4851:     var tmpCount = 0;
 4852:     origami.writeln(this.startVertices.length);
 4853:     origami.writeln(
 4854:       "\nBegin with: ",
 4855:       this.startVertices.map(function (o) {
 4856:         return o.layer.index;
 4857:       }),
 4858:     );
 4859:     randomVertices = randomVertices || false;
 4860:     var beginWith = [];
 4861:     if (this.startVertices.length == 0) {
 4862:       this.addStartVertex(this.vertices.getRandomArrayElements(1)[0]);
 4863:     }
 4864:     beginWith = this.startVertices;
 4865:     for (var b = 0; b < beginWith.length; b += 1) {
 4866:       beginWith[b].layer.threeDLayer = true;
 4867:       beginWith[b].setLayerWeight(0);
 4868:       beginWith[b].beenHere = true;
 4869:     }
 4870:     this.cycleVertices(beginWith, randomVertices, onePoint, progress);
 4871:     this.cleanup(randomVertices, onePoint);
 4872:   };
 4873:   this.cycleVertices = function (
 4874:     cuttingEdge,
 4875:     randomVertices,
 4876:     onePoint,
 4877:     progress,
 4878:   ) {
 4879:     var nextCuttingEdge = [];
 4880:     for (var ed = 0; ed < cuttingEdge.length; ed += 1) {
 4881:       var newNeighbors = this.getVertexNeighbors(cuttingEdge[ed], onePoint);
 4882:       newNeighbors = this.filterNeighbors(
 4883:         newNeighbors,
 4884:         cuttingEdge,
 4885:         nextCuttingEdge,
 4886:       );
 4887:       if (randomVertices) {
 4888:         newNeighbors = newNeighbors.getRandomArrayElements(null, true);
 4889:       }
 4890:       for (var n = 0; n < newNeighbors.length; n += 1) {
 4891:         var tmpN = newNeighbors[n].vertex;
 4892:         nextCuttingEdge.push(tmpN);
 4893:         tmpN.beenHere = true;
 4894:         var tmpEdge = new origami.graphEdge(cuttingEdge[ed], tmpN);
 4895:         tmpEdge.addAdjacentEdge(newNeighbors[n].edge);
 4896:         tmpEdge.setParent(cuttingEdge[ed].endOf);
 4897:         this.edges.push(tmpEdge);
 4898:         if (progress) {
 4899:           progress.value = progress.value + 1;
 4900:         }
 4901:       }
 4902:     }
 4903:     origami.writeln("Found " + nextCuttingEdge.length + " new edges");
 4904:     if (nextCuttingEdge.length !== 0) {
 4905:       return this.cycleVertices(
 4906:         nextCuttingEdge,
 4907:         randomVertices,
 4908:         onePoint,
 4909:         progress,
 4910:       );
 4911:     } else {
 4912:       return null;
 4913:     }
 4914:   };
 4915:   this.cleanup = function (randomVertices, onePoint) {
 4916:     var tmp = 0;
 4917:     for (var v = 0; v < this.vertices.length; v += 1) {
 4918:       if (!this.vertices[v].beenHere) {
 4919:         tmp++;
 4920:         var newNeighbors = this.getVertexNeighbors(this.vertices[v]);
 4921:         if (newNeighbors.length) {
 4922:           this.vertices[v].beenHere = true;
 4923:           var tmpEdge = new origami.graphEdge(
 4924:             newNeighbors[0].vertex,
 4925:             this.vertices[v],
 4926:           );
 4927:           tmpEdge.setParent(newNeighbors[0].vertex.endOf);
 4928:           tmpEdge.addAdjacentEdge(newNeighbors[0].edge);
 4929:           this.addEdges([tmpEdge]);
 4930:           this.buildEdges(randomVertices, onePoint);
 4931:         }
 4932:       }
 4933:     }
 4934:     origami.writeln(tmp, " vertices were parentless");
 4935:   };
 4936:   this.bboxes_overlaps_with_delta = function (a, b) {
 4937:     var delta = 2;
 4938:     return !(
 4939:       a[0][0] - delta > b[1][0] + delta ||
 4940:       b[0][0] - delta > a[1][0] + delta ||
 4941:       a[0][1] - delta > b[1][1] + delta ||
 4942:       b[0][1] - delta > a[1][1] + delta
 4943:     );
 4944:   };
 4945:   this.getVertexNeighbors = function (vertexToSearch, onePoint) {
 4946:     var neighborsList = [];
 4947:     for (var v = 0; v < this.vertices.length; v += 1) {
 4948:       if (this.vertices[v].layer != vertexToSearch.layer && !this.beenHere) {
 4949:         if (
 4950:           this.bboxes_overlaps_with_delta(
 4951:             this.vertices[v].polygon.boundingBox,
 4952:             vertexToSearch.polygon.boundingBox,
 4953:           )
 4954:         ) {
 4955:           var newEdge = this.vertices[v].polygon.findCommonEdge(
 4956:             vertexToSearch.polygon,
 4957:             onePoint,
 4958:           );
 4959:           if (newEdge) {
 4960:             neighborsList.push({ edge: newEdge, vertex: this.vertices[v] });
 4961:           }
 4962:         }
 4963:       }
 4964:     }
 4965:     return neighborsList;
 4966:   };
 4967:   this.filterNeighbors = function (nArray, cuttingEdge, nextCuttingEdge) {
 4968:     var neighborsList = [];
 4969:     for (var n = 0; n < nArray.length; n += 1) {
 4970:       if (
 4971:         !cuttingEdge.isThere(nArray[n].vertex) &&
 4972:         !nextCuttingEdge.isThere(nArray[n].vertex) &&
 4973:         !nArray[n].vertex.beenHere
 4974:       ) {
 4975:         neighborsList.push(nArray[n]);
 4976:       }
 4977:     }
 4978:     return neighborsList;
 4979:   };
 4980:   this.resetParentingAndProps = function () {
 4981:     for (var v = 0; v < this.vertices.length; v += 1) {
 4982:       if (!(this.vertices[v].layer instanceof LightLayer)) {
 4983:         this.vertices[v].layer.threeDLayer = false;
 4984:       }
 4985:     }
 4986:     for (var v = 0; v < this.vertices.length; v += 1) {
 4987:       if (!(this.vertices[v].layer instanceof LightLayer)) {
 4988:         this.vertices[v].layer
 4989:           .property("ADBE Transform Group")
 4990:           .property("ADBE Rotate Z")
 4991:           .setValue(0);
 4992:       }
 4993:     }
 4994:     for (var v = 0; v < this.vertices.length; v += 1) {
 4995:       this.vertices[v].layer.parent = null;
 4996:       try {
 4997:         this.vertices[v].layer
 4998:           .property("ADBE Transform Group")
 4999:           .property("ADBE Position").expression = "";
 5000:         this.vertices[v].layer
 5001:           .property("ADBE Transform Group")
 5002:           .property("ADBE Opacity").expression = "";
 5003:         this.vertices[v].layer
 5004:           .property("ADBE Transform Group")
 5005:           .property("ADBE Scale").expression = "";
 5006:         if (this.vertices[v].layer.threeDLayer === true) {
 5007:           this.vertices[v].layer
 5008:             .property("ADBE Transform Group")
 5009:             .property("ADBE Rotate X").expression = "";
 5010:           this.vertices[v].layer.threeDLayer = false;
 5011:         }
 5012:       } catch (err) {
 5013:         null;
 5014:       }
 5015:     }
 5016:   };
 5017:   this.setParentingAndProps = function () {
 5018:     for (var ed = 0; ed < this.edges.length; ed += 1) {
 5019:       this.edges[ed].setLayerWeight();
 5020:       parentVertex = this.edges[ed].getHead();
 5021:       childVertex = this.edges[ed].getTail();
 5022:       if (childVertex.startVertex === false) {
 5023:         childVertex.setStartVertex();
 5024:         childEdge = this.edges[ed].adjacentEdge;
 5025:         newAnchor = childEdge.centerPoint;
 5026:         delta =
 5027:           childVertex.layer
 5028:             .property("ADBE Transform Group")
 5029:             .property("ADBE Position").value - newAnchor;
 5030:         childVertex.layer
 5031:           .property("ADBE Transform Group")
 5032:           .property("ADBE Anchor Point")
 5033:           .setValue(
 5034:             childVertex.layer
 5035:               .property("ADBE Transform Group")
 5036:               .property("ADBE Anchor Point").value -
 5037:               (delta * 100) /
 5038:                 childVertex.layer
 5039:                   .property("ADBE Transform Group")
 5040:                   .property("ADBE Scale").value[0],
 5041:           );
 5042:         childVertex.layer
 5043:           .property("ADBE Transform Group")
 5044:           .property("ADBE Position")
 5045:           .setValue(newAnchor);
 5046:         try {
 5047:           childVertex.layer.parent = parentVertex.layer;
 5048:         } catch (err) {
 5049:           origami.writeln("!CIRCULAR REFERENCE FOUND!");
 5050:           childVertex.layer.label = 1;
 5051:           parentVertex.layer.label = 1;
 5052:           origami.writeln(
 5053:             childVertex.layer.name,
 5054:             " and ",
 5055:             parentVertex.layer.name,
 5056:           );
 5057:         }
 5058:       }
 5059:     }
 5060:     for (var ed = 0; ed < this.edges.length; ed += 1) {
 5061:       parentVertex = this.edges[ed].getHead();
 5062:       childVertex = this.edges[ed].getTail();
 5063:       childEdge = this.edges[ed].adjacentEdge;
 5064:       childVertex.layer.threeDLayer = true;
 5065:       childVertex.layer
 5066:         .property("ADBE Transform Group")
 5067:         .property("ADBE Orientation")
 5068:         .setValue([
 5069:           0,
 5070:           0,
 5071:           childEdge.getAngle() +
 5072:             childVertex.layer
 5073:               .property("ADBE Transform Group")
 5074:               .property("ADBE Rotate Z").value,
 5075:         ]);
 5076:       childVertex.layer
 5077:         .property("ADBE Transform Group")
 5078:         .property("ADBE Rotate Z")
 5079:         .setValue(-1 * childEdge.getAngle());
 5080:       childVertex.layer
 5081:         .property("ADBE Transform Group")
 5082:         .property("ADBE Rotate X").expression = origami.expressions.rotX;
 5083:       childVertex.layer
 5084:         .property("ADBE Transform Group")
 5085:         .property("ADBE Opacity").expression = origami.expressions.opacity;
 5086:       if (!parentVertex.layer.parent && parentVertex.startVertex === false) {
 5087:         parentVertex.setStartVertex();
 5088:         newAnchor = childEdge.centerPoint;
 5089:         parentVertex.layer.threeDLayer = true;
 5090:         delta =
 5091:           parentVertex.layer
 5092:             .property("ADBE Transform Group")
 5093:             .property("ADBE Position").value - newAnchor;
 5094:         parentVertex.layer
 5095:           .property("ADBE Transform Group")
 5096:           .property("ADBE Anchor Point")
 5097:           .setValue(
 5098:             parentVertex.layer
 5099:               .property("ADBE Transform Group")
 5100:               .property("ADBE Anchor Point").value -
 5101:               (delta * 100) /
 5102:                 parentVertex.layer
 5103:                   .property("ADBE Transform Group")
 5104:                   .property("ADBE Scale").value[0],
 5105:           );
 5106:         parentVertex.layer
 5107:           .property("ADBE Transform Group")
 5108:           .property("ADBE Position")
 5109:           .setValue(newAnchor);
 5110:         if (
 5111:           parentVertex.layer
 5112:             .property("ADBE Transform Group")
 5113:             .property("ADBE Rotate X").canSetExpression
 5114:         ) {
 5115:           parentVertex.layer
 5116:             .property("ADBE Transform Group")
 5117:             .property("ADBE Rotate X").expression = origami.expressions.rotX;
 5118:         }
 5119:         if (
 5120:           parentVertex.layer
 5121:             .property("ADBE Transform Group")
 5122:             .property("ADBE Opacity").canSetExpression
 5123:         ) {
 5124:           parentVertex.layer
 5125:             .property("ADBE Transform Group")
 5126:             .property("ADBE Opacity").expression = origami.expressions.opacity;
 5127:         }
 5128:       }
 5129:     }
 5130:   };
 5131:   this.reverseParenting = function () {
 5132:     var weights = this.vertices.map(function (o) {
 5133:       return o.getLayerWeight();
 5134:     });
 5135:     var maxWeight = Math.max.apply(Math, weights);
 5136:     for (var v = 0; v < this.vertices.length; v += 1) {
 5137:       this.vertices[v].setLayerWeight(
 5138:         maxWeight - this.vertices[v].getLayerWeight(),
 5139:       );
 5140:     }
 5141:     this.bondsReversed = !this.bondsReversed;
 5142:   };
 5143:   this.parentStartVertices = function (_control, update) {
 5144:     if (!update) {
 5145:       _control
 5146:         .property("ADBE Transform Group")
 5147:         .property("ADBE Position")
 5148:         .setValue(
 5149:           this.startVertices[0].layer
 5150:             .property("ADBE Transform Group")
 5151:             .property("ADBE Position").value,
 5152:         );
 5153:     }
 5154:     for (var s = 0; s < this.startVertices.length; s += 1) {
 5155:       this.startVertices[s].layer.parent = _control;
 5156:     }
 5157:   };
 5158:   this.postAction = function () {
 5159:     for (var v = 0; v < this.vertices.length; v += 1) {
 5160:       try {
 5161:         this.vertices[v].layer
 5162:           .property("Material Options")
 5163:           .property("Casts Shadows")
 5164:           .setValue(true);
 5165:         this.vertices[v].layer
 5166:           .property("Material Options")
 5167:           .property("Accepts Lights")
 5168:           .setValue(false);
 5169:       } catch (err) {
 5170:         null;
 5171:       }
 5172:     }
 5173:     var weights = this.vertices.map(function (o) {
 5174:       return o.getLayerWeight();
 5175:     });
 5176:     var maxWeight = Math.max.apply(Math, weights);
 5177:     for (var v = 0; v < this.vertices.length; v += 1) {
 5178:       this.vertices[v].appendLayerWeight(
 5179:         maxWeight - this.vertices[v].getLayerWeight(),
 5180:       );
 5181:     }
 5182:   };
 5183:   this.showEdgesInfo = function () {
 5184:     for (var ed = 0; ed < this.edges.length; ed += 1) {
 5185:       this.edges[ed].showInfo();
 5186:     }
 5187:   };
 5188: };
 5189: origami.graphVertex = function (layer, polygon) {
 5190:   this.layer = layer;
 5191:   this.polygon = polygon;
 5192:   this.startVertex = false;
 5193:   this.beenHere = false;
 5194:   this.endOf = null;
 5195:   this.setStartVertex = function () {
 5196:     this.startVertex = true;
 5197:   };
 5198:   this.setLayerWeight = function (newWeight) {
 5199:     newWeight = newWeight + parseFloat(Math.random().toFixed(1));
 5200:     this.layer.name = this.layer.name.split("\t")[0];
 5201:     this.layer.name += "_\t" + String(newWeight);
 5202:   };
 5203:   this.appendLayerWeight = function (newWeight) {
 5204:     newWeight = newWeight + parseFloat(Math.random().toFixed(1));
 5205:     this.layer.name = this.layer.name + "\t" + String(newWeight);
 5206:   };
 5207:   this.getLayerWeight = function () {
 5208:     if (this.layer.name.lastIndexOf("\t") != -1) {
 5209:       return parseInt(
 5210:         this.layer.name.substr(this.layer.name.lastIndexOf("_\t") + 2),
 5211:       );
 5212:     }
 5213:     return 0;
 5214:   };
 5215:   this.addChild = function (childLayer, polygon, commonEdge) {
 5216:     this.children.push(new origami.graphVertex(childLayer, polygon));
 5217:     this.edges.push(commonEdge);
 5218:   };
 5219:   this.addChildren = function (childrenArray, edgesArray) {
 5220:     this.children = this.children.concat(childrenArray);
 5221:     this.commonEdges = this.commonEdges.concat(edgesArray);
 5222:   };
 5223:   this.hasChildren = function () {
 5224:     if (this.children.length != 0) {
 5225:       return true;
 5226:     } else {
 5227:       return false;
 5228:     }
 5229:   };
 5230: };
 5231: origami.graphEdge = function (vertex1, vertex2) {
 5232:   this.v1 = vertex1;
 5233:   this.v2 = vertex2;
 5234:   this.v2.endOf = this;
 5235:   this.weight = 0;
 5236:   this.parent = null;
 5237:   this.setLayerWeight = function () {
 5238:     this.v2.setLayerWeight(this.weight);
 5239:   };
 5240:   this.setParent = function (parentEdge) {
 5241:     if (parentEdge) {
 5242:       this.parent = parentEdge;
 5243:       this.weight = parentEdge.weight + 1;
 5244:     } else {
 5245:       this.weight++;
 5246:     }
 5247:   };
 5248:   this.setWeight = function (newWeight) {
 5249:     this.weight = newWeight;
 5250:   };
 5251:   this.addAdjacentEdge = function (edge) {
 5252:     this.adjacentEdge = edge;
 5253:   };
 5254:   this.getHead = function () {
 5255:     return this.v1;
 5256:   };
 5257:   this.getTail = function () {
 5258:     return this.v2;
 5259:   };
 5260:   this.compare = function (anotherEdge) {
 5261:     if (
 5262:       this.v1 == anotherEdge.v1 ||
 5263:       this.v1 == anotherEdge.v2 ||
 5264:       this.v2 == anotherEdge.v1 ||
 5265:       this.v2 == anotherEdge.v2
 5266:     ) {
 5267:       return true;
 5268:     } else {
 5269:       return false;
 5270:     }
 5271:   };
 5272:   this.showInfo = function () {
 5273:     origami.writeln(this.v1.layer.name, " ---> ", this.v2.layer.name);
 5274:   };
 5275: };
 5276: origami.polygon = function (vertices, layer, transformsArr) {
 5277:   this.initEdges = function (thisObj) {
 5278:     thisObj.edges = [];
 5279:     for (var v = 0; v < thisObj.vertices.length; v += 1) {
 5280:       if (v != this.vertices.length - 1) {
 5281:         thisObj.edges.push(
 5282:           new origami.polyEdge(thisObj.vertices[v], thisObj.vertices[v + 1]),
 5283:         );
 5284:       } else {
 5285:         thisObj.edges.push(
 5286:           new origami.polyEdge(thisObj.vertices[v], thisObj.vertices[0]),
 5287:         );
 5288:       }
 5289:     }
 5290:   };
 5291:   this.reverse = function (thisObj) {
 5292:     thisObj.vertices = thisObj.vertices.reverse();
 5293:     thisObj.initEdges(thisObj);
 5294:   };
 5295:   this.checkClockwise = function (thisObj) {
 5296:     var sum = 0;
 5297:     var edgs = thisObj.edges;
 5298:     for (var e = 0; e < edgs.length; e += 1) {
 5299:       var A = [edgs[e].b.x - edgs[e].a.x, edgs[e].b.y - edgs[e].a.y];
 5300:       var B = [
 5301:         edgs[(e + 1) % edgs.length].b.x - edgs[(e + 1) % edgs.length].a.x,
 5302:         edgs[(e + 1) % edgs.length].b.y - edgs[(e + 1) % edgs.length].a.y,
 5303:       ];
 5304:       sum += A[0] * B[1] - A[1] * B[0];
 5305:     }
 5306:     if (sum < 0) {
 5307:       thisObj.reverse(thisObj);
 5308:     }
 5309:   };
 5310:   this.unTransform = function (transformsArr) {
 5311:     if (transformsArr !== null) {
 5312:       this.vertices = origami.untransformVerts(
 5313:         this.vertices,
 5314:         this.transformsArr,
 5315:       );
 5316:     }
 5317:     var tr = this.layer.property("ADBE Transform Group");
 5318:     var pos = tr.property("ADBE Position").value;
 5319:     var ap = tr.property("ADBE Anchor Point").value;
 5320:     var sc = tr.property("ADBE Scale").value / 100;
 5321:     var rot = (tr.property("ADBE Rotate Z").value * Math.PI) / 180;
 5322:     var getTrueValues = function (layer, position, anchor, scale, rotation) {
 5323:       if (layer.parent !== null) {
 5324:         var l = layer.parent.property("ADBE Transform Group");
 5325:         return getTrueValues(
 5326:           layer.parent,
 5327:           position +
 5328:             l.property("ADBE Position").value +
 5329:             l.property("ADBE Anchor Point").value,
 5330:           l.property("ADBE Anchor Point").value - anchor,
 5331:           [
 5332:             scale[0] * l.property("ADBE Scale").value[0],
 5333:             scale[1] * l.property("ADBE Scale").value[1],
 5334:           ] / 100,
 5335:           rotation + (l.property("ADBE Rotate Z").value * Math.PI) / 180,
 5336:         );
 5337:       } else {
 5338:         var obj = { ap: anchor, pos: position, rot: rotation, sc: scale };
 5339:         return obj;
 5340:       }
 5341:     };
 5342:     if (this.layer.parent != null) {
 5343:       var newValues = getTrueValues(this.layer, pos, ap, sc, rot);
 5344:       pos = newValues.pos;
 5345:       ap = newValues.ap;
 5346:       sc = newValues.sc;
 5347:       rot = newValues.rot;
 5348:     }
 5349:     this.vertices = this.vertices.map(function (p) {
 5350:       return p - [ap[0], ap[1]];
 5351:     });
 5352:     this.vertices = this.vertices.map(function (p) {
 5353:       return [p[0] * sc[0], p[1] * sc[1]];
 5354:     });
 5355:     this.vertices = this.vertices.map(function (p) {
 5356:       return [
 5357:         p[0] * Math.cos(rot) - p[1] * Math.sin(rot),
 5358:         p[0] * Math.sin(rot) + p[1] * Math.cos(rot),
 5359:       ];
 5360:     });
 5361:     this.vertices = this.vertices.map(function (p) {
 5362:       return p + [pos[0], pos[1]];
 5363:     });
 5364:   };
 5365:   this.getBack = function () {
 5366:     this.vertices = this.verticesBeforeUntransform;
 5367:     this.initEdges(this);
 5368:     this.checkClockwise(this);
 5369:     this.boundingBox = this.getBoundingBox();
 5370:   };
 5371:   this.getBoundingBox = function () {
 5372:     var minX = Infinity;
 5373:     var maxX = 0;
 5374:     var minY = Infinity;
 5375:     var maxY = 0;
 5376:     for (var v = 0; v < this.vertices.length; v += 1) {
 5377:       if (this.vertices[v].x < minX) {
 5378:         minX = this.vertices[v].x;
 5379:       }
 5380:       if (this.vertices[v].y < minY) {
 5381:         minY = this.vertices[v].y;
 5382:       }
 5383:     }
 5384:     for (var v = 0; v < this.vertices.length; v += 1) {
 5385:       if (this.vertices[v].x > maxX) {
 5386:         maxX = this.vertices[v].x;
 5387:       }
 5388:       if (this.vertices[v].y > maxY) {
 5389:         maxY = this.vertices[v].y;
 5390:       }
 5391:     }
 5392:     return [
 5393:       [minX, minY],
 5394:       [maxX, maxY],
 5395:     ];
 5396:   };
 5397:   this.getCenter = function () {
 5398:     bBox = this.getBoundingBox();
 5399:     return [(bBox[0][0] + bBox[1][0]) / 2, (bBox[0][1] + bBox[1][1]) / 2];
 5400:   };
 5401:   this.layer = layer || null;
 5402:   this.vertices = vertices;
 5403:   this.verticesBeforeUntransform = vertices.map(function (o) {
 5404:     return new origami.point(o);
 5405:   });
 5406:   this.transformsArr = transformsArr || null;
 5407:   if (this.layer != null) {
 5408:     this.unTransform(this.transformsArr);
 5409:   }
 5410:   this.vertices = this.vertices.map(function (o) {
 5411:     return new origami.point(o);
 5412:   });
 5413:   this.initEdges(this);
 5414:   this.checkClockwise(this);
 5415:   this.boundingBox = this.getBoundingBox();
 5416:   this.getVertices = function (asArray) {
 5417:     if (asArray === true) {
 5418:       return this.vertices.map(function (v) {
 5419:         return [v.x, v.y];
 5420:       });
 5421:     } else {
 5422:       return this.vertices;
 5423:     }
 5424:   };
 5425:   this.mergeWith = function (anotherPoly) {
 5426:     if (this.findCommonEdge(anotherPoly)) {
 5427:       var v1 = this.vertices;
 5428:       var v2 = anotherPoly.vertices;
 5429:       var adjacentEdge = this.findCommonEdge(anotherPoly);
 5430:       var tmp = [];
 5431:       var p1Start = v1.isThere(adjacentEdge.a);
 5432:       var direction = 1;
 5433:       if (v1[(p1Start + 1) % v1.length] == adjacentEdge.b) {
 5434:         direction = -1;
 5435:       }
 5436:       for (var v = 0; v < v1.length; v += 1) {
 5437:         var vertex = v1[(p1Start + v * direction + v1.length) % v1.length];
 5438:         tmp.push(vertex);
 5439:       }
 5440:       var p2start = v2.isThere(adjacentEdge.b);
 5441:       direction = 1;
 5442:       if (v2[(p2start + 1) % v2.length] == adjacentEdge.a) {
 5443:         direction = -1;
 5444:       }
 5445:       for (var vv = 0; vv < v2.length; vv += 1) {
 5446:         var vertex = v2[(p2start + vv * direction + v2.length) % v2.length];
 5447:         if (tmp.isThere(vertex) == false) {
 5448:           tmp.push(vertex);
 5449:         }
 5450:       }
 5451:       this.vertices = tmp;
 5452:     }
 5453:   };
 5454:   this.findCommonEdge = function (anotherPoly, onePoint) {
 5455:     for (var p1 = 0; p1 < this.edges.length; p1 += 1) {
 5456:       if (this.edges[p1].getLength() > 1) {
 5457:         for (var p2 = 0; p2 < anotherPoly.edges.length; p2 += 1) {
 5458:           if (anotherPoly.edges[p2].getLength() > 1) {
 5459:             var comparedEdge = this.edges[p1].compare(anotherPoly.edges[p2]);
 5460:             if (comparedEdge === true) {
 5461:               return anotherPoly.edges[p2];
 5462:             } else {
 5463:               if (comparedEdge) {
 5464:                 return comparedEdge;
 5465:               }
 5466:             }
 5467:           }
 5468:         }
 5469:       }
 5470:     }
 5471:     return null;
 5472:   };
 5473:   this.genRandomPoints = function (N) {
 5474:     this.newPointInPolygon = function () {
 5475:       var bBox = this.boundingBox;
 5476:       var newX = Math.random() * (bBox[1][0] - bBox[0][0]) + bBox[0][0];
 5477:       var newY = Math.random() * (bBox[1][1] - bBox[0][1]) + bBox[0][1];
 5478:       var newPoint = new origami.point([newX, newY]);
 5479:       while (this.contains(newPoint) == 0) {
 5480:         newX = Math.random() * (bBox[1][0] - bBox[0][0]) + bBox[0][0];
 5481:         newY = Math.random() * (bBox[1][1] - bBox[0][1]) + bBox[0][1];
 5482:         newPoint = new origami.point([newX, newY]);
 5483:       }
 5484:       return newPoint;
 5485:     };
 5486:     N = Math.abs(Number(N));
 5487:     if (N) {
 5488:       var pointsArray = [];
 5489:       while (pointsArray.length < N) {
 5490:         pointsArray.push(this.newPointInPolygon());
 5491:       }
 5492:       return pointsArray;
 5493:     } else {
 5494:       return [];
 5495:     }
 5496:   };
 5497:   this.contains = function (_point) {
 5498:     var c = 0;
 5499:     for (
 5500:       i = 0, j = this.vertices.length - 1;
 5501:       i < this.vertices.length;
 5502:       j = i++
 5503:     ) {
 5504:       if (
 5505:         this.vertices[i].y > _point.y != this.vertices[j].y > _point.y &&
 5506:         _point.x <
 5507:           ((this.vertices[j].x - this.vertices[i].x) *
 5508:             (_point.y - this.vertices[i].y)) /
 5509:             (this.vertices[j].y - this.vertices[i].y) +
 5510:             this.vertices[i].x
 5511:       ) {
 5512:         c = !c;
 5513:       }
 5514:     }
 5515:     origami.writeln(
 5516:       "Point:" +
 5517:         _point.x +
 5518:         " " +
 5519:         _point.y +
 5520:         ", with Polygon" +
 5521:         this.vertices.toString() +
 5522:         " answer: " +
 5523:         c,
 5524:     );
 5525:     return c == 1;
 5526:   };
 5527:   this.showEdgesInfo = function () {
 5528:     for (var e = 0; e < this.edges.length; e += 1) {
 5529:       this.edges[e].showInfo();
 5530:     }
 5531:   };
 5532:   this.getVertsAsArray = function () {
 5533:     return this.vertices.map(function (o) {
 5534:       return [o.x, o.y];
 5535:     });
 5536:   };
 5537: };
 5538: origami.polyEdge = function (p1, p2) {
 5539:   function getCommonPart(A, B, C, D) {
 5540:     return null;
 5541:   }
 5542:   this.a = p1;
 5543:   this.b = p2;
 5544:   this.getAngle = function () {
 5545:     return this.angle;
 5546:   };
 5547:   this.calculateCoeffs = function () {
 5548:     this.A = this.a.y - this.b.y;
 5549:     this.B = this.b.x - this.a.x;
 5550:     this.C = this.a.x * this.b.y - this.b.x * this.a.y;
 5551:     if (this.B) {
 5552:       this.angle = (180 * Math.atan(-this.A / this.B)) / Math.PI;
 5553:     } else {
 5554:       this.angle = 90;
 5555:     }
 5556:     if (Math.random() > 0.5) {
 5557:       this.angle = (this.angle + 180) % 360;
 5558:     }
 5559:     this.centerPoint = [(this.a.x + this.b.x) / 2, (this.a.y + this.b.y) / 2];
 5560:   };
 5561:   this.getLength = function () {
 5562:     return Math.sqrt(
 5563:       Math.pow(this.a.x - this.b.x, 2) + Math.pow(this.a.y - this.b.y, 2),
 5564:     );
 5565:   };
 5566:   this.normalize = function () {
 5567:     var delta = this.a - this.b;
 5568:     return new origami.point([
 5569:       delta.x / this.getLength(),
 5570:       delta.y / this.getLength(),
 5571:     ]);
 5572:   };
 5573:   this.pointOnEdge = function (point) {
 5574:     if (
 5575:       ((point.x >= this.a.x && point.x <= this.b.x) ||
 5576:         (point.x >= this.b.x && point.x <= this.a.x)) &&
 5577:       ((point.y >= this.a.y && point.y <= this.b.y) ||
 5578:         (point.y >= this.b.y && point.y <= this.a.y))
 5579:     ) {
 5580:       return true;
 5581:     } else {
 5582:       return false;
 5583:     }
 5584:   };
 5585:   this.pointInsideEdge = function (point) {
 5586:     if (
 5587:       ((point.x > this.a.x && point.x < this.b.x) ||
 5588:         (point.x > this.b.x && point.x < this.a.x)) &&
 5589:       ((point.y > this.a.y && point.y < this.b.y) ||
 5590:         (point.y > this.b.y && point.y < this.a.y))
 5591:     ) {
 5592:       return true;
 5593:     }
 5594:     return false;
 5595:   };
 5596:   this.getIntersection = function (anotherEdge) {
 5597:     var an = anotherEdge;
 5598:     newY =
 5599:       ((an.A * this.C) / this.A - an.C) / (an.B - (this.B * an.A) / this.A);
 5600:     newX = (-1 * (this.B * newY + this.C)) / this.A;
 5601:     if (
 5602:       ((newX <= this.a.x && newX > this.b.x) ||
 5603:         (newX >= this.a.x && newX < this.b.x)) &&
 5604:       ((newX <= an.a.x && newX > an.b.x) || (newX >= an.a.x && newX < an.b.x))
 5605:     ) {
 5606:       return new origami.point([newX, newY]);
 5607:     } else {
 5608:       return null;
 5609:     }
 5610:   };
 5611:   this.GetLineIntersection = function (anotherEdge) {
 5612:     var dax = this.a.x - anotherEdge.a.x;
 5613:     var dbx = this.b.x - anotherEdge.b.x;
 5614:     var day = this.a.y - anotherEdge.a.y;
 5615:     var dby = this.b.y - anotherEdge.b.y;
 5616:     var Den = dax * dby - day * dbx;
 5617:     if (Den === 0) {
 5618:       return null;
 5619:     }
 5620:     var A = this.a.x * anotherEdge.a.y - this.a.y * anotherEdge.a.x;
 5621:     var B = this.b.x * anotherEdge.b.y - this.b.y * anotherEdge.b.x;
 5622:     var I = new origami.point([0, 0]);
 5623:     I.x = (A * dbx - dax * B) / Den;
 5624:     I.y = (A * dby - day * B) / Den;
 5625:     return I;
 5626:   };
 5627:   this.getCommonPart = function (anotherEdge) {};
 5628:   this.compare = function (anotherEdge) {
 5629:     function getCommon(ab, cd) {
 5630:       if (ab.pointOnEdge(cd.a)) {
 5631:         if (ab.pointOnEdge(cd.b)) {
 5632:           return new origami.polyEdge(cd.a, cd.b);
 5633:         } else if (cd.pointInsideEdge(ab.a)) {
 5634:           return new origami.polyEdge(cd.a, ab.a);
 5635:         } else {
 5636:           if (cd.pointInsideEdge(ab.b)) {
 5637:             return new origami.polyEdge(cd.a, ab.b);
 5638:           }
 5639:         }
 5640:       } else if (ab.pointOnEdge(cd.b)) {
 5641:         if (ab.pointOnEdge(cd.a)) {
 5642:           return new origami.polyEdge(cd.b, cd.a);
 5643:         } else if (cd.pointInsideEdge(ab.a)) {
 5644:           return new origami.polyEdge(cd.b, ab.a);
 5645:         } else {
 5646:           if (cd.pointInsideEdge(ab.b)) {
 5647:             return new origami.polyEdge(cd.b, ab.b);
 5648:           }
 5649:         }
 5650:       } else if (cd.pointOnEdge(ab.a)) {
 5651:         if (cd.pointOnEdge(ab.b)) {
 5652:           return new origami.polyEdge(ab.a, ab.b);
 5653:         } else if (ab.pointInsideEdge(cd.a)) {
 5654:           return new origami.polyEdge(ab.a, cd.a);
 5655:         } else {
 5656:           if (ab.pointInsideEdge(cd.b)) {
 5657:             return new origami.polyEdge(ab.a, cd.b);
 5658:           }
 5659:         }
 5660:       } else {
 5661:         if (cd.pointOnEdge(ab.b)) {
 5662:           if (cd.pointOnEdge(ab.a)) {
 5663:             return new origami.polyEdge(ab.a, ab.b);
 5664:           } else if (ab.pointInsideEdge(cd.a)) {
 5665:             return new origami.polyEdge(ab.b, cd.a);
 5666:           } else {
 5667:             if (ab.pointInsideEdge(cd.b)) {
 5668:               return new origami.polyEdge(ab.b, cd.b);
 5669:             }
 5670:           }
 5671:         }
 5672:       }
 5673:       return false;
 5674:     }
 5675:     if (this.a == anotherEdge.a && this.b == anotherEdge.b) {
 5676:       return true;
 5677:     } else {
 5678:       if (this.a == anotherEdge.b && this.b == anotherEdge.a) {
 5679:         return true;
 5680:       }
 5681:     }
 5682:     A1 = this.A;
 5683:     A2 = anotherEdge.A;
 5684:     B1 = this.B;
 5685:     B2 = anotherEdge.B;
 5686:     if (A1 == 0 && A2 == 0) {
 5687:       return getCommon(this, anotherEdge);
 5688:     } else if (B1 == 0 && B2 == 0) {
 5689:       return getCommon(this, anotherEdge);
 5690:     } else {
 5691:       if ((A1 != 0 && B1 != 0) || (A2 != 0 && B2 != 0)) {
 5692:         if (
 5693:           A2 != 0 &&
 5694:           B2 != 0 &&
 5695:           parseInt((100 * A1) / A2) / 100 == parseInt((100 * B1) / B2) / 100
 5696:         ) {
 5697:           return getCommon(this, anotherEdge);
 5698:         }
 5699:       }
 5700:     }
 5701:     return false;
 5702:   };
 5703:   this.getInfo = function () {
 5704:     return (
 5705:       "p1: [" +
 5706:       this.a.x +
 5707:       "," +
 5708:       this.a.y +
 5709:       "]\np2: [" +
 5710:       this.b.x +
 5711:       "," +
 5712:       this.b.y +
 5713:       "]"
 5714:     );
 5715:   };
 5716:   this.calculateCoeffs();
 5717: };
 5718: origami.point = function (coordArray) {
 5719:   this.x = Math.round(coordArray[0] * 100) / 100;
 5720:   this.y = Math.round(coordArray[1] * 100) / 100;
 5721:   this.z = Math.round(coordArray[2] * 100) / 100 || undefined;
 5722:   this["+"] = function (operand) {
 5723:     return new origami.point([this.x + operand.x, this.y + operand.y]);
 5724:   };
 5725:   this["-"] = function (operand) {
 5726:     return new origami.point([this.x - operand.x, this.y - operand.y]);
 5727:   };
 5728:   this["*"] = function (operand) {
 5729:     return new origami.point([this.x * operand, this.y * operand]);
 5730:   };
 5731:   this["=="] = function (operand) {
 5732:     if (this.x == operand.x && this.y == operand.y && this.z == operand.z) {
 5733:       return true;
 5734:     } else {
 5735:       return false;
 5736:     }
 5737:   };
 5738:   this.toArray = function () {
 5739:     if (this.z !== undefined) {
 5740:       return [this.x, this.y, this.z];
 5741:     } else {
 5742:       return [this.x, this.y];
 5743:     }
 5744:   };
 5745:   this.toString = function () {
 5746:     if (this.z !== undefined) {
 5747:       return String(this.x) + "," + String(this.y) + "," + String(this.z);
 5748:     } else {
 5749:       return String(this.x) + "; " + String(this.y);
 5750:     }
 5751:   };
 5752: };
 5753: origami.colorGenerator = function (_color, _range, _static) {
 5754:   this.cArray = [];
 5755:   this._color = _color || "NILL";
 5756:   this._static = _static || false;
 5757:   this._range = _range || 50;
 5758:   this._range = 1 - (100 - this._range) / 100;
 5759:   this.generateNew = function (wut) {
 5760:     if (this._static == false) {
 5761:       if (this._color == "NILL") {
 5762:         var tmpColor = new origami.color(
 5763:           255 *
 5764:             [
 5765:               (1 - this._range) / 2 + Math.random() * this._range,
 5766:               (1 - this._range) / 2 + Math.random() * this._range,
 5767:               (1 - this._range) / 2 + Math.random() * this._range,
 5768:               1,
 5769:             ],
 5770:         );
 5771:         if (!this.cArray.isThere(tmpColor)) {
 5772:           this.cArray.push(tmpColor);
 5773:           return tmpColor.value;
 5774:         }
 5775:       } else {
 5776:         var hsl = this.getHSL(this._color[0], this._color[1], this._color[2]);
 5777:         var rgb = this.getRGB(
 5778:           hsl[0],
 5779:           hsl[1],
 5780:           (1 - this._range) / 2 + Math.random() * this._range,
 5781:         );
 5782:         return rgb / 255;
 5783:       }
 5784:     } else {
 5785:       return this._color / 255;
 5786:     }
 5787:   };
 5788:   this.getHSL = function (r, g, b) {
 5789:     r /= 255;
 5790:     g /= 255;
 5791:     b /= 255;
 5792:     var max = Math.max(r, g, b);
 5793:     var min = Math.min(r, g, b);
 5794:     var l = (max + min) / 2;
 5795:     if (max == min) {
 5796:       h = s = 0;
 5797:     } else {
 5798:       var d = max - min;
 5799:       s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
 5800:       switch (max) {
 5801:         case r:
 5802:           h = (g - b) / d + g < b ? 6 : 0;
 5803:           break;
 5804:         case g:
 5805:           h = (b - r) / d + 2;
 5806:           break;
 5807:         case b:
 5808:           h = (r - g) / d + 4;
 5809:           break;
 5810:       }
 5811:       h /= 6;
 5812:     }
 5813:     return [h, s, l];
 5814:   };
 5815:   this.getRGB = function (h, s, l) {
 5816:     if (s == 0) {
 5817:       r = g = b = l;
 5818:     } else {
 5819:       var hue2rgb = function hue2rgb(p, q, t) {
 5820:         if (t < 0) {
 5821:           t += 1;
 5822:         }
 5823:         if (t > 1) {
 5824:           t -= 1;
 5825:         }
 5826:         if (t < 0.16666666666666666) {
 5827:           return p + (q - p) * 6 * t;
 5828:         }
 5829:         if (t < 0.5) {
 5830:           return q;
 5831:         }
 5832:         if (t < 0.6666666666666666) {
 5833:           return p + (q - p) * (0.6666666666666666 - t) * 6;
 5834:         }
 5835:         return p;
 5836:       };
 5837:       var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
 5838:       var p = 2 * l - q;
 5839:       r = hue2rgb(p, q, h + 0.3333333333333333);
 5840:       g = hue2rgb(p, q, h);
 5841:       b = hue2rgb(p, q, h - 0.3333333333333333);
 5842:     }
 5843:     return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255), 255];
 5844:   };
 5845: };
 5846: origami.color = function (colorValue) {
 5847:   var hexRe = /[a-f0-9]{6}/;
 5848:   if (colorValue instanceof Array) {
 5849:     this.R = colorValue[0];
 5850:     this.G = colorValue[1];
 5851:     this.B = colorValue[2];
 5852:     if (colorValue.length == 4) {
 5853:       this.A = colorValue[3];
 5854:     } else {
 5855:       this.A = 255;
 5856:     }
 5857:   } else if (colorValue instanceof String && hexRe.test(colorValue)) {
 5858:     this.R = parseInt(colorValue.substr(0, 2), 16);
 5859:     this.G = parseInt(colorValue.substr(2, 2), 16);
 5860:     this.B = parseInt(colorValue.substr(4, 2), 16);
 5861:     this.A = 255;
 5862:     this.hexValue = colorValue;
 5863:   } else {
 5864:     this.R = 255;
 5865:     this.G = 255;
 5866:     this.B = 255;
 5867:     this.A = 255;
 5868:   }
 5869:   this.normalize = function () {
 5870:     return [this.R, this.G, this.B, this.A] / 255;
 5871:   };
 5872:   this.getHex = function () {
 5873:     function toHex(n) {
 5874:       n = parseInt(n, 10);
 5875:       if (isNaN(n)) {
 5876:         return "00";
 5877:       }
 5878:       n = Math.max(0, Math.min(n, 255));
 5879:       return (
 5880:         "0123456789ABCDEF".charAt((n - (n % 16)) / 16) +
 5881:         "0123456789ABCDEF".charAt(n % 16)
 5882:       );
 5883:     }
 5884:     return toHex(this.R) + toHex(this.G) + toHex(this.B);
 5885:   };
 5886:   this.value = this.normalize([this.R, this.G, this.B, this.A]);
 5887:   this["=="] = function (operand) {
 5888:     return this.value == operand.value;
 5889:   };
 5890: };
 5891: var origami = this;
 5892: var poly2tri = this;
 5893: origami.untransformVerts = function (vertices, transformsArr) {
 5894:   for (var t = transformsArr.length - 1; t >= 0; t--) {
 5895:     var s = transformsArr[t].property("ADBE Vector Scale").value / 100;
 5896:     var r =
 5897:       (transformsArr[t].property("ADBE Vector Rotation").value * Math.PI) / 180;
 5898:     vertices = vertices.map(function (o) {
 5899:       return o - transformsArr[t].property("ADBE Vector Anchor").value;
 5900:     });
 5901:     vertices = vertices.map(function (p) {
 5902:       return [p[0] * s[0], p[1] * s[1]];
 5903:     });
 5904:     vertices = vertices.map(function (p) {
 5905:       return [
 5906:         p[0] * Math.cos(r) - p[1] * Math.sin(r),
 5907:         p[0] * Math.sin(r) + p[1] * Math.cos(r),
 5908:       ];
 5909:     });
 5910:     vertices = vertices.map(function (o) {
 5911:       return o + transformsArr[t].property("ADBE Vector Position").value;
 5912:     });
 5913:   }
 5914:   return vertices;
 5915: };
 5916: origami.masksToLayers = function (layer, remove) {
 5917:   var masks = layer.property("ADBE Mask Parade");
 5918:   app.beginUndoGroup("tst mask");
 5919:   for (var m = masks.numProperties; m > 0; m--) {
 5920:     var newLayer = layer.duplicate();
 5921:     newLayer.name = newLayer.name + "_mask_" + String(m);
 5922:     var newMasks = newLayer.property("ADBE Mask Parade");
 5923:     for (var j = newMasks.numProperties; j > 0; j--) {
 5924:       if (j != m) {
 5925:         newMasks.property(j).remove();
 5926:       } else {
 5927:         newMasks.property(j).property("ADBE Mask Offset").setValue(1);
 5928:       }
 5929:     }
 5930:   }
 5931:   if (remove) {
 5932:     layer.remove();
 5933:   }
 5934:   app.endUndoGroup();
 5935: };
 5936: origami.clipPolygons = function (thisPoly, anotherPoly, hole) {
 5937:   var P = [];
 5938:   var Q = [];
 5939:   var pointsInsideAnother = 0;
 5940:   var pointsInsideThis = 0;
 5941:   for (var v = 0; v < thisPoly.vertices.length; v += 1) {
 5942:     if (anotherPoly.contains(thisPoly.vertices[v])) {
 5943:       pointsInsideAnother++;
 5944:     }
 5945:   }
 5946:   for (var v = 0; v < anotherPoly.vertices.length; v += 1) {
 5947:     if (thisPoly.contains(anotherPoly.vertices[v])) {
 5948:       pointsInsideThis++;
 5949:     }
 5950:   }
 5951:   if (pointsInsideAnother == thisPoly.vertices.length) {
 5952:     origami.writeln(pointsInsideAnother);
 5953:     origami.writeln("\t\nINSIDE f1!!\n");
 5954:     return thisPoly;
 5955:   } else if (pointsInsideThis == anotherPoly.vertices.length) {
 5956:     origami.writeln("\t\nINSIDE f2\n");
 5957:     return anotherPoly;
 5958:   } else {
 5959:     var inout = false;
 5960:     if (anotherPoly.contains(thisPoly.edges[0].a) == 1) {
 5961:       inout = true;
 5962:     }
 5963:     origami.writeln(
 5964:       "\nP 1st point: ",
 5965:       thisPoly.edges[0].a.toString(),
 5966:       " Inside: ",
 5967:       inout,
 5968:     );
 5969:     for (var aE = 0; aE < thisPoly.edges.length; aE += 1) {
 5970:       for (var bE = 0; bE < anotherPoly.edges.length; bE += 1) {
 5971:         var getInt = thisPoly.edges[aE].getIntersection(anotherPoly.edges[bE]);
 5972:         if (getInt) {
 5973:           P.push({ coord: getInt.toArray(), out: inout });
 5974:           inout = !inout;
 5975:         }
 5976:       }
 5977:       P.push({ coord: thisPoly.edges[aE].b.toArray(), out: null });
 5978:     }
 5979:     origami.writeln(
 5980:       "\nP: ",
 5981:       P.map(function (o) {
 5982:         return "\ntype " + o.out + " coord: " + o.coord[0] + "; " + o.coord[1];
 5983:       }),
 5984:     );
 5985:     inout = false;
 5986:     if (thisPoly.contains(anotherPoly.edges[0].a) == 1) {
 5987:       inout = true;
 5988:     }
 5989:     origami.writeln(
 5990:       "\nQ 1st point: ",
 5991:       anotherPoly.edges[0].a.toString(),
 5992:       " Inside: ",
 5993:       inout,
 5994:     );
 5995:     for (var bE = 0; bE < anotherPoly.edges.length; bE += 1) {
 5996:       for (var aE = 0; aE < thisPoly.edges.length; aE += 1) {
 5997:         var getInt = anotherPoly.edges[bE].getIntersection(thisPoly.edges[aE]);
 5998:         if (getInt) {
 5999:           Q.push({ coord: getInt.toArray(), out: inout });
 6000:           inout = !inout;
 6001:         }
 6002:       }
 6003:       Q.push({ coord: anotherPoly.edges[bE].b.toArray(), out: null });
 6004:     }
 6005:     origami.writeln(
 6006:       "Q: ",
 6007:       Q.map(function (o) {
 6008:         return "\ntype " + o.out + " coord: " + o.coord[0] + "; " + o.coord[1];
 6009:       }),
 6010:     );
 6011:     var numFalse = 0;
 6012:     var numTrue = 0;
 6013:     var QnumFalse = 0;
 6014:     var QnumTrue = 0;
 6015:     for (var p = 0; p < P.length; p += 1) {
 6016:       if (P[p].out == true) {
 6017:         numTrue++;
 6018:       }
 6019:       if (P[p].out == false) {
 6020:         numFalse++;
 6021:       }
 6022:     }
 6023:     for (var q = 0; q < Q.length; q += 1) {
 6024:       if (Q[q].out == true) {
 6025:         QnumTrue++;
 6026:       }
 6027:       if (Q[q].out == false) {
 6028:         QnumFalse++;
 6029:       }
 6030:     }
 6031:     origami.writeln("checking numFalse and numTrue");
 6032:     if (numTrue > 0 && numFalse > 0) {
 6033:       origami.writeln("checked, fine");
 6034:       var newPolyVertices = [];
 6035:       var mrkr = false;
 6036:       var prevOut = [];
 6037:       var getPolyFromPandQ = function (p, q) {
 6038:         var vertPushed = 0;
 6039:         var finalPoint = null;
 6040:         var mrkr = false;
 6041:         while (P[p].out === true && (mrkr === true) === false) {
 6042:           if (P[p].out === false) {
 6043:             mrkr = true;
 6044:           }
 6045:           if (mrkr == true) {
 6046:             newPolyVertices.push(P[p].coord);
 6047:             vertPushed++;
 6048:           }
 6049:           p = (p + 1) % P.length;
 6050:           if (P[p].out === true && mrkr === true) {
 6051:             finalPoint = P[p].coord;
 6052:             break;
 6053:           }
 6054:         }
 6055:         var mrkr = false;
 6056:         while (Q[q].out === true && (mrkr === true) === false) {
 6057:           if (Q[q].out === false) {
 6058:             mrkr = true;
 6059:           }
 6060:           if (mrkr == true && Q[q].out !== false) {
 6061:             newPolyVertices.push(Q[q].coord);
 6062:             vertPushed++;
 6063:           }
 6064:           q = (q + 1) % Q.length;
 6065:         }
 6066:         newPolyVertices.push(finalPoint);
 6067:         vertPushed++;
 6068:         origami.writeln(newPolyVertices.toString());
 6069:         return { p: p, pushed: vertPushed, q: q };
 6070:       };
 6071:       var polygons_count = numFalse / 2;
 6072:       var ind_p = 0;
 6073:       var ind_q = 0;
 6074:       while (polygons_count > 0) {
 6075:         var ANSWER = getPolyFromPandQ(ind_p, ind_q);
 6076:         ind_p = ANSWER.p;
 6077:         ind_q = ANSWER.q;
 6078:         polygons_count--;
 6079:         origami.writeln(numFalse, numTrue, QnumFalse, QnumTrue);
 6080:         origami.writeln(ANSWER.pushed + " " + ANSWER.p + " " + ANSWER.q);
 6081:       }
 6082:       if (newPolyVertices.length > 0) {
 6083:         return new origami.polygon(newPolyVertices);
 6084:       } else {
 6085:         return null;
 6086:       }
 6087:     } else {
 6088:       return null;
 6089:     }
 6090:   }
 6091: };
 6092: origami.getSliceVertices = function (layer, mask) {
 6093:   function getAllPathsObjects(_group, _transformsArr) {
 6094:     var transformName = "ADBE Vector Transform Group";
 6095:     var pathName = "ADBE Vector Shape";
 6096:     var arr = [];
 6097:     if (_transformsArr == undefined) {
 6098:       var _transformsArr = [];
 6099:     }
 6100:     if (_group.property(transformName) !== null) {
 6101:       localTrArr = _transformsArr.concat([_group.property(transformName)]);
 6102:     } else {
 6103:       localTrArr = _transformsArr;
 6104:     }
 6105:     for (var i = 1; i <= _group.numProperties; i += 1) {
 6106:       curProp = _group.property(i);
 6107:       if (curProp instanceof PropertyGroup) {
 6108:         arr = arr.concat(getAllPathsObjects(curProp, localTrArr));
 6109:       } else {
 6110:         if (curProp.matchName == pathName) {
 6111:           var obj = { prop: curProp, transformsArr: localTrArr };
 6112:           arr.push(obj);
 6113:         }
 6114:       }
 6115:     }
 6116:     return arr;
 6117:   }
 6118:   if (layer.property("ADBE Mask Parade").numProperties > 0) {
 6119:     var transforms = [];
 6120:     if (layer instanceof ShapeLayer) {
 6121:       var path = getAllPathsObjects(
 6122:         layer.property("ADBE Root Vectors Group"),
 6123:       )[0];
 6124:       if (path) {
 6125:         transforms = path.transformsArr;
 6126:       } else {
 6127:         var paramPath = origami.getAllParamObjects(
 6128:           layer.property("ADBE Root Vectors Group"),
 6129:         );
 6130:         if (paramPath.length > 0) {
 6131:           transforms = paramPath[0].transformsArr;
 6132:         }
 6133:       }
 6134:     }
 6135:     tmp = layer
 6136:       .property("ADBE Mask Parade")
 6137:       .property("ADBE Mask Atom")
 6138:       .property("ADBE Mask Shape").value.vertices;
 6139:     if (layer.property("ADBE Mask Parade").numProperties > 1) {
 6140:       var holesArray = [];
 6141:       for (
 6142:         var h = 2;
 6143:         h <= layer.property("ADBE Mask Parade").numProperties;
 6144:         h += 1
 6145:       ) {
 6146:         holesArray.push(
 6147:           new origami.polygon(
 6148:             layer
 6149:               .property("ADBE Mask Parade")
 6150:               .property(h)
 6151:               .property("ADBE Mask Shape").value.vertices,
 6152:             layer,
 6153:           ),
 6154:         );
 6155:       }
 6156:       return [new origami.polygon(tmp, layer, transforms), holesArray];
 6157:     }
 6158:     return new origami.polygon(tmp, layer, transforms);
 6159:   } else if (layer instanceof ShapeLayer) {
 6160:     var path = getAllPathsObjects(layer.property("ADBE Root Vectors Group"))[0];
 6161:     if (path) {
 6162:       vert = path.prop.value.vertices;
 6163:       var newPoly = new origami.polygon(vert, layer, path.transformsArr);
 6164:       return newPoly;
 6165:     } else {
 6166:       var paramPath = origami.getAllParamObjects(
 6167:         layer.property("ADBE Root Vectors Group"),
 6168:       );
 6169:       if (paramPath.length > 0) {
 6170:         var vert = origami.convertParamShape(paramPath[0].prop);
 6171:         var newPoly = new origami.polygon(
 6172:           vert,
 6173:           layer,
 6174:           paramPath[0].transformsArr,
 6175:         );
 6176:         return newPoly;
 6177:       }
 6178:     }
 6179:     return null;
 6180:   } else {
 6181:     return null;
 6182:   }
 6183: };
 6184: origami.meshGen = function (
 6185:   pointCount,
 6186:   sliceType,
 6187:   createMask,
 6188:   explode,
 6189:   remove,
 6190:   offset,
 6191:   preview,
 6192:   colorType,
 6193:   colorRange,
 6194:   postCompose,
 6195: ) {
 6196:   var activeComp = app.project.activeItem;
 6197:   if (activeComp && activeComp instanceof CompItem) {
 6198:     var sel = activeComp.selectedLayers;
 6199:     if (sel.length > 0) {
 6200:       var poly = origami.getSliceVertices(sel[0]);
 6201:       if (poly == null) {
 6202:         if (sel[0] instanceof AVLayer && origami.AEversion >= 13.2) {
 6203:           poly = origami.getLayerBound(sel[0]);
 6204:         } else {
 6205:           alert("Select a shape layer or a layer with a mask");
 6206:         }
 6207:       }
 6208:       if (poly !== null) {
 6209:         if (poly instanceof Array) {
 6210:           poly = poly[0];
 6211:         }
 6212:         if (poly.vertices.length > 2) {
 6213:           if (createMask) {
 6214:             poly.getBack();
 6215:           }
 6216:           if (createMask === false && sel[0].threeDLayer === true) {
 6217:             poly.getBack();
 6218:           }
 6219:           var polygons = origami.getSliceByType(sliceType);
 6220:           polygons = polygons.slicer(poly, pointCount);
 6221:           if (createMask === true && sel[0] instanceof ShapeLayer) {
 6222:             polygons = polygons.map(function (o) {
 6223:               return origami.untransformVerts(o, poly.transformsArr);
 6224:             });
 6225:           }
 6226:           origami.makeSlices(
 6227:             activeComp,
 6228:             polygons,
 6229:             sel[0],
 6230:             explode,
 6231:             offset,
 6232:             remove,
 6233:             createMask,
 6234:             preview,
 6235:             colorType,
 6236:             colorRange,
 6237:             postCompose,
 6238:           );
 6239:         }
 6240:       }
 6241:     }
 6242:   }
 6243: };
 6244: origami.makeSlices = function (
 6245:   _comp,
 6246:   polygons,
 6247:   selLayer,
 6248:   explode,
 6249:   offset,
 6250:   remove,
 6251:   createMask,
 6252:   preview,
 6253:   colorType,
 6254:   colorRange,
 6255:   postCompose,
 6256: ) {
 6257:   function centerShapeAnchor(_layer, vertices) {
 6258:     var tmpPoly = new origami.polygon(vertices);
 6259:     var newAnchor = tmpPoly.getBoundingBox();
 6260:     newAnchor =
 6261:       [newAnchor[1][0] + newAnchor[0][0], newAnchor[1][1] + newAnchor[0][1]] /
 6262:       2;
 6263:     var delta =
 6264:       _layer.property("ADBE Transform Group").property("ADBE Position").value -
 6265:       newAnchor;
 6266:     _layer
 6267:       .property("ADBE Transform Group")
 6268:       .property("ADBE Anchor Point")
 6269:       .setValue(
 6270:         _layer.property("ADBE Transform Group").property("ADBE Anchor Point")
 6271:           .value - delta,
 6272:       );
 6273:     _layer
 6274:       .property("ADBE Transform Group")
 6275:       .property("ADBE Position")
 6276:       .setValue(newAnchor);
 6277:   }
 6278:   var createdLayers = [];
 6279:   var getFirstFill = function (_group) {
 6280:     var fillName = "ADBE Vector Graphic - Fill";
 6281:     if (_group.property(fillName) != null) {
 6282:       return (
 6283:         _group.property(fillName).property("ADBE Vector Fill Color").value * 255
 6284:       );
 6285:     }
 6286:     for (var i = 1; i <= _group.numProperties; i += 1) {
 6287:       var curProp = _group.property(i);
 6288:       if (curProp instanceof PropertyGroup) {
 6289:         return getFirstFill(curProp);
 6290:       }
 6291:     }
 6292:     return null;
 6293:   };
 6294:   var colorGetter = function (_comp, layer) {
 6295:     this.comp = _comp;
 6296:     this.layer = _layer || null;
 6297:     this.init = function () {
 6298:       this.adj = this.comp.layers.addSolid(
 6299:         [1, 1, 0],
 6300:         "tst",
 6301:         _comp.width,
 6302:         _comp.height,
 6303:         _comp.pixelAspect,
 6304:         _comp.duration,
 6305:       );
 6306:       this.adj.adjustmentLayer = true;
 6307:       this.col = this.adj
 6308:         .property("ADBE Effect Parade")
 6309:         .addProperty("ADBE Color Control");
 6310:     };
 6311:     this.generateNew = function (coordinate) {
 6312:       this.adj.moveToBeginning();
 6313:       this.col.property("ADBE Color Control-0001").expression =
 6314:         'bgLayer = thisComp.layer("' +
 6315:         this.layer.name +
 6316:         '"' +
 6317:         "\nbgLayer.sampleImage([" +
 6318:         coordinate[0] +
 6319:         ", " +
 6320:         coordinate[1] +
 6321:         "], [5,5], true, time)";
 6322:       $.sleep(750);
 6323:       return this.col
 6324:         .property("ADBE Color Control-0001")
 6325:         .valueAtTime(this.comp.time, false);
 6326:     };
 6327:     this.remove = function () {
 6328:       this.adj.remove();
 6329:     };
 6330:     this.init();
 6331:   };
 6332:   if (createMask == false) {
 6333:     var col = 255 * [Math.random(), Math.random(), Math.random(), 1];
 6334:     if (selLayer instanceof ShapeLayer) {
 6335:       col = getFirstFill(selLayer.property("ADBE Root Vectors Group"));
 6336:       if (col == null) {
 6337:         col = [Math.random(), Math.random(), Math.random(), 1] * 255;
 6338:       }
 6339:     }
 6340:   }
 6341:   if (colorType == 0) {
 6342:     colorGen = new origami.colorGenerator(col, 0, true);
 6343:   } else if (colorType == 1) {
 6344:     colorGen = new origami.colorGenerator("NILL", colorRange);
 6345:   } else if (colorType == 2) {
 6346:     colorGen = new origami.colorGenerator(col, colorRange);
 6347:   } else {
 6348:     colorGen = new colorGetter(_comp, selLayer);
 6349:   }
 6350:   if (createMask) {
 6351:     if (selLayer instanceof ShapeLayer) {
 6352:       var p = selLayer
 6353:         .property("ADBE Transform Group")
 6354:         .property("ADBE Position").value;
 6355:     }
 6356:     if (explode) {
 6357:       m = selLayer.property("ADBE Mask Parade");
 6358:       for (var i = m.numProperties; i > 0; i--) {
 6359:         m.property(i).remove();
 6360:       }
 6361:       for (var t = 0; t < polygons.length; t += 1) {
 6362:         dLayer = selLayer.duplicate();
 6363:         dLayer.name = dLayer.name + "_fragment" + t;
 6364:         dLayer.comment = origami.names.layerComment;
 6365:         origami.drawMask(polygons[t], dLayer, offset);
 6366:         createdLayers.push(dLayer);
 6367:         if (selLayer.comment == origami.names.layerComment) {
 6368:           dLayer.name = selLayer.name;
 6369:         }
 6370:       }
 6371:       if (
 6372:         selLayer.threeDLayer === true &&
 6373:         selLayer.comment == origami.names.layerComment
 6374:       ) {
 6375:         for (var l = 1; l <= _comp.layers.length; l += 1) {
 6376:           if (_comp.layers[l].parent == selLayer) {
 6377:             _comp.layers[l].parent = dLayer;
 6378:           }
 6379:         }
 6380:       }
 6381:     } else {
 6382:       dLayer = selLayer.duplicate();
 6383:       createdLayers.push(dLayer);
 6384:       m = dLayer.property("ADBE Mask Parade");
 6385:       for (var i = m.numProperties; i > 0; i--) {
 6386:         m.property(i).remove();
 6387:       }
 6388:       for (var t = 0; t < polygons.length; t += 1) {
 6389:         origami.drawMask(polygons[t], dLayer, offset);
 6390:       }
 6391:       selLayer.selected = false;
 6392:       dLayer.property("ADBE Mask Parade").property("ADBE Mask Atom").selected =
 6393:         true;
 6394:     }
 6395:   } else {
 6396:     if (explode) {
 6397:       for (var t = 0; t < polygons.length; t += 1) {
 6398:         if (polygons[t] != null) {
 6399:           shapeLayer = _comp.layers.addShape();
 6400:           shapeLayer.name = selLayer.name + "_fragment" + t;
 6401:           shapeLayer.comment = origami.names.layerComment;
 6402:           shapeLayer
 6403:             .property("ADBE Transform Group")
 6404:             .property("ADBE Position")
 6405:             .setValue([0, 0]);
 6406:           shapeLayer.moveAfter(selLayer);
 6407:           origami.writeln("===Draw Shape=== ");
 6408:           origami.writeln(polygons[t]);
 6409:           tmpPoly = new origami.polygon(polygons[t]);
 6410:           center = tmpPoly.getCenter();
 6411:           origami.drawShape(
 6412:             polygons[t],
 6413:             shapeLayer,
 6414:             offset,
 6415:             colorGen.generateNew(),
 6416:             col,
 6417:           );
 6418:           centerShapeAnchor(shapeLayer, polygons[t]);
 6419:           createdLayers.push(shapeLayer);
 6420:           if (selLayer.parent) {
 6421:             shapeLayer.parent = selLayer.parent;
 6422:           }
 6423:           if (selLayer.threeDLayer === true) {
 6424:             shapeLayer.threeDLayer = true;
 6425:             if (selLayer.comment == origami.names.layerComment) {
 6426:               shapeLayer.name = selLayer.name;
 6427:               shapeLayer
 6428:                 .property("ADBE Transform Group")
 6429:                 .property("ADBE Position")
 6430:                 .setValue(
 6431:                   selLayer
 6432:                     .property("ADBE Transform Group")
 6433:                     .property("ADBE Position").value,
 6434:                 );
 6435:               shapeLayer
 6436:                 .property("ADBE Transform Group")
 6437:                 .property("ADBE Anchor Point")
 6438:                 .setValue(
 6439:                   selLayer
 6440:                     .property("ADBE Transform Group")
 6441:                     .property("ADBE Anchor Point").value,
 6442:                 );
 6443:               if (shapeLayer.threeDLayer === true) {
 6444:                 shapeLayer
 6445:                   .property("ADBE Transform Group")
 6446:                   .property("ADBE Orientation")
 6447:                   .setValue(
 6448:                     selLayer
 6449:                       .property("ADBE Transform Group")
 6450:                       .property("ADBE Orientation").value,
 6451:                   );
 6452:               }
 6453:               shapeLayer
 6454:                 .property("ADBE Transform Group")
 6455:                 .property("ADBE Rotate Z")
 6456:                 .setValue(
 6457:                   selLayer
 6458:                     .property("ADBE Transform Group")
 6459:                     .property("ADBE Rotate Z").value,
 6460:                 );
 6461:               if (
 6462:                 selLayer
 6463:                   .property("ADBE Transform Group")
 6464:                   .property("ADBE Rotate X").expression != ""
 6465:               ) {
 6466:                 shapeLayer
 6467:                   .property("ADBE Transform Group")
 6468:                   .property("ADBE Rotate X").expression = this.expressions.rotX;
 6469:               }
 6470:               if (
 6471:                 selLayer
 6472:                   .property("ADBE Transform Group")
 6473:                   .property("ADBE Opacity").expression != ""
 6474:               ) {
 6475:                 shapeLayer
 6476:                   .property("ADBE Transform Group")
 6477:                   .property("ADBE Opacity").expression =
 6478:                   this.expressions.opacity;
 6479:               }
 6480:               if (
 6481:                 selLayer.property("ADBE Transform Group").property("ADBE Scale")
 6482:                   .expression != ""
 6483:               ) {
 6484:                 shapeLayer
 6485:                   .property("ADBE Transform Group")
 6486:                   .property("ADBE Scale").expression = this.expressions.scale;
 6487:               }
 6488:               if (
 6489:                 selLayer
 6490:                   .property("ADBE Transform Group")
 6491:                   .property("ADBE Position").expression != ""
 6492:               ) {
 6493:                 shapeLayer
 6494:                   .property("ADBE Transform Group")
 6495:                   .property("ADBE Position").expression =
 6496:                   this.expressions.position;
 6497:               }
 6498:               if (
 6499:                 selLayer
 6500:                   .property("ADBE Transform Group")
 6501:                   .property("ADBE Rotate Z").expression != ""
 6502:               ) {
 6503:                 shapeLayer
 6504:                   .property("ADBE Transform Group")
 6505:                   .property("ADBE Rotate Z").expression = this.expressions.rotZ;
 6506:               }
 6507:             }
 6508:           }
 6509:         }
 6510:       }
 6511:       if (
 6512:         selLayer.threeDLayer === true &&
 6513:         selLayer.comment == origami.names.layerComment
 6514:       ) {
 6515:         for (var l = 1; l <= _comp.layers.length; l += 1) {
 6516:           if (_comp.layers[l].parent == selLayer) {
 6517:             _comp.layers[l].parent = shapeLayer;
 6518:           }
 6519:         }
 6520:       }
 6521:       if (colorType == 3) {
 6522:         colorGen.remove();
 6523:       }
 6524:     } else {
 6525:       if (preview) {
 6526:         var previewLayer = _comp.findLayerByName(
 6527:           origami.names.previewLayer.name,
 6528:         );
 6529:         if (previewLayer !== null) {
 6530:           shapeLayer = previewLayer;
 6531:           shapeLayer.locked = false;
 6532:           shapeLayer.comment = origami.names.layerComment;
 6533:           for (
 6534:             var i = shapeLayer.property(
 6535:               "ADBE Root Vectors Group",
 6536:             ).numProperties;
 6537:             i > 0;
 6538:             i--
 6539:           ) {
 6540:             shapeLayer.property("ADBE Root Vectors Group").property(i).remove();
 6541:           }
 6542:         } else {
 6543:           shapeLayer = _comp.layers.addShape();
 6544:           shapeLayer.name = origami.names.previewLayer.name;
 6545:         }
 6546:         shapeLayer.locked = true;
 6547:       } else {
 6548:         shapeLayer = _comp.layers.addShape();
 6549:         shapeLayer.name = selLayer.name + "_fragments";
 6550:         shapeLayer.comment = origami.names.layerComment;
 6551:         createdLayers.push(shapeLayer);
 6552:       }
 6553:       shapeLayer
 6554:         .property("ADBE Transform Group")
 6555:         .property("ADBE Position")
 6556:         .setValue([0, 0]);
 6557:       for (var t = 0; t < polygons.length; t += 1) {
 6558:         if (preview === true) {
 6559:           origami.drawShape(
 6560:             polygons[t],
 6561:             shapeLayer,
 6562:             true,
 6563:             [1, 0, 0, 1],
 6564:             col,
 6565:             false,
 6566:           );
 6567:         } else {
 6568:           origami.drawShape(
 6569:             polygons[t],
 6570:             shapeLayer,
 6571:             offset,
 6572:             colorGen.generateNew(),
 6573:             col,
 6574:             false,
 6575:           );
 6576:         }
 6577:       }
 6578:       centerShapeAnchor(shapeLayer, polygons[0]);
 6579:       if (colorType == 3) {
 6580:         colorGen.remove();
 6581:       }
 6582:     }
 6583:   }
 6584:   if (postCompose) {
 6585:     createdLayers = createdLayers.map(function (o) {
 6586:       return o.index;
 6587:     });
 6588:     _comp.layers
 6589:       .precompose(createdLayers, selLayer.name + "_fragments", true)
 6590:       .openInViewer();
 6591:     _comp.layer(selLayer.name + "_fragments").moveToBeginning();
 6592:   }
 6593:   selLayer.enabled = false;
 6594:   if (
 6595:     remove ||
 6596:     (selLayer.threeDLayer === true &&
 6597:       selLayer.comment == origami.names.layerComment)
 6598:   ) {
 6599:     selLayer.remove();
 6600:   }
 6601: };
 6602: origami.recolor = function (_comp, colorType, colorRange) {
 6603:   var comp = _comp || null;
 6604:   if (comp == null) {
 6605:     var tmp = app.project.activeItem;
 6606:     if (tmp instanceof CompItem) {
 6607:       comp = tmp;
 6608:     }
 6609:   }
 6610:   for (var l = 1; l <= comp.layers.length; l += 1) {
 6611:     if (
 6612:       comp.layers[l].comment == origami.names.layerComment &&
 6613:       comp.layers[l].selected === true
 6614:     ) {
 6615:       var mainShapeGroup = comp.layers[l].property("ADBE Root Vectors Group");
 6616:       for (var g = 1; g <= mainShapeGroup.numProperties; g += 1) {
 6617:         try {
 6618:           originalColor = mainShapeGroup
 6619:             .property(g)
 6620:             .property("Contents")
 6621:             .property(origami.names.originalColor)
 6622:             .property("ADBE Vector Fill Color");
 6623:           currentColor = mainShapeGroup
 6624:             .property(g)
 6625:             .property("Contents")
 6626:             .property(origami.names.currentColor)
 6627:             .property("ADBE Vector Fill Color");
 6628:           strokeColor = mainShapeGroup
 6629:             .property(g)
 6630:             .property("Contents")
 6631:             .property(origami.names.strokeColor)
 6632:             .property("ADBE Vector Stroke Color");
 6633:           if (colorType == 0) {
 6634:             colorGen = new origami.colorGenerator(originalColor.value, 0, true);
 6635:           } else if (colorType == 1) {
 6636:             colorGen = new origami.colorGenerator("NILL", colorRange);
 6637:           } else {
 6638:             colorGen = new origami.colorGenerator(
 6639:               originalColor.value,
 6640:               colorRange,
 6641:             );
 6642:           }
 6643:           col = colorGen.generateNew();
 6644:           currentColor.setValue(col);
 6645:           if (strokeColor !== null) {
 6646:             strokeColor.setValue(col);
 6647:           }
 6648:         } catch (err) {
 6649:           null;
 6650:         }
 6651:       }
 6652:     }
 6653:   }
 6654: };
 6655: origami.drawShape = function (
 6656:   trVertices,
 6657:   masterLayer,
 6658:   stroke,
 6659:   color,
 6660:   originalColor,
 6661:   strokeOnly,
 6662: ) {
 6663:   if (trVertices.length > 0) {
 6664:     var vertices = trVertices;
 6665:     if (
 6666:       vertices[vertices.length - 1][0] == vertices[0][0] &&
 6667:       vertices[vertices.length - 1][1] == vertices[0][1]
 6668:     ) {
 6669:       vertices = vertices.slice(1, vertices.length);
 6670:     }
 6671:     var triangle = new Shape();
 6672:     triangle.vertices = vertices;
 6673:     triangle.closed = true;
 6674:     var contents = masterLayer.property("ADBE Root Vectors Group");
 6675:     var g = contents.addProperty("ADBE Vector Group");
 6676:     var p = g.addProperty("ADBE Vectors Group");
 6677:     g.name = "Polygon";
 6678:     var t1 = p.addProperty("ADBE Vector Shape - Group");
 6679:     t1.property("ADBE Vector Shape").setValue(triangle);
 6680:     var trim = p.addProperty("ADBE Vector Filter - Trim");
 6681:     trim.property("ADBE Vector Trim End").expression =
 6682:       origami.expressions.trimPath;
 6683:     if (strokeOnly === true) {
 6684:       origami.setStroke(p, 1, color);
 6685:     } else {
 6686:       if (color !== null) {
 6687:         origami.setFill(p, color, origami.names.currentColor, false);
 6688:       }
 6689:       if (stroke !== null) {
 6690:         origami.setStroke(p, 1, color);
 6691:       }
 6692:       if (originalColor !== null) {
 6693:         origami.setFill(p, originalColor, origami.names.originalColor, true);
 6694:       }
 6695:     }
 6696:     return null;
 6697:   }
 6698: };
 6699: origami.drawMask = function (mVertices, masterLayer, offset) {
 6700:   var vertices = mVertices;
 6701:   if (vertices.length > 2) {
 6702:     if (
 6703:       vertices[vertices.length - 1][0] == vertices[0][0] &&
 6704:       vertices[vertices.length - 1][1] == vertices[0][1]
 6705:     ) {
 6706:       vertices = vertices.slice(1, vertices.length);
 6707:     }
 6708:     var offset = offset || 1;
 6709:     var triangle = new Shape();
 6710:     triangle.vertices = vertices;
 6711:     triangle.closed = true;
 6712:     var mask = masterLayer.property("ADBE Mask Parade");
 6713:     var g = mask.addProperty("ADBE Mask Atom");
 6714:     g.property("ADBE Mask Shape").setValue(triangle);
 6715:     g.property("ADBE Mask Offset").setValue(offset);
 6716:     return null;
 6717:   }
 6718: };
 6719: origami.setStroke = function (group, thick, color) {
 6720:   var strokeGroup = group.addProperty("ADBE Vector Graphic - Stroke");
 6721:   strokeGroup.name = origami.names.strokeColor;
 6722:   strokeGroup.property("ADBE Vector Stroke Width").setValue(thick);
 6723:   strokeGroup.property("ADBE Vector Stroke Color").setValue(color);
 6724: };
 6725: origami.setFill = function (group, color, _name, hide) {
 6726:   name = _name || null;
 6727:   var colGroup = group.addProperty("ADBE Vector Graphic - Fill");
 6728:   colGroup.property("ADBE Vector Fill Color").setValue(color);
 6729:   if (name !== null) {
 6730:     colGroup.name = name;
 6731:     if (hide === true) {
 6732:       colGroup.enabled = false;
 6733:     }
 6734:   }
 6735: };
 6736: origami.names = {
 6737:   algorithm: { name: "Unwrap algorithm", tip: "" },
 6738:   algorithms: {
 6739:     name: ["Greedy", "Random"],
 6740:     tip: "Greedy \u2013 will take every polygin neighbor.\nRandom \u2013 will build a random tree for cool animation.",
 6741:   },
 6742:   animateTab: { name: "Animate", tip: "" },
 6743:   animationEffects: {
 6744:     name: "Effects",
 6745:     tip: "Choose which properties to animate",
 6746:   },
 6747:   animationMethod: {
 6748:     name: "Animation",
 6749:     tip: "Choose algorithm for building mesh tree:\n\tWave will take all the neighbors on each step\n\tTree will build a nicely looking tree",
 6750:   },
 6751:   colorSettings: {
 6752:     name: "SHAPES COLOR",
 6753:     tip: "Choose created Shape Layers fill color type\nAnd set color variations",
 6754:   },
 6755:   controlLayer: "!control",
 6756:   controlName: "Origami Control",
 6757:   createMeshBttn: {
 6758:     name: "CREATE A MESH",
 6759:     tip: "Slice selected layer into selected fragments type",
 6760:   },
 6761:   createPanel: { name: "Make", tip: "" },
 6762:   currentColor: "Origami Fill",
 6763:   delayControl: "delay",
 6764:   directionColumn: {
 6765:     name: "Direction",
 6766:     tip: "Animate mesh appearance (IN)\nor disappearance (OUT)",
 6767:   },
 6768:   fixedRadioBttn: { name: "Fixed color", tip: "" },
 6769:   layerComment: "origami",
 6770:   mainModePanel: { name: "Set mesh type", tip: "" },
 6771:   maskTab: { name: "Tools", tip: "" },
 6772:   masksCreate: {
 6773:     name: "Masks",
 6774:     tip: "Creates masks and places them on selected layer copies",
 6775:   },
 6776:   methodGreedy: { name: "Wave", tip: "Takes all neighbors on each step" },
 6777:   methodRandom: {
 6778:     name: "Tree",
 6779:     tip: "Creates a tree branches style animation",
 6780:   },
 6781:   modeAdvanced: {
 6782:     name: "ADVANCED",
 6783:     tip: "Slice and Animate separately with lots of options",
 6784:   },
 6785:   modeBasic: {
 6786:     name: "BASIC",
 6787:     tip: "One-click slice and unwrap\nFor fast transitions",
 6788:   },
 6789:   modeSettings: {
 6790:     name: "",
 6791:     tip: "Tweak settings and Recolor your mesh fragments",
 6792:   },
 6793:   numPoints: {
 6794:     name: "Number of points",
 6795:     tip: "Set the number of points to add to source layer.\nMore point - more layers. ",
 6796:   },
 6797:   offsetOne: {
 6798:     name: "Offset 1px",
 6799:     tip: "Expands created masks 1px or creates a 1px wide stroke for shapes\nto prevent holes between objects",
 6800:   },
 6801:   opacityControl: "Opacity Control",
 6802:   originalColor: "Original Color",
 6803:   polyNull: "Polygon Null",
 6804:   positionControl: "Position Control",
 6805:   positionNull: "Position Control",
 6806:   postCompose: {
 6807:     name: "Precompose fragments",
 6808:     tip: "Precomposes fragments after creating mesh",
 6809:   },
 6810:   postExplode: {
 6811:     name: "Fragments to Layers",
 6812:     tip: "Puts each fragment on a new layer\n\nWill create one layer with all fragments if unchecked\nWARNING: Won\'t be suitable for animation!",
 6813:   },
 6814:   postRemove: {
 6815:     name: "Remove original layer",
 6816:     tip: "Removes the source layer after splitting it into polygons.",
 6817:   },
 6818:   previewLayer: "FLUX_PREVIEW",
 6819:   recolorBttn: {
 6820:     name: "RECOLOR",
 6821:     tip: "Recolor selected Shape Layers\nwith new fill type settings",
 6822:   },
 6823:   scaleControl: "Scale Control",
 6824:   separator: "or",
 6825:   setGroup: { name: "Slice Settings", tip: "" },
 6826:   shapesCreate: { name: "Shapes", tip: "Creates individual shape layers" },
 6827:   sliceAlgorithm: { name: "Slice algorithm", tip: "" },
 6828:   slicerTab: { name: "Slice", tip: "" },
 6829:   slicesSelect: {
 6830:     methods: origami.AllSlicesNames,
 6831:     name: "Mesh",
 6832:     tip: "Choose mesh fragments type\nPlay with different cutting algorithms.\nWe like all of them.",
 6833:   },
 6834:   stepOne: {
 6835:     name: "STEP1.CREATE A MESH",
 6836:     tip: "Create mesh (Shapes or Masks)",
 6837:   },
 6838:   stepTwo: { name: "STEP2.ANIMATE", tip: "Animate mesh" },
 6839:   strokeColor: "Origami Stroke",
 6840:   trimPathControl: "Trim Path control",
 6841:   updateBttn: { name: "UPDATE", tip: "Update created animation" },
 6842:   watToWat: {
 6843:     name: ["Masks", "Shapes"],
 6844:     tip: "Create layer copies with masks\nor Shape Layers",
 6845:   },
 6846:   xRotControl: "X rotation control",
 6847:   zRotControl: "Z rotation control",
 6848: };
 6849: origami.tips = {
 6850:   algorithms:
 6851:     "Greedy \u2013 will parent all neighbors\nRandom \u2013 will randomly move around polygons",
 6852:   mergePolys: "Merge two polygons",
 6853:   onePointChckBx:
 6854:     "If checked, polygons with one common point\nwill be treated as neighbors",
 6855:   previewBttn: "Preview slicing",
 6856:   shapesToMasks:
 6857:     "Takes all paths from a shape layer\nand converts them into masks on new solid",
 6858:   shatterMapBttn: "Create shatter map based on current polygons",
 6859:   slicesSelect: "Select polygon creation algorithm",
 6860: };
 6861: origami.buildGUI = function (thisObj) {
 6862:   thisObj.iconsFiles = [];
 6863:   var fldr = new Folder(Folder.userData.fullName + "/Aescripts/origami/");
 6864:   fldr.create();
 6865:   for (var i = 0; i < thisObj.iconsBinaries.length; i += 1) {
 6866:     thisObj.iconsFiles[i] = new File(
 6867:       fldr.fullName + "/origamiIconFile_" + i + ".png",
 6868:     );
 6869:     thisObj.iconsFiles[i].encoding = "BINARY";
 6870:     thisObj.iconsFiles[i].open("w");
 6871:     thisObj.iconsFiles[i].write(thisObj.iconsBinaries[i]);
 6872:     thisObj.iconsFiles[i].close();
 6873:   }
 6874:   var setPrefs = function () {
 6875:     if (thisObj.mode == 0) {
 6876:       thisObj.pointsEdit = pointsEditBasic.text;
 6877:       thisObj.selectSliceAlgorythm = sliceSelectBasic.selection.index;
 6878:       thisObj.createMode = createModeLineBasic.children[0].value;
 6879:       thisObj.unwrapMode = unwrapModeBasic.children[0].value;
 6880:     } else {
 6881:       if (thisObj.mode == 1) {
 6882:         thisObj.pointsEdit = pointsEditAdvanced.text;
 6883:         thisObj.selectSliceAlgorythm = sliceSelectAdvanced.selection.index;
 6884:         thisObj.createMode = createModeLineAdvanced.children[0].value;
 6885:         thisObj.unwrapMode = unwrapModeAdvanced.children[0].value;
 6886:         thisObj.animationDirection = directionColumn.children[0].value;
 6887:       }
 6888:     }
 6889:     thisObj.postRemove = postRemove.value;
 6890:     thisObj.offsetOne = offsetOne.value;
 6891:     thisObj.colorRangeValue = parseInt(rangeSlider.value);
 6892:     thisObj.pointsEdit = pointsEditAdvanced.text;
 6893:     thisObj.animRotation = animRotation.value;
 6894:     thisObj.animOpacity = animOpacity.value;
 6895:     thisObj.animRotationZ = animRotationZ.value;
 6896:     thisObj.animTrimPath = animTrimPath.value;
 6897:     thisObj.animScale = animScale.value;
 6898:     thisObj.animPosition = animPosition.value;
 6899:     thisObj.postExplode = postExplode.value;
 6900:     thisObj.postCompose = postCompose.value;
 6901:     for (var c = 0; c <= 2; c += 1) {
 6902:       if (colorGroup.children[c].value === true) {
 6903:         thisObj.colorMode = c;
 6904:       }
 6905:     }
 6906:     thisObj.setPrefs();
 6907:   };
 6908:   var getPrefs = function () {
 6909:     thisObj.getPrefs();
 6910:     thisObj.createMode = thisObj.createMode === "true";
 6911:     thisObj.unwrapMode = thisObj.unwrapMode === "true";
 6912:     thisObj.postExplode = thisObj.postExplode === "true";
 6913:     thisObj.postCompose = thisObj.postCompose === "true";
 6914:     thisObj.postRemove = thisObj.postRemove === "true";
 6915:     thisObj.animRotation = thisObj.animRotation === "true";
 6916:     thisObj.animOpacity = thisObj.animOpacity === "true";
 6917:     thisObj.animScale = thisObj.animScale === "true";
 6918:     thisObj.animPosition = thisObj.animPosition === "true";
 6919:     thisObj.animRotationZ = thisObj.animRotationZ === "true";
 6920:     thisObj.animTrimPath = thisObj.animTrimPath === "true";
 6921:     thisObj.updateExpressions = thisObj.updateExpressions === "true";
 6922:     thisObj.offsetOne = thisObj.offsetOne === "true";
 6923:     thisObj.strokeOnly = thisObj.strokeOnly === "true";
 6924:     thisObj.animationDirection = thisObj.animationDirection === "true";
 6925:   };
 6926:   getPrefs();
 6927:   var setMode = function () {
 6928:     basicModeGroup.visible = false;
 6929:     advancedModeGroup.visible = false;
 6930:     settingsModeGroup.visible = false;
 6931:     modeBasicIndicator.visible = false;
 6932:     settingsIndicator.visible = false;
 6933:     modeAdvancedIndicator.visible = false;
 6934:     modeBasicText.on.visible = false;
 6935:     modeBasicText.off.visible = true;
 6936:     modeAdvancedText.on.visible = false;
 6937:     modeAdvancedText.off.visible = true;
 6938:     if (thisObj.mode == 0) {
 6939:       basicModeGroup.visible = true;
 6940:       modeBasicIndicator.visible = true;
 6941:       modeBasicText.on.visible = true;
 6942:       modeBasicText.off.visible = false;
 6943:     } else if (thisObj.mode == 1) {
 6944:       advancedModeGroup.visible = true;
 6945:       modeAdvancedIndicator.visible = true;
 6946:       modeAdvancedText.on.visible = true;
 6947:       modeAdvancedText.off.visible = false;
 6948:       setAdvancedStep();
 6949:     } else {
 6950:       settingsModeGroup.visible = true;
 6951:       settingsIndicator.visible = true;
 6952:     }
 6953:     thisObj.setPrefs();
 6954:   };
 6955:   var setAdvancedStep = function () {
 6956:     if (thisObj.advancedStep == 0) {
 6957:       advancedStepOne.visible = true;
 6958:       advancedStepTwo.visible = false;
 6959:     } else {
 6960:       advancedStepOne.visible = false;
 6961:       advancedStepTwo.visible = true;
 6962:     }
 6963:     thisObj.setPrefs();
 6964:   };
 6965:   thisObj.ptGUI =
 6966:     thisObj instanceof Panel
 6967:       ? thisObj
 6968:       : new Window(
 6969:           "palette{spacing: 0, margins: [0,5,5,10], alignChildren:[\'left\', \'top\']}",
 6970:           thisObj.scriptTitle + " v" + thisObj.version,
 6971:           undefined,
 6972:           { resizeable: true },
 6973:         );
 6974:   var upperLine = thisObj.ptGUI.add(
 6975:     "group{orientation: \'column\', margins: [0,0,0,0], spacing: 0, alighChildren: [\'left\', \'top\']}",
 6976:   );
 6977:   var modeSelectGroup = upperLine.add(
 6978:     "group{orientation: \'row\', margins: [10,0,0,0]}",
 6979:   );
 6980:   var modeBasicGroup = modeSelectGroup.add(
 6981:     "group{margins:[0,3,0,0],orientation: \'column\', spacing: 0}",
 6982:   );
 6983:   var modeBasicText = modeBasicGroup.add("group{orientation:\'stack\'}");
 6984:   modeBasicText.off = modeBasicText
 6985:     .add("statictext", undefined, thisObj.names.modeBasic.name)
 6986:     .nsSetFG([0.65, 0.65, 0.65, 1])
 6987:     .nsSetTip(thisObj.names.modeBasic.tip);
 6988:   modeBasicText.on = modeBasicText
 6989:     .add("statictext", undefined, thisObj.names.modeBasic.name)
 6990:     .nsSetFG([0.8, 0.8, 0.8, 1])
 6991:     .nsSetTip(thisObj.names.modeBasic.tip);
 6992:   var modeBasicIndicator = modeBasicGroup
 6993:     .add("group{margins: [0,5,0,0]}")
 6994:     .add("group{preferredSize:[40,2]}")
 6995:     .nsSetBG([0.8, 0.8, 0.8, 1]);
 6996:   modeBasicGroup.addEventListener("mouseup", function (k) {
 6997:     if (k.button == 0) {
 6998:       setPrefs();
 6999:       thisObj.mode = 0;
 7000:       setMode();
 7001:     }
 7002:   });
 7003:   var modeAdvancedGroup = modeSelectGroup.add(
 7004:     "group{margins:[0,3,0,0],orientation: \'column\', spacing: 0}",
 7005:   );
 7006:   var modeAdvancedText = modeAdvancedGroup.add("group{orientation:\'stack\'}");
 7007:   modeAdvancedText.off = modeAdvancedText
 7008:     .add("statictext", undefined, origami.names.modeAdvanced.name)
 7009:     .nsSetFG([0.65, 0.65, 0.65, 1])
 7010:     .nsSetTip(thisObj.names.modeAdvanced.tip);
 7011:   modeAdvancedText.on = modeAdvancedText
 7012:     .add("statictext", undefined, origami.names.modeAdvanced.name)
 7013:     .nsSetFG([0.8, 0.8, 0.8, 1])
 7014:     .nsSetTip(thisObj.names.modeAdvanced.tip);
 7015:   var modeAdvancedIndicator = modeAdvancedGroup
 7016:     .add("group{margins: [0,5,0,0]}")
 7017:     .add("group{preferredSize:[75,2]}")
 7018:     .nsSetBG([0.8, 0.8, 0.8, 1]);
 7019:   modeAdvancedGroup.addEventListener("mouseup", function (k) {
 7020:     if (k.button == 0) {
 7021:       setPrefs();
 7022:       thisObj.mode = 1;
 7023:       setMode();
 7024:     }
 7025:   });
 7026:   var setBttnGroup = modeSelectGroup
 7027:     .add("group{margins:[8,0,0,0]}")
 7028:     .add("group{orientation: \'column\', spacing: 0}}");
 7029:   var setBttn = setBttnGroup
 7030:     .add("group{alignChildren:[\'center\',\'center\']}")
 7031:     .nsSetIcon(thisObj.iconsBinaries[2]);
 7032:   setBttn.preferredSize = [25, 25];
 7033:   var settingsIndicator = setBttnGroup
 7034:     .add("group{margins: [0,0,0,0]}")
 7035:     .add("group{preferredSize:[25,2]}")
 7036:     .nsSetBG([0.8, 0.8, 0.8, 1])
 7037:     .nsSetTip(thisObj.names.modeSettings.tip);
 7038:   setBttn.addEventListener("mouseup", function (k) {
 7039:     if (k.button == 0) {
 7040:       setPrefs();
 7041:       thisObj.mode = 2;
 7042:       setMode();
 7043:     }
 7044:   });
 7045:   var modesGroup = thisObj.ptGUI.add(
 7046:     "group{orientation: \'stack\', spacing: 0, margins: [5,3,0,0], alignChildren: [\'left\', \'top\']}",
 7047:   );
 7048:   modesGroup.preferredSize = [170, 250];
 7049:   var basicModeGroup = modesGroup.add(
 7050:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], margins: [10,0,0,0]}",
 7051:   );
 7052:   var sliceSelectBasicGroup = basicModeGroup.add("group{orientation: \'row\'}");
 7053:   sliceSelectBasicGroup
 7054:     .add("statictext", undefined, thisObj.names.slicesSelect.name)
 7055:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7056:   var sliceSelectBasic = sliceSelectBasicGroup
 7057:     .add("dropdownlist", undefined, thisObj.names.slicesSelect.methods)
 7058:     .nsSetTip(thisObj.names.slicesSelect.tip);
 7059:   sliceSelectBasic.preferredSize = [116, 30];
 7060:   sliceSelectBasic.selection = thisObj.selectSliceAlgorythm;
 7061:   var pointsEditBasicGroup = basicModeGroup.add(
 7062:     "group{orientation: \'row\', margins:[0,10,0,0]}",
 7063:   );
 7064:   pointsEditBasicGroup
 7065:     .add("statictext", undefined, thisObj.names.numPoints.name)
 7066:     .nsSetTip(thisObj.names.numPoints.tip)
 7067:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7068:   var pointsEditBasic = pointsEditBasicGroup
 7069:     .add("edittext", undefined, "20")
 7070:     .nsSetTip(thisObj.names.numPoints.tip);
 7071:   pointsEditBasic.text = thisObj.pointsEdit;
 7072:   pointsEditBasic.preferredSize = [50, 25];
 7073:   basicModeGroup
 7074:     .add("group{margins:[0,10,0,5]}")
 7075:     .add("statictext", undefined, thisObj.names.createPanel.name)
 7076:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7077:   var createModeLineBasic = basicModeGroup.add("group{orientation: \'row\'}");
 7078:   createModeLineBasic
 7079:     .add("radiobutton", undefined, thisObj.names.masksCreate.name)
 7080:     .nsSetTip(thisObj.names.masksCreate.tip);
 7081:   createModeLineBasic
 7082:     .add("radiobutton", undefined, thisObj.names.shapesCreate.name)
 7083:     .nsSetTip(thisObj.names.shapesCreate.tip);
 7084:   createModeLineBasic.children[0].value = thisObj.createMode;
 7085:   createModeLineBasic.children[1].value = !thisObj.createMode;
 7086:   basicModeGroup
 7087:     .add("group{margins:[0,10,0,5]}")
 7088:     .add("statictext", undefined, "Animation")
 7089:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7090:   var unwrapModeBasic = basicModeGroup.add(
 7091:     "group{orientation: \'row\', margins:[0,5,0,0]}",
 7092:   );
 7093:   unwrapModeBasic.add("radiobutton", undefined, "Wave");
 7094:   unwrapModeBasic.add("radiobutton", undefined, "Tree");
 7095:   unwrapModeBasic.children[0].value = thisObj.unwrapMode;
 7096:   unwrapModeBasic.children[1].value = !thisObj.unwrapMode;
 7097:   var unwrapBttnGroup = basicModeGroup.add(
 7098:     "group{orientation: \'stack\', margins:[0,60,0,0]}",
 7099:   );
 7100:   unwrapBttnGroup
 7101:     .add("group{preferredSize:[155,30]}")
 7102:     .nsSetBG([0.4, 0.4, 0.4, 1]);
 7103:   var oneClickUnwrap = unwrapBttnGroup.add(
 7104:     "button",
 7105:     undefined,
 7106:     "MESH + ANIMATE",
 7107:   );
 7108:   oneClickUnwrap.preferredSize = [151, 26];
 7109:   var advancedModeGroup = modesGroup.add(
 7110:     "group{orientation:\'stack\', spacing: 0, alignChildren: [\'left\', \'top\'], margins: [0,0,0,0]}",
 7111:   );
 7112:   var advancedStepOne = advancedModeGroup.add(
 7113:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], justify: \'left\', margins:[2,0,0,0]}",
 7114:   );
 7115:   var stepOne_1 = advancedStepOne.add(
 7116:     "panel{orientation: \'row\', alignChildren: [\'left\', \'top\'], spacing:0, margins: [0,0,0,5], size: [170,29], preferredSize: [170,29]}",
 7117:   );
 7118:   stepOne_1
 7119:     .add("group{margins:[10,5,0,0]}")
 7120:     .add("statictext", undefined, thisObj.names.stepOne.name)
 7121:     .nsSetTip(thisObj.names.stepOne.tip)
 7122:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7123:   stepOne_1
 7124:     .add("group{margins:[13,5,5,0]}")
 7125:     .add("group{preferredSize:[20,20], alignment:[\'center\', \'center\']}")
 7126:     .nsSetIcon(thisObj.iconsBinaries[0]);
 7127:   stepOne_1.addEventListener("mouseup", function (k) {
 7128:     if (k.button == 0) {
 7129:       setPrefs();
 7130:       thisObj.advancedStep = 1;
 7131:       setAdvancedStep();
 7132:     }
 7133:   });
 7134:   var overPanel = advancedStepOne.add(
 7135:     "group{orientation: \'stack\', spacing:0, margins: [0,0,0,0], alignChildren:[\'left\', \'top\']}",
 7136:   );
 7137:   var advancedStepOneInside = overPanel.add(
 7138:     "panel{orientation: \'column\', spacing:0, margins: [5,5,6,5], preferredSize: [170,200]}",
 7139:   );
 7140:   var insideGroup1 = advancedStepOneInside.add(
 7141:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], margins: [0,0,0,0]}",
 7142:   );
 7143:   var sliceSelectAdvancedGroup = insideGroup1.add(
 7144:     "group{orientation: \'row\', margins:[5,0,0,0]}",
 7145:   );
 7146:   sliceSelectAdvancedGroup
 7147:     .add("statictext", undefined, thisObj.names.slicesSelect.name)
 7148:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7149:   var sliceSelectAdvanced = sliceSelectAdvancedGroup
 7150:     .add("group{margins:[10,0,0,0]}")
 7151:     .add("dropdownlist", undefined, thisObj.names.slicesSelect.methods)
 7152:     .nsSetTip(thisObj.names.slicesSelect.tip);
 7153:   sliceSelectAdvanced.preferredSize = [100, 30];
 7154:   sliceSelectAdvanced.selection = thisObj.selectSliceAlgorythm;
 7155:   var pointsEditAdvancedGroup = insideGroup1.add(
 7156:     "group{orientation: \'row\', margins:[5,5,0,0]}",
 7157:   );
 7158:   pointsEditAdvancedGroup
 7159:     .add("statictext", undefined, thisObj.names.numPoints.name)
 7160:     .nsSetTip(thisObj.names.numPoints.tip)
 7161:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7162:   var pointsEditAdvanced = pointsEditAdvancedGroup
 7163:     .add("edittext", undefined, "20")
 7164:     .nsSetTip(thisObj.names.numPoints.tip);
 7165:   pointsEditAdvanced.text = thisObj.pointsEdit;
 7166:   pointsEditAdvanced.preferredSize = [45, 25];
 7167:   insideGroup1
 7168:     .add("group{margins:[5,10,0,0]}")
 7169:     .add("statictext", undefined, thisObj.names.createPanel.name)
 7170:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7171:   var createModeLineAdvanced = insideGroup1.add(
 7172:     "group{orientation: \'row\', margins:[5,5,0,0]}",
 7173:   );
 7174:   createModeLineAdvanced
 7175:     .add("radiobutton", undefined, thisObj.names.masksCreate.name)
 7176:     .nsSetTip(thisObj.names.masksCreate.tip);
 7177:   createModeLineAdvanced
 7178:     .add("radiobutton", undefined, thisObj.names.shapesCreate.name)
 7179:     .nsSetTip(thisObj.names.shapesCreate.tip);
 7180:   createModeLineAdvanced.children[0].value = thisObj.createMode;
 7181:   createModeLineAdvanced.children[1].value = !thisObj.createMode;
 7182:   var postExplode = insideGroup1
 7183:     .add("group{margins:[5,10,0,0]}")
 7184:     .add("checkbox", undefined, thisObj.names.postExplode.name)
 7185:     .nsSetTip(thisObj.names.postExplode.tip);
 7186:   postExplode.value = thisObj.postExplode;
 7187:   var sliceBttnGroup = insideGroup1
 7188:     .add("group{alignment:[\'center\', \'center\']}")
 7189:     .add("group{orientation: \'stack\', margins: [0,10,0,0]}");
 7190:   sliceBttnGroup
 7191:     .add("group{preferredSize: [149,30]}")
 7192:     .nsSetBG([0.4, 0.4, 0.4, 1]);
 7193:   var sliceBttn = sliceBttnGroup
 7194:     .add("button", undefined, thisObj.names.createMeshBttn.name)
 7195:     .nsSetTip(thisObj.names.createMeshBttn.tip);
 7196:   sliceBttn.size = [145, 26];
 7197:   var stepTwo_1 = advancedStepOne.add(
 7198:     "panel{orientation: \'row\', alignChildren: [\'left\', \'center\'], spacing:0, margins: [0,2,0,5], size: [170,29], preferredSize: [170,29]}",
 7199:   );
 7200:   stepTwo_1
 7201:     .add("group{margins:[10,0,0,0]}")
 7202:     .add("statictext", undefined, thisObj.names.stepTwo.name)
 7203:     .nsSetTip(thisObj.names.stepTwo.tip);
 7204:   stepTwo_1
 7205:     .add("group{margins:[49,0,5,0]}")
 7206:     .add("group{preferredSize:[20,20], alignment:[\'center\', \'center\']}")
 7207:     .nsSetIcon(thisObj.iconsBinaries[1]);
 7208:   stepTwo_1.addEventListener("mouseup", function (k) {
 7209:     if (k.button == 0) {
 7210:       setPrefs();
 7211:       thisObj.advancedStep = 1;
 7212:       setAdvancedStep();
 7213:     }
 7214:   });
 7215:   var hints = {
 7216:     hint1: { margins: [], reverse: false, size: [], text: "" },
 7217:     hint2: { margins: [], reverse: false, size: [], text: "" },
 7218:     hint3: {
 7219:       margins: [0, 70, 0, 0],
 7220:       reverse: false,
 7221:       size: [165, 40],
 7222:       text: "Set number of points\nto fill mesh with fragments.\nMore points = more fragments",
 7223:     },
 7224:     hint4: {
 7225:       margins: [0, 120, 0, 0],
 7226:       reverse: false,
 7227:       size: [165, 40],
 7228:       text: "Create Shape Layers\nor layer copies with Masks",
 7229:     },
 7230:     hint5: {
 7231:       margins: [0, 45, 0, 0],
 7232:       reverse: false,
 7233:       size: [165, 40],
 7234:       text: "Create lots of fragments\nor only one layer",
 7235:     },
 7236:     hint6: {
 7237:       margins: [0, 60, 0, 0],
 7238:       reverse: true,
 7239:       size: [165, 40],
 7240:       text: "Now select a Shape layer or\na layer with a mask and\nclick the button",
 7241:     },
 7242:   };
 7243:   var advancedStepTwo = advancedModeGroup.add(
 7244:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], justify: \'left\', margins:[2,0,0,0]}",
 7245:   );
 7246:   var stepOne_2 = advancedStepTwo.add(
 7247:     "panel{orientation: \'row\', alignChildren: [\'left\', \'top\'], spacing:0, margins: [0,0,0,5], size: [170,29], preferredSize: [170,29]}",
 7248:   );
 7249:   stepOne_2
 7250:     .add("group{margins:[10,5,0,0]}")
 7251:     .add("statictext", undefined, thisObj.names.stepOne.name)
 7252:     .nsSetTip(thisObj.names.stepOne.tip);
 7253:   stepOne_2
 7254:     .add("group{margins:[13,3,5,0]}")
 7255:     .add("group{preferredSize:[20,20], alignment:[\'center\', \'center\']}")
 7256:     .nsSetIcon(thisObj.iconsBinaries[1]);
 7257:   stepOne_2.addEventListener("mouseup", function (k) {
 7258:     if (k.button == 0) {
 7259:       setPrefs();
 7260:       thisObj.advancedStep = 0;
 7261:       setAdvancedStep();
 7262:     }
 7263:   });
 7264:   var stepTwo_2 = advancedStepTwo.add(
 7265:     "panel{orientation: \'row\', alignChildren: [\'left\', \'center\'], spacing:0, margins: [0,2,0,3], size: [170,29], preferredSize: [170,29]}",
 7266:   );
 7267:   stepTwo_2
 7268:     .add("group{margins:[10,0,0,0]}")
 7269:     .add("statictext", undefined, thisObj.names.stepTwo.name)
 7270:     .nsSetFG([0.8, 0.8, 0.8, 1])
 7271:     .nsSetTip(thisObj.names.stepTwo.tip);
 7272:   stepTwo_2
 7273:     .add("group{margins:[49,3,5,0]}")
 7274:     .add("group{preferredSize:[20,20], alignment:[\'center\', \'center\']}")
 7275:     .nsSetIcon(thisObj.iconsBinaries[0]);
 7276:   stepTwo_2.addEventListener("mouseup", function (k) {
 7277:     if (k.button == 0) {
 7278:       setPrefs();
 7279:       thisObj.advancedStep = 0;
 7280:       setAdvancedStep();
 7281:     }
 7282:   });
 7283:   var advancedStepTwoInside = advancedStepTwo.add(
 7284:     "panel{orientation: \'column\', spacing:0, margins: [6,5,6,5], preferredSize: [170,200]}",
 7285:   );
 7286:   var insideGroup2 = advancedStepTwoInside.add(
 7287:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], margins: [0,0,0,0]}",
 7288:   );
 7289:   var lineOne = insideGroup2.add(
 7290:     "group{orientation:\'row\', margins:[5,0,0,0], alignChildren: [\'left\', \'top\']}",
 7291:   );
 7292:   var col1 = lineOne.add(
 7293:     "group{orientation:\'column\', margins:[0,0,0,0], spacing: 0, alignChildren: [\'left\', \'top\']}",
 7294:   );
 7295:   col1
 7296:     .add("statictext", undefined, thisObj.names.directionColumn.name)
 7297:     .nsSetTip(thisObj.names.directionColumn.tip)
 7298:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7299:   var directionColumn = col1.add(
 7300:     "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], spacing: 2, margins:[0,5,0,0]}",
 7301:   );
 7302:   directionColumn.add("radiobutton", undefined, "In");
 7303:   directionColumn.add("radiobutton", undefined, "Out");
 7304:   directionColumn.children[0].value = thisObj.animationDirection;
 7305:   directionColumn.children[1].value = !thisObj.animationDirection;
 7306:   var col2 = lineOne.add(
 7307:     "group{orientation:\'column\', margins:[19,0,0,0], spacing: 0, alignChildren: [\'left\', \'top\']}",
 7308:   );
 7309:   col2
 7310:     .add("statictext", undefined, thisObj.names.animationMethod.name)
 7311:     .nsSetTip(thisObj.names.animationMethod.tip)
 7312:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7313:   var unwrapModeAdvanced = col2.add(
 7314:     "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], spacing: 2, margins:[0,5,0,0]}",
 7315:   );
 7316:   unwrapModeAdvanced
 7317:     .add("radiobutton", undefined, thisObj.names.methodGreedy.name)
 7318:     .nsSetTip(thisObj.names.methodGreedy.tip);
 7319:   unwrapModeAdvanced
 7320:     .add("radiobutton", undefined, thisObj.names.methodRandom.name)
 7321:     .nsSetTip(thisObj.names.methodRandom.tip);
 7322:   unwrapModeAdvanced.children[0].value = thisObj.unwrapMode;
 7323:   unwrapModeAdvanced.children[1].value = !thisObj.unwrapMode;
 7324:   insideGroup2
 7325:     .add("group{margins:[5,10,0,0]}")
 7326:     .add("statictext", undefined, thisObj.names.animationEffects.name)
 7327:     .nsSetTip(thisObj.names.animationEffects.tip)
 7328:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7329:   var lineTwo = insideGroup2.add(
 7330:     "group{orientation:\'row\', margins:[5,10,0,0]}",
 7331:   );
 7332:   var effectsColOne = lineTwo.add(
 7333:     "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], margins:[0,0,0,0], spacing: 3}",
 7334:   );
 7335:   var animRotation = effectsColOne.add("checkbox", undefined, "Rotate X");
 7336:   var animRotationZ = effectsColOne.add("checkbox", undefined, "Rotate Z");
 7337:   var animOpacity = effectsColOne.add("checkbox", undefined, "Opacity");
 7338:   var effectsColTwo = lineTwo.add(
 7339:     "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], margins:[5,0,0,0], spacing: 3}",
 7340:   );
 7341:   var animScale = effectsColTwo.add("checkbox", undefined, "Scale");
 7342:   var animPosition = effectsColTwo.add("checkbox", undefined, "Position");
 7343:   var animTrimPath = effectsColTwo
 7344:     .add("checkbox", undefined, "Trim Path")
 7345:     .nsSetTip("Works only for Shape Layers");
 7346:   animRotation.value = thisObj.animRotation;
 7347:   animOpacity.value = thisObj.animOpacity;
 7348:   animScale.value = thisObj.animScale;
 7349:   animPosition.value = thisObj.animPosition;
 7350:   animRotationZ.value = thisObj.animRotationZ;
 7351:   animTrimPath.value = thisObj.animTrimPath;
 7352:   if (thisObj.kekPuk) {
 7353:     animTrimPath.enabled = false;
 7354:     animRotationZ.enabled = false;
 7355:   }
 7356:   var bttnsLine = insideGroup2.add(
 7357:     "group{orientation:\'row\', margins: [5,10,0,0], spacing: 0}",
 7358:   );
 7359:   var animateBttnGroup = bttnsLine.add(
 7360:     "group{orientation: \'stack\', margins:[0,0,0,0]}",
 7361:   );
 7362:   animateBttnGroup
 7363:     .add("group{preferredSize:[70,30]}")
 7364:     .nsSetBG([0.4, 0.4, 0.4, 1]);
 7365:   var animateBttn = animateBttnGroup.add("button", undefined, "ANIMATE");
 7366:   animateBttn.preferredSize = [66, 26];
 7367:   var updateBttnGroup = bttnsLine.add(
 7368:     "group{orientation: \'stack\', margins:[8,0,0,0]}",
 7369:   );
 7370:   updateBttnGroup
 7371:     .add("group{preferredSize:[70,30]}")
 7372:     .nsSetBG([0.4, 0.4, 0.4, 1]);
 7373:   var updateBttn = updateBttnGroup
 7374:     .add("button", undefined, thisObj.names.updateBttn.name)
 7375:     .nsSetTip(thisObj.names.updateBttn.tip);
 7376:   updateBttn.preferredSize = [66, 26];
 7377:   var settingsModeGroup = modesGroup.add(
 7378:     "group{orientation:\'column\', spacing: 0, alignChildren: [\'left\', \'top\'], margins: [0,0,0,0]}",
 7379:   );
 7380:   var setOneGroup = settingsModeGroup.add(
 7381:     "group{orientation:\'column\', margins:[5,0,0,0] alignChildren: [\'left\', \'top\'], spacing:0}",
 7382:   );
 7383:   var lowLine = setOneGroup.add("group{orientation: \'row\'}");
 7384:   var postRemove = lowLine
 7385:     .add("group{margins:[0,5,0,0]}")
 7386:     .add("checkbox", undefined, thisObj.names.postRemove.name)
 7387:     .nsSetTip(thisObj.names.postRemove.tip);
 7388:   var watSign = lowLine
 7389:     .add("group{orientation: \'row\', margins: [10,0,0,0]}")
 7390:     .add("statictext", undefined, "?");
 7391:   watSign.addEventListener("mouseup", function (k) {
 7392:     if (k.button == 0) {
 7393:       thisObj.buildWatUI(thisObj);
 7394:     }
 7395:   });
 7396:   var postCompose = setOneGroup
 7397:     .add("group{margins:[0,3,0,0]}")
 7398:     .add("checkbox", undefined, thisObj.names.postCompose.name)
 7399:     .nsSetTip(thisObj.names.postCompose.tip);
 7400:   var offsetOne = setOneGroup
 7401:     .add("group{margins:[0,10,0,0]}")
 7402:     .add("checkbox", undefined, thisObj.names.offsetOne.name)
 7403:     .nsSetTip(thisObj.names.offsetOne.tip);
 7404:   postRemove.value = thisObj.postRemove;
 7405:   postCompose.value = thisObj.postCompose;
 7406:   offsetOne.value = thisObj.offsetOne;
 7407:   settingsModeGroup
 7408:     .add("group{margins:[0,5,0,0]}")
 7409:     .add("panel{margins:[0,0,0,0], spacing:0}", [0, 0, 170, 1]);
 7410:   settingsModeGroup
 7411:     .add("group{margins:[5,10,0,0]}")
 7412:     .add("statictext", undefined, thisObj.names.colorSettings.name)
 7413:     .nsSetTip(thisObj.names.colorSettings.tip)
 7414:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7415:   var colorGroup = settingsModeGroup.add(
 7416:     "group{orientation:\'column\', margins:[5,10,0,0] alignChildren: [\'left\', \'top\'], spacing:2}",
 7417:   );
 7418:   colorGroup.add("radiobutton", undefined, "Original color");
 7419:   colorGroup.add("radiobutton", undefined, "Random color");
 7420:   colorGroup.add("radiobutton", undefined, "Shades of original color");
 7421:   for (var c = 0; c <= 2; c += 1) {
 7422:     if (thisObj.colorMode == c) {
 7423:       colorGroup.children[c].value = true;
 7424:     } else {
 7425:       colorGroup.children[c].value = false;
 7426:     }
 7427:   }
 7428:   var rangeGroup = settingsModeGroup.add(
 7429:     "group{orientation:\'column\', alignChildren:[\'center\', \'center\'], margins:[10,10,0,0], spacing:0}",
 7430:   );
 7431:   rangeEditRow = rangeGroup.add("group{orientation:\'row\'}");
 7432:   rangeEditRow.add("statictext", undefined, "Color Variation");
 7433:   var rangeEdit = rangeEditRow
 7434:     .add("group{margins:[30,0,0,0]}")
 7435:     .add("statictext", undefined, 50)
 7436:     .nsSetFG([0.8, 0.8, 0.8, 1]);
 7437:   rangeEdit.size = [30, 25];
 7438:   rangeEdit.text = String(thisObj.colorRangeValue) + "%";
 7439:   var rangeSlider = rangeGroup.add("slider{minvalue: 1, maxvalue:99}");
 7440:   rangeSlider.value = thisObj.colorRangeValue;
 7441:   rangeSlider.size = [150, 10];
 7442:   rangeSlider.onChanging = function () {
 7443:     rangeEdit.text = String(parseInt(this.value)) + "%";
 7444:   };
 7445:   var recolorBttnGroup = settingsModeGroup.add(
 7446:     "group{orientation: \'stack\', margins:[10,10,0,0]}",
 7447:   );
 7448:   recolorBttnGroup
 7449:     .add("group{preferredSize:[150,30]}")
 7450:     .nsSetBG([0.4, 0.4, 0.4, 1]);
 7451:   var recolorBttn = recolorBttnGroup
 7452:     .add("button", undefined, thisObj.names.recolorBttn.name)
 7453:     .nsSetTip(thisObj.names.recolorBttn.tip);
 7454:   recolorBttn.preferredSize = [146, 26];
 7455:   if (thisObj.kekPuk) {
 7456:     recolorBttn.enabled = false;
 7457:     rangeSlider.enabled = false;
 7458:   }
 7459:   pointsEditBasic.onChanging = pointsEditAdvanced.onChanging = function () {
 7460:     if (this.text != this.text.match(/(\d*)/)[0]) {
 7461:       this.text = this.text.match(/(\d*)/)[0];
 7462:     }
 7463:     if (thisObj.kekPuk) {
 7464:       if (Number(this.text) > 20) {
 7465:         this.text = 20;
 7466:         alert("Trial version is limited to 20 points per object");
 7467:       }
 7468:     }
 7469:   };
 7470:   oneClickUnwrap.onClick = function () {
 7471:     app.beginUndoGroup("Slice and unwrap");
 7472:     thisObj.meshGen(
 7473:       Number(pointsEditBasic.text),
 7474:       sliceSelectBasic.selection.index,
 7475:       createModeLineBasic.children[0].value,
 7476:       true,
 7477:       Boolean(postRemove.value),
 7478:       Boolean(offsetOne.value),
 7479:       false,
 7480:       thisObj.colorMode,
 7481:       false,
 7482:     );
 7483:     thisObj.unwrap(thisObj, unwrapModeBasic.children[1].value, false, false, [
 7484:       true,
 7485:       true,
 7486:       false,
 7487:       false,
 7488:     ]);
 7489:     var activeComp = app.project.activeItem;
 7490:     if (activeComp && activeComp instanceof CompItem) {
 7491:       thisObj.createControls(
 7492:         thisObj,
 7493:         activeComp,
 7494:         true,
 7495:         true,
 7496:         false,
 7497:         false,
 7498:         false,
 7499:         false,
 7500:       );
 7501:     }
 7502:     app.endUndoGroup();
 7503:     setPrefs();
 7504:   };
 7505:   recolorBttn.onClick = function () {
 7506:     setPrefs();
 7507:     app.beginUndoGroup("Recoloring Shapes");
 7508:     thisObj.recolor(null, thisObj.colorMode, thisObj.colorRangeValue);
 7509:     app.endUndoGroup();
 7510:   };
 7511:   sliceBttn.onClick = function () {
 7512:     app.beginUndoGroup("Creating Mesh");
 7513:     thisObj.meshGen(
 7514:       Number(pointsEditAdvanced.text),
 7515:       sliceSelectAdvanced.selection.index,
 7516:       createModeLineAdvanced.children[0].value,
 7517:       Boolean(postExplode.value),
 7518:       Boolean(postRemove.value),
 7519:       Boolean(offsetOne.value),
 7520:       false,
 7521:       thisObj.colorMode,
 7522:       thisObj.colorRangeValue,
 7523:       thisObj.postCompose,
 7524:     );
 7525:     app.endUndoGroup();
 7526:     setPrefs();
 7527:   };
 7528:   animateBttn.onClick = function () {
 7529:     app.beginUndoGroup("Animating Slices");
 7530:     thisObj.unwrap(
 7531:       thisObj,
 7532:       unwrapModeAdvanced.children[1].value,
 7533:       false,
 7534:       directionColumn.children[1].value,
 7535:       [
 7536:         animRotation.value,
 7537:         animOpacity.value,
 7538:         animScale.value,
 7539:         animPosition.value,
 7540:         animRotationZ.value,
 7541:         animTrimPath.value,
 7542:       ],
 7543:     );
 7544:     if (origami.activeGraph.vertices.length > 0) {
 7545:       var activeComp = app.project.activeItem;
 7546:       if (activeComp && activeComp instanceof CompItem) {
 7547:         thisObj.createControls(
 7548:           thisObj,
 7549:           activeComp,
 7550:           animRotation.value,
 7551:           animOpacity.value,
 7552:           animScale.value,
 7553:           animPosition.value,
 7554:           animRotationZ.value,
 7555:           animTrimPath.value,
 7556:           directionColumn.children[1].value,
 7557:           false,
 7558:           false,
 7559:         );
 7560:       }
 7561:       setPrefs();
 7562:     } else {
 7563:       alert("Create a mesh first!");
 7564:     }
 7565:     app.endUndoGroup();
 7566:   };
 7567:   updateBttn.onClick = function () {
 7568:     var tmp = app.project.activeItem;
 7569:     if (tmp && tmp instanceof CompItem) {
 7570:       var activeComp = tmp;
 7571:     }
 7572:     if (thisObj.activeGraph && thisObj.activeGraph.comp == activeComp) {
 7573:       if (origami.activeGraph.vertices.length > 0) {
 7574:         app.beginUndoGroup("Updating expressions");
 7575:         if (directionColumn.children[0].value) {
 7576:           if (thisObj.activeGraph.bondsReversed) {
 7577:             thisObj.activeGraph.reverseParenting();
 7578:           }
 7579:         } else {
 7580:           if (!thisObj.activeGraph.bondsReversed) {
 7581:             thisObj.activeGraph.reverseParenting();
 7582:           }
 7583:         }
 7584:         thisObj.applyExpressions(thisObj.activeGraph, [
 7585:           animRotation.value,
 7586:           animOpacity.value,
 7587:           animScale.value,
 7588:           animPosition.value,
 7589:           animRotationZ.value,
 7590:           animTrimPath.value,
 7591:         ]);
 7592:         thisObj.relinkMainNull(activeComp, false);
 7593:         thisObj.createControls(
 7594:           thisObj,
 7595:           activeComp,
 7596:           animRotation.value,
 7597:           animOpacity.value,
 7598:           animScale.value,
 7599:           animPosition.value,
 7600:           animRotationZ.value,
 7601:           animTrimPath.value,
 7602:           directionColumn.children[1].value,
 7603:           false,
 7604:           false,
 7605:         );
 7606:         thisObj.relinkMainNull(activeComp, true);
 7607:         app.endUndoGroup();
 7608:         setPrefs();
 7609:       }
 7610:     } else {
 7611:       thisObj.activeGraph = thisObj.buildGraph(activeComp, true);
 7612:       if (thisObj.activeGraph && thisObj.activeGraph.vertices.length > 0) {
 7613:         app.beginUndoGroup("Updating expressions");
 7614:         if (directionColumn.children[0].value) {
 7615:           if (thisObj.activeGraph.bondsReversed) {
 7616:             thisObj.activeGraph.reverseParenting();
 7617:           }
 7618:         } else {
 7619:           if (!thisObj.activeGraph.bondsReversed) {
 7620:             thisObj.activeGraph.reverseParenting();
 7621:           }
 7622:         }
 7623:         thisObj.applyExpressions(thisObj.activeGraph, [
 7624:           animRotation.value,
 7625:           animOpacity.value,
 7626:           animScale.value,
 7627:           animPosition.value,
 7628:         ]);
 7629:         thisObj.relinkMainNull(activeComp, false);
 7630:         thisObj.createControls(
 7631:           thisObj,
 7632:           activeComp,
 7633:           animRotation.value,
 7634:           animOpacity.value,
 7635:           animScale.value,
 7636:           animPosition.value,
 7637:           animRotationZ.value,
 7638:           animTrimPath.value,
 7639:           directionColumn.children[1].value,
 7640:           false,
 7641:           false,
 7642:         );
 7643:         thisObj.relinkMainNull(activeComp, true);
 7644:         app.endUndoGroup();
 7645:         setPrefs();
 7646:       } else {
 7647:         alert("Animate mesh first!");
 7648:       }
 7649:     }
 7650:   };
 7651:   setMode();
 7652:   setAdvancedStep();
 7653:   if (thisObj.ptGUI instanceof Window) {
 7654:     thisObj.ptGUI.center();
 7655:     thisObj.ptGUI.show();
 7656:   } else {
 7657:     thisObj.ptGUI.layout.layout(true);
 7658:   }
 7659: };
 7660: origami.iconsBinaries = [
 7661:   __BLOB__BLOB_000452__,
 7662:   __BLOB__BLOB_000453__,
 7663:   __BLOB__BLOB_000454__,
 7664:   __BLOB__BLOB_000455__,
 7665: ];
 7666: origami.buildWatUI = function (thisObj) {
 7667:   thisObj.oriWAT = new Window(
 7668:     "palette",
 7669:     "Origami v" + thisObj.version,
 7670:     undefined,
 7671:     { resizeable: false },
 7672:   );
 7673:   thisObj.oriWAT.alignChildren = ["left", "top"];
 7674:   var logoFile = [__BLOB__BLOB_000456__];
 7675:   var fldr = new Folder(Folder.userData.fullName + "/Aescripts/origami/");
 7676:   fldr.create();
 7677:   iconFile = new File(fldr.fullName + "/origamiIconFileWat.png");
 7678:   iconFile.encoding = "BINARY";
 7679:   iconFile.open("w");
 7680:   iconFile.write(logoFile[0]);
 7681:   iconFile.close();
 7682:   origami.link1 = origami.prefix + "http://aescripts.com/origami/";
 7683:   origami.link2 = origami.prefix + "http://twitter.com/extrabitesoft/";
 7684:   var mainGroup = thisObj.oriWAT.add(
 7685:     "group{orientation:\'column\', alignChildren: [\'left\', \'top\'], spacing: 0}",
 7686:   );
 7687:   mainGroup.add("image", undefined, iconFile);
 7688:   var howToGroup = mainGroup.add(
 7689:     "group{orientation:\'column\',alignChildren:[\'left\', \'top\'], margins:[0,10,0,0], spacing: 5}",
 7690:   );
 7691:   howToGroup.add(
 7692:     "statictext",
 7693:     undefined,
 7694:     "Origami is the mesh generaiton and animation tool for After Effects. It works with Photos, Videos, Masks and Shape Layers as a source.\n\nFor more information and tutorials, refer to the",
 7695:     { multiline: true },
 7696:   );
 7697:   howToGroup
 7698:     .add("statictext", undefined, "Product page on aescripts")
 7699:     .nsSetFG([67, 170, 207, 255] / 255)
 7700:     .addEventListener("mouseup", function (k) {
 7701:       if (k.button == 0) {
 7702:         system.callSystem(thisObj.link1);
 7703:       }
 7704:     });
 7705:   howToGroup
 7706:     .add("group{margins:[0,10,0,0]}")
 7707:     .add(
 7708:       "statictext",
 7709:       undefined,
 7710:       "For any questions or lightning fast support:",
 7711:       { multiline: true },
 7712:     );
 7713:   howToGroup
 7714:     .add("statictext", undefined, "Hit us up on Twitter")
 7715:     .nsSetFG([67, 170, 207, 255] / 255)
 7716:     .addEventListener("mouseup", function (k) {
 7717:       if (k.button == 0) {
 7718:         system.callSystem(thisObj.link2);
 7719:       }
 7720:     });
 7721:   if (thisObj.kekPuk === false) {
 7722:     howToGroup.add("statictext", undefined, "");
 7723:     howToGroup
 7724:       .add("statictext", undefined, origami.jsx_Registered, { multiline: true })
 7725:       .nsSetFG([0.4, 0.4, 0.4, 1]);
 7726:   } else {
 7727:     howToGroup
 7728:       .add(
 7729:         "statictext",
 7730:         undefined,
 7731:         "\nYOU ARE IN TRIAL MODE\n-Points number is limited to 20\n-You can\'t recolor fragments\n-Rotation Z and Trim Path are disabled",
 7732:         { multiline: true },
 7733:       )
 7734:       .nsSetFG([0.4, 0.4, 0.4, 1]);
 7735:   }
 7736:   if (thisObj.oriWAT instanceof Window) {
 7737:     thisObj.oriWAT.center();
 7738:     thisObj.oriWAT.show();
 7739:   } else {
 7740:     thisObj.oriWAT.layout.layout(true);
 7741:   }
 7742: };
 7743: origami.expressionControls = {
 7744:   control0: {
 7745:     defaultValue: 3,
 7746:     expression: "",
 7747:     keys: {},
 7748:     name: origami.names.delayControl,
 7749:     pseudoString: [
 7750:       "Slider",
 7751:       origami.names.delayControl,
 7752:       false,
 7753:       2,
 7754:       -100,
 7755:       -100,
 7756:       3,
 7757:       100,
 7758:       100,
 7759:       1,
 7760:       true,
 7761:     ],
 7762:     type: "ADBE Slider Control",
 7763:   },
 7764:   control1: {
 7765:     defaultValue: undefined,
 7766:     expression: "",
 7767:     keys: {
 7768:       inAnimation: {
 7769:         1: { easing: null, time: 0, value: 130 },
 7770:         2: { easing: "easein", time: 10, value: 0 },
 7771:       },
 7772:       outAnimation: {
 7773:         1: { easing: "easeout", time: 0, value: 0 },
 7774:         2: { easing: "easein", time: 10, value: 140 },
 7775:       },
 7776:     },
 7777:     name: origami.names.xRotControl,
 7778:     pseudoString: ["Angle", origami.names.xRotControl, false, 2, 0],
 7779:     type: "ADBE Angle Control",
 7780:   },
 7781:   control2: {
 7782:     defaultValue: undefined,
 7783:     expression: "",
 7784:     keys: {
 7785:       inAnimation: {
 7786:         1: { easing: null, time: 0, value: 0 },
 7787:         2: { easing: "easein", time: 3, value: 100 },
 7788:       },
 7789:       outAnimation: {
 7790:         1: { easing: "easeout", time: 8, value: 100 },
 7791:         2: { easing: null, time: 10, value: 0 },
 7792:       },
 7793:     },
 7794:     name: origami.names.opacityControl,
 7795:     pseudoString: [
 7796:       "Slider",
 7797:       origami.names.opacityControl,
 7798:       false,
 7799:       2,
 7800:       0,
 7801:       0,
 7802:       0,
 7803:       100,
 7804:       100,
 7805:       1,
 7806:       true,
 7807:     ],
 7808:     type: "ADBE Slider Control",
 7809:   },
 7810:   control3: {
 7811:     defaultValue: undefined,
 7812:     expression: "",
 7813:     keys: {
 7814:       inAnimation: {
 7815:         1: { easing: null, time: 0, value: 0 },
 7816:         2: { easing: "easein", time: 8, value: 100 },
 7817:       },
 7818:       outAnimation: {
 7819:         1: { easing: "easeout", time: 0, value: 100 },
 7820:         2: { easing: null, time: 10, value: 0 },
 7821:       },
 7822:     },
 7823:     name: origami.names.scaleControl,
 7824:     pseudoString: [
 7825:       "Slider",
 7826:       origami.names.scaleControl,
 7827:       false,
 7828:       2,
 7829:       -200,
 7830:       -200,
 7831:       100,
 7832:       200,
 7833:       200,
 7834:       1,
 7835:       true,
 7836:     ],
 7837:     type: "ADBE Slider Control",
 7838:   },
 7839:   control4: {
 7840:     defaultValue: undefined,
 7841:     expression: "",
 7842:     keys: {
 7843:       inAnimation: {
 7844:         1: { easing: null, time: 0, value: [200, 200] },
 7845:         2: { easing: "easein", time: 10, value: [0, 0] },
 7846:       },
 7847:       outAnimation: {
 7848:         1: { easing: "easeout", time: 0, value: [0, 0] },
 7849:         2: { easing: null, time: 10, value: [200, 200] },
 7850:       },
 7851:     },
 7852:     name: origami.names.positionControl,
 7853:     pseudoString: ["Point", origami.names.positionControl, false, 2, 0, 0],
 7854:     type: "ADBE Point Control",
 7855:   },
 7856:   control5: {
 7857:     defaultValue: undefined,
 7858:     expression: "",
 7859:     keys: {
 7860:       inAnimation: {
 7861:         1: { easing: null, time: 0, value: 50 },
 7862:         2: { easing: "easein", time: 10, value: 0 },
 7863:       },
 7864:       outAnimation: {
 7865:         1: { easing: "easeout", time: 0, value: 0 },
 7866:         2: { easing: "easein", time: 10, value: 50 },
 7867:       },
 7868:     },
 7869:     name: origami.names.zRotControl,
 7870:     pseudoString: ["Angle", origami.names.zRotControl, false, 2, 0],
 7871:     type: "ADBE Angle Control",
 7872:   },
 7873:   control6: {
 7874:     defaultValue: undefined,
 7875:     expression: "",
 7876:     keys: {
 7877:       inAnimation: {
 7878:         1: { easing: null, time: 0, value: 0 },
 7879:         2: { easing: "easein", time: 8, value: 100 },
 7880:       },
 7881:       outAnimation: {
 7882:         1: { easing: "easeout", time: 0, value: 100 },
 7883:         2: { easing: null, time: 10, value: 0 },
 7884:       },
 7885:     },
 7886:     name: origami.names.trimPathControl,
 7887:     pseudoString: [
 7888:       "Slider",
 7889:       origami.names.trimPathControl,
 7890:       false,
 7891:       2,
 7892:       0,
 7893:       0,
 7894:       0,
 7895:       100,
 7896:       100,
 7897:       1,
 7898:       true,
 7899:     ],
 7900:     type: "ADBE Slider Control",
 7901:   },
 7902: };
 7903: origami.createControls = function (
 7904:   thisObj,
 7905:   _comp,
 7906:   rotation,
 7907:   opacity,
 7908:   scale,
 7909:   position,
 7910:   rotZ,
 7911:   trimPath,
 7912:   out,
 7913:   leaveIt,
 7914:   update,
 7915: ) {
 7916:   function setKeysNEW(effect, _controls, inout) {
 7917:     var easeIn = new KeyframeEase(0.5, 50);
 7918:     var easeOut = new KeyframeEase(0.75, 85);
 7919:     var newProp = effect;
 7920:     if (_controls.defaultValue != undefined) {
 7921:       newProp.setValue(_controls.defaultValue);
 7922:     }
 7923:     newProp.expression = _controls.expression;
 7924:     var newKeys = _controls.keys[inout];
 7925:     if (newKeys) {
 7926:       for (var key in newKeys) {
 7927:         if (!(newKeys[key] instanceof Function)) {
 7928:           var newKeyIndex = newProp.addKey(
 7929:             Number(newKeys[key].time) * _comp.frameDuration,
 7930:           );
 7931:           newProp.setValueAtKey(newKeyIndex, newKeys[key].value);
 7932:           if (newKeys[key].easing) {
 7933:             newProp.setTemporalEaseAtKey(newKeyIndex, [easeIn], [easeOut]);
 7934:             if (newKeys[key].easing == "easein") {
 7935:               newProp.setInterpolationTypeAtKey(
 7936:                 newKeyIndex,
 7937:                 KeyframeInterpolationType.BEZIER,
 7938:                 KeyframeInterpolationType.LINEAR,
 7939:               );
 7940:             } else if (newKeys[key].easing == "easeout") {
 7941:               newProp.setInterpolationTypeAtKey(
 7942:                 newKeyIndex,
 7943:                 KeyframeInterpolationType.LINEAR,
 7944:                 KeyframeInterpolationType.BEZIER,
 7945:               );
 7946:             } else {
 7947:               if (newKeys[key].easing == "easyease") {
 7948:                 newProp.setInterpolationTypeAtKey(
 7949:                   newKeyIndex,
 7950:                   KeyframeInterpolationType.BEZIER,
 7951:                   KeyframeInterpolationType.BEZIER,
 7952:                 );
 7953:               }
 7954:             }
 7955:           }
 7956:         }
 7957:       }
 7958:     }
 7959:   }
 7960:   var inout = "inAnimation";
 7961:   if (out) {
 7962:     inout = "outAnimation";
 7963:   }
 7964:   var controlLayer = _comp.layer(origami.names.controlLayer);
 7965:   if (!controlLayer) {
 7966:     controlLayer = _comp.layers.addNull();
 7967:     controlLayer.name = origami.names.controlLayer;
 7968:     controlLayer
 7969:       .property("ADBE Transform Group")
 7970:       .property("ADBE Anchor Point")
 7971:       .setValue([50, 50]);
 7972:     controlLayer.moveToBeginning();
 7973:     controlLayer.threeDLayer = true;
 7974:     controlLayer.label = 2;
 7975:   } else {
 7976:     controlLayer.moveToBeginning();
 7977:   }
 7978:   var controls = [];
 7979:   var controlsEnabled = [
 7980:     true,
 7981:     rotation,
 7982:     opacity,
 7983:     scale,
 7984:     position,
 7985:     rotZ,
 7986:     trimPath,
 7987:   ];
 7988:   for (var key in origami.expressionControls) {
 7989:     if (!(origami.expressionControls[key] instanceof Function)) {
 7990:       controls.push(origami.expressionControls[key]);
 7991:     }
 7992:   }
 7993:   var tmp = controlLayer.findEffectByName(origami.names.controlName);
 7994:   if (tmp) {
 7995:     tmp.remove();
 7996:   }
 7997:   for (var l = 1; l <= _comp.layers.length; l += 1) {
 7998:     _comp.layers[l].selected = false;
 7999:   }
 8000:   controlLayer.selected = true;
 8001:   customPreset = [];
 8002:   customPreset.push(["Effect", origami.names.controlName]);
 8003:   var effectMatchName = "OrigamiFX_";
 8004:   for (var c = 0; c < controls.length; c += 1) {
 8005:     if (controlsEnabled[c]) {
 8006:       customPreset.push(controls[c].pseudoString);
 8007:     }
 8008:   }
 8009:   var preset = origami.Generator_FFX(customPreset, effectMatchName);
 8010:   var presetString = preset.str;
 8011:   var presetString = preset.str;
 8012:   effectMatchName = preset.mn;
 8013:   var presetFile = new File(origami.presetString);
 8014:   if (presetFile.exists) {
 8015:     presetFile.remove();
 8016:   }
 8017:   if (!presetFile.exists) {
 8018:     presetFile.encoding = "binary";
 8019:     presetFile.open("w");
 8020:     presetFile.write(decodeURIComponent(presetString));
 8021:     presetFile.close();
 8022:   }
 8023:   controlLayer.applyPreset(presetFile);
 8024:   for (var c = 0; c < controls.length; c += 1) {
 8025:     if (controlsEnabled[c]) {
 8026:       effect = controlLayer
 8027:         .property("ADBE Effect Parade")
 8028:         .property(effectMatchName)
 8029:         .property(controls[c].name);
 8030:       setKeysNEW(effect, controls[c], inout);
 8031:     }
 8032:   }
 8033:   thisObj.activeGraph.parentStartVertices(controlLayer, update);
 8034: };
 8035: origami.posExpression = {};
 8036: origami.expressions = {
 8037:   opacity:
 8038:     'function getParentDepth(out){if(out === false) l = thisLayer.name.split("\t")[1];else l = thisLayer.name.split("\t")[2];if(l!=undefined) return Number(l);else return 0;}try{if(toCompVec([0, 0, 1])[2] > 0){var control = thisComp.layer("' +
 8039:     origami.names.controlLayer +
 8040:     '"' +
 8041:     ");var d = getParentDepth(false);var o = control.effect(" +
 8042:     '"' +
 8043:     origami.names.controlName +
 8044:     '"' +
 8045:     ")(" +
 8046:     '"' +
 8047:     origami.names.opacityControl +
 8048:     '"' +
 8049:     ");t1 = time;n = 0;sign = -1;if (control.marker.numKeys > 0){n = control.marker.nearestKey(time).index; if (control.marker.key(n).time > time) n--;} if (n > 0){t = time-control.marker.key(n).time;if(n%2==1){lastKeyTime = o.key(o.numKeys).time;t1 = lastKeyTime-t;d = getParentDepth(true);sign = 1;}else{t1 = t + o.key(1).time;}}o.valueAtTime(t1 + sign*d*control.effect(" +
 8050:     '"' +
 8051:     origami.names.controlName +
 8052:     '"' +
 8053:     ")(" +
 8054:     '"' +
 8055:     origami.names.delayControl +
 8056:     '"' +
 8057:     ")*thisComp.frameDuration);}else 0;}catch(err){0}",
 8058:   position:
 8059:     'function getParentDepth(e){if(e===!1)var t=thisLayer.name.split("\t")[1];else var t=thisLayer.name.split("\t")[2];return void 0!=t?Number(t):0}try{var control=thisComp.layer("' +
 8060:     origami.names.controlLayer +
 8061:     '"' +
 8062:     "),d=getParentDepth(!1),r=control.effect(" +
 8063:     '"' +
 8064:     origami.names.controlName +
 8065:     '"' +
 8066:     ")(" +
 8067:     '"' +
 8068:     origami.names.positionControl +
 8069:     '"' +
 8070:     "),sign=-1,n=0,t1=time;if(control.marker.numKeys>0){n=control.marker.nearestKey(time).index;control.marker.key(n).time>time&&n--}if(n>0){t=time-control.marker.key(n).time;if(n%2==1){lastKeyTime=r.key(r.numKeys).time;t1=lastKeyTime-t;d=getParentDepth(!0);sign=1}else t1=t+r.key(1).time}value+r.valueAtTime(t1+sign*d*control.effect(" +
 8071:     '"' +
 8072:     origami.names.controlName +
 8073:     '"' +
 8074:     ")(" +
 8075:     '"' +
 8076:     origami.names.delayControl +
 8077:     '"' +
 8078:     ")*thisComp.frameDuration)}catch(err){value}",
 8079:   rotX:
 8080:     'function getParentDepth(e){if(e===!1)var t=thisLayer.name.split("\t")[1];else var t=thisLayer.name.split("\t")[2];return void 0!=t?Number(t):0}try{var control=thisComp.layer("' +
 8081:     origami.names.controlLayer +
 8082:     '"' +
 8083:     "),d=getParentDepth(!1),r=control.effect(" +
 8084:     '"' +
 8085:     origami.names.controlName +
 8086:     '"' +
 8087:     ")(" +
 8088:     '"' +
 8089:     origami.names.xRotControl +
 8090:     '"' +
 8091:     ");t1=time;n=0;sign=-1;if(control.marker.numKeys>0){n=control.marker.nearestKey(time).index;control.marker.key(n).time>time&&n--}if(n>0){t=time-control.marker.key(n).time;if(n%2==1){lastKeyTime=r.key(r.numKeys).time;t1=lastKeyTime-t;d=getParentDepth(!0);sign=1}else t1=t+r.key(1).time}r.valueAtTime(t1+sign*d*control.effect(" +
 8092:     '"' +
 8093:     origami.names.controlName +
 8094:     '"' +
 8095:     ")(" +
 8096:     '"' +
 8097:     origami.names.delayControl +
 8098:     '"' +
 8099:     ")*thisComp.frameDuration)}catch(err){value}",
 8100:   rotZ:
 8101:     'function getParentDepth(e){if(e===!1)var t=thisLayer.name.split("\t")[1];else var t=thisLayer.name.split("\t")[2];return void 0!=t?Number(t):0}try{var control=thisComp.layer("' +
 8102:     origami.names.controlLayer +
 8103:     '"' +
 8104:     "),d=getParentDepth(!1),r=control.effect(" +
 8105:     '"' +
 8106:     origami.names.controlName +
 8107:     '"' +
 8108:     ")(" +
 8109:     '"' +
 8110:     origami.names.zRotControl +
 8111:     '"' +
 8112:     ");t1=time;n=0;sign=-1;if(control.marker.numKeys>0){n=control.marker.nearestKey(time).index;control.marker.key(n).time>time&&n--}if(n>0){t=time-control.marker.key(n).time;if(n%2==1){lastKeyTime=r.key(r.numKeys).time;t1=lastKeyTime-t;d=getParentDepth(!0);sign=1}else t1=t+r.key(1).time}value-r.valueAtTime(t1+sign*d*control.effect(" +
 8113:     '"' +
 8114:     origami.names.controlName +
 8115:     '"' +
 8116:     ")(" +
 8117:     '"' +
 8118:     origami.names.delayControl +
 8119:     '"' +
 8120:     ")*thisComp.frameDuration)}catch(err){value}",
 8121:   scale:
 8122:     'function getParentDepth(e){if(e===!1)var t=thisLayer.name.split("\t")[1];else var t=thisLayer.name.split("\t")[2];return void 0!=t?Number(t):0}try{var control=thisComp.layer("' +
 8123:     origami.names.controlLayer +
 8124:     '"' +
 8125:     "),d=getParentDepth(!1),r=control.effect(" +
 8126:     '"' +
 8127:     origami.names.controlName +
 8128:     '"' +
 8129:     ")(" +
 8130:     '"' +
 8131:     origami.names.scaleControl +
 8132:     '"' +
 8133:     "),sign=-1,n=0,t1=time;if(control.marker.numKeys>0){n=control.marker.nearestKey(time).index;control.marker.key(n).time>time&&n--}if(n>0){t=time-control.marker.key(n).time;if(n%2==1){lastKeyTime=r.key(r.numKeys).time;t1=lastKeyTime-t;d=getParentDepth(!0);sign=1}else t1=t+r.key(1).time}r.valueAtTime(t1+sign*d*control.effect(" +
 8134:     '"' +
 8135:     origami.names.controlName +
 8136:     '"' +
 8137:     ")(" +
 8138:     '"' +
 8139:     origami.names.delayControl +
 8140:     '"' +
 8141:     ')*thisComp.frameDuration)*[thisLayer("ADBE Transform Group")("ADBE Scale")[0],thisLayer("ADBE Transform Group")("ADBE Scale")[1]]/100}catch(err){value}',
 8142:   trimPath:
 8143:     'function getParentDepth(e){if(e===!1)var t=thisLayer.name.split("\t")[1];else var t=thisLayer.name.split("\t")[2];return void 0!=t?Number(t):0}try{var control=thisComp.layer("' +
 8144:     origami.names.controlLayer +
 8145:     '"' +
 8146:     "),d=getParentDepth(!1),r=control.effect(" +
 8147:     '"' +
 8148:     origami.names.controlName +
 8149:     '"' +
 8150:     ")(" +
 8151:     '"' +
 8152:     origami.names.trimPathControl +
 8153:     '"' +
 8154:     ");t1=time;n=0;sign=-1;if(control.marker.numKeys>0){n=control.marker.nearestKey(time).index;control.marker.key(n).time>time&&n--}if(n>0){t=time-control.marker.key(n).time;if(n%2==1){lastKeyTime=r.key(r.numKeys).time;t1=lastKeyTime-t;d=getParentDepth(!0);sign=1}else t1=t+r.key(1).time}r.valueAtTime(time+sign*d*control.effect(" +
 8155:     '"' +
 8156:     origami.names.controlName +
 8157:     '"' +
 8158:     ")(" +
 8159:     '"' +
 8160:     origami.names.delayControl +
 8161:     '"' +
 8162:     ")*thisComp.frameDuration)}catch(err){value}",
 8163: };
 8164: origami.Generator_FFX = function (new_arr0, myName) {
 8165:   function parTparn(ID, new_arr0) {
 8166:     var pt = "parTparn%00%00%00%04" + HexEncodeURI(new_arr0.length, 4);
 8167:     var data = "";
 8168:     for (var i = 0; i < new_arr0.length; i += 1) {
 8169:       temp = i;
 8170:       while (temp.length < 4) {
 8171:         temp = "0" + temp;
 8172:       }
 8173:       data =
 8174:         data +
 8175:         "tdmn%00%00%00(" +
 8176:         FixedLength(ID + "-" + temp, 40) +
 8177:         pard(new_arr0[i]);
 8178:     }
 8179:     return pt + data;
 8180:   }
 8181:   function tdgptdsb(ID, new_arr0, lName) {
 8182:     var td = "tdgptdsb%00%00%00%04%00%00%00%01tdsn" + lName;
 8183:     var tdEnd = "tdmn%00%00%00(ADBE%20Group%20End" + Zeros(26);
 8184:     var data = "";
 8185:     for (var i = 0; i < new_arr0.length; i += 1) {
 8186:       temp = i;
 8187:       while (temp.length < 4) {
 8188:         temp = "0" + temp;
 8189:       }
 8190:       data =
 8191:         data +
 8192:         "tdmn%00%00%00(" +
 8193:         FixedLength(ID + "-" + temp, 40) +
 8194:         tdgp(new_arr0[i]);
 8195:     }
 8196:     return td + data + tdEnd;
 8197:   }
 8198:   function tdgp(arr1) {
 8199:     var temp = "%00%00%5D%C2%A8" + Zeros(108) + "cdat";
 8200:     var lName =
 8201:       arr1[0] === "GroupEnd" ? "%00%00%00%01%00%00" : LengthName(arr1[1]);
 8202:     var tdbstdsb =
 8203:       "tdbstdsb%00%00%00%04%00%00%00%01tdsn" +
 8204:       lName +
 8205:       "tdb4%00%00%00%7C%C2%BD%C2%99%00%01%00%01%00%00%00%01%00";
 8206:     var ret = "";
 8207:     var value = "";
 8208:     if (arr1[0] == "Checkbox" || arr1[0] == "Angle" || arr1[0] == "Popup") {
 8209:       ret =
 8210:         tdbstdsb +
 8211:         ExtTimer(arr1[3]) +
 8212:         temp +
 8213:         "%00%00%00(" +
 8214:         FixedLength(toDouble(arr1[4]));
 8215:     } else if (arr1[0] == "Color") {
 8216:       for (var i = 0; i < 6; i = i + 2) {
 8217:         value = value + toDouble(parseInt(arr1[4].substr(i, 2), 16));
 8218:       }
 8219:       tdbstdsb =
 8220:         "tdbstdsb%00%00%00%04%00%00%00%01tdsn" +
 8221:         lName +
 8222:         "tdb4%00%00%00%7C%C2%BD%C2%99%00%04%00%07%00%00%00%01%00";
 8223:       ret =
 8224:         tdbstdsb +
 8225:         ExtTimer(arr1[3]) +
 8226:         temp +
 8227:         "%00%00%00%60" +
 8228:         FixedLength("@o%C3%A0" + Zeros(5) + value, 96);
 8229:     } else if (arr1[0] == "Point") {
 8230:       tdbstdsb =
 8231:         "tdbstdsb%00%00%00%04%00%00%00%01tdsn" +
 8232:         lName +
 8233:         "tdb4%00%00%00%7C%C2%BD%C2%99%00%02%00%0F%00%00%00%01%00";
 8234:       ret = tdbstdsb + ExtTimer(arr1[3]) + temp + "%00%00%00(" + Zeros(40);
 8235:     } else if (arr1[0] == "3DPoint") {
 8236:       tdbstdsb =
 8237:         "tdbstdsb%00%00%00%04%00%00%00%01tdsn" +
 8238:         lName +
 8239:         "tdb4%00%00%00%7C%C2%BD%C2%99%00%03%00%0F%00%00%00%01%00";
 8240:       ret = tdbstdsb + ExtTimer(arr1[3]) + temp + "%00%00%00H" + Zeros(72);
 8241:     } else if (arr1[0] == "Slider") {
 8242:       ret =
 8243:         tdbstdsb +
 8244:         ExtTimer(arr1[3]) +
 8245:         temp +
 8246:         "%00%00%00(" +
 8247:         FixedLength(toDouble(arr1[6])) +
 8248:         "tdum" +
 8249:         "%00%00%00%08" +
 8250:         toDouble(arr1[5]) +
 8251:         "tduM" +
 8252:         "%00%00%00%08" +
 8253:         toDouble(arr1[7]);
 8254:     } else if (arr1[0] == "Layer") {
 8255:       value = "%00";
 8256:       if (arr1[3]) {
 8257:         value = "%0E";
 8258:       }
 8259:       ret =
 8260:         tdbstdsb +
 8261:         "%00" +
 8262:         temp +
 8263:         "%00%00%00(" +
 8264:         Zeros(40) +
 8265:         "tdpi%00%00%00%04%00%00%00" +
 8266:         value;
 8267:     } else if (
 8268:       arr1[0] == "Group" ||
 8269:       arr1[0] == "GroupEnd" ||
 8270:       arr1[0] == "Button"
 8271:     ) {
 8272:       ret = tdbstdsb + "%04" + temp + "%00%00%00(" + Zeros(40);
 8273:     } else if (arr1[0] == "Effect") {
 8274:       tdbstdsb =
 8275:         "tdbstdsb%00%00%00%04%00%00%00%03tdsn" +
 8276:         lName +
 8277:         "tdb4%00%00%00%7C%C2%BD%C2%99%00%01%00%01%00%00%00%01%00";
 8278:       ret =
 8279:         tdbstdsb +
 8280:         "%04" +
 8281:         temp +
 8282:         "%00%00%00(" +
 8283:         Zeros(40) +
 8284:         "tdpi%00%00%00%04%00%00%00%0E";
 8285:     } else {
 8286:       alert("\nError \n\n id03\n", "\nError \n\n id03\n");
 8287:     }
 8288:     return "LIST" + CountLengthTo_hex(ret);
 8289:   }
 8290:   function pard(arr1) {
 8291:     var pr = "pard%00%00%00%C2%94";
 8292:     var ret = "";
 8293:     var temp = "";
 8294:     var value = "";
 8295:     if (arr1[0] == "Checkbox") {
 8296:       value = "%00";
 8297:       if (arr1[4]) {
 8298:         value = "%01";
 8299:       }
 8300:       ret =
 8301:         Zeros(7) +
 8302:         Locked(arr1[2]) +
 8303:         Zeros(7) +
 8304:         "%04" +
 8305:         FixedName(arr1[1]) +
 8306:         Zeros(5) +
 8307:         Timer(arr1[3]) +
 8308:         Zeros(7) +
 8309:         value +
 8310:         value +
 8311:         Zeros(87) +
 8312:         "pdnm" +
 8313:         LengthName(arr1[5]);
 8314:     } else if (arr1[0] == "Popup") {
 8315:       value = HexEncodeURI(arr1[4], 4);
 8316:       ret =
 8317:         Zeros(7) +
 8318:         Locked(arr1[2]) +
 8319:         Zeros(7) +
 8320:         "%07" +
 8321:         FixedName(arr1[1]) +
 8322:         Zeros(5) +
 8323:         Timer(arr1[3]) +
 8324:         Zeros(4) +
 8325:         value +
 8326:         value +
 8327:         Zeros(84) +
 8328:         "pdnm" +
 8329:         LengthName(arr1[5]);
 8330:     } else if (arr1[0] == "Color") {
 8331:       value = "%C3%BF";
 8332:       for (var i = 0; i < 6; i = i + 2) {
 8333:         value = value + HexEncodeURI(parseInt(arr1[4].substr(i, 2), 16));
 8334:       }
 8335:       ret =
 8336:         Zeros(7) +
 8337:         Locked(arr1[2]) +
 8338:         Zeros(7) +
 8339:         "%05" +
 8340:         FixedName(arr1[1]) +
 8341:         Zeros(5) +
 8342:         Timer(arr1[3]) +
 8343:         Zeros(4) +
 8344:         value +
 8345:         value +
 8346:         Zeros(84);
 8347:     } else if (arr1[0] == "Angle") {
 8348:       value = toFraction(arr1[4]);
 8349:       ret =
 8350:         Zeros(7) +
 8351:         Locked(arr1[2]) +
 8352:         Zeros(7) +
 8353:         "%03" +
 8354:         FixedName(arr1[1]) +
 8355:         Zeros(5) +
 8356:         Timer(arr1[3]) +
 8357:         Zeros(4) +
 8358:         value +
 8359:         value +
 8360:         Zeros(84);
 8361:     } else if (arr1[0] == "Point") {
 8362:       ret =
 8363:         Zeros(7) +
 8364:         Locked(arr1[2]) +
 8365:         Zeros(7) +
 8366:         "%06" +
 8367:         FixedName(arr1[1]) +
 8368:         Zeros(5) +
 8369:         Timer(arr1[3]) +
 8370:         Zeros(14) +
 8371:         HexEncodeURI(arr1[4], 4) +
 8372:         HexEncodeURI(arr1[5], 4) +
 8373:         Zeros(74);
 8374:     } else if (arr1[0] == "3DPoint") {
 8375:       ret =
 8376:         Zeros(7) +
 8377:         Locked(arr1[2]) +
 8378:         Zeros(7) +
 8379:         "%12" +
 8380:         FixedName(arr1[1]) +
 8381:         Zeros(5) +
 8382:         Timer(arr1[3]) +
 8383:         Zeros(28) +
 8384:         toDouble(arr1[4]) +
 8385:         toDouble(arr1[5]) +
 8386:         toDouble(arr1[6]) +
 8387:         Zeros(44);
 8388:     } else if (arr1[0] == "Slider") {
 8389:       ret =
 8390:         Zeros(7) +
 8391:         Locked(arr1[2]) +
 8392:         Zeros(7) +
 8393:         "%0a" +
 8394:         FixedName(arr1[1]) +
 8395:         Zeros(5) +
 8396:         Timer(arr1[3]) +
 8397:         Zeros(52) +
 8398:         toFloat(arr1[4]) +
 8399:         toFloat(arr1[8]) +
 8400:         toFloat(arr1[5]) +
 8401:         toFloat(arr1[7]) +
 8402:         toFloat(arr1[6]) +
 8403:         HexEncodeURI(arr1[9], 2) +
 8404:         HexEncodeURI(arr1[10], 2) +
 8405:         Zeros(20);
 8406:     } else if (arr1[0] == "Layer") {
 8407:       value = Zeros(4);
 8408:       if (arr1[3]) {
 8409:         value = "%C3%BF%C3%BF%C3%BF%C3%BF";
 8410:       }
 8411:       ret =
 8412:         Zeros(7) +
 8413:         Locked(arr1[2]) +
 8414:         Zeros(8) +
 8415:         FixedName(arr1[1]) +
 8416:         Zeros(82) +
 8417:         value +
 8418:         Zeros(16);
 8419:     } else if (arr1[0] == "Group") {
 8420:       ret =
 8421:         Zeros(7) +
 8422:         Locked(arr1[2]) +
 8423:         Zeros(7) +
 8424:         "%0d" +
 8425:         FixedName(arr1[1]) +
 8426:         Zeros(102);
 8427:     } else if (arr1[0] == "GroupEnd") {
 8428:       ret = Zeros(15) + "%0e" + Zeros(132);
 8429:     } else if (arr1[0] == "Button") {
 8430:       ret =
 8431:         Zeros(7) +
 8432:         Locked(arr1[2]) +
 8433:         Zeros(7) +
 8434:         "%0f" +
 8435:         FixedName(arr1[1]) +
 8436:         Zeros(5) +
 8437:         Zeros(97) +
 8438:         "pdnm" +
 8439:         LengthName(arr1[3]);
 8440:     } else if (arr1[0] == "Effect") {
 8441:       ret = Zeros(148);
 8442:     } else {
 8443:       alert("\nError \n\n id02\n", "\nError \n\n id02\n");
 8444:       return "";
 8445:     }
 8446:     return pr + ret;
 8447:   }
 8448:   function LengthName(arg) {
 8449:     var i = ansi2binary(arg) + "%00";
 8450:     var b = "";
 8451:     if (decodeURIComponent(i).length % 2 != 0) {
 8452:       b = "%00";
 8453:     }
 8454:     return CountLengthTo_hex(i) + b;
 8455:   }
 8456:   function FixedName(arg) {
 8457:     return FixedLength(ansi2binary(arg), 30);
 8458:   }
 8459:   function Timer(arg) {
 8460:     if (arg == 0) {
 8461:       return "%02";
 8462:     }
 8463:     return "%00";
 8464:   }
 8465:   function ExtTimer(arg) {
 8466:     if (arg == 2) {
 8467:       return "%C3%BF";
 8468:     }
 8469:     return "%04";
 8470:   }
 8471:   function Locked(arg) {
 8472:     if (arg) {
 8473:       return "%20";
 8474:     }
 8475:     return "%00";
 8476:   }
 8477:   function LengthDown(data, length_) {
 8478:     var length = parseInt(length_);
 8479:     if (isNaN(length) || length == null || length == undefined || length <= 0) {
 8480:       length = 40;
 8481:     }
 8482:     var Sdata = decodeURIComponent(data);
 8483:     if (Sdata.length >= length) {
 8484:       Sdata = Sdata.substr(0, length);
 8485:     }
 8486:     Sdata = encodeURIComponent(Sdata);
 8487:     return Sdata;
 8488:   }
 8489:   function FixedLength(data, length_) {
 8490:     var length = parseInt(length_);
 8491:     if (isNaN(length) || length == null || length == undefined || length <= 0) {
 8492:       length = 40;
 8493:     }
 8494:     var Sdata = decodeURIComponent(data);
 8495:     if (Sdata.length >= length) {
 8496:       Sdata = Sdata.substr(0, length - 1);
 8497:     }
 8498:     Sdata = encodeURIComponent(Sdata) + Zeros(length - Sdata.length);
 8499:     return Sdata;
 8500:   }
 8501:   function Zeros(amount) {
 8502:     var data = "";
 8503:     for (var i = 0; i < amount; i += 1) {
 8504:       data = data + "%00";
 8505:     }
 8506:     return data;
 8507:   }
 8508:   function CountLengthTo_hex(data, length_) {
 8509:     var length = length_;
 8510:     if (length == null || length == undefined) {
 8511:       length = 4;
 8512:     }
 8513:     var HEXStringLength = HexEncodeURI(decodeURIComponent(data).length, length);
 8514:     return HEXStringLength + data;
 8515:   }
 8516:   function crc32(str) {
 8517:     var crc = 4294967295;
 8518:     var table = new Array();
 8519:     for (var i = 0; i < 256; i += 1) {
 8520:       n = i;
 8521:       for (var j = 8; j > 0; j += -1) {
 8522:         if ((n & 1) == 1) {
 8523:           n = (n >>> 1) ^ 3988292384;
 8524:         } else {
 8525:           n = n >>> 1;
 8526:         }
 8527:       }
 8528:       table[i] = n;
 8529:     }
 8530:     for (var i = 0; i < str.length; i += 1) {
 8531:       crc = (crc >>> 8) ^ table[str.charCodeAt(i) ^ (crc & 255)];
 8532:     }
 8533:     crc = ~crc;
 8534:     crc = crc < 0 ? 4294967295 + crc + 1 : crc;
 8535:     crc = crc.toString(16);
 8536:     return crc;
 8537:   }
 8538:   function toFloat(number) {
 8539:     return toDouble(number, true);
 8540:   }
 8541:   function toDouble(v, fl) {
 8542:     var ebits = 11;
 8543:     var fbits = 52;
 8544:     if (fl) {
 8545:       ebits = 8;
 8546:       fbits = 23;
 8547:     }
 8548:     var bias = (1 << (ebits - 1)) - 1;
 8549:     if (isNaN(v)) {
 8550:       e = (1 << bias) - 1;
 8551:       f = 1;
 8552:       s = 0;
 8553:     } else if (v === Infinity || v === -Infinity) {
 8554:       e = (1 << bias) - 1;
 8555:       f = 0;
 8556:       s = v < 0 ? 1 : 0;
 8557:     } else if (v === 0) {
 8558:       e = 0;
 8559:       f = 0;
 8560:       s = 1 / v === -Infinity ? 1 : 0;
 8561:     } else {
 8562:       s = v < 0;
 8563:       v = Math.abs(v);
 8564:       if (v >= Math.pow(2, 1 - bias)) {
 8565:         var ln = Math.min(Math.floor(Math.log(v) / Math.LN2), bias);
 8566:         e = ln + bias;
 8567:         f = v * Math.pow(2, fbits - ln) - Math.pow(2, fbits);
 8568:       } else {
 8569:         e = 0;
 8570:         f = v / Math.pow(2, 1 - bias - fbits);
 8571:       }
 8572:     }
 8573:     var bits = [];
 8574:     for (i = fbits; i; i -= 1) {
 8575:       bits.push(f % 2 ? 1 : 0);
 8576:       f = Math.floor(f / 2);
 8577:     }
 8578:     for (i = ebits; i; i -= 1) {
 8579:       bits.push(e % 2 ? 1 : 0);
 8580:       e = Math.floor(e / 2);
 8581:     }
 8582:     bits.push(s ? 1 : 0);
 8583:     bits.reverse();
 8584:     var str = bits.join("");
 8585:     var bytes = "";
 8586:     while (str.length) {
 8587:       bytes = bytes + HexEncodeURI(parseInt(str.substring(0, 8), 2));
 8588:       str = str.substring(8);
 8589:     }
 8590:     return bytes;
 8591:   }
 8592:   function toFraction(number_) {
 8593:     var number = number_;
 8594:     if (number > 32767) {
 8595:       number = 32767;
 8596:     } else if (number < -32768) {
 8597:       number = 32768;
 8598:     } else {
 8599:       number = parseFloat(number.toFixed(5));
 8600:     }
 8601:     integer = parseInt(number);
 8602:     fractional = (number - integer).toFixed(14).substr(-14);
 8603:     fractional = (fractional / 1525878906).toFixed();
 8604:     if (number < 0) {
 8605:       fractional = 65535 - fractional;
 8606:       integer = 65535 + integer;
 8607:     }
 8608:     return HexEncodeURI(integer, 2) + HexEncodeURI(fractional, 2);
 8609:   }
 8610:   function HexEncodeURI(number, length_) {
 8611:     var length = length_;
 8612:     var URLdata = __BLOB__BLOB_000457__;
 8613:     if (length == null || length == undefined) {
 8614:       var length = 1;
 8615:     }
 8616:     var str = number.toString(16);
 8617:     while (str.length < length * 2) {
 8618:       str = "0" + str;
 8619:     }
 8620:     var bytes = "";
 8621:     var sstrn = "";
 8622:     var i = 0;
 8623:     while (bytes.length < length) {
 8624:       sstrn = parseInt(str.substr(i, 2), 16);
 8625:       bytes = bytes + URLdata.substr(sstrn, 1);
 8626:       i = i + 2;
 8627:     }
 8628:     return encodeURIComponent(bytes);
 8629:   }
 8630:   function CreateID(new_arr0) {
 8631:     var date = new Date();
 8632:     var day = date.getDate();
 8633:     var ss = date.getSeconds();
 8634:     var ret = LengthDown(
 8635:       encodeURIComponent(
 8636:         RandomSymbol() +
 8637:           NumberToSymbol(ss) +
 8638:           crc32(ArrayParser(new_arr0)) +
 8639:           RandomSymbol() +
 8640:           NumberToSymbol(day) +
 8641:           RandomSymbol(),
 8642:       ),
 8643:       31,
 8644:     );
 8645:     return ret;
 8646:   }
 8647:   function ArrayParser(data) {
 8648:     var x = "\x11";
 8649:     var y = "\x12";
 8650:     if (typeof data === "string") {
 8651:       str = decodeURIComponent(data);
 8652:       str = str.split(y);
 8653:       arr = new Array();
 8654:       for (var i = 0; i < str.length; i += 1) {
 8655:         arr[i] = str[i].split(x);
 8656:       }
 8657:       return arr;
 8658:     } else {
 8659:       str = data[0].join(x);
 8660:       for (var i = 1; i < data.length; i += 1) {
 8661:         str += y + data[i].join(x);
 8662:       }
 8663:       return str;
 8664:     }
 8665:   }
 8666:   function NumberToSymbol(number_) {
 8667:     var line = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
 8668:     var number = number_ % line.length;
 8669:     return line.substr(number, 1);
 8670:   }
 8671:   function RandomSymbol() {
 8672:     var min = 0;
 8673:     var max = 62;
 8674:     var rand = min - 0.5 + Math.random() * (max - min + 1);
 8675:     rand = parseInt(Math.round(rand));
 8676:     rand = NumberToSymbol(rand);
 8677:     return rand;
 8678:   }
 8679:   function ansi2binary(name_) {
 8680:     var name = name_;
 8681:     var Converter = new File(Folder.temp.fsName + "/temp.AEpr");
 8682:     Converter.encoding = "ASCI";
 8683:     Converter.open("w");
 8684:     Converter.write(name);
 8685:     Converter.open("r");
 8686:     Converter.encoding = "BINARY";
 8687:     name = encodeURI(Converter.read());
 8688:     Converter.close();
 8689:     Converter.remove();
 8690:     return name;
 8691:   }
 8692:   if (new_arr0[0][0] != "Effect") {
 8693:     alert("\nError \n\n id01\n", "\nError \n\n id01\n");
 8694:     return;
 8695:   }
 8696:   var FaFX =
 8697:     "FaFXhead%00%00%00%10%00%00%00%03%00%00%00D%00%00%00%01%01%00%00%00LIST";
 8698:   var beso =
 8699:     "bescbeso%00%00%002%00%00%00%01%00%00%00%01%00%00%00%00%00%00%02X%00%1E%00%00%00%00%00%00%01@%00%C3%B0%01@%00%C3%B0?%C3%B0%00%00%00%00%00%00?%C3%B0%00%00%00%00%00%00%00%00";
 8700:   var sspc = "sspcfnam%00%00%000" + Zeros(48) + "LIST";
 8701:   for (var i = 0; i < new_arr0.length; i += 1) {
 8702:     if (new_arr0[i][0] == "3DPoint") {
 8703:       FaFX =
 8704:         "FaFXhead%00%00%00%10%00%00%00%03%00%00%00N%00%00%00%00%01%00%00%00LIST";
 8705:       beso =
 8706:         "bescbeso%00%00%008%00%00%00%01%00%00%00%01%00%00%00%00%00%00%5D%C2%A8%00%1D%C3%B8R%00%00%00%00%07%C2%80%048%07%C2%80%048?%C3%B0%00%00%00%00%00%00?%C3%B0%00%00%00%00%00%00%00%00%00%00%C3%BF%C3%BF%C3%BF%C3%BF";
 8707:       break;
 8708:     }
 8709:   }
 8710:   var lName = LengthName(new_arr0[0][1]);
 8711:   var tdsptdot1 =
 8712:     "LIST%00%00%00%C2%ACtdsptdot%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdpl%00%00%00%04%00%00%00%02LIST%00%00%00%40tdsitdix%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdmn%00%00%00(ADBE%20Effect%20Parade%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00LIST%00%00%00%40tdsitdix%00%00%00%04%00%00%00%00tdmn%00%00%00(";
 8713:   var tdsptdot2 =
 8714:     "tdsn" +
 8715:     lName +
 8716:     "LIST%00%00%00dtdsptdot%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdpl%00%00%00%04%00%00%00%01LIST%00%00%00@tdsitdix%00%00%00%04%C3%BF%C3%BF%C3%BF%C3%BFtdmn%00%00%00(ADBE%20End%20of%20path%20sentinel%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00LIST";
 8717:   var ID = CreateID(new_arr0);
 8718:   ID = LengthDown(encodeURIComponent("Pseudo/" + myName + ID), 31);
 8719:   var fullMatchName = decodeURIComponent(ID);
 8720:   var ss = CountLengthTo_hex(
 8721:     sspc +
 8722:       CountLengthTo_hex(parTparn(ID, new_arr0)) +
 8723:       "LIST" +
 8724:       CountLengthTo_hex(tdgptdsb(ID, new_arr0, lName)),
 8725:   );
 8726:   return {
 8727:     mn: fullMatchName,
 8728:     str:
 8729:       "RIFX" +
 8730:       CountLengthTo_hex(
 8731:         FaFX +
 8732:           CountLengthTo_hex(
 8733:             beso + tdsptdot1 + FixedLength(ID, 40) + tdsptdot2 + ss,
 8734:           ),
 8735:       ),
 8736:   };
 8737: };
 8738: origami.GUIvariables = {
 8739:   advancedStep: { defValue: 0, lookup: [0, 1] },
 8740:   animOpacity: { defValue: "false", lookup: ["false", "true"] },
 8741:   animPosition: { defValue: "false", lookup: ["false", "true"] },
 8742:   animRotation: { defValue: "true", lookup: ["false", "true"] },
 8743:   animRotationZ: { defValue: "false", lookup: ["false", "true"] },
 8744:   animScale: { defValue: "false", lookup: ["false", "true"] },
 8745:   animationDirection: { defValue: "false", lookup: ["false", "true"] },
 8746:   colorMode: { defValue: 2, lookup: null },
 8747:   colorRangeValue: { defValue: 60, lookup: null },
 8748:   createMode: { defValue: "false", lookup: ["false", "true"] },
 8749:   mode: { defValue: 0, lookup: [0, 1, 2] },
 8750:   offsetOne: { defValue: "true", lookup: ["false", "true"] },
 8751:   pointsEdit: { defValue: 20, lookup: null },
 8752:   postCompose: { defValue: "false", lookup: ["false", "true"] },
 8753:   postExplode: { defValue: "true", lookup: ["false", "true"] },
 8754:   postRemove: { defValue: "false", lookup: ["false", "true"] },
 8755:   selectSliceAlgorythm: { defValue: 0, lookup: null },
 8756:   unwrapMode: { defValue: "false", lookup: ["false", "true"] },
 8757: };
 8758: origami.setPrefs = function () {
 8759:   for (var key in origami.GUIvariables) {
 8760:     if (!(origami.GUIvariables[key] instanceof Function)) {
 8761:       app.settings.saveSetting("origamiUI", key, origami[key]);
 8762:     }
 8763:   }
 8764: };
 8765: origami.getPrefs = function () {
 8766:   for (var key in origami.GUIvariables) {
 8767:     thisKey = origami.GUIvariables[key];
 8768:     if (!(thisKey instanceof Function)) {
 8769:       if (app.settings.haveSetting("origamiUI", key) === false) {
 8770:         origami[key] = thisKey.defValue;
 8771:       } else {
 8772:         origami[key] = app.settings.getSetting("origamiUI", key);
 8773:       }
 8774:     }
 8775:   }
 8776: };
 8777: origami.GUIvariables = {
 8778:   advancedStep: { defValue: 0, lookup: [0, 1] },
 8779:   animOpacity: { defValue: "false", lookup: ["false", "true"] },
 8780:   animPosition: { defValue: "false", lookup: ["false", "true"] },
 8781:   animRotation: { defValue: "true", lookup: ["false", "true"] },
 8782:   animRotationZ: { defValue: "false", lookup: ["false", "true"] },
 8783:   animScale: { defValue: "false", lookup: ["false", "true"] },
 8784:   animationDirection: { defValue: "false", lookup: ["false", "true"] },
 8785:   colorMode: { defValue: 2, lookup: null },
 8786:   colorRangeValue: { defValue: 60, lookup: null },
 8787:   createMode: { defValue: "false", lookup: ["false", "true"] },
 8788:   mode: { defValue: 0, lookup: [0, 1, 2] },
 8789:   offsetOne: { defValue: "true", lookup: ["false", "true"] },
 8790:   pointsEdit: { defValue: 20, lookup: null },
 8791:   postCompose: { defValue: "false", lookup: ["false", "true"] },
 8792:   postExplode: { defValue: "true", lookup: ["false", "true"] },
 8793:   postRemove: { defValue: "false", lookup: ["false", "true"] },
 8794:   selectSliceAlgorythm: { defValue: 0, lookup: null },
 8795:   unwrapMode: { defValue: "false", lookup: ["false", "true"] },
 8796: };
 8797: Voronoi.prototype.reset = function () {
 8798:   if (!this.beachline) {
 8799:     this.beachline = new this.RBTree();
 8800:   }
 8801:   if (this.beachline.root) {
 8802:     var beachsection = this.beachline.getFirst(this.beachline.root);
 8803:     while (beachsection) {
 8804:       this.beachsectionJunkyard.push(beachsection);
 8805:       beachsection = beachsection.rbNext;
 8806:     }
 8807:   }
 8808:   this.beachline.root = null;
 8809:   if (!this.circleEvents) {
 8810:     this.circleEvents = new this.RBTree();
 8811:   }
 8812:   this.circleEvents.root = this.firstCircleEvent = null;
 8813:   this.vertices = [];
 8814:   this.edges = [];
 8815:   this.cells = [];
 8816: };
 8817: Voronoi.prototype.sqrt = Math.sqrt;
 8818: Voronoi.prototype.abs = Math.abs;
 8819: Voronoi.prototype["\u03b5"] = Voronoi["\u03b5"] = 1e-9;
 8820: Voronoi.prototype.inv = Voronoi.inv = 1 / Voronoi["\u03b5"];
 8821: Voronoi.prototype.equalWithEpsilon = function (a, b) {
 8822:   return this.abs(a - b) < 1e-9;
 8823: };
 8824: Voronoi.prototype.greaterThanWithEpsilon = function (a, b) {
 8825:   return a - b > 1e-9;
 8826: };
 8827: Voronoi.prototype.greaterThanOrEqualWithEpsilon = function (a, b) {
 8828:   return b - a < 1e-9;
 8829: };
 8830: Voronoi.prototype.lessThanWithEpsilon = function (a, b) {
 8831:   return b - a > 1e-9;
 8832: };
 8833: Voronoi.prototype.lessThanOrEqualWithEpsilon = function (a, b) {
 8834:   return a - b < 1e-9;
 8835: };
 8836: Voronoi.prototype.RBTree = function () {
 8837:   this.root = null;
 8838: };
 8839: Voronoi.prototype.RBTree.prototype.rbInsertSuccessor = function (
 8840:   node,
 8841:   successor,
 8842: ) {
 8843:   if (node) {
 8844:     successor.rbPrevious = node;
 8845:     successor.rbNext = node.rbNext;
 8846:     if (node.rbNext) {
 8847:       node.rbNext.rbPrevious = successor;
 8848:     }
 8849:     node.rbNext = successor;
 8850:     if (node.rbRight) {
 8851:       node = node.rbRight;
 8852:       while (node.rbLeft) {
 8853:         node = node.rbLeft;
 8854:       }
 8855:       node.rbLeft = successor;
 8856:     } else {
 8857:       node.rbRight = successor;
 8858:     }
 8859:     parent = node;
 8860:   } else if (this.root) {
 8861:     node = this.getFirst(this.root);
 8862:     successor.rbPrevious = null;
 8863:     successor.rbNext = node;
 8864:     node.rbPrevious = successor;
 8865:     node.rbLeft = successor;
 8866:     parent = node;
 8867:   } else {
 8868:     successor.rbPrevious = successor.rbNext = null;
 8869:     this.root = successor;
 8870:     parent = null;
 8871:   }
 8872:   successor.rbLeft = successor.rbRight = null;
 8873:   successor.rbParent = parent;
 8874:   successor.rbRed = true;
 8875:   node = successor;
 8876:   while (parent && parent.rbRed) {
 8877:     grandpa = parent.rbParent;
 8878:     if (parent === grandpa.rbLeft) {
 8879:       uncle = grandpa.rbRight;
 8880:       if (uncle && uncle.rbRed) {
 8881:         parent.rbRed = uncle.rbRed = false;
 8882:         grandpa.rbRed = true;
 8883:         node = grandpa;
 8884:       } else {
 8885:         if (node === parent.rbRight) {
 8886:           this.rbRotateLeft(parent);
 8887:           node = parent;
 8888:           parent = node.rbParent;
 8889:         }
 8890:         parent.rbRed = false;
 8891:         grandpa.rbRed = true;
 8892:         this.rbRotateRight(grandpa);
 8893:       }
 8894:     } else {
 8895:       uncle = grandpa.rbLeft;
 8896:       if (uncle && uncle.rbRed) {
 8897:         parent.rbRed = uncle.rbRed = false;
 8898:         grandpa.rbRed = true;
 8899:         node = grandpa;
 8900:       } else {
 8901:         if (node === parent.rbLeft) {
 8902:           this.rbRotateRight(parent);
 8903:           node = parent;
 8904:           parent = node.rbParent;
 8905:         }
 8906:         parent.rbRed = false;
 8907:         grandpa.rbRed = true;
 8908:         this.rbRotateLeft(grandpa);
 8909:       }
 8910:     }
 8911:     parent = node.rbParent;
 8912:   }
 8913:   this.root.rbRed = false;
 8914: };
 8915: Voronoi.prototype.RBTree.prototype.rbRemoveNode = function (node) {
 8916:   if (node.rbNext) {
 8917:     node.rbNext.rbPrevious = node.rbPrevious;
 8918:   }
 8919:   if (node.rbPrevious) {
 8920:     node.rbPrevious.rbNext = node.rbNext;
 8921:   }
 8922:   node.rbNext = node.rbPrevious = null;
 8923:   var parent = node.rbParent;
 8924:   var left = node.rbLeft;
 8925:   var right = node.rbRight;
 8926:   if (!left) {
 8927:     next = right;
 8928:   } else if (!right) {
 8929:     next = left;
 8930:   } else {
 8931:     next = this.getFirst(right);
 8932:   }
 8933:   if (parent) {
 8934:     if (parent.rbLeft === node) {
 8935:       parent.rbLeft = next;
 8936:     } else {
 8937:       parent.rbRight = next;
 8938:     }
 8939:   } else {
 8940:     this.root = next;
 8941:   }
 8942:   if (left && right) {
 8943:     isRed = next.rbRed;
 8944:     next.rbRed = node.rbRed;
 8945:     next.rbLeft = left;
 8946:     left.rbParent = next;
 8947:     if (next !== right) {
 8948:       parent = next.rbParent;
 8949:       next.rbParent = node.rbParent;
 8950:       node = next.rbRight;
 8951:       parent.rbLeft = node;
 8952:       next.rbRight = right;
 8953:       right.rbParent = next;
 8954:     } else {
 8955:       next.rbParent = parent;
 8956:       parent = next;
 8957:       node = next.rbRight;
 8958:     }
 8959:   } else {
 8960:     isRed = node.rbRed;
 8961:     node = next;
 8962:   }
 8963:   if (node) {
 8964:     node.rbParent = parent;
 8965:   }
 8966:   if (isRed) {
 8967:     return;
 8968:   }
 8969:   if (node && node.rbRed) {
 8970:     node.rbRed = false;
 8971:     return;
 8972:   }
 8973:   do {
 8974:     if (node === this.root) {
 8975:       break;
 8976:     }
 8977:     if (node === parent.rbLeft) {
 8978:       sibling = parent.rbRight;
 8979:       if (sibling.rbRed) {
 8980:         sibling.rbRed = false;
 8981:         parent.rbRed = true;
 8982:         this.rbRotateLeft(parent);
 8983:         sibling = parent.rbRight;
 8984:       }
 8985:       if (
 8986:         (sibling.rbLeft && sibling.rbLeft.rbRed) ||
 8987:         (sibling.rbRight && sibling.rbRight.rbRed)
 8988:       ) {
 8989:         if (!sibling.rbRight || !sibling.rbRight.rbRed) {
 8990:           sibling.rbLeft.rbRed = false;
 8991:           sibling.rbRed = true;
 8992:           this.rbRotateRight(sibling);
 8993:           sibling = parent.rbRight;
 8994:         }
 8995:         sibling.rbRed = parent.rbRed;
 8996:         parent.rbRed = sibling.rbRight.rbRed = false;
 8997:         this.rbRotateLeft(parent);
 8998:         node = this.root;
 8999:         break;
 9000:       }
 9001:     } else {
 9002:       sibling = parent.rbLeft;
 9003:       if (sibling.rbRed) {
 9004:         sibling.rbRed = false;
 9005:         parent.rbRed = true;
 9006:         this.rbRotateRight(parent);
 9007:         sibling = parent.rbLeft;
 9008:       }
 9009:       if (
 9010:         (sibling.rbLeft && sibling.rbLeft.rbRed) ||
 9011:         (sibling.rbRight && sibling.rbRight.rbRed)
 9012:       ) {
 9013:         if (!sibling.rbLeft || !sibling.rbLeft.rbRed) {
 9014:           sibling.rbRight.rbRed = false;
 9015:           sibling.rbRed = true;
 9016:           this.rbRotateLeft(sibling);
 9017:           sibling = parent.rbLeft;
 9018:         }
 9019:         sibling.rbRed = parent.rbRed;
 9020:         parent.rbRed = sibling.rbLeft.rbRed = false;
 9021:         this.rbRotateRight(parent);
 9022:         node = this.root;
 9023:         break;
 9024:       }
 9025:     }
 9026:     sibling.rbRed = true;
 9027:     node = parent;
 9028:     parent = parent.rbParent;
 9029:   } while (!node.rbRed);
 9030:   if (node) {
 9031:     node.rbRed = false;
 9032:   }
 9033: };
 9034: Voronoi.prototype.RBTree.prototype.rbRotateLeft = function (node) {
 9035:   var p = node;
 9036:   var q = node.rbRight;
 9037:   var parent = p.rbParent;
 9038:   if (parent) {
 9039:     if (parent.rbLeft === p) {
 9040:       parent.rbLeft = q;
 9041:     } else {
 9042:       parent.rbRight = q;
 9043:     }
 9044:   } else {
 9045:     this.root = q;
 9046:   }
 9047:   q.rbParent = parent;
 9048:   p.rbParent = q;
 9049:   p.rbRight = q.rbLeft;
 9050:   if (p.rbRight) {
 9051:     p.rbRight.rbParent = p;
 9052:   }
 9053:   q.rbLeft = p;
 9054: };
 9055: Voronoi.prototype.RBTree.prototype.rbRotateRight = function (node) {
 9056:   var p = node;
 9057:   var q = node.rbLeft;
 9058:   var parent = p.rbParent;
 9059:   if (parent) {
 9060:     if (parent.rbLeft === p) {
 9061:       parent.rbLeft = q;
 9062:     } else {
 9063:       parent.rbRight = q;
 9064:     }
 9065:   } else {
 9066:     this.root = q;
 9067:   }
 9068:   q.rbParent = parent;
 9069:   p.rbParent = q;
 9070:   p.rbLeft = q.rbRight;
 9071:   if (p.rbLeft) {
 9072:     p.rbLeft.rbParent = p;
 9073:   }
 9074:   q.rbRight = p;
 9075: };
 9076: Voronoi.prototype.RBTree.prototype.getFirst = function (node) {
 9077:   while (node.rbLeft) {
 9078:     node = node.rbLeft;
 9079:   }
 9080:   return node;
 9081: };
 9082: Voronoi.prototype.RBTree.prototype.getLast = function (node) {
 9083:   while (node.rbRight) {
 9084:     node = node.rbRight;
 9085:   }
 9086:   return node;
 9087: };
 9088: Voronoi.prototype.Diagram = function (site) {
 9089:   this.site = site;
 9090: };
 9091: Voronoi.prototype.Cell = function (site) {
 9092:   this.site = site;
 9093:   this.halfedges = [];
 9094:   this.closeMe = false;
 9095: };
 9096: Voronoi.prototype.Cell.prototype.init = function (site) {
 9097:   this.site = site;
 9098:   this.halfedges = [];
 9099:   this.closeMe = false;
 9100:   return this;
 9101: };
 9102: Voronoi.prototype.createCell = function (site) {
 9103:   var cell = this.cellJunkyard.pop();
 9104:   if (cell) {
 9105:     return cell.init(site);
 9106:   }
 9107:   return new this.Cell(site);
 9108: };
 9109: Voronoi.prototype.Cell.prototype.prepareHalfedges = function () {
 9110:   var halfedges = this.halfedges;
 9111:   var iHalfedge = halfedges.length;
 9112:   while (iHalfedge--) {
 9113:     edge = halfedges[iHalfedge].edge;
 9114:     if (!edge.vb || !edge.va) {
 9115:       halfedges.splice(iHalfedge, 1);
 9116:     }
 9117:   }
 9118:   halfedges.sort(function (a, b) {
 9119:     return b.angle - a.angle;
 9120:   });
 9121:   return halfedges.length;
 9122: };
 9123: Voronoi.prototype.Cell.prototype.getNeighborIds = function () {
 9124:   var neighbors = [];
 9125:   var iHalfedge = this.halfedges.length;
 9126:   while (iHalfedge--) {
 9127:     edge = this.halfedges[iHalfedge].edge;
 9128:     if (edge.lSite !== null && edge.lSite.voronoiId != this.site.voronoiId) {
 9129:       neighbors.push(edge.lSite.voronoiId);
 9130:     } else {
 9131:       if (edge.rSite !== null && edge.rSite.voronoiId != this.site.voronoiId) {
 9132:         neighbors.push(edge.rSite.voronoiId);
 9133:       }
 9134:     }
 9135:   }
 9136:   return neighbors;
 9137: };
 9138: Voronoi.prototype.Cell.prototype.getBbox = function () {
 9139:   var halfedges = this.halfedges;
 9140:   var iHalfedge = halfedges.length;
 9141:   var xmin = Infinity;
 9142:   var ymin = Infinity;
 9143:   var xmax = -Infinity;
 9144:   var ymax = -Infinity;
 9145:   while (iHalfedge--) {
 9146:     v = halfedges[iHalfedge].getStartpoint();
 9147:     vx = v.x;
 9148:     vy = v.y;
 9149:     if (vx < xmin) {
 9150:       xmin = vx;
 9151:     }
 9152:     if (vy < ymin) {
 9153:       ymin = vy;
 9154:     }
 9155:     if (vx > xmax) {
 9156:       xmax = vx;
 9157:     }
 9158:     if (vy > ymax) {
 9159:       ymax = vy;
 9160:     }
 9161:   }
 9162:   return { height: ymax - ymin, width: xmax - xmin, x: xmin, y: ymin };
 9163: };
 9164: Voronoi.prototype.Cell.prototype.pointIntersection = function (x, y) {
 9165:   var halfedges = this.halfedges;
 9166:   var iHalfedge = halfedges.length;
 9167:   while (iHalfedge--) {
 9168:     halfedge = halfedges[iHalfedge];
 9169:     p0 = halfedge.getStartpoint();
 9170:     p1 = halfedge.getEndpoint();
 9171:     r = (y - p0.y) * (p1.x - p0.x) - (x - p0.x) * (p1.y - p0.y);
 9172:     if (!r) {
 9173:       return 0;
 9174:     }
 9175:     if (r > 0) {
 9176:       return -1;
 9177:     }
 9178:   }
 9179:   return 1;
 9180: };
 9181: Voronoi.prototype.Vertex = function (x, y) {
 9182:   this.x = x;
 9183:   this.y = y;
 9184: };
 9185: Voronoi.prototype.Edge = function (lSite, rSite) {
 9186:   this.lSite = lSite;
 9187:   this.rSite = rSite;
 9188:   this.va = this.vb = null;
 9189: };
 9190: Voronoi.prototype.Halfedge = function (edge, lSite, rSite) {
 9191:   this.site = lSite;
 9192:   this.edge = edge;
 9193:   if (rSite) {
 9194:     this.angle = Math.atan2(rSite.y - lSite.y, rSite.x - lSite.x);
 9195:   } else {
 9196:     var va = edge.va;
 9197:     var vb = edge.vb;
 9198:     this.angle =
 9199:       edge.lSite === lSite
 9200:         ? Math.atan2(vb.x - va.x, va.y - vb.y)
 9201:         : Math.atan2(va.x - vb.x, vb.y - va.y);
 9202:   }
 9203: };
 9204: Voronoi.prototype.createHalfedge = function (edge, lSite, rSite) {
 9205:   return new this.Halfedge(edge, lSite, rSite);
 9206: };
 9207: Voronoi.prototype.Halfedge.prototype.getStartpoint = function () {
 9208:   return this.edge.lSite === this.site ? this.edge.va : this.edge.vb;
 9209: };
 9210: Voronoi.prototype.Halfedge.prototype.getEndpoint = function () {
 9211:   return this.edge.lSite === this.site ? this.edge.vb : this.edge.va;
 9212: };
 9213: Voronoi.prototype.createVertex = function (x, y) {
 9214:   var v = this.vertexJunkyard.pop();
 9215:   if (!v) {
 9216:     v = new this.Vertex(x, y);
 9217:   } else {
 9218:     v.x = x;
 9219:     v.y = y;
 9220:   }
 9221:   this.vertices.push(v);
 9222:   return v;
 9223: };
 9224: Voronoi.prototype.createEdge = function (lSite, rSite, va, vb) {
 9225:   var edge = this.edgeJunkyard.pop();
 9226:   if (!edge) {
 9227:     edge = new this.Edge(lSite, rSite);
 9228:   } else {
 9229:     edge.lSite = lSite;
 9230:     edge.rSite = rSite;
 9231:     edge.va = edge.vb = null;
 9232:   }
 9233:   this.edges.push(edge);
 9234:   if (va) {
 9235:     this.setEdgeStartpoint(edge, lSite, rSite, va);
 9236:   }
 9237:   if (vb) {
 9238:     this.setEdgeEndpoint(edge, lSite, rSite, vb);
 9239:   }
 9240:   this.cells[lSite.voronoiId].halfedges.push(
 9241:     this.createHalfedge(edge, lSite, rSite),
 9242:   );
 9243:   this.cells[rSite.voronoiId].halfedges.push(
 9244:     this.createHalfedge(edge, rSite, lSite),
 9245:   );
 9246:   return edge;
 9247: };
 9248: Voronoi.prototype.createBorderEdge = function (lSite, va, vb) {
 9249:   var edge = this.edgeJunkyard.pop();
 9250:   if (!edge) {
 9251:     edge = new this.Edge(lSite, null);
 9252:   } else {
 9253:     edge.lSite = lSite;
 9254:     edge.rSite = null;
 9255:   }
 9256:   edge.va = va;
 9257:   edge.vb = vb;
 9258:   this.edges.push(edge);
 9259:   return edge;
 9260: };
 9261: Voronoi.prototype.setEdgeStartpoint = function (edge, lSite, rSite, vertex) {
 9262:   if (!edge.va && !edge.vb) {
 9263:     edge.va = vertex;
 9264:     edge.lSite = lSite;
 9265:     edge.rSite = rSite;
 9266:   } else if (edge.lSite === rSite) {
 9267:     edge.vb = vertex;
 9268:   } else {
 9269:     edge.va = vertex;
 9270:   }
 9271: };
 9272: Voronoi.prototype.setEdgeEndpoint = function (edge, lSite, rSite, vertex) {
 9273:   this.setEdgeStartpoint(edge, rSite, lSite, vertex);
 9274: };
 9275: Voronoi.prototype.Beachsection = function () {};
 9276: Voronoi.prototype.createBeachsection = function (site) {
 9277:   var beachsection = this.beachsectionJunkyard.pop();
 9278:   if (!beachsection) {
 9279:     beachsection = new this.Beachsection();
 9280:   }
 9281:   beachsection.site = site;
 9282:   return beachsection;
 9283: };
 9284: Voronoi.prototype.leftBreakPoint = function (arc, directrix) {
 9285:   var site = arc.site;
 9286:   var rfocx = site.x;
 9287:   var rfocy = site.y;
 9288:   var pby2 = rfocy - directrix;
 9289:   if (!pby2) {
 9290:     return rfocx;
 9291:   }
 9292:   var lArc = arc.rbPrevious;
 9293:   if (!lArc) {
 9294:     return -Infinity;
 9295:   }
 9296:   site = lArc.site;
 9297:   var lfocx = site.x;
 9298:   var lfocy = site.y;
 9299:   var plby2 = lfocy - directrix;
 9300:   if (!plby2) {
 9301:     return lfocx;
 9302:   }
 9303:   var hl = lfocx - rfocx;
 9304:   var aby2 = 1 / pby2 - 1 / plby2;
 9305:   var b = hl / plby2;
 9306:   if (aby2) {
 9307:     return (
 9308:       (-b +
 9309:         this.sqrt(
 9310:           b * b -
 9311:             2 *
 9312:               aby2 *
 9313:               ((hl * hl) / (-2 * plby2) - lfocy + plby2 / 2 + rfocy - pby2 / 2),
 9314:         )) /
 9315:         aby2 +
 9316:       rfocx
 9317:     );
 9318:   }
 9319:   return (rfocx + lfocx) / 2;
 9320: };
 9321: Voronoi.prototype.rightBreakPoint = function (arc, directrix) {
 9322:   var rArc = arc.rbNext;
 9323:   if (rArc) {
 9324:     return this.leftBreakPoint(rArc, directrix);
 9325:   }
 9326:   var site = arc.site;
 9327:   return site.y === directrix ? site.x : Infinity;
 9328: };
 9329: Voronoi.prototype.detachBeachsection = function (beachsection) {
 9330:   this.detachCircleEvent(beachsection);
 9331:   this.beachline.rbRemoveNode(beachsection);
 9332:   this.beachsectionJunkyard.push(beachsection);
 9333: };
 9334: Voronoi.prototype.removeBeachsection = function (beachsection) {
 9335:   var circle = beachsection.circleEvent;
 9336:   var x = circle.x;
 9337:   var y = circle.ycenter;
 9338:   var vertex = this.createVertex(x, y);
 9339:   var previous = beachsection.rbPrevious;
 9340:   var next = beachsection.rbNext;
 9341:   var disappearingTransitions = [beachsection];
 9342:   var abs_fn = Math.abs;
 9343:   this.detachBeachsection(beachsection);
 9344:   var lArc = previous;
 9345:   while (
 9346:     lArc.circleEvent &&
 9347:     abs_fn(x - lArc.circleEvent.x) < 1e-9 &&
 9348:     abs_fn(y - lArc.circleEvent.ycenter) < 1e-9
 9349:   ) {
 9350:     previous = lArc.rbPrevious;
 9351:     disappearingTransitions.unshift(lArc);
 9352:     this.detachBeachsection(lArc);
 9353:     lArc = previous;
 9354:   }
 9355:   disappearingTransitions.unshift(lArc);
 9356:   this.detachCircleEvent(lArc);
 9357:   var rArc = next;
 9358:   while (
 9359:     rArc.circleEvent &&
 9360:     abs_fn(x - rArc.circleEvent.x) < 1e-9 &&
 9361:     abs_fn(y - rArc.circleEvent.ycenter) < 1e-9
 9362:   ) {
 9363:     next = rArc.rbNext;
 9364:     disappearingTransitions.push(rArc);
 9365:     this.detachBeachsection(rArc);
 9366:     rArc = next;
 9367:   }
 9368:   disappearingTransitions.push(rArc);
 9369:   this.detachCircleEvent(rArc);
 9370:   var nArcs = disappearingTransitions.length;
 9371:   for (var iArc = 1; iArc < nArcs; iArc += 1) {
 9372:     rArc = disappearingTransitions[iArc];
 9373:     lArc = disappearingTransitions[iArc - 1];
 9374:     this.setEdgeStartpoint(rArc.edge, lArc.site, rArc.site, vertex);
 9375:   }
 9376:   lArc = disappearingTransitions[0];
 9377:   rArc = disappearingTransitions[nArcs - 1];
 9378:   rArc.edge = this.createEdge(lArc.site, rArc.site, undefined, vertex);
 9379:   this.attachCircleEvent(lArc);
 9380:   this.attachCircleEvent(rArc);
 9381: };
 9382: Voronoi.prototype.addBeachsection = function (site) {
 9383:   var x = site.x;
 9384:   var directrix = site.y;
 9385:   var node = this.beachline.root;
 9386:   while (node) {
 9387:     dxl = this.leftBreakPoint(node, directrix) - x;
 9388:     if (dxl > 1e-9) {
 9389:       node = node.rbLeft;
 9390:     } else {
 9391:       dxr = x - this.rightBreakPoint(node, directrix);
 9392:       if (dxr > 1e-9) {
 9393:         if (!node.rbRight) {
 9394:           lArc = node;
 9395:           break;
 9396:         }
 9397:         node = node.rbRight;
 9398:       } else {
 9399:         if (dxl > -1e-9) {
 9400:           lArc = node.rbPrevious;
 9401:           rArc = node;
 9402:         } else if (dxr > -1e-9) {
 9403:           lArc = node;
 9404:           rArc = node.rbNext;
 9405:         } else {
 9406:           lArc = rArc = node;
 9407:         }
 9408:         break;
 9409:       }
 9410:     }
 9411:   }
 9412:   var newArc = this.createBeachsection(site);
 9413:   this.beachline.rbInsertSuccessor(lArc, newArc);
 9414:   if (!lArc && !rArc) {
 9415:     return;
 9416:   }
 9417:   if (lArc === rArc) {
 9418:     this.detachCircleEvent(lArc);
 9419:     rArc = this.createBeachsection(lArc.site);
 9420:     this.beachline.rbInsertSuccessor(newArc, rArc);
 9421:     newArc.edge = rArc.edge = this.createEdge(lArc.site, newArc.site);
 9422:     this.attachCircleEvent(lArc);
 9423:     this.attachCircleEvent(rArc);
 9424:     return;
 9425:   }
 9426:   if (lArc && !rArc) {
 9427:     newArc.edge = this.createEdge(lArc.site, newArc.site);
 9428:     return;
 9429:   }
 9430:   if (lArc !== rArc) {
 9431:     this.detachCircleEvent(lArc);
 9432:     this.detachCircleEvent(rArc);
 9433:     var lSite = lArc.site;
 9434:     var ax = lSite.x;
 9435:     var ay = lSite.y;
 9436:     var bx = site.x - ax;
 9437:     var by = site.y - ay;
 9438:     var rSite = rArc.site;
 9439:     var cx = rSite.x - ax;
 9440:     var cy = rSite.y - ay;
 9441:     var d = 2 * (bx * cy - by * cx);
 9442:     var hb = bx * bx + by * by;
 9443:     var hc = cx * cx + cy * cy;
 9444:     var vertex = this.createVertex(
 9445:       (cy * hb - by * hc) / d + ax,
 9446:       (bx * hc - cx * hb) / d + ay,
 9447:     );
 9448:     this.setEdgeStartpoint(rArc.edge, lSite, rSite, vertex);
 9449:     newArc.edge = this.createEdge(lSite, site, undefined, vertex);
 9450:     rArc.edge = this.createEdge(site, rSite, undefined, vertex);
 9451:     this.attachCircleEvent(lArc);
 9452:     this.attachCircleEvent(rArc);
 9453:     return;
 9454:   }
 9455: };
 9456: Voronoi.prototype.CircleEvent = function () {
 9457:   this.arc = null;
 9458:   this.rbLeft = null;
 9459:   this.rbNext = null;
 9460:   this.rbParent = null;
 9461:   this.rbPrevious = null;
 9462:   this.rbRed = false;
 9463:   this.rbRight = null;
 9464:   this.site = null;
 9465:   this.x = this.y = this.ycenter = 0;
 9466: };
 9467: Voronoi.prototype.attachCircleEvent = function (arc) {
 9468:   var lArc = arc.rbPrevious;
 9469:   var rArc = arc.rbNext;
 9470:   if (!lArc || !rArc) {
 9471:     return;
 9472:   }
 9473:   var lSite = lArc.site;
 9474:   var cSite = arc.site;
 9475:   var rSite = rArc.site;
 9476:   if (lSite === rSite) {
 9477:     return;
 9478:   }
 9479:   var bx = cSite.x;
 9480:   var by = cSite.y;
 9481:   var ax = lSite.x - bx;
 9482:   var ay = lSite.y - by;
 9483:   var cx = rSite.x - bx;
 9484:   var cy = rSite.y - by;
 9485:   var d = 2 * (ax * cy - ay * cx);
 9486:   if (d >= -2e-12) {
 9487:     return;
 9488:   }
 9489:   var ha = ax * ax + ay * ay;
 9490:   var hc = cx * cx + cy * cy;
 9491:   var x = (cy * ha - ay * hc) / d;
 9492:   var y = (ax * hc - cx * ha) / d;
 9493:   var ycenter = y + by;
 9494:   var circleEvent = this.circleEventJunkyard.pop();
 9495:   if (!circleEvent) {
 9496:     circleEvent = new this.CircleEvent();
 9497:   }
 9498:   circleEvent.arc = arc;
 9499:   circleEvent.site = cSite;
 9500:   circleEvent.x = x + bx;
 9501:   circleEvent.y = ycenter + this.sqrt(x * x + y * y);
 9502:   circleEvent.ycenter = ycenter;
 9503:   arc.circleEvent = circleEvent;
 9504:   var predecessor = null;
 9505:   var node = this.circleEvents.root;
 9506:   while (node) {
 9507:     if (
 9508:       circleEvent.y < node.y ||
 9509:       (circleEvent.y === node.y && circleEvent.x <= node.x)
 9510:     ) {
 9511:       if (node.rbLeft) {
 9512:         node = node.rbLeft;
 9513:       } else {
 9514:         predecessor = node.rbPrevious;
 9515:         break;
 9516:       }
 9517:     } else {
 9518:       if (node.rbRight) {
 9519:         node = node.rbRight;
 9520:       } else {
 9521:         predecessor = node;
 9522:         break;
 9523:       }
 9524:     }
 9525:   }
 9526:   this.circleEvents.rbInsertSuccessor(predecessor, circleEvent);
 9527:   if (!predecessor) {
 9528:     this.firstCircleEvent = circleEvent;
 9529:   }
 9530: };
 9531: Voronoi.prototype.detachCircleEvent = function (arc) {
 9532:   var circleEvent = arc.circleEvent;
 9533:   if (circleEvent) {
 9534:     if (!circleEvent.rbPrevious) {
 9535:       this.firstCircleEvent = circleEvent.rbNext;
 9536:     }
 9537:     this.circleEvents.rbRemoveNode(circleEvent);
 9538:     this.circleEventJunkyard.push(circleEvent);
 9539:     arc.circleEvent = null;
 9540:   }
 9541: };
 9542: Voronoi.prototype.connectEdge = function (edge, bbox) {
 9543:   var vb = edge.vb;
 9544:   if (!!vb) {
 9545:     return true;
 9546:   }
 9547:   var va = edge.va;
 9548:   var xl = bbox.xl;
 9549:   var xr = bbox.xr;
 9550:   var yt = bbox.yt;
 9551:   var yb = bbox.yb;
 9552:   var lSite = edge.lSite;
 9553:   var rSite = edge.rSite;
 9554:   var lx = lSite.x;
 9555:   var ly = lSite.y;
 9556:   var rx = rSite.x;
 9557:   var ry = rSite.y;
 9558:   var fx = (lx + rx) / 2;
 9559:   var fy = (ly + ry) / 2;
 9560:   this.cells[lSite.voronoiId].closeMe = true;
 9561:   this.cells[rSite.voronoiId].closeMe = true;
 9562:   if (ry !== ly) {
 9563:     fm = (lx - rx) / (ry - ly);
 9564:     fb = fy - fm * fx;
 9565:   }
 9566:   if (fm === undefined) {
 9567:     if (fx < xl || fx >= xr) {
 9568:       return false;
 9569:     }
 9570:     if (lx > rx) {
 9571:       if (!va || va.y < yt) {
 9572:         va = this.createVertex(fx, yt);
 9573:       } else {
 9574:         if (va.y >= yb) {
 9575:           return false;
 9576:         }
 9577:       }
 9578:       vb = this.createVertex(fx, yb);
 9579:     } else {
 9580:       if (!va || va.y > yb) {
 9581:         va = this.createVertex(fx, yb);
 9582:       } else {
 9583:         if (va.y < yt) {
 9584:           return false;
 9585:         }
 9586:       }
 9587:       vb = this.createVertex(fx, yt);
 9588:     }
 9589:   } else if (fm < -1 || fm > 1) {
 9590:     if (lx > rx) {
 9591:       if (!va || va.y < yt) {
 9592:         va = this.createVertex((yt - fb) / fm, yt);
 9593:       } else {
 9594:         if (va.y >= yb) {
 9595:           return false;
 9596:         }
 9597:       }
 9598:       vb = this.createVertex((yb - fb) / fm, yb);
 9599:     } else {
 9600:       if (!va || va.y > yb) {
 9601:         va = this.createVertex((yb - fb) / fm, yb);
 9602:       } else {
 9603:         if (va.y < yt) {
 9604:           return false;
 9605:         }
 9606:       }
 9607:       vb = this.createVertex((yt - fb) / fm, yt);
 9608:     }
 9609:   } else {
 9610:     if (ly < ry) {
 9611:       if (!va || va.x < xl) {
 9612:         va = this.createVertex(xl, fm * xl + fb);
 9613:       } else {
 9614:         if (va.x >= xr) {
 9615:           return false;
 9616:         }
 9617:       }
 9618:       vb = this.createVertex(xr, fm * xr + fb);
 9619:     } else {
 9620:       if (!va || va.x > xr) {
 9621:         va = this.createVertex(xr, fm * xr + fb);
 9622:       } else {
 9623:         if (va.x < xl) {
 9624:           return false;
 9625:         }
 9626:       }
 9627:       vb = this.createVertex(xl, fm * xl + fb);
 9628:     }
 9629:   }
 9630:   edge.va = va;
 9631:   edge.vb = vb;
 9632:   return true;
 9633: };
 9634: Voronoi.prototype.clipEdge = function (edge, bbox) {
 9635:   var ax = edge.va.x;
 9636:   var ay = edge.va.y;
 9637:   var bx = edge.vb.x;
 9638:   var by = edge.vb.y;
 9639:   var t0 = 0;
 9640:   var t1 = 1;
 9641:   var dx = bx - ax;
 9642:   var dy = by - ay;
 9643:   var q = ax - bbox.xl;
 9644:   if (dx === 0 && q < 0) {
 9645:     return false;
 9646:   }
 9647:   var r = -q / dx;
 9648:   if (dx < 0) {
 9649:     if (r < t0) {
 9650:       return false;
 9651:     }
 9652:     if (r < t1) {
 9653:       t1 = r;
 9654:     }
 9655:   } else {
 9656:     if (dx > 0) {
 9657:       if (r > t1) {
 9658:         return false;
 9659:       }
 9660:       if (r > t0) {
 9661:         t0 = r;
 9662:       }
 9663:     }
 9664:   }
 9665:   q = bbox.xr - ax;
 9666:   if (dx === 0 && q < 0) {
 9667:     return false;
 9668:   }
 9669:   r = q / dx;
 9670:   if (dx < 0) {
 9671:     if (r > t1) {
 9672:       return false;
 9673:     }
 9674:     if (r > t0) {
 9675:       t0 = r;
 9676:     }
 9677:   } else {
 9678:     if (dx > 0) {
 9679:       if (r < t0) {
 9680:         return false;
 9681:       }
 9682:       if (r < t1) {
 9683:         t1 = r;
 9684:       }
 9685:     }
 9686:   }
 9687:   q = ay - bbox.yt;
 9688:   if (dy === 0 && q < 0) {
 9689:     return false;
 9690:   }
 9691:   r = -q / dy;
 9692:   if (dy < 0) {
 9693:     if (r < t0) {
 9694:       return false;
 9695:     }
 9696:     if (r < t1) {
 9697:       t1 = r;
 9698:     }
 9699:   } else {
 9700:     if (dy > 0) {
 9701:       if (r > t1) {
 9702:         return false;
 9703:       }
 9704:       if (r > t0) {
 9705:         t0 = r;
 9706:       }
 9707:     }
 9708:   }
 9709:   q = bbox.yb - ay;
 9710:   if (dy === 0 && q < 0) {
 9711:     return false;
 9712:   }
 9713:   r = q / dy;
 9714:   if (dy < 0) {
 9715:     if (r > t1) {
 9716:       return false;
 9717:     }
 9718:     if (r > t0) {
 9719:       t0 = r;
 9720:     }
 9721:   } else {
 9722:     if (dy > 0) {
 9723:       if (r < t0) {
 9724:         return false;
 9725:       }
 9726:       if (r < t1) {
 9727:         t1 = r;
 9728:       }
 9729:     }
 9730:   }
 9731:   if (t0 > 0) {
 9732:     edge.va = this.createVertex(ax + t0 * dx, ay + t0 * dy);
 9733:   }
 9734:   if (t1 < 1) {
 9735:     edge.vb = this.createVertex(ax + t1 * dx, ay + t1 * dy);
 9736:   }
 9737:   if (t0 > 0 || t1 < 1) {
 9738:     this.cells[edge.lSite.voronoiId].closeMe = true;
 9739:     this.cells[edge.rSite.voronoiId].closeMe = true;
 9740:   }
 9741:   return true;
 9742: };
 9743: Voronoi.prototype.clipEdges = function (bbox) {
 9744:   var edges = this.edges;
 9745:   var iEdge = edges.length;
 9746:   var abs_fn = Math.abs;
 9747:   while (iEdge--) {
 9748:     edge = edges[iEdge];
 9749:     if (
 9750:       !this.connectEdge(edge, bbox) ||
 9751:       !this.clipEdge(edge, bbox) ||
 9752:       (abs_fn(edge.va.x - edge.vb.x) < 1e-9 &&
 9753:         abs_fn(edge.va.y - edge.vb.y) < 1e-9)
 9754:     ) {
 9755:       edge.va = edge.vb = null;
 9756:       edges.splice(iEdge, 1);
 9757:     }
 9758:   }
 9759: };
 9760: Voronoi.prototype.closeCells = function (bbox) {
 9761:   var xl = bbox.xl;
 9762:   var xr = bbox.xr;
 9763:   var yt = bbox.yt;
 9764:   var yb = bbox.yb;
 9765:   var cells = this.cells;
 9766:   var iCell = cells.length;
 9767:   var abs_fn = Math.abs;
 9768:   while (iCell--) {
 9769:     cell = cells[iCell];
 9770:     if (!cell.prepareHalfedges()) {
 9771:       continue;
 9772:     }
 9773:     if (!cell.closeMe) {
 9774:       continue;
 9775:     }
 9776:     halfedges = cell.halfedges;
 9777:     nHalfedges = halfedges.length;
 9778:     iLeft = 0;
 9779:     while (iLeft < nHalfedges) {
 9780:       va = halfedges[iLeft].getEndpoint();
 9781:       vz = halfedges[(iLeft + 1) % nHalfedges].getStartpoint();
 9782:       if (abs_fn(va.x - vz.x) >= 1e-9 || abs_fn(va.y - vz.y) >= 1e-9) {
 9783:         switch (true) {
 9784:           case this.equalWithEpsilon(va.x, xl) &&
 9785:             this.lessThanWithEpsilon(va.y, yb):
 9786:             lastBorderSegment = this.equalWithEpsilon(vz.x, xl);
 9787:             vb = this.createVertex(xl, lastBorderSegment ? vz.y : yb);
 9788:             edge = this.createBorderEdge(cell.site, va, vb);
 9789:             iLeft++;
 9790:             halfedges.splice(
 9791:               iLeft,
 9792:               0,
 9793:               this.createHalfedge(edge, cell.site, null),
 9794:             );
 9795:             nHalfedges++;
 9796:             if (lastBorderSegment) {
 9797:               break;
 9798:             }
 9799:             va = vb;
 9800:           case this.equalWithEpsilon(va.y, yb) &&
 9801:             this.lessThanWithEpsilon(va.x, xr):
 9802:             lastBorderSegment = this.equalWithEpsilon(vz.y, yb);
 9803:             vb = this.createVertex(lastBorderSegment ? vz.x : xr, yb);
 9804:             edge = this.createBorderEdge(cell.site, va, vb);
 9805:             iLeft++;
 9806:             halfedges.splice(
 9807:               iLeft,
 9808:               0,
 9809:               this.createHalfedge(edge, cell.site, null),
 9810:             );
 9811:             nHalfedges++;
 9812:             if (lastBorderSegment) {
 9813:               break;
 9814:             }
 9815:             va = vb;
 9816:           case this.equalWithEpsilon(va.x, xr) &&
 9817:             this.greaterThanWithEpsilon(va.y, yt):
 9818:             lastBorderSegment = this.equalWithEpsilon(vz.x, xr);
 9819:             vb = this.createVertex(xr, lastBorderSegment ? vz.y : yt);
 9820:             edge = this.createBorderEdge(cell.site, va, vb);
 9821:             iLeft++;
 9822:             halfedges.splice(
 9823:               iLeft,
 9824:               0,
 9825:               this.createHalfedge(edge, cell.site, null),
 9826:             );
 9827:             nHalfedges++;
 9828:             if (lastBorderSegment) {
 9829:               break;
 9830:             }
 9831:             va = vb;
 9832:           case this.equalWithEpsilon(va.y, yt) &&
 9833:             this.greaterThanWithEpsilon(va.x, xl):
 9834:             lastBorderSegment = this.equalWithEpsilon(vz.y, yt);
 9835:             vb = this.createVertex(lastBorderSegment ? vz.x : xl, yt);
 9836:             edge = this.createBorderEdge(cell.site, va, vb);
 9837:             iLeft++;
 9838:             halfedges.splice(
 9839:               iLeft,
 9840:               0,
 9841:               this.createHalfedge(edge, cell.site, null),
 9842:             );
 9843:             nHalfedges++;
 9844:             if (lastBorderSegment) {
 9845:               break;
 9846:             }
 9847:             va = vb;
 9848:             lastBorderSegment = this.equalWithEpsilon(vz.x, xl);
 9849:             vb = this.createVertex(xl, lastBorderSegment ? vz.y : yb);
 9850:             edge = this.createBorderEdge(cell.site, va, vb);
 9851:             iLeft++;
 9852:             halfedges.splice(
 9853:               iLeft,
 9854:               0,
 9855:               this.createHalfedge(edge, cell.site, null),
 9856:             );
 9857:             nHalfedges++;
 9858:             if (lastBorderSegment) {
 9859:               break;
 9860:             }
 9861:             va = vb;
 9862:             lastBorderSegment = this.equalWithEpsilon(vz.y, yb);
 9863:             vb = this.createVertex(lastBorderSegment ? vz.x : xr, yb);
 9864:             edge = this.createBorderEdge(cell.site, va, vb);
 9865:             iLeft++;
 9866:             halfedges.splice(
 9867:               iLeft,
 9868:               0,
 9869:               this.createHalfedge(edge, cell.site, null),
 9870:             );
 9871:             nHalfedges++;
 9872:             if (lastBorderSegment) {
 9873:               break;
 9874:             }
 9875:             va = vb;
 9876:             lastBorderSegment = this.equalWithEpsilon(vz.x, xr);
 9877:             vb = this.createVertex(xr, lastBorderSegment ? vz.y : yt);
 9878:             edge = this.createBorderEdge(cell.site, va, vb);
 9879:             iLeft++;
 9880:             halfedges.splice(
 9881:               iLeft,
 9882:               0,
 9883:               this.createHalfedge(edge, cell.site, null),
 9884:             );
 9885:             nHalfedges++;
 9886:             if (lastBorderSegment) {
 9887:               break;
 9888:             }
 9889:           default:
 9890:             throw "Voronoi.closeCells() > this makes no sense!";
 9891:         }
 9892:       }
 9893:       iLeft++;
 9894:     }
 9895:     cell.closeMe = false;
 9896:   }
 9897: };
 9898: Voronoi.prototype.quantizeSites = function (sites) {
 9899:   var epsilon = this["\u03b5"];
 9900:   var n = sites.length;
 9901:   while (n--) {
 9902:     site = sites[n];
 9903:     site.x = Math.floor(site.x / epsilon) * epsilon;
 9904:     site.y = Math.floor(site.y / epsilon) * epsilon;
 9905:   }
 9906: };
 9907: Voronoi.prototype.recycle = function (diagram) {
 9908:   if (diagram) {
 9909:     if (diagram instanceof this.Diagram) {
 9910:       this.toRecycle = diagram;
 9911:     } else {
 9912:       throw "Voronoi.recycleDiagram() > Need a Diagram object.";
 9913:     }
 9914:   }
 9915: };
 9916: Voronoi.prototype.compute = function (sites, bbox) {
 9917:   var startTime = new Date();
 9918:   this.reset();
 9919:   if (this.toRecycle) {
 9920:     this.vertexJunkyard = this.vertexJunkyard.concat(this.toRecycle.vertices);
 9921:     this.edgeJunkyard = this.edgeJunkyard.concat(this.toRecycle.edges);
 9922:     this.cellJunkyard = this.cellJunkyard.concat(this.toRecycle.cells);
 9923:     this.toRecycle = null;
 9924:   }
 9925:   var siteEvents = sites.slice(0);
 9926:   siteEvents.sort(function (a, b) {
 9927:     var r = b.y - a.y;
 9928:     if (r) {
 9929:       return r;
 9930:     }
 9931:     return b.x - a.x;
 9932:   });
 9933:   var site = siteEvents.pop();
 9934:   var siteid = 0;
 9935:   var cells = this.cells;
 9936:   while (true) {
 9937:     circle = this.firstCircleEvent;
 9938:     if (
 9939:       site &&
 9940:       (!circle ||
 9941:         site.y < circle.y ||
 9942:         (site.y === circle.y && site.x < circle.x))
 9943:     ) {
 9944:       if (site.x !== xsitex || site.y !== xsitey) {
 9945:         cells[siteid] = this.createCell(site);
 9946:         site.voronoiId = siteid++;
 9947:         this.addBeachsection(site);
 9948:         xsitey = site.y;
 9949:         xsitex = site.x;
 9950:       }
 9951:       site = siteEvents.pop();
 9952:     } else if (circle) {
 9953:       this.removeBeachsection(circle.arc);
 9954:     } else {
 9955:       break;
 9956:     }
 9957:   }
 9958:   this.clipEdges(bbox);
 9959:   this.closeCells(bbox);
 9960:   var stopTime = new Date();
 9961:   var diagram = new this.Diagram();
 9962:   diagram.cells = this.cells;
 9963:   diagram.edges = this.edges;
 9964:   diagram.vertices = this.vertices;
 9965:   diagram.execTime = stopTime.getTime() - startTime.getTime();
 9966:   this.reset();
 9967:   return diagram;
 9968: };
 9969: if (typeof module !== "undefined") {
 9970:   module.exports = Voronoi;
 9971: }
 9972: origami.convertParamShape = {};
 9973: origami.matchNames = {
 9974:   layer: {
 9975:     effects: {
 9976:       layerControl: {
 9977:         layer: { mn: "ADBE Layer Control-0001" },
 9978:         mn: "ADBE Layer Control",
 9979:       },
 9980:       mn: "ADBE Effect Parade",
 9981:     },
 9982:     marker: { mn: "ADBE Marker" },
 9983:     text: {
 9984:       mn: "ADBE Text Properties",
 9985:       sourceText: { mn: "ADBE Text Document" },
 9986:     },
 9987:     transform: {
 9988:       anchorPoint: { mn: "ADBE Anchor Point" },
 9989:       mn: "ADBE Transform Group",
 9990:       opacity: { mn: "ADBE Opacity" },
 9991:       orientation: { mn: "ADBE Orientation" },
 9992:       position: { mn: "ADBE Position" },
 9993:       rotation: { mn: "ADBE Rotate Z" },
 9994:       scale: { mn: "ADBE Scale" },
 9995:     },
 9996:   },
 9997:   paint: {
 9998:     effect: {
 9999:       mn: "ADBE Paint",
10000:       strokes: {
10001:         brush: {
10002:           mn: "ADBE Paint Atom",
10003:           path: { mn: "ADBE Paint Shape" },
10004:           stroke: {
10005:             color: { mn: "ADBE Paint Color" },
10006:             diameter: { mn: "ADBE Paint Diameter" },
10007:             end: { mn: "ADBE Paint End" },
10008:             mn: "ADBE Paint Properties",
10009:           },
10010:           transform: {
10011:             mn: "ADBE Paint Transform",
10012:             position: { mn: "ADBE Paint Position" },
10013:           },
10014:         },
10015:         mn: "ADBE Paint Group",
10016:       },
10017:     },
10018:   },
10019:   shape: {
10020:     contents: {
10021:       group: {
10022:         content: {
10023:           ellipseGroup: {
10024:             mn: "ADBE Vector Shape - Ellipse",
10025:             position: { mn: "ADBE Vector Ellipse Position" },
10026:             size: { mn: "ADBE Vector Ellipse Size" },
10027:           },
10028:           fill: {
10029:             color: { mn: "ADBE Vector Fill Color" },
10030:             mn: "ADBE Vector Graphic - Fill",
10031:             opacity: { mn: "ADBE Vector Fill Opacity" },
10032:           },
10033:           mn: "ADBE Vectors Group",
10034:           pathGroup: {
10035:             mn: "ADBE Vector Shape - Group",
10036:             path: { mn: "ADBE Vector Shape" },
10037:           },
10038:           polystarGroup: {
10039:             innerRadius: { mn: "ADBE Vector Star Inner Radius" },
10040:             innerRoundness: { mn: "ADBE Vector Star Inner Roundess" },
10041:             mn: "ADBE Vector Shape - Star",
10042:             outerRadius: { mn: "ADBE Vector Star Outer Radius" },
10043:             outerRoundness: { mn: "ADBE Vector Star Outer Roundess" },
10044:             points: { mn: "ADBE Vector Star Points" },
10045:             position: { mn: "ADBE Vector Star Position" },
10046:             rotation: { mn: "ADBE Vector Star Rotation" },
10047:             type: { mn: "ADBE Vector Star Type" },
10048:           },
10049:           rectangleGroup: {
10050:             mn: "ADBE Vector Shape - Rect",
10051:             position: { mn: "ADBE Vector Rect Position" },
10052:             roundness: { mn: "ADBE Vector Rect Roundness" },
10053:             size: { mn: "ADBE Vector Rect Size" },
10054:           },
10055:           stroke: {
10056:             color: { mn: "ADBE Vector Stroke Color" },
10057:             lineCap: { mn: "ADBE Vector Stroke Line Cap" },
10058:             lineJoin: { mn: "ADBE Vector Stroke Line Join" },
10059:             mn: "ADBE Vector Graphic - Stroke",
10060:             opacity: { mn: "ADBE Vector Stroke Opacity" },
10061:             width: { mn: "ADBE Vector Stroke Width" },
10062:           },
10063:           trimPaths: {
10064:             end: { mn: "ADBE Vector Trim End" },
10065:             mn: "ADBE Vector Filter - Trim",
10066:           },
10067:         },
10068:         mn: "ADBE Vector Group",
10069:         transform: {
10070:           mn: "ADBE Vector Transform Group",
10071:           position: { mn: "ADBE Vector Position" },
10072:         },
10073:       },
10074:       mn: "ADBE Root Vectors Group",
10075:     },
10076:   },
10077: };
10078: origami.math = {};
10079: origami.math.turnVector2D = function (vec, angle) {
10080:   angle = (angle / 180) * Math.PI;
10081:   var rotatedVec = [];
10082:   rotatedVec[0] = vec[0] * Math.cos(angle) - vec[1] * Math.sin(angle);
10083:   rotatedVec[1] = vec[0] * Math.sin(angle) + vec[1] * Math.cos(angle);
10084:   return rotatedVec;
10085: };
10086: origami.math.generatePolygon = function (numPoints, radius) {
10087:   if (numPoints < 3) {
10088:     throw new Error("Can\'t generate polygon with " + numPoints + " points");
10089:   }
10090:   if (radius <= 0) {
10091:     throw new Error("Can\'t generate polygon with radius = " + radius);
10092:   }
10093:   var angleStep = 360 / numPoints;
10094:   var vertices = [];
10095:   for (var i = 0; i < numPoints; i += 1) {
10096:     var vec = [0, -radius];
10097:     vec = origami.math.turnVector2D(vec, angleStep * i);
10098:     vertices.push(vec);
10099:   }
10100:   return vertices;
10101: };
10102: origami.getAllParamObjects = function (_group, _transformsArr) {
10103:   var transformName = "ADBE Vector Transform Group";
10104:   var allowedNames = [];
10105:   allowedNames.push(
10106:     origami.matchNames.shape.contents.group.content.rectangleGroup.mn,
10107:   );
10108:   allowedNames.push(
10109:     origami.matchNames.shape.contents.group.content.ellipseGroup.mn,
10110:   );
10111:   allowedNames.push(
10112:     origami.matchNames.shape.contents.group.content.polystarGroup.mn,
10113:   );
10114:   var arr = [];
10115:   if (_transformsArr == undefined) {
10116:     var _transformsArr = [];
10117:   }
10118:   if (_group.property(transformName) !== null) {
10119:     localTrArr = _transformsArr.concat([_group.property(transformName)]);
10120:   } else {
10121:     localTrArr = _transformsArr;
10122:   }
10123:   for (var i = 1; i <= _group.numProperties; i += 1) {
10124:     curProp = _group.property(i);
10125:     if (allowedNames.indexOf(curProp.matchName) >= 0) {
10126:       var obj = { prop: curProp, transformsArr: localTrArr };
10127:       arr.push(obj);
10128:     } else {
10129:       if (curProp instanceof PropertyGroup) {
10130:         arr = arr.concat(origami.getAllParamObjects(curProp, localTrArr));
10131:       }
10132:     }
10133:   }
10134:   return arr;
10135: };
10136: origami.convertParamShape = function (prop) {
10137:   rectangle = function (prop) {
10138:     var size = prop.property(
10139:       origami.matchNames.shape.contents.group.content.rectangleGroup.size.mn,
10140:     ).value;
10141:     var pos = prop.property(
10142:       origami.matchNames.shape.contents.group.content.rectangleGroup.position
10143:         .mn,
10144:     ).value;
10145:     var roundness = prop.property(
10146:       origami.matchNames.shape.contents.group.content.rectangleGroup.roundness
10147:         .mn,
10148:     ).value;
10149:     if (!(size instanceof Array)) {
10150:       throw new Error("Size is not an array");
10151:     }
10152:     var vertices = [];
10153:     vertices[0] = [size[0], -size[1]] / 2;
10154:     vertices[1] = [size[0], size[1]] / 2;
10155:     vertices[2] = [-size[0], size[1]] / 2;
10156:     vertices[3] = [-size[0], -size[1]] / 2;
10157:     for (var i = 0; i < vertices.length; i += 1) {
10158:       vertices[i] += pos;
10159:     }
10160:     if (roundness > 0) {
10161:       var roundVertices = [];
10162:       roundVertices[7] = vertices[0] + [-roundness, 0];
10163:       roundVertices[0] = vertices[0] + [0, roundness];
10164:       roundVertices[1] = vertices[1] + [0, -roundness];
10165:       roundVertices[2] = vertices[1] + [-roundness, 0];
10166:       roundVertices[3] = vertices[2] + [roundness, 0];
10167:       roundVertices[4] = vertices[2] + [0, -roundness];
10168:       roundVertices[5] = vertices[3] + [0, roundness];
10169:       roundVertices[6] = vertices[3] + [roundness, 0];
10170:       return roundVertices;
10171:     } else {
10172:       return vertices;
10173:     }
10174:   };
10175:   ellipse = function (prop) {
10176:     var size = prop.property(
10177:       origami.matchNames.shape.contents.group.content.ellipseGroup.size.mn,
10178:     ).value;
10179:     var pos = prop.property(
10180:       origami.matchNames.shape.contents.group.content.ellipseGroup.position.mn,
10181:     ).value;
10182:     var vertices = [];
10183:     vertices.push([0, -size[1] / 2]);
10184:     vertices.push([size[0] / 2, 0]);
10185:     vertices.push([0, size[1] / 2]);
10186:     vertices.push([-size[0] / 2, 0]);
10187:     for (var i = 0; i < vertices.length; i += 1) {
10188:       vertices[i] += pos;
10189:     }
10190:     return vertices;
10191:   };
10192:   polystar = function (prop) {
10193:     paramPoly = function (prop) {
10194:       var numPoints = prop.property(
10195:         origami.matchNames.shape.contents.group.content.polystarGroup.points.mn,
10196:       ).value;
10197:       var outerRadius = prop.property(
10198:         origami.matchNames.shape.contents.group.content.polystarGroup
10199:           .outerRadius.mn,
10200:       ).value;
10201:       return origami.math.generatePolygon(numPoints, outerRadius);
10202:     };
10203:     star = function (prop) {
10204:       var numPoints = prop.property(
10205:         origami.matchNames.shape.contents.group.content.polystarGroup.points.mn,
10206:       ).value;
10207:       var innerRadius = prop.property(
10208:         origami.matchNames.shape.contents.group.content.polystarGroup
10209:           .innerRadius.mn,
10210:       ).value;
10211:       var outerPolygon = paramPoly(prop);
10212:       var innerPolygon = origami.math.generatePolygon(numPoints, innerRadius);
10213:       for (var i = 0; i < innerPolygon.length; i += 1) {
10214:         innerPolygon[i] = origami.math.turnVector2D(
10215:           innerPolygon[i],
10216:           180 / numPoints,
10217:         );
10218:       }
10219:       if (outerPolygon.length != innerPolygon.length) {
10220:         throw new Error(
10221:           "Error while converting a polystar: outer and inner polygons do not match!",
10222:         );
10223:       }
10224:       var vertices = [];
10225:       for (var i = 0; i < innerPolygon.length; i += 1) {
10226:         vertices.push(outerPolygon[i]);
10227:         vertices.push(innerPolygon[i]);
10228:       }
10229:       return vertices;
10230:     };
10231:     var type = prop.property(
10232:       origami.matchNames.shape.contents.group.content.polystarGroup.type.mn,
10233:     ).value;
10234:     var rotation = prop.property(
10235:       origami.matchNames.shape.contents.group.content.polystarGroup.rotation.mn,
10236:     ).value;
10237:     var position = prop.property(
10238:       origami.matchNames.shape.contents.group.content.polystarGroup.position.mn,
10239:     ).value;
10240:     var vertices = [];
10241:     if (type == 2) {
10242:       vertices = paramPoly(prop);
10243:     } else if (type == 1) {
10244:       vertices = star(prop);
10245:     } else {
10246:       throw new Error("Unknown polystar type!");
10247:     }
10248:     for (var i = 0; i < vertices.length; i += 1) {
10249:       vertices[i] = origami.math.turnVector2D(vertices[i], rotation);
10250:       vertices[i] += position;
10251:     }
10252:     return vertices;
10253:   };
10254:   var vertices = [];
10255:   switch (prop.matchName) {
10256:     case origami.matchNames.shape.contents.group.content.rectangleGroup.mn:
10257:       vertices = rectangle(prop);
10258:       break;
10259:     case origami.matchNames.shape.contents.group.content.ellipseGroup.mn:
10260:       vertices = ellipse(prop);
10261:       break;
10262:     case origami.matchNames.shape.contents.group.content.polystarGroup.mn:
10263:       vertices = polystar(prop);
10264:       break;
10265:     default:
10266:       throw new Error("Unknown parametrical shape type!");
10267:   }
10268:   return vertices;
10269: };
10270: var Vertex = function (x, y) {
10271:   if (arguments.length === 1) {
10272:     if (Array.isArray(x)) {
10273:       y = x[1];
10274:       x = x[0];
10275:     } else {
10276:       y = x.y;
10277:       x = x.x;
10278:     }
10279:   }
10280:   this.x = x;
10281:   this.y = y;
10282:   this.next = null;
10283:   this.prev = null;
10284:   this._corresponding = null;
10285:   this._distance = 0;
10286:   this._isEntry = true;
10287:   this._isIntersection = false;
10288:   this._visited = false;
10289:   this._isShared = false;
10290: };
10291: Vertex.createIntersection = function (x, y, distance) {
10292:   var vertex = new Vertex(x, y);
10293:   vertex._distance = distance;
10294:   vertex._isIntersection = true;
10295:   vertex._isEntry = false;
10296:   return vertex;
10297: };
10298: Vertex.prototype.visit = function () {
10299:   this._visited = true;
10300:   if (this._corresponding !== null && !this._corresponding._visited) {
10301:     this._corresponding.visit();
10302:   }
10303: };
10304: Vertex.prototype.equals = function (v) {
10305:   return this.x === v.x && this.y === v.y;
10306: };
10307: Vertex.prototype.setCorresponding = function (v) {
10308:   this._corresponding = v;
10309: };
10310: Vertex.prototype.isInside = function (poly) {
10311:   var oddNodes = false;
10312:   var vertex = poly.first;
10313:   var next = vertex.next;
10314:   var x = this.x;
10315:   var y = this.y;
10316:   do {
10317:     if (
10318:       ((vertex.y < y && next.y >= y) || next.y < y) &&
10319:       vertex.y >= y &&
10320:       (vertex.x <= x || next.x <= x)
10321:     ) {
10322:       oddNodes ^=
10323:         vertex.x +
10324:           ((y - vertex.y) / (next.y - vertex.y)) * (next.x - vertex.x) <
10325:         x;
10326:     }
10327:     vertex = vertex.next;
10328:     next = vertex.next || poly.first;
10329:   } while (!vertex.equals(poly.first));
10330:   return oddNodes;
10331: };
10332: Vertex.prototype.onSegment = function (segment) {
10333:   var x1 = segment[0].x;
10334:   var y1 = segment[0].y;
10335:   var x2 = segment[1].x;
10336:   var y2 = segment[1].y;
10337:   if (
10338:     this.x == x1 &&
10339:     this.x == x2 &&
10340:     ((y1 < this.y && this.y < y2) || (y2 < this.y && this.y < y1))
10341:   ) {
10342:     return true;
10343:   }
10344:   return (
10345:     (this.x - x1) * (y2 - y1) - (this.y - y1) * (x2 - x1) == 0 &&
10346:     ((x1 < this.x && this.x < x2) || (x2 < this.x && this.x < x1))
10347:   );
10348: };
10349: Vertex.prototype.inMiddleOfStraightLine = function () {
10350:   var x1 = this.prev.x;
10351:   var y1 = this.prev.y;
10352:   var x2 = this.x;
10353:   var y2 = this.y;
10354:   var x3 = this.next.x;
10355:   var y3 = this.next.y;
10356:   return (x3 - x1) / (x2 - x1) == (y3 - y1) / (y2 - y1);
10357: };
10358: var Intersection = function (s1, s2, c1, c2) {
10359:   this.x = 0;
10360:   this.y = 0;
10361:   this.toSource = 0;
10362:   this.toClip = 0;
10363:   this.d = 0;
10364:   var d = (c2.y - c1.y) * (s2.x - s1.x) - (c2.x - c1.x) * (s2.y - s1.y);
10365:   if (d === 0) {
10366:     return;
10367:   }
10368:   this.toSource =
10369:     ((c2.x - c1.x) * (s1.y - c1.y) - (c2.y - c1.y) * (s1.x - c1.x)) / d;
10370:   this.toClip =
10371:     ((s2.x - s1.x) * (s1.y - c1.y) - (s2.y - s1.y) * (s1.x - c1.x)) / d;
10372:   if (this.valid()) {
10373:     this.x = s1.x + this.toSource * (s2.x - s1.x);
10374:     this.y = s1.y + this.toSource * (s2.y - s1.y);
10375:   }
10376: };
10377: Intersection.prototype.valid = function () {
10378:   return (
10379:     0 < this.toSource && this.toSource < 1 && 0 < this.toClip && this.toClip < 1
10380:   );
10381: };
10382: Array.isArray =
10383:   Array.isArray ||
10384:   function (o) {
10385:     return Boolean(
10386:       o && Object.prototype.toString.call(Object(o)) === "[object Array]",
10387:     );
10388:   };
10389: var isVertexSharedWith = function (vert, pol) {
10390:   var polVertex = pol.first;
10391:   do {
10392:     if (vert.x == polVertex.x && vert.y == polVertex.y) {
10393:       return true;
10394:     }
10395:     polVertex = polVertex.next;
10396:   } while (!polVertex.equals(pol.first));
10397:   return false;
10398: };
10399: __buildPolyFake = function (arr) {
10400:   if (!Array.isArray(arr)) {
10401:     alert("NOT ARRAY");
10402:     return arr;
10403:   }
10404:   var poly = {};
10405:   poly = arr.map(function (o) {
10406:     return { x: o[0], y: o[1] };
10407:   });
10408:   return poly;
10409: };
10410: var Polygon = function (p, arrayVertices) {
10411:   this.first = null;
10412:   this.vertices = 0;
10413:   this._lastUnprocessed = null;
10414:   this._arrayVertices =
10415:     typeof arrayVertices === "undefined" ? Array.isArray(p[0]) : arrayVertices;
10416:   for (var i = 0, len = p.length; i < len; i++) {
10417:     this.addVertex(new Vertex(p[i]));
10418:   }
10419:   origami.writeln("POLYGON CREATED!");
10420:   origami.writeln("FROM:");
10421:   for (var i = 0; i < p.length; i += 1) {
10422:     origami.writeln(p[i].x + " " + p[i].y);
10423:   }
10424:   origami.writeln("-----\n");
10425: };
10426: Polygon.prototype.addVertex = function (vertex) {
10427:   if (this.first == null) {
10428:     this.first = vertex;
10429:     this.first.next = vertex;
10430:     this.first.prev = vertex;
10431:   } else {
10432:     var next = this.first;
10433:     var prev = next.prev;
10434:     next.prev = vertex;
10435:     vertex.next = next;
10436:     vertex.prev = prev;
10437:     prev.next = vertex;
10438:   }
10439:   this.vertices++;
10440: };
10441: Polygon.prototype.insertVertex = function (vertex, start, end) {
10442:   var curr = start;
10443:   while (!curr.equals(end) && curr._distance < vertex._distance) {
10444:     curr = curr.next;
10445:   }
10446:   vertex.next = curr;
10447:   prev = curr.prev;
10448:   vertex.prev = prev;
10449:   prev.next = vertex;
10450:   curr.prev = vertex;
10451:   this.vertices++;
10452: };
10453: Polygon.prototype.insertBetween = function (vertex, start, end) {
10454:   vertex.prev = start;
10455:   start.next = vertex;
10456:   vertex.next = end;
10457:   end.prev = vertex;
10458:   this.vertices++;
10459:   return vertex;
10460: };
10461: Polygon.prototype.getNext = function (v) {
10462:   var c = v;
10463:   while (c._isIntersection) {
10464:     c = c.next;
10465:   }
10466:   return c;
10467: };
10468: Polygon.prototype.getFirstIntersect = function () {
10469:   var v = this._firstIntersect || this.first;
10470:   do {
10471:     if (v._isIntersection && !v._visited) {
10472:       break;
10473:     }
10474:     v = v.next;
10475:   } while (!v.equals(this.first));
10476:   this._firstIntersect = v;
10477:   return v;
10478: };
10479: Polygon.prototype.hasUnprocessed = function () {
10480:   var v = this._lastUnprocessed || this.first;
10481:   do {
10482:     if (v._isIntersection && !v._visited) {
10483:       this._lastUnprocessed = v;
10484:       return true;
10485:     }
10486:     v = v.next;
10487:   } while (!v.equals(this.first));
10488:   this._lastUnprocessed = null;
10489:   return false;
10490: };
10491: Polygon.prototype.getPoints = function () {
10492:   var points = [];
10493:   var v = this.first;
10494:   if (this._arrayVertices) {
10495:     do {
10496:       points.push([v.x, v.y]);
10497:       v = v.next;
10498:     } while (v !== this.first);
10499:   } else {
10500:     do {
10501:       points.push({ x: v.x, y: v.y });
10502:       v = v.next;
10503:     } while (v !== this.first);
10504:   }
10505:   return points;
10506: };
10507: Polygon.prototype.setCorrespondingPair = function (vertex) {
10508:   var v = this.first;
10509:   do {
10510:     if (v.x == vertex.x && v.y == vertex.y) {
10511:       vertex._corresponding = v;
10512:       v._corresponding = vertex;
10513:     }
10514:     v = v.next;
10515:   } while (!v.equals(this.first));
10516: };
10517: var vertexPushed = function (arr, vert_arr) {
10518:   for (var i = 0; i < arr.length; i += 1) {
10519:     if (arr[i][0] == vert_arr[0] && arr[i][1] == vert_arr[1]) {
10520:       return true;
10521:     }
10522:   }
10523:   return false;
10524: };
10525: Polygon.prototype.clip = function (clip, sourceForwards, clipForwards) {
10526:   var sourceVertex = this.first;
10527:   var clipVertex = clip.first;
10528:   origami.writeln("making cool stuf");
10529:   origami.writeln(sourceForwards + " " + clipForwards);
10530:   var arr_pushed = [];
10531:   do {
10532:     do {
10533:       if (
10534:         sourceVertex.onSegment([clipVertex, clipVertex.next]) &&
10535:         !vertexPushed(arr_pushed, [sourceVertex.x, sourceVertex.y])
10536:       ) {
10537:         inserted = clip.insertBetween(
10538:           new Vertex(sourceVertex.x, sourceVertex.y),
10539:           clipVertex,
10540:           clipVertex.next,
10541:         );
10542:         arr_pushed.push([sourceVertex.x, sourceVertex.y]);
10543:         sourceVertex = sourceVertex.next;
10544:       } else {
10545:         sourceVertex = sourceVertex.next;
10546:       }
10547:     } while (!sourceVertex.equals(this.first));
10548:     clipVertex = clipVertex.next;
10549:   } while (!clipVertex.equals(clip.first));
10550:   arr_pushed = [];
10551:   do {
10552:     do {
10553:       if (
10554:         clipVertex.onSegment([sourceVertex, sourceVertex.next]) &&
10555:         !vertexPushed(arr_pushed, [clipVertex.x, clipVertex.y])
10556:       ) {
10557:         inserted = this.insertBetween(
10558:           new Vertex(clipVertex.x, clipVertex.y),
10559:           sourceVertex,
10560:           sourceVertex.next,
10561:         );
10562:         arr_pushed.push([clipVertex.x, clipVertex.y]);
10563:         clipVertex = clipVertex.next;
10564:       } else {
10565:         clipVertex = clipVertex.next;
10566:       }
10567:     } while (!clipVertex.equals(clip.first));
10568:     sourceVertex = sourceVertex.next;
10569:   } while (!sourceVertex.equals(this.first));
10570:   sourceVertex = this.first;
10571:   clipVertex = clip.first;
10572:   do {
10573:     sourceVertex = sourceVertex.next;
10574:   } while (!sourceVertex.equals(this.first));
10575:   clipVertex = clip.first;
10576:   sourceVertex = this.first;
10577:   if (clip.first == null) {
10578:     origami.writeln("TUT!!!");
10579:     return this.getPoints();
10580:   }
10581:   do {
10582:     if (!sourceVertex._isIntersection) {
10583:       do {
10584:         if (!clipVertex._isIntersection) {
10585:           var i = new Intersection(
10586:             sourceVertex,
10587:             this.getNext(sourceVertex.next),
10588:             clipVertex,
10589:             clip.getNext(clipVertex.next),
10590:           );
10591:           if (i.valid()) {
10592:             var sourceIntersection = Vertex.createIntersection(
10593:               i.x,
10594:               i.y,
10595:               i.toSource,
10596:             );
10597:             var clipIntersection = Vertex.createIntersection(
10598:               i.x,
10599:               i.y,
10600:               i.toClip,
10601:             );
10602:             sourceIntersection._corresponding = clipIntersection;
10603:             clipIntersection._corresponding = sourceIntersection;
10604:             this.insertVertex(
10605:               sourceIntersection,
10606:               sourceVertex,
10607:               this.getNext(sourceVertex.next),
10608:             );
10609:             clip.insertVertex(
10610:               clipIntersection,
10611:               clipVertex,
10612:               clip.getNext(clipVertex.next),
10613:             );
10614:             origami.writeln("found intersection");
10615:           }
10616:         }
10617:         clipVertex = clipVertex.next;
10618:       } while (!clipVertex.equals(clip.first));
10619:     }
10620:     sourceVertex = sourceVertex.next;
10621:   } while (!sourceVertex.equals(this.first));
10622:   sourceVertex = this.first;
10623:   clipVertex = clip.first;
10624:   do {
10625:     if (
10626:       !sourceVertex._isIntersection &&
10627:       isVertexSharedWith(sourceVertex, clip)
10628:     ) {
10629:       if (!this._firstIntersect) {
10630:         this._firstIntersect = sourceVertex;
10631:       }
10632:       sourceVertex._isIntersection = true;
10633:       sourceVertex._isShared = true;
10634:       sourceVertex._corresponding = sourceVertex;
10635:     }
10636:     sourceVertex = sourceVertex.next;
10637:   } while (!sourceVertex.equals(this.first));
10638:   do {
10639:     if (!clipVertex._isIntersection && isVertexSharedWith(clipVertex, this)) {
10640:       if (!clip._firstIntersect) {
10641:         clip._firstIntersect = clipVertex;
10642:       }
10643:       clipVertex._isIntersection = true;
10644:       clipVertex._isShared = true;
10645:       clipVertex._corresponding = clipVertex;
10646:     }
10647:     clipVertex = clipVertex.next;
10648:   } while (!clipVertex.equals(clip.first));
10649:   sourceVertex = this.first;
10650:   clipVertex = clip.first;
10651:   sourceInClip = _contains(sourceVertex, clip.getPoints());
10652:   var f = this.getPoints();
10653:   clipInSource = _contains(clipVertex, __buildPolyFake(this.getPoints()));
10654:   origami.writeln("first source: " + this.first.x + " " + this.first.y);
10655:   origami.writeln("first clipping: " + clip.first.x + " " + clip.first.y);
10656:   origami.writeln(
10657:     "Calculated SINCLIP and CISOUR " + sourceInClip + " " + clipInSource,
10658:   );
10659:   sourceForwards ^= sourceInClip;
10660:   clipForwards ^= clipInSource;
10661:   do {
10662:     if (sourceVertex._isIntersection) {
10663:       if (sourceVertex._isShared && sourceVertex.next._isShared) {
10664:         sourceVertex._isIntersection = false;
10665:       } else {
10666:         sourceVertex._isEntry = Boolean(sourceForwards);
10667:         sourceForwards = Boolean(!sourceForwards);
10668:       }
10669:       if (!sourceVertex.inMiddleOfStraightLine() && sourceVertex._isShared) {
10670:         sourceVertex._isEntry = Boolean(sourceForwards);
10671:         sourceForwards = Boolean(!sourceForwards);
10672:       }
10673:     }
10674:     sourceVertex = sourceVertex.next;
10675:   } while (!sourceVertex.equals(this.first));
10676:   do {
10677:     if (clipVertex._isIntersection) {
10678:       if (clipVertex._isShared && clipVertex.next._isShared) {
10679:         clipVertex._isIntersection = false;
10680:       } else {
10681:         clipVertex._isEntry = Boolean(clipForwards);
10682:         clipForwards = Boolean(!clipForwards);
10683:       }
10684:       if (!clipVertex.inMiddleOfStraightLine() && clipVertex._isShared) {
10685:         clipVertex._isIntersection = true;
10686:       }
10687:     }
10688:     clipVertex = clipVertex.next;
10689:   } while (!clipVertex.equals(clip.first));
10690:   var list = [];
10691:   while (this.hasUnprocessed()) {
10692:     var current = this.getFirstIntersect();
10693:     var clipped = new Polygon([], this._arrayVertices);
10694:     clipped.addVertex(new Vertex(current.x, current.y));
10695:     do {
10696:       current.visit();
10697:       if (current._isEntry) {
10698:         do {
10699:           current = current.next;
10700:           clipped.addVertex(new Vertex(current.x, current.y));
10701:         } while (!current._isIntersection);
10702:       } else {
10703:         do {
10704:           current = current.prev;
10705:           clipped.addVertex(new Vertex(current.x, current.y));
10706:         } while (!current._isIntersection);
10707:       }
10708:       current = current._corresponding;
10709:     } while (!current._visited);
10710:     list.push(clipped.getPoints());
10711:   }
10712:   origami.writeln(
10713:     "Polygonjs: sourceinClip and clipInSource" +
10714:       sourceInClip +
10715:       " " +
10716:       clipInSource,
10717:   );
10718:   if (list.length === 0) {
10719:     if (sourceInClip) {
10720:       list.push(this.getPoints());
10721:     }
10722:     if (clipInSource) {
10723:       list.push(clip.getPoints());
10724:     }
10725:     if (list.length === 0) {
10726:       list = null;
10727:     }
10728:   }
10729:   return list;
10730: };
10731: clip = function (polygonA, polygonB, eA, eB) {
10732:   origami.writeln("SUKO" + eA + " " + eB);
10733:   var source = new Polygon(polygonA);
10734:   var clip = new Polygon(polygonB);
10735:   var result = source.clip(clip, eA, eB);
10736:   return result;
10737: };
10738: greinerHormann = this;
10739: greinerHormann.union = function (polygonA, polygonB) {
10740:   return clip(polygonA, polygonB, false, false);
10741: };
10742: greinerHormann.intersection = function (polygonA, polygonB) {
10743:   return clip(polygonA, polygonB, true, true);
10744: };
10745: greinerHormann.diff = function (polygonA, polygonB) {
10746:   return clip(polygonA, polygonB, false, true);
10747: };
10748: origami.mergePolygons = function (mask) {
10749:   var activeComp = app.project.activeItem;
10750:   if (activeComp && activeComp instanceof CompItem) {
10751:     var sel = activeComp.selectedLayers;
10752:     if (sel.length > 1) {
10753:       var tmpPolys = [];
10754:       for (var s = 0; s < 2; s += 1) {
10755:         tmpPolys.push(this.getSliceVertices(sel[s], mask));
10756:       }
10757:       tmpPolys[0].mergeWith(tmpPolys[1]);
10758:       sel[1].remove();
10759:       if (!mask) {
10760:         p = sel[0].property("ADBE Root Vectors Group").getFirstPath();
10761:       } else {
10762:         p = sel[0]
10763:           .property("ADBE Mask Parade")
10764:           .property("ADBE Mask Atom")
10765:           .property("ADBE Mask Shape");
10766:       }
10767:       var newPoly = new Shape();
10768:       newPoly.vertices = tmpPolys[0].vertices.map(function (o) {
10769:         return [o.x, o.y];
10770:       });
10771:       newPoly.closed = true;
10772:       p.setValue(newPoly);
10773:     }
10774:   }
10775: };
10776: origami.shapesToMasks = function (layer) {
10777:   if (layer == undefined) {
10778:     var activeComp = app.project.activeItem;
10779:     if (activeComp && activeComp instanceof CompItem) {
10780:       var sel = activeComp.selectedLayers;
10781:       if (sel && sel.length > 0) {
10782:         layer = sel[0];
10783:       }
10784:     }
10785:   }
10786:   if (layer && layer instanceof ShapeLayer) {
10787:     var comp = layer.containingComp;
10788:     var originalPolygons = layer
10789:       .property("ADBE Root Vectors Group")
10790:       .getAllPathsObjects();
10791:     var polygons = originalPolygons.map(function (p) {
10792:       return new this.polygon(p.prop.value.vertices, layer);
10793:     });
10794:     var transforms = originalPolygons.map(function (t) {
10795:       return new this.point(
10796:         t.transformsArr[0].property("ADBE Vector Position").value -
10797:           t.transformsArr[0].property("ADBE Vector Anchor").value,
10798:       );
10799:     });
10800:     for (var p = 0; p < polygons.length; p += 1) {
10801:       polygons[p].vertices = polygons[p].vertices.addToAll(transforms[p]);
10802:     }
10803:     var maskSolid = comp.layers.addSolid(
10804:       [1, 1, 0],
10805:       "maskSolid",
10806:       comp.width,
10807:       comp.height,
10808:       comp.pixelAspect,
10809:       comp.duration,
10810:     );
10811:     maskSolid
10812:       .property("ADBE Transform Group")
10813:       .property("ADBE Position")
10814:       .setValue([0, 0]);
10815:     maskSolid
10816:       .property("ADBE Transform Group")
10817:       .property("ADBE Anchor Point")
10818:       .setValue([0, 0]);
10819:     for (var p = 0; p < polygons.length; p += 1) {
10820:       meshGen.drawMask(
10821:         polygons[p].vertices.map(function (o) {
10822:           return [o.x, o.y];
10823:         }),
10824:         maskSolid,
10825:         1,
10826:       );
10827:     }
10828:   }
10829: };
10830: origami.unwrap = function (thisObj, mode, onePoint, out, animArray) {
10831:   var activeComp = app.project.activeItem;
10832:   if (activeComp && activeComp instanceof CompItem) {
10833:     var sel = activeComp.selectedLayers;
10834:     if (sel != undefined) {
10835:       origami.activeGraph = origami.buildGraph(activeComp);
10836:       origami.writeln(origami.activeGraph.vertices.length);
10837:       if (origami.activeGraph.vertices.length > 0) {
10838:         var w = new Window("palette");
10839:         var progressGroup = w.add(
10840:           "group{orientation:\'column\', justify: \'center\',alignment:[\'left\',\'top\']}",
10841:         );
10842:         var progressTxt = progressGroup.add(
10843:           "statictext",
10844:           undefined,
10845:           "Looking for neighbors",
10846:         );
10847:         var progress = progressGroup.add(
10848:           "progressbar",
10849:           undefined,
10850:           1,
10851:           origami.activeGraph.vertices.length,
10852:         );
10853:         w.show();
10854:         origami.activeGraph.resetParentingAndProps();
10855:         origami.activeGraph = origami.buildGraph(activeComp);
10856:         origami.activeGraph.buildEdges(Boolean(mode), onePoint, progress);
10857:         origami.activeGraph.setParentingAndProps();
10858:         if (out) {
10859:           origami.activeGraph.reverseParenting();
10860:         }
10861:         origami.applyExpressions(origami.activeGraph, animArray);
10862:         origami.activeGraph.postAction();
10863:       }
10864:     }
10865:   }
10866: };
10867: origami.buildGraph = function (_comp, _update) {
10868:   var comp = _comp || null;
10869:   var update = _update || false;
10870:   if (comp == null) {
10871:     var tmp = app.project.activeItem;
10872:     if (tmp instanceof CompItem) {
10873:       comp = tmp;
10874:     }
10875:   }
10876:   var graph = new this.graph(comp);
10877:   for (var l = 1; l <= comp.layers.length; l += 1) {
10878:     if (comp.layers[l].enabled == true) {
10879:       var newPolygon = this.getSliceVertices(comp.layers[l]);
10880:       if (newPolygon) {
10881:         vert = new this.graphVertex(comp.layers[l], newPolygon);
10882:         if (update === true) {
10883:           weight = comp.layers[l].name.lastIndexOf("_\t");
10884:           if (weight != -1) {
10885:             weight = Number(
10886:               comp.layers[l].name.substr(
10887:                 weight + 1,
10888:                 comp.layers[l].name.length,
10889:               ),
10890:             );
10891:             vert.setLayerWeight(weight);
10892:             if (weight == 0) {
10893:               graph.addStartVertex(vert);
10894:             }
10895:           }
10896:         }
10897:         if (vert) {
10898:           graph.addVertex(vert);
10899:         }
10900:         if (comp.layers[l].selected === true) {
10901:           graph.addStartVertex(vert);
10902:         }
10903:       }
10904:     }
10905:   }
10906:   return graph;
10907: };
10908: origami.getLayerBound = function (_layer) {
10909:   function getSourceRect(_layer) {
10910:     var gettySlider = _layer
10911:       .property("ADBE Effect Parade")
10912:       .addProperty("ADBE Point Control");
10913:     gettySlider.property("ADBE Point Control-0001").expression =
10914:       "thisLayer.sourceRectAtTime(time, true).width * [1,1]";
10915:     width = gettySlider
10916:       .property("ADBE Point Control-0001")
10917:       .valueAtTime(_layer.containingComp.time, false)[0];
10918:     gettySlider.property("ADBE Point Control-0001").expression =
10919:       "thisLayer.sourceRectAtTime(time, true).height * [1,1]";
10920:     height = gettySlider
10921:       .property("ADBE Point Control-0001")
10922:       .valueAtTime(_layer.containingComp.time, false)[0];
10923:     gettySlider.remove();
10924:     return [
10925:       [0, 0],
10926:       [width, 0],
10927:       [width, height],
10928:       [0, height],
10929:     ];
10930:   }
10931:   var maskVertices = getSourceRect(_layer);
10932:   origami.drawMask(maskVertices, _layer, 1, true);
10933:   return new origami.polygon(maskVertices, _layer);
10934: };
10935: origami.createShattermap = function (colorType) {
10936:   var activeComp = app.project.activeItem;
10937:   if (activeComp && activeComp instanceof CompItem) {
10938:     var sel = activeComp.selectedLayers;
10939:     var colorGen = new origami.colorGenerator();
10940:     if (sel) {
10941:       origami.activeGraph = origami.buildGraph(activeComp);
10942:       var shapeLayer = activeComp.layers.addShape();
10943:       shapeLayer.name = activeComp.name + "_shattermap";
10944:       shapeLayer
10945:         .property("ADBE Transform Group")
10946:         .property("ADBE Position")
10947:         .setValue([0, 0]);
10948:       var polygons = origami.activeGraph.vertices.map(function (o) {
10949:         return o.polygon.vertices.map(function (v) {
10950:           return [v.x, v.y];
10951:         });
10952:       });
10953:       origami.makeSlices(
10954:         activeComp,
10955:         polygons,
10956:         activeComp.layers[1],
10957:         true,
10958:         1,
10959:         false,
10960:         false,
10961:         false,
10962:         2,
10963:         80,
10964:         true,
10965:       );
10966:     }
10967:   }
10968: };
10969: origami.relinkMainNull = function (comp, connect) {
10970:   var tmp = [];
10971:   var controlLayer = comp.layer(origami.names.controlLayer);
10972:   if (controlLayer) {
10973:     if (connect === false) {
10974:       for (var l = 1; l <= comp.layers.length; l += 1) {
10975:         thisL = comp.layers[l];
10976:         if (thisL.parent == controlLayer) {
10977:           tmp.push(thisL);
10978:           thisL.parent = null;
10979:         }
10980:       }
10981:       origami.tmpConnect = tmp;
10982:     } else {
10983:       if (origami.tmpConnect) {
10984:         for (var t = 0; t < origami.tmpConnect.length; t += 1) {
10985:           origami.tmpConnect[t].parent = controlLayer;
10986:         }
10987:       }
10988:     }
10989:   }
10990: };
10991: origami.applyExpressions = function (graph, animArray) {
10992:   for (var v = 0; v < graph.vertices.length; v += 1) {
10993:     try {
10994:       if (animArray[0]) {
10995:         graph.vertices[v].layer
10996:           .property("ADBE Transform Group")
10997:           .property("ADBE Rotate X").expression = this.expressions.rotX;
10998:       } else {
10999:         graph.vertices[v].layer
11000:           .property("ADBE Transform Group")
11001:           .property("ADBE Rotate X").expression = "";
11002:       }
11003:       if (animArray[1]) {
11004:         graph.vertices[v].layer
11005:           .property("ADBE Transform Group")
11006:           .property("ADBE Opacity").expression = this.expressions.opacity;
11007:       } else {
11008:         graph.vertices[v].layer
11009:           .property("ADBE Transform Group")
11010:           .property("ADBE Opacity").expression = "";
11011:       }
11012:       if (animArray[2]) {
11013:         graph.vertices[v].layer
11014:           .property("ADBE Transform Group")
11015:           .property("ADBE Scale").expression = this.expressions.scale;
11016:       } else {
11017:         graph.vertices[v].layer
11018:           .property("ADBE Transform Group")
11019:           .property("ADBE Scale").expression = "";
11020:       }
11021:       if (animArray[3]) {
11022:         graph.vertices[v].layer
11023:           .property("ADBE Transform Group")
11024:           .property("ADBE Position").expression = this.expressions.position;
11025:       } else {
11026:         graph.vertices[v].layer
11027:           .property("ADBE Transform Group")
11028:           .property("ADBE Position").expression = "";
11029:       }
11030:       if (animArray[4]) {
11031:         graph.vertices[v].layer
11032:           .property("ADBE Transform Group")
11033:           .property("ADBE Rotate Z").expression = this.expressions.rotZ;
11034:       } else {
11035:         graph.vertices[v].layer
11036:           .property("ADBE Transform Group")
11037:           .property("ADBE Rotate Z").expression = "";
11038:       }
11039:     } catch (err) {
11040:       null;
11041:     }
11042:   }
11043: };
11044: origami.masksExplode = function (layer, offset, remove) {
11045:   if (layer == undefined) {
11046:     var activeComp = app.project.activeItem;
11047:     if (activeComp && activeComp instanceof CompItem) {
11048:       var sel = activeComp.selectedLayers;
11049:       if (sel.length > 0) {
11050:         layer = sel[0];
11051:       }
11052:     }
11053:   }
11054:   if (layer && layer.property("ADBE Mask Parade").numProperties > 0) {
11055:     var masks = layer.property("ADBE Mask Parade");
11056:     var allMasks = [];
11057:     for (var m = masks.numProperties; m > 0; m--) {
11058:       allMasks.push(masks.property(m).property("ADBE Mask Shape").value);
11059:       masks.property(m).remove();
11060:     }
11061:     for (var m = 0; m < allMasks.length; m += 1) {
11062:       var newLayer = layer.duplicate();
11063:       var newMask = newLayer
11064:         .property("ADBE Mask Parade")
11065:         .addProperty("ADBE Mask Atom");
11066:       newMask.property("ADBE Mask Shape").setValue(allMasks[m]);
11067:       newMask.property("ADBE Mask Offset").setValue(offset);
11068:       newLayer.name = newLayer.name + "_Mask_" + String(m);
11069:     }
11070:     if (remove) {
11071:       layer.remove();
11072:     }
11073:   }
11074: };
11075: var wtfnh = {
11076:   helpButtons: [],
11077:   offerBeta: false,
11078:   offerTrial: true,
11079:   privateNumber: 7242854536479338,
11080:   productSKU: "NSO-SUL",
11081:   scriptAuthor: "ExtraBite",
11082:   scriptName: "Origami",
11083:   scriptURL: "https://aescripts.com/origami/",
11084:   scriptVersion: "1.4.0",
11085: };
11086: var gr44ssa = new a(wtfnh);
11087: if (gr44ssa.t()) {
11088:   origami.kekPuk = true;
11089: } else {
11090:   origami.kekPuk = false;
11091:   origami.jsx_Registered = gr44ssa.getRegistration();
11092: }
11093: if (gr44ssa.c()) {
11094:   origami.buildGUI(origami);
11095: } else {
11096:   alert("Such a great time to purchase Origami!");
11097: }
```
