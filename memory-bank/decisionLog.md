# Decision Log

## Architectural Decisions

[2026-02-08 22:40:00] - GridCloner CEP implementation using Hybrid 2.0 architecture - Rationale: leverage existing PyShiftBridge registry pattern, maintain consistency with MediaSolution panel, provide pure Python coordinate matrix generation with AE mutations via PyShiftAE - Implications: new CEP panel ready for testing, extends PyShiftBridge with dual handler registry, expressions not supported (note returned), 3D flag set via PyFx.LayerSuite().SetLayerFlag, controller null + Slider Control effect added for future linking - Files Modified: GridCloner-CEP/ (full panel), PyShiftBridge/gridcloner/ (handlers + core), PyShiftBridge/bridge_daemon.py (registry integration), PyShiftBridge/tests/test_gridcloner_pure.py (8/8 passed)

[2026-02-08 19:32:00] - Documentation capabilities.md refaite en v3 avec matrice d'arbitrage enrichie basée sur audit SDK AEGP - Rationale: clarifier quand utiliser PyShiftAE natif vs fallback ExtendScript, identifier angles morts du SDK C++ (.ffx, layer.comment), fournir architecture hybride avec batching C++ - Implications: documentation plus précise pour développeurs, évite erreurs d'architecture, guide optimisation performance (80% PyShiftAE, 20% ExtendScript) - Files Modified: docs/04-reference/capabilities.md (refonte complète)

[2026-02-07 16:20:00] - MediaSolution CEP: STEP3.1 project open migrated as opt-in via PyShiftBridge (`mediasolution_open_project_and_select_comp`) with ping preflight + ExtendScript fallback. - Rationale: keep risky project IO behind feature flag while reducing ExtendScript burden and enabling more consistent comp/layer selection heuristics in Python. - Implications: CEP UI adds `enablePythonProjectOpen` toggle; host selects comp/layer in JSX after Python returns names/indices; tests expanded (pytest 41/41).

[2026-02-07 15:40:00] - Architecture: Completed MediaSolution batch pipeline migration to PyShiftAE via PyShiftBridge (images import, comp/layer prepare, cuts, auto-recenter) with DISABLE_UNDO_GROUP support for nested undo contexts; integrated versioned bootstrap scripts with environment variable path strategy; added comprehensive unit tests (21/21 pass). - Rationale: reduce AE freezing and code duplication while maintaining compatibility; provide production-ready bootstrap system without hardcoded paths. - Implications: heavy batch operations now use PyShiftBridge with fallback ExtendScript; bootstrap scripts versioned in repo with env-var path strategy; DISABLE_UNDO_GROUP support for batch undo groups.

[2026-02-07 13:18:00] - MediaSolution CEP: migration progressive validée - Cuts CSV du batch (STEP3.2) routés vers PyShiftAE via PyShiftBridge avec fallback ExtendScript + ajout flag `DISABLE_UNDO_GROUP` pour éviter undo groups imbriqués - Rationale: réduire gel AE et duplication logicielle tout en conservant compatibilité - Implications: batch cuts utilise `sendToPyShiftBridge(mediasolution_apply_cuts_active_layer)` + tests PyShiftBridge mis à jour (pytest OK)

[2026-02-07 12:47:00] - Session completed - docs-updater workflow appliqué à MediaSolution integration - Rationale: documentation obsolète vs code Hybrid 2.0 (transport, health monitoring, auto recentrage) - Implications: docs/mediasolution/mediasolution_pyshiftae_integration.md enrichi avec sections Hybrid 2.0 Transport (Mermaid), Health Monitoring & UI Feedback, Validation & Observabilité, Tests unitaires (24/24), Déploiement 7.x checklist - Application skill documentation (TL;DR, problem-first, trade-offs, Golden Rule) - Alignement parfait entre état actuel du code et documentation - Memory Bank synchronisée

[2026-02-06 22:30:00] - Session completed - MediaSolution CEP Cuts → PyShiftBridge → PyShiftAE validated in production (9 projects processed) - Rationale: integration works end-to-end with mailbox transport and fallback preserved - Implications: bootstrap snippets added to installation guide, comprehensive integration guide created with detailed next steps for future sessions

[2026-02-06 20:28:00] - MediaSolution CEP Cuts routed through PyShiftBridge mailbox → PyShiftAE (fallback ExtendScript preserved) - Rationale: keep UI in CEP/JSX but move heavy AE mutations to PyShiftAE patterns and standardize IPC transport - Implications: new entrypoint `mediasolution_apply_cuts_active_layer`, runtime config sync via `updateRuntimeConfig`, adds pure Python core + unit tests; requires PyShiftBridge daemon availability

[2025-02-06 19:49:00] - Move aetk_bindings.md from docs/internal/after_effects/ to docs/internal/pyshiftae/ for better logical grouping - **Rationale**: AETK bindings document the C++ foundation that underpins PyShiftAE, making them more logically grouped with PyShiftAE documentation than standalone After Effects scripting guides - Document covers complete AETK → SDK architecture with PyShiftBridge → PyShiftAE → PyFx → AETK → AE SDK pipeline, serving as native foundation for PyShiftAE API - **Implications**: Consolidated all PyShiftAE-related documentation (Python API + C++ wrappers) in single directory - Maintained clear separation between PyShiftAE ecosystem and pure ExtendScript content - Updated cross-references in docs/index.md and docs/architecture_overview.md to new location - **Files Modified**: Moved docs/internal/after_effects/aetk_bindings.md → docs/internal/pyshiftae/aetk_bindings.md - Updated docs/index.md and docs/architecture_overview.md links - **Alternatives Considered**: Keep in after_effects/ directory (would fragment PyShiftAE documentation) - Create separate aetk/ subdirectory (unnecessary complexity for single file)

[2025-02-06 19:15:00] - Add explicit formatting rules for reverse chronological order and single-line entries in progress.md and decisionLog.md - **Rationale**: Improve readability and maintainability of memory bank logs - Ensure consistent structure across all memory bank entries - Follow best practices for log organization with newest entries first - **Implications**: All future entries in progress.md and decisionLog.md must be single-line - New entries must be inserted at the top (reverse chronological order) - Enhanced consistency and easier scanning of recent activity - **Files Modified**: Updated `.windsurf/rules/memorybankprotocol.md` with entry_formatting section - Reorganized progress.md to follow new formatting rules - **Alternatives Considered**: Keep existing multi-line format (less readable) - Use chronological order (harder to find recent entries)

[2025-02-06 18:08:00] - Initialize Memory Bank structure for After Effects Scripts & Plugins Bundle project - **Rationale**: Project complexity (559+ scripts) requires systematic tracking - Multiple automation frameworks need coordinated documentation - Existing .windsurf/ structure suggests mature development workflow - **Implications**: Centralized context for all development activities - Better knowledge retention across sessions - Improved project organization and maintainability - **Alternatives Considered**: Continue without structured memory management - Use external documentation tools - Rely solely on git history

[2025-02-06 18:11:00] - Update memorybankprotocol.md to reference project-specific documentation files - **Rationale**: Original references (`ARCHITECTURE_COMPLETE_FR.md`, `GUIDE_DEMARRAGE_RAPIDE.md`, `REFERENCE_RAPIDE_DEVELOPPEURS.md`) don't exist in this project - Project has rich documentation structure in `docs/` with official and internal sections - Key files identified: `docs/official/index.md` (AE Scripting Guide), `docs/internal/pyshiftae/pyshiftae_guide.md` (comprehensive PyShiftAE guide) - **Implications**: Better context awareness for documentation-related queries - More accurate responses based on actual project documentation - Improved alignment with project's documentation architecture - **Alternatives Considered**: Keep generic references (less effective) - Add all documentation files (too verbose)

[2025-02-06 18:47:00] - Implement comprehensive documentation updates based on structural audit - **Rationale**: Audit revealed 372k LOC with significant C++/Python asymmetry (270k C++ vs 8k Python) - Critical gaps identified: Shape Layers editing, TaskScheduler deep dive, Scripts reference missing - Memory Bank context confirmed need for better technical documentation - **Implications**: Enhanced developer experience with precise API coverage mapping - Clear roadmap for PyShiftAE limitations and workarounds - Standardized documentation patterns for AE ecosystem - **Files Created/Modified**: Extended `docs/internal/pyshiftae/pyshiftae_guide.md` with volumetry, TaskScheduler diagram, Shape limitations - Created `docs/official/general/scripts_reference.md` for 5 critical ExtendScript scripts - Created `docs/internal/after_effects/aetk_bindings.md` for C++ wrappers architecture - **Alternatives Considered**: Minimal updates only (insufficient for project complexity) - Focus only on Python docs (would ignore C++ foundation)

[2025-02-06 19:02:00] - Create unified documentation architecture with ecosystem dashboard and bridge documentation - **Rationale**: Previous audit revealed excellent technical docs but fragmented navigation - User needs clear entry point showing all 4 frameworks (Scripts_AE, PyShiftAE, PyShiftBridge, AETK) - Missing comprehensive bridge documentation for IPC communication patterns - Need to showcase 372k LOC metrics and technology choices - **Implications**: Single entry point (`docs/official/index.md`) with ecosystem overview and quick navigation - New architecture documentation (`docs/official/architecture/overview.md`) with detailed metrics and patterns - Complete bridge documentation (`docs/official/bridge/communication.md`) with IPC protocols and examples - Cross-linked documentation ecosystem with consistent navigation - Better developer onboarding with technology-specific pathways - **Files Created/Modified**: **NEW** `docs/official/architecture/overview.md` - Complete ecosystem architecture with Mermaid diagrams, volumetry metrics, integration patterns - **NEW** `docs/official/bridge/communication.md` - Comprehensive PyShiftBridge documentation with IPC protocols, CEP examples, troubleshooting - **UPDATED** `docs/official/index.md` - Transformed from simple guide to ecosystem dashboard with metrics, quick start, navigation by technology - **Technical Details**: Added ecosystem Mermaid diagram showing CEP → Bridge → Python → C++ → AE flow - Integrated real volumetry: 73k LOC C++, 8k LOC Python, 150k LOC estimated JSX - Documented Hybrid 2.0 architecture with named pipes/sockets + JSON fallback - Created quick start guide for each technology pathway - **Alternatives Considered**: Keep existing simple index (would miss ecosystem complexity) - Focus only on new docs (would break existing navigation) - Separate documentation sites (would fragment knowledge)

[2025-02-06 19:04:00] - Move foundational documentation to docs/ root for better accessibility - **Rationale**: Architecture overview, bridge communication are cross-cutting concerns - Root-level placement provides better visibility and navigation - Reduces nesting complexity for fundamental documents - Aligns with documentation hierarchy: foundational → specific - **Implications**: `docs/architecture_overview.md` - Ecosystem architecture at root level - `docs/bridge_communication.md` - IPC protocols at root level - Updated all cross-references to new locations - Cleaner docs/ structure with clear hierarchy - **Files Moved**: `docs/official/architecture/overview.md` → `docs/architecture_overview.md` - `docs/official/bridge/communication.md` → `docs/bridge_communication.md` - Updated links in `docs/official/index.md` and moved documents - **Alternatives Considered**: Keep in official/ subdirectory (would bury foundational content) - Create separate top-level sections (would overcomplicate structure)

[2025-02-06 19:06:00] - Move docs/official/index.md to docs/index.md for proper root-level entry point - **Rationale**: Main entry point should be at docs/ root for maximum accessibility - Current location in official/ subdirectory creates unnecessary navigation depth - Root index.md serves as true portal to entire documentation ecosystem - Aligns with standard documentation hierarchy practices - **Implications**: `docs/index.md` - Main dashboard and entry point at root level - Updated all internal links to reflect new root position - Simplified navigation path for all users - Clear separation: entry point (root) → specialized content (subdirectories) - **Files Moved**: `docs/official/index.md` → `docs/index.md` - Updated all relative paths from `../` to `./` syntax - Fixed navigation links throughout the document - **Alternatives Considered**: Keep in official/ (would require extra navigation step) - Create symlink (would complicate maintenance) - Duplicate content (would create sync issues)

---
*Last updated: 2025-02-06*
